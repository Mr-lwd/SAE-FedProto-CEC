==================================================
goal = gltest_umap
device = cuda
device_id = 0
dataset = MNIST_dir_0.1_imbalance_40
jetson = 0
DVFS = 0
drawGMM = 0
num_classes = 10
model_family = HCNNs8
batch_size = 256
num_workers = 0
local_learning_rate = 0.06
use_decay_scheduler = False
learning_rate_decay = False
learning_rate_decay_gamma = 0.99
global_rounds = 200
edge_epochs = 1
local_epochs = 5
algorithm = FedProto
join_ratio = 1.0
edge_join_ratio = 1.0
random_join_ratio = False
num_clients = 40
num_edges = 10
prev = 0
times = 1
eval_gap = 1
save_folder_name = static
auto_break = False
feature_dim = 512
vocab_size = 98635
max_len = 200
client_drop_rate = 0.0
train_slow_rate = 0.0
send_slow_rate = 0.0
time_select = False
time_threthold = 10000
optimizer = SGD
lamda = 1.0
weight_decay = 0
trans_delay_simulate = False
momentum = 0.8
agg_type = 0
buffersize = 10
gl_use_clients = 1
test_useglclassifier = 1
gamma = 1
drawtsne = 1
drawround = 20
noise_dim = 512
generator_learning_rate = 0.0001
hidden_dim = 512
server_epochs = 100
alpha = 1.0
beta = 1.0
mentee_learning_rate = 0.005
T_start = 0.95
T_end = 0.98
server_learning_rate = 0.01
margin_threthold = 100.0
generator_path = stylegan/stylegan-xl-models/imagenet64.pkl
stable_diffusion_prompt = a cat
server_batch_size = 100
gen_batch_size = 4
mu = 50.0
buffer_size = 10
==================================================
Random seed set as 42
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes)
temp/MNIST_dir_0.1_imbalance_40/NE_10/featuredim_512/FedProto/SGD/lr_0.06/wd_0/momentum_0.8/lbs_256/lamda_1.0/localepoch_5/buffer_10/gamma_1_usegltest_1/
id 0
label_counts: defaultdict(<class 'int'>, {4: 158, 9: 289, 2: 4, 6: 121})
id 1
label_counts: defaultdict(<class 'int'>, {6: 1134, 5: 758, 1: 271, 0: 9})
id 2
label_counts: defaultdict(<class 'int'>, {7: 2296, 1: 923, 5: 49})
id 3
label_counts: defaultdict(<class 'int'>, {8: 57, 6: 52, 4: 16, 5: 654, 2: 451, 0: 2, 3: 1, 1: 1})
id 4
label_counts: defaultdict(<class 'int'>, {2: 718, 9: 865, 6: 391, 0: 93})
id 5
label_counts: defaultdict(<class 'int'>, {7: 364, 8: 1280, 0: 34})
id 6
label_counts: defaultdict(<class 'int'>, {4: 1193, 0: 369, 2: 14, 1: 10})
id 7
label_counts: defaultdict(<class 'int'>, {9: 1087, 8: 34, 5: 33, 6: 17, 7: 5})
id 8
label_counts: defaultdict(<class 'int'>, {2: 1474, 1: 320})
id 9
label_counts: defaultdict(<class 'int'>, {5: 434, 4: 506, 1: 50, 7: 1})
id 10
label_counts: defaultdict(<class 'int'>, {6: 696, 5: 114, 3: 14, 7: 3})
id 11
label_counts: defaultdict(<class 'int'>, {3: 1008, 5: 70, 6: 296, 0: 29})
id 12
label_counts: defaultdict(<class 'int'>, {3: 1642, 0: 32})
id 13
label_counts: defaultdict(<class 'int'>, {3: 1120, 4: 192})
id 14
label_counts: defaultdict(<class 'int'>, {2: 309, 1: 352, 3: 6, 6: 5})
id 15
label_counts: defaultdict(<class 'int'>, {8: 235, 2: 21, 1: 72, 7: 49, 3: 70, 5: 1})
id 16
label_counts: defaultdict(<class 'int'>, {6: 262, 9: 284, 1: 38, 8: 66, 0: 8})
id 17
label_counts: defaultdict(<class 'int'>, {4: 2317, 1: 196})
id 18
label_counts: defaultdict(<class 'int'>, {7: 1087, 3: 608, 5: 157, 4: 21, 1: 16, 0: 1})
id 19
label_counts: defaultdict(<class 'int'>, {8: 119, 2: 260, 7: 7, 9: 1})
id 20
label_counts: defaultdict(<class 'int'>, {7: 320, 3: 436, 1: 248, 9: 69, 4: 1, 8: 1})
id 21
label_counts: defaultdict(<class 'int'>, {1: 50, 6: 230, 5: 897, 9: 7, 3: 1, 7: 3})
id 22
label_counts: defaultdict(<class 'int'>, {9: 769, 5: 33, 0: 3})
id 23
label_counts: defaultdict(<class 'int'>, {8: 1046, 2: 859, 0: 3, 5: 2})
id 24
label_counts: defaultdict(<class 'int'>, {0: 778, 6: 33, 8: 3, 9: 1, 5: 1})
id 25
label_counts: defaultdict(<class 'int'>, {0: 1463})
id 26
label_counts: defaultdict(<class 'int'>, {0: 390, 6: 465, 1: 543, 2: 3})
id 27
label_counts: defaultdict(<class 'int'>, {0: 1152, 6: 696, 5: 27})
id 28
label_counts: defaultdict(<class 'int'>, {0: 644, 8: 35, 5: 3, 6: 13, 2: 4, 9: 1})
id 29
label_counts: defaultdict(<class 'int'>, {8: 265, 9: 1793, 0: 69, 4: 16, 3: 14})
id 30
label_counts: defaultdict(<class 'int'>, {1: 368, 0: 78, 2: 1, 7: 2, 4: 1, 6: 1})
id 31
label_counts: defaultdict(<class 'int'>, {2: 1094, 5: 1461, 4: 190, 1: 4, 3: 1})
id 32
label_counts: defaultdict(<class 'int'>, {8: 843, 1: 99, 7: 54, 9: 16, 4: 6, 3: 1, 5: 1})
id 33
label_counts: defaultdict(<class 'int'>, {4: 486, 9: 30, 6: 445, 0: 2, 5: 1})
id 34
label_counts: defaultdict(<class 'int'>, {1: 1866})
id 35
label_counts: defaultdict(<class 'int'>, {3: 141, 8: 578, 1: 71, 2: 23, 4: 1, 9: 12})
id 36
label_counts: defaultdict(<class 'int'>, {1: 254, 5: 70, 8: 42, 7: 11, 2: 7, 6: 1})
id 37
label_counts: defaultdict(<class 'int'>, {7: 1286, 6: 162, 3: 95, 1: 10, 0: 8})
id 38
label_counts: defaultdict(<class 'int'>, {1: 122, 3: 191, 0: 11, 6: 27})
id 39
label_counts: defaultdict(<class 'int'>, {8: 484, 1: 1, 6: 107, 7: 1, 4: 1, 2: 1, 3: 1, 9: 1})

Join ratio / total clients: 1.0 / 40
Finished creating server and clients.
Server glclassifier Not Found
X shape: (191, 512), Y shape: (191,)
Server glclassifier Not Found
X shape: (725, 512), Y shape: (725,)
Server glclassifier Not Found
X shape: (1090, 512), Y shape: (1090,)
Server glclassifier Not Found
X shape: (412, 512), Y shape: (412,)
Server glclassifier Not Found
X shape: (690, 512), Y shape: (690,)
Server glclassifier Not Found
X shape: (560, 512), Y shape: (560,)
Server glclassifier Not Found
X shape: (529, 512), Y shape: (529,)
Server glclassifier Not Found
X shape: (392, 512), Y shape: (392,)
Server glclassifier Not Found
X shape: (599, 512), Y shape: (599,)
Server glclassifier Not Found
X shape: (331, 512), Y shape: (331,)
Server glclassifier Not Found
X shape: (276, 512), Y shape: (276,)
Server glclassifier Not Found
X shape: (468, 512), Y shape: (468,)
Server glclassifier Not Found
X shape: (559, 512), Y shape: (559,)
Server glclassifier Not Found
X shape: (438, 512), Y shape: (438,)
Server glclassifier Not Found
X shape: (224, 512), Y shape: (224,)
Server glclassifier Not Found
X shape: (150, 512), Y shape: (150,)
Server glclassifier Not Found
X shape: (220, 512), Y shape: (220,)
Server glclassifier Not Found
X shape: (838, 512), Y shape: (838,)
Server glclassifier Not Found
X shape: (631, 512), Y shape: (631,)
Server glclassifier Not Found
X shape: (130, 512), Y shape: (130,)
Server glclassifier Not Found
X shape: (359, 512), Y shape: (359,)
Server glclassifier Not Found
X shape: (397, 512), Y shape: (397,)
Server glclassifier Not Found
X shape: (269, 512), Y shape: (269,)
Server glclassifier Not Found
X shape: (637, 512), Y shape: (637,)
Server glclassifier Not Found
X shape: (273, 512), Y shape: (273,)
Server glclassifier Not Found
X shape: (488, 512), Y shape: (488,)
Server glclassifier Not Found
X shape: (467, 512), Y shape: (467,)
Server glclassifier Not Found
X shape: (625, 512), Y shape: (625,)
Server glclassifier Not Found
X shape: (234, 512), Y shape: (234,)
Server glclassifier Not Found
X shape: (720, 512), Y shape: (720,)
Server glclassifier Not Found
X shape: (151, 512), Y shape: (151,)
Server glclassifier Not Found
X shape: (917, 512), Y shape: (917,)
Server glclassifier Not Found
X shape: (340, 512), Y shape: (340,)
Server glclassifier Not Found
X shape: (322, 512), Y shape: (322,)
Server glclassifier Not Found
X shape: (622, 512), Y shape: (622,)
Server glclassifier Not Found
X shape: (276, 512), Y shape: (276,)
Server glclassifier Not Found
X shape: (129, 512), Y shape: (129,)
Server glclassifier Not Found
X shape: (521, 512), Y shape: (521,)
Server glclassifier Not Found
X shape: (118, 512), Y shape: (118,)
Server glclassifier Not Found
X shape: (199, 512), Y shape: (199,)
Averaged Test Accuracy (Regular Model): 0.9910
Averaged Test Accuracy (Prototype Model): 0.9910
Averaged Train Loss (Regular Model): 0.0000
Averaged Train Loss (Regular + Proto): 0.0000
Std Test Accuracy (Regular Model): 0.0103
Std Test Accuracy (Prototype Model): 0.0102
umap_features map
