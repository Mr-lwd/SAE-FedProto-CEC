==================================================
goal = test
device = cuda
device_id = 0
dataset = MNIST_dir_0.3_imbalance_40
num_classes = 10
model_family = HCNNs8
batch_size = 256
local_learning_rate = 0.06
use_decay_scheduler = False
learning_rate_decay = False
learning_rate_decay_gamma = 0.99
global_rounds = 200
edge_epochs = 1
local_epochs = 5
algorithm = FedTGP
join_ratio = 1.0
random_join_ratio = False
num_clients = 40
num_edges = 10
prev = 0
times = 1
eval_gap = 1
save_folder_name = temp
auto_break = False
feature_dim = 512
vocab_size = 98635
max_len = 200
client_drop_rate = 0.0
train_slow_rate = 0.0
send_slow_rate = 0.0
time_select = False
time_threthold = 10000
optimizer = SGD
lamda = 1.0
weight_decay = 0
trans_delay_simulate = False
momentum = 0.8
agg_type = 0
buffersize = 10
mixclassifier = 0
gl_use_clients = 1
test_useglclassifier = 1
tgpaddmse = 0
addmse = 0
gamma = 1
addTGP = 0
SAEbeta = 0
drawtsne = 1
drawround = 20
noise_dim = 512
generator_learning_rate = 0.005
hidden_dim = 512
server_epochs = 100
alpha = 1.0
beta = 1.0
mentee_learning_rate = 0.005
T_start = 0.95
T_end = 0.98
server_learning_rate = 0.01
margin_threthold = 100.0
generator_path = stylegan/stylegan-xl-models/imagenet64.pkl
stable_diffusion_prompt = a cat
server_batch_size = 100
gen_batch_size = 4
mu = 50.0
==================================================
Random seed set as 42

============= Running time: 0th =============
Creating server and clients ...
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 0
label_counts: defaultdict(<class 'int'>, {7: 487, 6: 197, 8: 413, 1: 35, 4: 113, 0: 3, 5: 8, 2: 24})
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 1
label_counts: defaultdict(<class 'int'>, {1: 314, 8: 346, 7: 243, 0: 210, 3: 103, 4: 45, 2: 9, 5: 6, 6: 4})
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 2
label_counts: defaultdict(<class 'int'>, {9: 543, 4: 422, 2: 135, 0: 70, 6: 48, 3: 24, 8: 31, 5: 3, 1: 4})
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 3
label_counts: defaultdict(<class 'int'>, {1: 485, 0: 152, 8: 245, 3: 110, 2: 22, 7: 2, 6: 7, 9: 1})
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 4
label_counts: defaultdict(<class 'int'>, {6: 53, 7: 164, 8: 230, 3: 236, 0: 43, 1: 24, 5: 5, 9: 13})
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 5
label_counts: defaultdict(<class 'int'>, {5: 257, 3: 425, 2: 36, 8: 33, 7: 5, 0: 9, 4: 1, 9: 2})
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 6
label_counts: defaultdict(<class 'int'>, {3: 471, 5: 64, 6: 76, 7: 35, 1: 22, 2: 44, 9: 41, 8: 14, 0: 1})
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 7
label_counts: defaultdict(<class 'int'>, {8: 469, 7: 49, 2: 50, 3: 890, 4: 16, 6: 62})
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 8
label_counts: defaultdict(<class 'int'>, {2: 136, 7: 267, 9: 101, 4: 69, 5: 237, 8: 112, 6: 72, 3: 7, 0: 18, 1: 5})
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 9
label_counts: defaultdict(<class 'int'>, {0: 161, 7: 383, 2: 164, 4: 108, 3: 76, 8: 31, 5: 93, 1: 4, 9: 4})
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 10
label_counts: defaultdict(<class 'int'>, {2: 924, 6: 181, 7: 897, 3: 36, 0: 3, 5: 7})
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 11
label_counts: defaultdict(<class 'int'>, {5: 572, 4: 98, 0: 797, 2: 58, 1: 11})
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 12
label_counts: defaultdict(<class 'int'>, {9: 1764, 3: 362, 6: 302, 4: 231, 5: 101, 0: 44, 2: 2, 8: 10})
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 13
label_counts: defaultdict(<class 'int'>, {6: 579, 4: 103, 2: 53, 0: 20, 5: 7, 3: 172, 7: 346})
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 14
label_counts: defaultdict(<class 'int'>, {3: 332, 7: 524, 4: 328, 6: 47, 1: 47, 0: 2})
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 15
label_counts: defaultdict(<class 'int'>, {9: 233, 7: 156, 1: 215, 8: 88, 4: 49, 6: 15, 3: 4, 2: 4, 0: 4})
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 16
label_counts: defaultdict(<class 'int'>, {9: 190, 8: 72, 2: 563, 6: 243, 1: 61, 0: 75, 4: 2, 5: 22, 3: 36, 7: 16})
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 17
label_counts: defaultdict(<class 'int'>, {6: 102, 1: 376, 0: 255, 3: 14, 2: 14, 5: 4, 9: 3})
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 18
label_counts: defaultdict(<class 'int'>, {4: 679, 3: 362, 5: 233, 2: 6})
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 19
label_counts: defaultdict(<class 'int'>, {6: 80, 5: 72, 4: 89, 0: 154, 1: 59, 3: 3, 2: 52, 9: 2, 7: 1})
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 20
label_counts: defaultdict(<class 'int'>, {4: 381, 5: 1209, 1: 460, 3: 233, 2: 21})
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 21
label_counts: defaultdict(<class 'int'>, {2: 380, 8: 90, 9: 122, 6: 368, 1: 45, 3: 3, 5: 10, 7: 5, 0: 1})
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 22
label_counts: defaultdict(<class 'int'>, {1: 790, 0: 220, 2: 270})
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 23
label_counts: defaultdict(<class 'int'>, {6: 312, 2: 136, 0: 163, 3: 36, 9: 26, 1: 82, 4: 11, 5: 1, 7: 1})
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 24
label_counts: defaultdict(<class 'int'>, {7: 320, 6: 60, 4: 62, 1: 50, 9: 10, 3: 6, 8: 2, 5: 2})
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 25
label_counts: defaultdict(<class 'int'>, {2: 148, 1: 723, 4: 375, 3: 4, 7: 9, 5: 21})
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 26
label_counts: defaultdict(<class 'int'>, {0: 379, 6: 65, 2: 222, 3: 205, 1: 62, 7: 34, 9: 41, 5: 4, 8: 10, 4: 2})
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 27
label_counts: defaultdict(<class 'int'>, {5: 398, 9: 368, 7: 252, 4: 199, 0: 42, 1: 17, 2: 3, 6: 1})
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 28
label_counts: defaultdict(<class 'int'>, {0: 514, 3: 395, 2: 371})
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 29
label_counts: defaultdict(<class 'int'>, {8: 699, 0: 155, 2: 125, 4: 780, 1: 25, 3: 4, 6: 3, 5: 1})
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 30
label_counts: defaultdict(<class 'int'>, {2: 378, 5: 453, 1: 140, 0: 260, 4: 37, 3: 12})
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 31
label_counts: defaultdict(<class 'int'>, {9: 234, 1: 392, 6: 9, 4: 99, 8: 23, 0: 8, 7: 1, 3: 2})
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 32
label_counts: defaultdict(<class 'int'>, {0: 67, 9: 603, 5: 241, 2: 68, 3: 27, 7: 8, 6: 3, 8: 6, 1: 1})
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 33
label_counts: defaultdict(<class 'int'>, {6: 877, 2: 252, 0: 237, 1: 72, 4: 42, 3: 55, 5: 1})
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 34
label_counts: defaultdict(<class 'int'>, {0: 547, 4: 196, 1: 62, 9: 105, 6: 51, 2: 40, 7: 6, 5: 16, 3: 1})
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 35
label_counts: defaultdict(<class 'int'>, {6: 292, 8: 88, 2: 42, 7: 49, 9: 38, 5: 2, 3: 1})
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 36
label_counts: defaultdict(<class 'int'>, {6: 459, 9: 44, 4: 63, 1: 205, 3: 17, 2: 77, 8: 23, 7: 124, 0: 12})
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 37
label_counts: defaultdict(<class 'int'>, {8: 1303, 5: 58, 6: 75, 7: 71, 2: 8, 3: 13, 0: 6, 1: 2})
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 38
label_counts: defaultdict(<class 'int'>, {1: 631, 7: 208, 8: 83, 3: 38, 5: 25, 9: 6, 6: 26, 4: 7})
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 39
label_counts: defaultdict(<class 'int'>, {5: 141, 9: 267, 8: 28, 0: 64, 4: 4, 1: 6, 6: 1, 3: 1})

Join ratio / total clients: 1.0 / 40
Finished creating server and clients.
Trainable_prototypes(
  (embedings): Embedding(10, 512)
  (middle): Sequential(
    (0): Sequential(
      (0): Linear(in_features=512, out_features=512, bias=True)
      (1): ReLU()
    )
  )
  (fc): Linear(in_features=512, out_features=512, bias=True)
)
tobetrained:
[9, 8, 7, 6, 5, 4, 3, 2, 1, 0]
Edge 9 begin training
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Edge 8 begin training
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Edge 7 begin training
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Edge 6 begin training
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Edge 5 begin training
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Edge 4 begin training
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Edge 3 begin training
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Edge 2 begin training
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Edge 1 begin training
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Edge 0 begin training
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
readyList:
[6, 8, 7, 0, 2, 5, 4, 3, 1, 9]
aggregation_buffer:
[6, 8, 7, 0, 2, 5, 4, 3, 1, 9]
class-wise minimum distance tensor([0.2194, 0.2715, 0.1865, 0.1865, 0.2023, 0.2592, 0.2441, 0.2022, 0.2696,
        0.2022], device='cuda:0')
min_gap tensor(0.1865, device='cuda:0')
max_gap tensor(0.2715, device='cuda:0')
Server loss: 2.56246018409729
Number of samples: 314
end Update
server_global_time: 0.8651506304740906
only_train_time: 9.891700707376003

-------------Global Round number: 0-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.8217
Averaged Test Accuracy (Prototype Model): 0.1106
Averaged Train Loss (Regular Model): 0.7027
Averaged Train Loss (Regular + Proto): 0.7027
Std Test Accuracy (Regular Model): 0.1764
Std Test Accuracy (Prototype Model): 0.1384
tobetrained:
[6, 8, 7, 0, 2, 5, 4, 3, 1, 9]
Edge 6 begin training
Edge 8 begin training
Edge 7 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 3 begin training
Edge 1 begin training
Edge 9 begin training
readyList:
[0, 6, 8, 7, 2, 4, 5, 9, 3, 1]
aggregation_buffer:
[0, 6, 8, 7, 2, 4, 5, 9, 3, 1]
class-wise minimum distance tensor([2.0397, 1.6990, 1.3851, 1.1527, 1.6081, 1.1527, 1.5864, 1.5946, 1.6394,
        1.5946], device='cuda:0')
min_gap tensor(1.1527, device='cuda:0')
max_gap tensor(2.0397, device='cuda:0')
Server loss: 3.9616239070892334
end Update
server_global_time: 1.6719703301787376
only_train_time: 24.588190525770187

-------------Global Round number: 1-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9118
Averaged Test Accuracy (Prototype Model): 0.7779
Averaged Train Loss (Regular Model): 0.3559
Averaged Train Loss (Regular + Proto): 0.4660
Std Test Accuracy (Regular Model): 0.1117
Std Test Accuracy (Prototype Model): 0.2395
tobetrained:
[0, 6, 8, 7, 2, 4, 5, 9, 3, 1]
Edge 0 begin training
Edge 6 begin training
Edge 8 begin training
Edge 7 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 0, 7, 8, 2, 4, 5, 9, 3, 1]
aggregation_buffer:
[6, 0, 7, 8, 2, 4, 5, 9, 3, 1]
class-wise minimum distance tensor([1.3130, 1.2989, 1.1222, 0.9135, 1.1563, 0.9135, 1.1444, 1.0921, 1.1360,
        1.0921], device='cuda:0')
min_gap tensor(0.9135, device='cuda:0')
max_gap tensor(1.3130, device='cuda:0')
Server loss: 2.8671867847442627
end Update
server_global_time: 2.5355390161275864
only_train_time: 39.446282148361206

-------------Global Round number: 2-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9434
Averaged Test Accuracy (Prototype Model): 0.8659
Averaged Train Loss (Regular Model): 0.2125
Averaged Train Loss (Regular + Proto): 0.3205
Std Test Accuracy (Regular Model): 0.0622
Std Test Accuracy (Prototype Model): 0.1688
tobetrained:
[6, 0, 7, 8, 2, 4, 5, 9, 3, 1]
Edge 6 begin training
Edge 0 begin training
Edge 7 begin training
Edge 8 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 0, 7, 8, 2, 4, 5, 9, 3, 1]
aggregation_buffer:
[6, 0, 7, 8, 2, 4, 5, 9, 3, 1]
class-wise minimum distance tensor([1.6166, 1.6526, 1.4323, 1.1520, 1.3931, 1.1520, 1.4300, 1.3622, 1.5085,
        1.3622], device='cuda:0')
min_gap tensor(1.1520, device='cuda:0')
max_gap tensor(1.6526, device='cuda:0')
Server loss: 2.9676332473754883
end Update
server_global_time: 3.3912521973252296
only_train_time: 54.044451266527176

-------------Global Round number: 3-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9604
Averaged Test Accuracy (Prototype Model): 0.9186
Averaged Train Loss (Regular Model): 0.1348
Averaged Train Loss (Regular + Proto): 0.2472
Std Test Accuracy (Regular Model): 0.0296
Std Test Accuracy (Prototype Model): 0.0935
tobetrained:
[6, 0, 7, 8, 2, 4, 5, 9, 3, 1]
Edge 6 begin training
Edge 0 begin training
Edge 7 begin training
Edge 8 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 8, 7, 0, 2, 4, 3, 5, 9, 1]
aggregation_buffer:
[6, 8, 7, 0, 2, 4, 3, 5, 9, 1]
class-wise minimum distance tensor([1.9960, 2.1504, 1.8803, 1.5204, 1.8363, 1.5204, 1.8825, 1.8681, 1.9363,
        1.8363], device='cuda:0')
min_gap tensor(1.5204, device='cuda:0')
max_gap tensor(2.1504, device='cuda:0')
Server loss: 2.9836843013763428
end Update
server_global_time: 4.242961503565311
only_train_time: 70.6002936437726

-------------Global Round number: 4-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9650
Averaged Test Accuracy (Prototype Model): 0.9358
Averaged Train Loss (Regular Model): 0.0880
Averaged Train Loss (Regular + Proto): 0.2174
Std Test Accuracy (Regular Model): 0.0281
Std Test Accuracy (Prototype Model): 0.0595
tobetrained:
[6, 8, 7, 0, 2, 4, 3, 5, 9, 1]
Edge 6 begin training
Edge 8 begin training
Edge 7 begin training
Edge 0 begin training
Edge 2 begin training
Edge 4 begin training
Edge 3 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
readyList:
[6, 0, 2, 7, 8, 4, 5, 9, 3, 1]
aggregation_buffer:
[6, 0, 2, 7, 8, 4, 5, 9, 3, 1]
class-wise minimum distance tensor([2.4935, 2.8605, 2.4856, 2.0237, 2.2976, 2.0237, 2.3896, 2.4698, 2.5130,
        2.2976], device='cuda:0')
min_gap tensor(2.0237, device='cuda:0')
max_gap tensor(2.8605, device='cuda:0')
Server loss: 3.1738359928131104
end Update
server_global_time: 5.142861448228359
only_train_time: 85.64684677124023

-------------Global Round number: 5-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9698
Averaged Test Accuracy (Prototype Model): 0.9420
Averaged Train Loss (Regular Model): 0.0615
Averaged Train Loss (Regular + Proto): 0.2117
Std Test Accuracy (Regular Model): 0.0195
Std Test Accuracy (Prototype Model): 0.0461
tobetrained:
[6, 0, 2, 7, 8, 4, 5, 9, 3, 1]
Edge 6 begin training
Edge 0 begin training
Edge 2 begin training
Edge 7 begin training
Edge 8 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 0, 7, 4, 2, 8, 5, 9, 3, 1]
aggregation_buffer:
[6, 0, 7, 4, 2, 8, 5, 9, 3, 1]
class-wise minimum distance tensor([3.1877, 3.5309, 3.0936, 2.5318, 2.9871, 2.5318, 3.0418, 2.9825, 3.2475,
        2.9825], device='cuda:0')
min_gap tensor(2.5318, device='cuda:0')
max_gap tensor(3.5309, device='cuda:0')
Server loss: 3.301093101501465
end Update
server_global_time: 5.997719869017601
only_train_time: 101.61181250959635

-------------Global Round number: 6-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9716
Averaged Test Accuracy (Prototype Model): 0.9474
Averaged Train Loss (Regular Model): 0.0464
Averaged Train Loss (Regular + Proto): 0.2179
Std Test Accuracy (Regular Model): 0.0176
Std Test Accuracy (Prototype Model): 0.0340
tobetrained:
[6, 0, 7, 4, 2, 8, 5, 9, 3, 1]
Edge 6 begin training
Edge 0 begin training
Edge 7 begin training
Edge 4 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 0, 7, 8, 2, 4, 5, 9, 1, 3]
aggregation_buffer:
[6, 0, 7, 8, 2, 4, 5, 9, 1, 3]
class-wise minimum distance tensor([3.7874, 4.2559, 3.8301, 3.0956, 3.7047, 3.0956, 3.7272, 3.8112, 3.8413,
        3.7047], device='cuda:0')
min_gap tensor(3.0956, device='cuda:0')
max_gap tensor(4.2559, device='cuda:0')
Server loss: 3.8874967098236084
end Update
server_global_time: 6.96619626134634
only_train_time: 117.37752429395914

-------------Global Round number: 7-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9714
Averaged Test Accuracy (Prototype Model): 0.9503
Averaged Train Loss (Regular Model): 0.0333
Averaged Train Loss (Regular + Proto): 0.2247
Std Test Accuracy (Regular Model): 0.0182
Std Test Accuracy (Prototype Model): 0.0334
tobetrained:
[6, 0, 7, 8, 2, 4, 5, 9, 1, 3]
Edge 6 begin training
Edge 0 begin training
Edge 7 begin training
Edge 8 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 3 begin training
readyList:
[6, 8, 7, 2, 0, 4, 5, 9, 3, 1]
aggregation_buffer:
[6, 8, 7, 2, 0, 4, 5, 9, 3, 1]
class-wise minimum distance tensor([4.4866, 5.2009, 4.5356, 3.7113, 4.8162, 3.7113, 4.5492, 4.6507, 4.6837,
        4.6507], device='cuda:0')
min_gap tensor(3.7113, device='cuda:0')
max_gap tensor(5.2009, device='cuda:0')
Server loss: 3.601820230484009
end Update
server_global_time: 7.8058706149458885
only_train_time: 132.5985747501254

-------------Global Round number: 8-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9734
Averaged Test Accuracy (Prototype Model): 0.9540
Averaged Train Loss (Regular Model): 0.0260
Averaged Train Loss (Regular + Proto): 0.2392
Std Test Accuracy (Regular Model): 0.0158
Std Test Accuracy (Prototype Model): 0.0263
tobetrained:
[6, 8, 7, 2, 0, 4, 5, 9, 3, 1]
Edge 6 begin training
Edge 8 begin training
Edge 7 begin training
Edge 2 begin training
Edge 0 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 0, 8, 2, 7, 4, 5, 9, 3, 1]
aggregation_buffer:
[6, 0, 8, 2, 7, 4, 5, 9, 3, 1]
class-wise minimum distance tensor([5.1707, 5.9735, 5.3771, 4.5522, 5.9370, 4.5522, 5.4703, 5.4858, 5.5473,
        5.4858], device='cuda:0')
min_gap tensor(4.5522, device='cuda:0')
max_gap tensor(5.9735, device='cuda:0')
Server loss: 4.30219030380249
end Update
server_global_time: 8.649122677743435
only_train_time: 147.83305056393147

-------------Global Round number: 9-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9742
Averaged Test Accuracy (Prototype Model): 0.9563
Averaged Train Loss (Regular Model): 0.0200
Averaged Train Loss (Regular + Proto): 0.2534
Std Test Accuracy (Regular Model): 0.0159
Std Test Accuracy (Prototype Model): 0.0241
tobetrained:
[6, 0, 8, 2, 7, 4, 5, 9, 3, 1]
Edge 6 begin training
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 7 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[0, 7, 8, 6, 2, 4, 5, 9, 3, 1]
aggregation_buffer:
[0, 7, 8, 6, 2, 4, 5, 9, 3, 1]
class-wise minimum distance tensor([5.9100, 6.9682, 6.3409, 5.3353, 6.5205, 5.3353, 6.1470, 6.2413, 6.2153,
        6.2413], device='cuda:0')
min_gap tensor(5.3353, device='cuda:0')
max_gap tensor(6.9682, device='cuda:0')
Server loss: 5.164095878601074
end Update
server_global_time: 9.520639896392822
only_train_time: 162.79996107518673

-------------Global Round number: 10-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9745
Averaged Test Accuracy (Prototype Model): 0.9593
Averaged Train Loss (Regular Model): 0.0158
Averaged Train Loss (Regular + Proto): 0.2695
Std Test Accuracy (Regular Model): 0.0156
Std Test Accuracy (Prototype Model): 0.0240
tobetrained:
[0, 7, 8, 6, 2, 4, 5, 9, 3, 1]
Edge 0 begin training
Edge 7 begin training
Edge 8 begin training
Edge 6 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 0, 7, 8, 2, 4, 5, 3, 9, 1]
aggregation_buffer:
[6, 0, 7, 8, 2, 4, 5, 3, 9, 1]
class-wise minimum distance tensor([6.6589, 7.6850, 7.1551, 5.8771, 7.6463, 5.8771, 7.0826, 6.8507, 6.9550,
        6.8507], device='cuda:0')
min_gap tensor(5.8771, device='cuda:0')
max_gap tensor(7.6850, device='cuda:0')
Server loss: 4.267271041870117
end Update
server_global_time: 10.363221682608128
only_train_time: 177.72570133209229

-------------Global Round number: 11-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9752
Averaged Test Accuracy (Prototype Model): 0.9604
Averaged Train Loss (Regular Model): 0.0134
Averaged Train Loss (Regular + Proto): 0.2849
Std Test Accuracy (Regular Model): 0.0157
Std Test Accuracy (Prototype Model): 0.0240
tobetrained:
[6, 0, 7, 8, 2, 4, 5, 3, 9, 1]
Edge 6 begin training
Edge 0 begin training
Edge 7 begin training
Edge 8 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 3 begin training
Edge 9 begin training
Edge 1 begin training
readyList:
[0, 6, 7, 2, 8, 5, 9, 4, 3, 1]
aggregation_buffer:
[0, 6, 7, 2, 8, 5, 9, 4, 3, 1]
class-wise minimum distance tensor([7.5867, 8.8015, 8.0176, 6.7533, 8.4814, 6.7533, 7.8142, 7.5939, 7.9060,
        7.5939], device='cuda:0')
min_gap tensor(6.7533, device='cuda:0')
max_gap tensor(8.8015, device='cuda:0')
Server loss: 4.87153959274292
end Update
server_global_time: 11.206984236836433
only_train_time: 193.3340944647789

-------------Global Round number: 12-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9756
Averaged Test Accuracy (Prototype Model): 0.9624
Averaged Train Loss (Regular Model): 0.0104
Averaged Train Loss (Regular + Proto): 0.3003
Std Test Accuracy (Regular Model): 0.0157
Std Test Accuracy (Prototype Model): 0.0219
tobetrained:
[0, 6, 7, 2, 8, 5, 9, 4, 3, 1]
Edge 0 begin training
Edge 6 begin training
Edge 7 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 0, 7, 2, 8, 4, 5, 9, 3, 1]
aggregation_buffer:
[6, 0, 7, 2, 8, 4, 5, 9, 3, 1]
class-wise minimum distance tensor([8.3405, 9.5429, 8.9894, 7.1716, 9.6024, 7.1716, 8.8788, 8.3499, 8.5948,
        8.3499], device='cuda:0')
min_gap tensor(7.1716, device='cuda:0')
max_gap tensor(9.6024, device='cuda:0')
Server loss: 5.404018402099609
end Update
server_global_time: 12.051173985004425
only_train_time: 208.33484280109406

-------------Global Round number: 13-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9757
Averaged Test Accuracy (Prototype Model): 0.9638
Averaged Train Loss (Regular Model): 0.0089
Averaged Train Loss (Regular + Proto): 0.3153
Std Test Accuracy (Regular Model): 0.0157
Std Test Accuracy (Prototype Model): 0.0208
tobetrained:
[6, 0, 7, 2, 8, 4, 5, 9, 3, 1]
Edge 6 begin training
Edge 0 begin training
Edge 7 begin training
Edge 2 begin training
Edge 8 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 0, 7, 8, 2, 5, 4, 9, 3, 1]
aggregation_buffer:
[6, 0, 7, 8, 2, 5, 4, 9, 3, 1]
class-wise minimum distance tensor([ 9.2445, 10.8591,  9.9805,  8.1971, 10.2993,  8.1971, 10.0456,  9.0591,
         9.6420,  9.0591], device='cuda:0')
min_gap tensor(8.1971, device='cuda:0')
max_gap tensor(10.8591, device='cuda:0')
Server loss: 6.458510875701904
end Update
server_global_time: 13.137358501553535
only_train_time: 223.7485312372446

-------------Global Round number: 14-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9757
Averaged Test Accuracy (Prototype Model): 0.9650
Averaged Train Loss (Regular Model): 0.0072
Averaged Train Loss (Regular + Proto): 0.3278
Std Test Accuracy (Regular Model): 0.0153
Std Test Accuracy (Prototype Model): 0.0203
tobetrained:
[6, 0, 7, 8, 2, 5, 4, 9, 3, 1]
Edge 6 begin training
Edge 0 begin training
Edge 7 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 8, 2, 4, 7, 0, 5, 9, 3, 1]
aggregation_buffer:
[6, 8, 2, 4, 7, 0, 5, 9, 3, 1]
class-wise minimum distance tensor([10.2710, 11.9206, 10.9709,  8.5723, 11.3062,  8.5723, 10.9068, 10.0010,
        10.5920, 10.0010], device='cuda:0')
min_gap tensor(8.5723, device='cuda:0')
max_gap tensor(11.9206, device='cuda:0')
Server loss: 5.581014633178711
end Update
server_global_time: 13.992368519306183
only_train_time: 239.368641667068

-------------Global Round number: 15-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9758
Averaged Test Accuracy (Prototype Model): 0.9663
Averaged Train Loss (Regular Model): 0.0062
Averaged Train Loss (Regular + Proto): 0.3397
Std Test Accuracy (Regular Model): 0.0152
Std Test Accuracy (Prototype Model): 0.0198
tobetrained:
[6, 8, 2, 4, 7, 0, 5, 9, 3, 1]
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 4 begin training
Edge 7 begin training
Edge 0 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 0, 8, 7, 2, 4, 5, 9, 3, 1]
aggregation_buffer:
[6, 0, 8, 7, 2, 4, 5, 9, 3, 1]
class-wise minimum distance tensor([11.0300, 12.8907, 12.0140,  9.4654, 12.4103,  9.4654, 12.0143, 11.4772,
        11.5835, 11.4772], device='cuda:0')
min_gap tensor(9.4654, device='cuda:0')
max_gap tensor(12.8907, device='cuda:0')
Server loss: 7.452758312225342
end Update
server_global_time: 14.835080236196518
only_train_time: 254.3927658572793

-------------Global Round number: 16-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9761
Averaged Test Accuracy (Prototype Model): 0.9669
Averaged Train Loss (Regular Model): 0.0050
Averaged Train Loss (Regular + Proto): 0.3541
Std Test Accuracy (Regular Model): 0.0148
Std Test Accuracy (Prototype Model): 0.0194
tobetrained:
[6, 0, 8, 7, 2, 4, 5, 9, 3, 1]
Edge 6 begin training
Edge 0 begin training
Edge 8 begin training
Edge 7 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 0, 8, 7, 2, 4, 5, 9, 3, 1]
aggregation_buffer:
[6, 0, 8, 7, 2, 4, 5, 9, 3, 1]
class-wise minimum distance tensor([12.2222, 14.1132, 13.3349, 10.2262, 13.7205, 10.2262, 12.9833, 12.0518,
        12.7382, 12.0518], device='cuda:0')
min_gap tensor(10.2262, device='cuda:0')
max_gap tensor(14.1132, device='cuda:0')
Server loss: 8.255005836486816
end Update
server_global_time: 15.673564925789833
only_train_time: 269.19102716445923

-------------Global Round number: 17-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9762
Averaged Test Accuracy (Prototype Model): 0.9678
Averaged Train Loss (Regular Model): 0.0040
Averaged Train Loss (Regular + Proto): 0.3692
Std Test Accuracy (Regular Model): 0.0147
Std Test Accuracy (Prototype Model): 0.0189
tobetrained:
[6, 0, 8, 7, 2, 4, 5, 9, 3, 1]
Edge 6 begin training
Edge 0 begin training
Edge 8 begin training
Edge 7 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 7, 2, 8, 4, 0, 5, 9, 3, 1]
aggregation_buffer:
[6, 7, 2, 8, 4, 0, 5, 9, 3, 1]
class-wise minimum distance tensor([13.1421, 15.4165, 14.3414, 10.9337, 15.0166, 10.9337, 14.5834, 13.3796,
        13.3078, 13.3796], device='cuda:0')
min_gap tensor(10.9337, device='cuda:0')
max_gap tensor(15.4165, device='cuda:0')
Server loss: 6.505777835845947
end Update
server_global_time: 16.503734566271305
only_train_time: 284.44846019893885

-------------Global Round number: 18-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9764
Averaged Test Accuracy (Prototype Model): 0.9691
Averaged Train Loss (Regular Model): 0.0037
Averaged Train Loss (Regular + Proto): 0.3870
Std Test Accuracy (Regular Model): 0.0148
Std Test Accuracy (Prototype Model): 0.0185
tobetrained:
[6, 7, 2, 8, 4, 0, 5, 9, 3, 1]
Edge 6 begin training
Edge 7 begin training
Edge 2 begin training
Edge 8 begin training
Edge 4 begin training
Edge 0 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 0, 8, 7, 2, 4, 5, 9, 3, 1]
aggregation_buffer:
[6, 0, 8, 7, 2, 4, 5, 9, 3, 1]
class-wise minimum distance tensor([13.9159, 16.3164, 15.4219, 11.8168, 16.2572, 11.8168, 15.4162, 13.9433,
        14.4830, 13.9433], device='cuda:0')
min_gap tensor(11.8168, device='cuda:0')
max_gap tensor(16.3164, device='cuda:0')
Server loss: 7.376303195953369
end Update
server_global_time: 17.35834950208664
only_train_time: 298.8990599811077

-------------Global Round number: 19-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9765
Averaged Test Accuracy (Prototype Model): 0.9703
Averaged Train Loss (Regular Model): 0.0030
Averaged Train Loss (Regular + Proto): 0.4036
Std Test Accuracy (Regular Model): 0.0144
Std Test Accuracy (Prototype Model): 0.0181
tobetrained:
[6, 0, 8, 7, 2, 4, 5, 9, 3, 1]
Edge 6 begin training
Edge 0 begin training
Edge 8 begin training
Edge 7 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 0, 7, 2, 8, 4, 9, 5, 3, 1]
aggregation_buffer:
[6, 0, 7, 2, 8, 4, 9, 5, 3, 1]
class-wise minimum distance tensor([15.1005, 17.6588, 16.7210, 12.9613, 17.2944, 12.9613, 16.5753, 15.1247,
        15.6624, 15.1247], device='cuda:0')
min_gap tensor(12.9613, device='cuda:0')
max_gap tensor(17.6588, device='cuda:0')
Server loss: 8.139715194702148
Number of samples: 314
end Update
server_global_time: 18.182163193821907
only_train_time: 313.3169108852744

-------------Global Round number: 20-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9769
Averaged Test Accuracy (Prototype Model): 0.9711
Averaged Train Loss (Regular Model): 0.0025
Averaged Train Loss (Regular + Proto): 0.4286
Std Test Accuracy (Regular Model): 0.0140
Std Test Accuracy (Prototype Model): 0.0179
tobetrained:
[6, 0, 7, 2, 8, 4, 9, 5, 3, 1]
Edge 6 begin training
Edge 0 begin training
Edge 7 begin training
Edge 2 begin training
Edge 8 begin training
Edge 4 begin training
Edge 9 begin training
Edge 5 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 0, 8, 4, 7, 2, 9, 5, 3, 1]
aggregation_buffer:
[6, 0, 8, 4, 7, 2, 9, 5, 3, 1]
class-wise minimum distance tensor([16.6619, 18.8952, 17.8279, 14.4317, 18.4384, 14.4317, 17.7940, 16.1821,
        16.8107, 16.1821], device='cuda:0')
min_gap tensor(14.4317, device='cuda:0')
max_gap tensor(18.8952, device='cuda:0')
Server loss: 6.28278112411499
end Update
server_global_time: 18.9891340136528
only_train_time: 328.6124359816313

-------------Global Round number: 21-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9770
Averaged Test Accuracy (Prototype Model): 0.9714
Averaged Train Loss (Regular Model): 0.0021
Averaged Train Loss (Regular + Proto): 0.4502
Std Test Accuracy (Regular Model): 0.0143
Std Test Accuracy (Prototype Model): 0.0178
tobetrained:
[6, 0, 8, 4, 7, 2, 9, 5, 3, 1]
Edge 6 begin training
Edge 0 begin training
Edge 8 begin training
Edge 4 begin training
Edge 7 begin training
Edge 2 begin training
Edge 9 begin training
Edge 5 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 0, 8, 4, 7, 2, 5, 9, 1, 3]
aggregation_buffer:
[6, 0, 8, 4, 7, 2, 5, 9, 1, 3]
class-wise minimum distance tensor([17.3998, 20.4348, 19.2688, 15.4730, 19.3139, 15.4730, 19.5827, 18.2701,
        18.1760, 18.2701], device='cuda:0')
min_gap tensor(15.4730, device='cuda:0')
max_gap tensor(20.4348, device='cuda:0')
Server loss: 5.56447696685791
end Update
server_global_time: 19.875296875834465
only_train_time: 345.17097683250904

-------------Global Round number: 22-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9776
Averaged Test Accuracy (Prototype Model): 0.9720
Averaged Train Loss (Regular Model): 0.0019
Averaged Train Loss (Regular + Proto): 0.4773
Std Test Accuracy (Regular Model): 0.0139
Std Test Accuracy (Prototype Model): 0.0169
tobetrained:
[6, 0, 8, 4, 7, 2, 5, 9, 1, 3]
Edge 6 begin training
Edge 0 begin training
Edge 8 begin training
Edge 4 begin training
Edge 7 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 3 begin training
readyList:
[6, 7, 2, 0, 8, 4, 5, 9, 3, 1]
aggregation_buffer:
[6, 7, 2, 0, 8, 4, 5, 9, 3, 1]
class-wise minimum distance tensor([19.0281, 22.4360, 21.0239, 16.2526, 21.7824, 16.2526, 20.2411, 19.5975,
        19.1343, 19.5975], device='cuda:0')
min_gap tensor(16.2526, device='cuda:0')
max_gap tensor(22.4360, device='cuda:0')
Server loss: 7.855907440185547
end Update
server_global_time: 20.702392764389515
only_train_time: 360.5278315246105

-------------Global Round number: 23-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9775
Averaged Test Accuracy (Prototype Model): 0.9723
Averaged Train Loss (Regular Model): 0.0015
Averaged Train Loss (Regular + Proto): 0.5029
Std Test Accuracy (Regular Model): 0.0141
Std Test Accuracy (Prototype Model): 0.0169
tobetrained:
[6, 7, 2, 0, 8, 4, 5, 9, 3, 1]
Edge 6 begin training
Edge 7 begin training
Edge 2 begin training
Edge 0 begin training
Edge 8 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[7, 0, 6, 8, 4, 2, 5, 3, 9, 1]
aggregation_buffer:
[7, 0, 6, 8, 4, 2, 5, 3, 9, 1]
class-wise minimum distance tensor([20.0309, 23.5008, 22.4529, 17.3655, 22.1385, 17.3655, 21.6545, 20.2453,
        20.8250, 20.2453], device='cuda:0')
min_gap tensor(17.3655, device='cuda:0')
max_gap tensor(23.5008, device='cuda:0')
Server loss: 6.956860542297363
end Update
server_global_time: 21.540856696665287
only_train_time: 376.4008920490742

-------------Global Round number: 24-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9773
Averaged Test Accuracy (Prototype Model): 0.9737
Averaged Train Loss (Regular Model): 0.0014
Averaged Train Loss (Regular + Proto): 0.5341
Std Test Accuracy (Regular Model): 0.0147
Std Test Accuracy (Prototype Model): 0.0161
tobetrained:
[7, 0, 6, 8, 4, 2, 5, 3, 9, 1]
Edge 7 begin training
Edge 0 begin training
Edge 6 begin training
Edge 8 begin training
Edge 4 begin training
Edge 2 begin training
Edge 5 begin training
Edge 3 begin training
Edge 9 begin training
Edge 1 begin training
readyList:
[6, 0, 7, 2, 8, 4, 5, 9, 3, 1]
aggregation_buffer:
[6, 0, 7, 2, 8, 4, 5, 9, 3, 1]
class-wise minimum distance tensor([21.7499, 25.9865, 24.0595, 18.9742, 24.6089, 18.9742, 23.5304, 22.3758,
        22.7627, 22.3758], device='cuda:0')
min_gap tensor(18.9742, device='cuda:0')
max_gap tensor(25.9865, device='cuda:0')
Server loss: 6.993375778198242
end Update
server_global_time: 22.437604390084743
only_train_time: 391.6483056396246

-------------Global Round number: 25-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9783
Averaged Test Accuracy (Prototype Model): 0.9744
Averaged Train Loss (Regular Model): 0.0011
Averaged Train Loss (Regular + Proto): 0.5721
Std Test Accuracy (Regular Model): 0.0133
Std Test Accuracy (Prototype Model): 0.0162
tobetrained:
[6, 0, 7, 2, 8, 4, 5, 9, 3, 1]
Edge 6 begin training
Edge 0 begin training
Edge 7 begin training
Edge 2 begin training
Edge 8 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 0, 8, 7, 2, 4, 5, 9, 3, 1]
aggregation_buffer:
[6, 0, 8, 7, 2, 4, 5, 9, 3, 1]
class-wise minimum distance tensor([23.4864, 27.1150, 26.1057, 20.2860, 25.6177, 20.2860, 25.8565, 23.7526,
        24.0839, 23.7526], device='cuda:0')
min_gap tensor(20.2860, device='cuda:0')
max_gap tensor(27.1150, device='cuda:0')
Server loss: 10.131712913513184
end Update
server_global_time: 23.30089519917965
only_train_time: 406.541674926877

-------------Global Round number: 26-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9784
Averaged Test Accuracy (Prototype Model): 0.9746
Averaged Train Loss (Regular Model): 0.0009
Averaged Train Loss (Regular + Proto): 0.6138
Std Test Accuracy (Regular Model): 0.0132
Std Test Accuracy (Prototype Model): 0.0160
tobetrained:
[6, 0, 8, 7, 2, 4, 5, 9, 3, 1]
Edge 6 begin training
Edge 0 begin training
Edge 8 begin training
Edge 7 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 0, 8, 2, 7, 4, 9, 5, 3, 1]
aggregation_buffer:
[6, 0, 8, 2, 7, 4, 9, 5, 3, 1]
class-wise minimum distance tensor([25.7316, 28.8504, 28.2921, 22.1689, 28.2902, 22.1689, 27.6864, 25.6314,
        26.6748, 25.6314], device='cuda:0')
min_gap tensor(22.1689, device='cuda:0')
max_gap tensor(28.8504, device='cuda:0')
Server loss: 11.638855934143066
end Update
server_global_time: 24.105096377432346
only_train_time: 421.41413459926844

-------------Global Round number: 27-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9790
Averaged Test Accuracy (Prototype Model): 0.9753
Averaged Train Loss (Regular Model): 0.0008
Averaged Train Loss (Regular + Proto): 0.6496
Std Test Accuracy (Regular Model): 0.0129
Std Test Accuracy (Prototype Model): 0.0157
tobetrained:
[6, 0, 8, 2, 7, 4, 9, 5, 3, 1]
Edge 6 begin training
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 7 begin training
Edge 4 begin training
Edge 9 begin training
Edge 5 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 0, 8, 7, 4, 2, 9, 5, 3, 1]
aggregation_buffer:
[6, 0, 8, 7, 4, 2, 9, 5, 3, 1]
class-wise minimum distance tensor([27.4860, 30.9869, 30.0333, 23.2983, 29.6248, 23.2983, 30.1325, 28.2227,
        28.9304, 28.2227], device='cuda:0')
min_gap tensor(23.2983, device='cuda:0')
max_gap tensor(30.9869, device='cuda:0')
Server loss: 9.476455688476562
end Update
server_global_time: 24.954331666231155
only_train_time: 437.2016084641218

-------------Global Round number: 28-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9788
Averaged Test Accuracy (Prototype Model): 0.9754
Averaged Train Loss (Regular Model): 0.0007
Averaged Train Loss (Regular + Proto): 0.7158
Std Test Accuracy (Regular Model): 0.0135
Std Test Accuracy (Prototype Model): 0.0161
tobetrained:
[6, 0, 8, 7, 4, 2, 9, 5, 3, 1]
Edge 6 begin training
Edge 0 begin training
Edge 8 begin training
Edge 7 begin training
Edge 4 begin training
Edge 2 begin training
Edge 9 begin training
Edge 5 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 7, 8, 0, 2, 4, 5, 9, 3, 1]
aggregation_buffer:
[6, 7, 8, 0, 2, 4, 5, 9, 3, 1]
class-wise minimum distance tensor([29.1167, 32.4844, 32.1775, 24.7775, 31.5942, 24.7775, 31.4672, 29.8566,
        30.6993, 29.8566], device='cuda:0')
min_gap tensor(24.7775, device='cuda:0')
max_gap tensor(32.4844, device='cuda:0')
Server loss: 9.786421775817871
end Update
server_global_time: 25.79030215740204
only_train_time: 451.84016297757626

-------------Global Round number: 29-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9674
Averaged Test Accuracy (Prototype Model): 0.9580
Averaged Train Loss (Regular Model): 0.0532
Averaged Train Loss (Regular + Proto): 0.9187
Std Test Accuracy (Regular Model): 0.1002
Std Test Accuracy (Prototype Model): 0.1518
tobetrained:
[6, 7, 8, 0, 2, 4, 5, 9, 3, 1]
Edge 6 begin training
Edge 7 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 0, 8, 2, 7, 4, 5, 9, 3, 1]
aggregation_buffer:
[6, 0, 8, 2, 7, 4, 5, 9, 3, 1]
class-wise minimum distance tensor([31.2424, 33.8268, 34.0338, 26.6743, 31.9561, 26.6743, 33.7956, 30.3505,
        32.3718, 30.3505], device='cuda:0')
min_gap tensor(26.6743, device='cuda:0')
max_gap tensor(34.0338, device='cuda:0')
Server loss: 11.308853149414062
end Update
server_global_time: 26.615353479981422
only_train_time: 466.92539454996586

-------------Global Round number: 30-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9756
Averaged Test Accuracy (Prototype Model): 0.9592
Averaged Train Loss (Regular Model): 0.0211
Averaged Train Loss (Regular + Proto): 0.9574
Std Test Accuracy (Regular Model): 0.0311
Std Test Accuracy (Prototype Model): 0.1441
tobetrained:
[6, 0, 8, 2, 7, 4, 5, 9, 3, 1]
Edge 6 begin training
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 7 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 0, 8, 7, 2, 4, 5, 9, 1, 3]
aggregation_buffer:
[6, 0, 8, 7, 2, 4, 5, 9, 1, 3]
class-wise minimum distance tensor([34.3358, 36.0271, 36.3269, 28.9402, 36.7536, 28.9402, 35.7356, 32.9609,
        34.2942, 32.9609], device='cuda:0')
min_gap tensor(28.9402, device='cuda:0')
max_gap tensor(36.7536, device='cuda:0')
Server loss: 12.850408554077148
end Update
server_global_time: 27.49545019119978
only_train_time: 483.07038727402687

-------------Global Round number: 31-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9745
Averaged Test Accuracy (Prototype Model): 0.9597
Averaged Train Loss (Regular Model): 0.0527
Averaged Train Loss (Regular + Proto): 1.1021
Std Test Accuracy (Regular Model): 0.0333
Std Test Accuracy (Prototype Model): 0.1074
tobetrained:
[6, 0, 8, 7, 2, 4, 5, 9, 1, 3]
Edge 6 begin training
Edge 0 begin training
Edge 8 begin training
Edge 7 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 3 begin training
readyList:
[6, 0, 8, 7, 2, 4, 5, 9, 3, 1]
aggregation_buffer:
[6, 0, 8, 7, 2, 4, 5, 9, 3, 1]
class-wise minimum distance tensor([35.4554, 35.9386, 37.8911, 28.7284, 36.0300, 28.7284, 35.5690, 33.0505,
        32.9455, 33.0505], device='cuda:0')
min_gap tensor(28.7284, device='cuda:0')
max_gap tensor(37.8911, device='cuda:0')
Server loss: 11.129931449890137
end Update
server_global_time: 28.29463090747595
only_train_time: 497.45791950821877

-------------Global Round number: 32-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9575
Averaged Test Accuracy (Prototype Model): 0.9149
Averaged Train Loss (Regular Model): 0.1099
Averaged Train Loss (Regular + Proto): 1.6241
Std Test Accuracy (Regular Model): 0.1142
Std Test Accuracy (Prototype Model): 0.2279
tobetrained:
[6, 0, 8, 7, 2, 4, 5, 9, 3, 1]
Edge 6 begin training
Edge 0 begin training
Edge 8 begin training
Edge 7 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 0, 7, 8, 2, 4, 5, 9, 3, 1]
aggregation_buffer:
[6, 0, 7, 8, 2, 4, 5, 9, 3, 1]
class-wise minimum distance tensor([36.1275, 36.4834, 38.9169, 30.5747, 35.1994, 30.5747, 38.5227, 31.9984,
        33.4817, 31.9984], device='cuda:0')
min_gap tensor(30.5747, device='cuda:0')
max_gap tensor(38.9169, device='cuda:0')
Server loss: 7.575013637542725
end Update
server_global_time: 29.120897687971592
only_train_time: 512.4244382679462

-------------Global Round number: 33-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9686
Averaged Test Accuracy (Prototype Model): 0.9322
Averaged Train Loss (Regular Model): 0.0637
Averaged Train Loss (Regular + Proto): 1.5270
Std Test Accuracy (Regular Model): 0.0698
Std Test Accuracy (Prototype Model): 0.1866
tobetrained:
[6, 0, 7, 8, 2, 4, 5, 9, 3, 1]
Edge 6 begin training
Edge 0 begin training
Edge 7 begin training
Edge 8 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 0, 7, 8, 2, 4, 5, 9, 3, 1]
aggregation_buffer:
[6, 0, 7, 8, 2, 4, 5, 9, 3, 1]
class-wise minimum distance tensor([38.2179, 39.5532, 41.6625, 33.3829, 36.3880, 33.3829, 40.8393, 34.4554,
        36.0092, 34.4554], device='cuda:0')
min_gap tensor(33.3829, device='cuda:0')
max_gap tensor(41.6625, device='cuda:0')
Server loss: 10.743002891540527
end Update
server_global_time: 29.953662797808647
only_train_time: 527.3850348293781

-------------Global Round number: 34-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9658
Averaged Test Accuracy (Prototype Model): 0.9348
Averaged Train Loss (Regular Model): 0.0649
Averaged Train Loss (Regular + Proto): 1.6190
Std Test Accuracy (Regular Model): 0.0735
Std Test Accuracy (Prototype Model): 0.1809
tobetrained:
[6, 0, 7, 8, 2, 4, 5, 9, 3, 1]
Edge 6 begin training
Edge 0 begin training
Edge 7 begin training
Edge 8 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 0, 8, 7, 2, 4, 5, 9, 3, 1]
aggregation_buffer:
[6, 0, 8, 7, 2, 4, 5, 9, 3, 1]
class-wise minimum distance tensor([40.8208, 43.1561, 43.8748, 34.6740, 37.5118, 34.6740, 42.2979, 37.7398,
        37.7103, 37.5118], device='cuda:0')
min_gap tensor(34.6740, device='cuda:0')
max_gap tensor(43.8748, device='cuda:0')
Server loss: 16.684858322143555
end Update
server_global_time: 30.79443984478712
only_train_time: 542.1161021515727

-------------Global Round number: 35-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9711
Averaged Test Accuracy (Prototype Model): 0.9403
Averaged Train Loss (Regular Model): 0.0437
Averaged Train Loss (Regular + Proto): 1.6554
Std Test Accuracy (Regular Model): 0.0685
Std Test Accuracy (Prototype Model): 0.1741
tobetrained:
[6, 0, 8, 7, 2, 4, 5, 9, 3, 1]
Edge 6 begin training
Edge 0 begin training
Edge 8 begin training
Edge 7 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[7, 8, 2, 6, 0, 5, 9, 4, 3, 1]
aggregation_buffer:
[7, 8, 2, 6, 0, 5, 9, 4, 3, 1]
class-wise minimum distance tensor([43.5033, 44.4921, 47.9684, 38.6402, 41.0955, 38.6402, 45.1529, 38.8171,
        41.3760, 38.8171], device='cuda:0')
min_gap tensor(38.6402, device='cuda:0')
max_gap tensor(47.9684, device='cuda:0')
Server loss: 16.143774032592773
end Update
server_global_time: 31.62993912398815
only_train_time: 558.4264088198543

-------------Global Round number: 36-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9672
Averaged Test Accuracy (Prototype Model): 0.9443
Averaged Train Loss (Regular Model): 0.0508
Averaged Train Loss (Regular + Proto): 1.7824
Std Test Accuracy (Regular Model): 0.0716
Std Test Accuracy (Prototype Model): 0.1650
tobetrained:
[7, 8, 2, 6, 0, 5, 9, 4, 3, 1]
Edge 7 begin training
Edge 8 begin training
Edge 2 begin training
Edge 6 begin training
Edge 0 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 0, 7, 8, 4, 2, 9, 5, 3, 1]
aggregation_buffer:
[6, 0, 7, 8, 4, 2, 9, 5, 3, 1]
class-wise minimum distance tensor([46.0469, 47.2104, 50.0174, 39.4275, 46.3850, 39.4275, 47.9244, 41.7802,
        44.3636, 41.7802], device='cuda:0')
min_gap tensor(39.4275, device='cuda:0')
max_gap tensor(50.0174, device='cuda:0')
Server loss: 14.884263038635254
end Update
server_global_time: 32.485099613666534
only_train_time: 574.3891901522875

-------------Global Round number: 37-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9602
Averaged Test Accuracy (Prototype Model): 0.9351
Averaged Train Loss (Regular Model): 0.1056
Averaged Train Loss (Regular + Proto): 2.1715
Std Test Accuracy (Regular Model): 0.1013
Std Test Accuracy (Prototype Model): 0.1784
tobetrained:
[6, 0, 7, 8, 4, 2, 9, 5, 3, 1]
Edge 6 begin training
Edge 0 begin training
Edge 7 begin training
Edge 8 begin training
Edge 4 begin training
Edge 2 begin training
Edge 9 begin training
Edge 5 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 0, 7, 8, 2, 4, 5, 9, 3, 1]
aggregation_buffer:
[6, 0, 7, 8, 2, 4, 5, 9, 3, 1]
class-wise minimum distance tensor([48.0341, 49.0833, 53.7156, 43.4092, 46.1752, 43.4092, 51.6436, 45.3213,
        44.7466, 45.3213], device='cuda:0')
min_gap tensor(43.4092, device='cuda:0')
max_gap tensor(53.7156, device='cuda:0')
Server loss: 16.032970428466797
end Update
server_global_time: 33.33075362443924
only_train_time: 589.4485523477197

-------------Global Round number: 38-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9587
Averaged Test Accuracy (Prototype Model): 0.9077
Averaged Train Loss (Regular Model): 0.0915
Averaged Train Loss (Regular + Proto): 2.5053
Std Test Accuracy (Regular Model): 0.1013
Std Test Accuracy (Prototype Model): 0.2382
tobetrained:
[6, 0, 7, 8, 2, 4, 5, 9, 3, 1]
Edge 6 begin training
Edge 0 begin training
Edge 7 begin training
Edge 8 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 0, 8, 2, 7, 4, 5, 9, 3, 1]
aggregation_buffer:
[6, 0, 8, 2, 7, 4, 5, 9, 3, 1]
class-wise minimum distance tensor([49.3520, 52.2444, 52.9788, 43.0322, 51.2288, 43.0322, 53.5328, 46.3203,
        47.3856, 46.3203], device='cuda:0')
min_gap tensor(43.0322, device='cuda:0')
max_gap tensor(53.5328, device='cuda:0')
Server loss: 19.100540161132812
end Update
server_global_time: 34.17027795314789
only_train_time: 605.217455483973

-------------Global Round number: 39-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9615
Averaged Test Accuracy (Prototype Model): 0.9474
Averaged Train Loss (Regular Model): 0.0748
Averaged Train Loss (Regular + Proto): 2.5537
Std Test Accuracy (Regular Model): 0.1009
Std Test Accuracy (Prototype Model): 0.1334
tobetrained:
[6, 0, 8, 2, 7, 4, 5, 9, 3, 1]
Edge 6 begin training
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 7 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 8, 0, 7, 4, 2, 9, 5, 3, 1]
aggregation_buffer:
[6, 8, 0, 7, 4, 2, 9, 5, 3, 1]
class-wise minimum distance tensor([53.5300, 54.1371, 59.0211, 47.7472, 54.6381, 47.7472, 56.5373, 48.8682,
        49.6956, 48.8682], device='cuda:0')
min_gap tensor(47.7472, device='cuda:0')
max_gap tensor(59.0211, device='cuda:0')
Server loss: 24.73554039001465
Number of samples: 313
end Update
server_global_time: 35.01401089131832
only_train_time: 620.6715223938227

-------------Global Round number: 40-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9444
Averaged Test Accuracy (Prototype Model): 0.9150
Averaged Train Loss (Regular Model): 0.1375
Averaged Train Loss (Regular + Proto): 3.1390
Std Test Accuracy (Regular Model): 0.1520
Std Test Accuracy (Prototype Model): 0.2415
tobetrained:
[6, 8, 0, 7, 4, 2, 9, 5, 3, 1]
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 7 begin training
Edge 4 begin training
Edge 2 begin training
Edge 9 begin training
Edge 5 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 0, 8, 2, 7, 4, 5, 9, 3, 1]
aggregation_buffer:
[6, 0, 8, 2, 7, 4, 5, 9, 3, 1]
class-wise minimum distance tensor([53.1069, 56.3169, 59.1409, 47.7843, 52.4316, 47.7843, 55.4678, 50.9847,
        51.1518, 50.9847], device='cuda:0')
min_gap tensor(47.7843, device='cuda:0')
max_gap tensor(59.1409, device='cuda:0')
Server loss: 17.5931453704834
end Update
server_global_time: 36.05241332948208
only_train_time: 636.1697422638535

-------------Global Round number: 41-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9423
Averaged Test Accuracy (Prototype Model): 0.9193
Averaged Train Loss (Regular Model): 0.3643
Averaged Train Loss (Regular + Proto): 3.7618
Std Test Accuracy (Regular Model): 0.1334
Std Test Accuracy (Prototype Model): 0.2203
tobetrained:
[6, 0, 8, 2, 7, 4, 5, 9, 3, 1]
Edge 6 begin training
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 7 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 0, 7, 8, 2, 4, 5, 9, 3, 1]
aggregation_buffer:
[6, 0, 7, 8, 2, 4, 5, 9, 3, 1]
class-wise minimum distance tensor([58.8785, 58.5589, 64.0768, 52.5454, 55.6360, 52.5454, 61.3453, 53.2937,
        54.4425, 53.2937], device='cuda:0')
min_gap tensor(52.5454, device='cuda:0')
max_gap tensor(64.0768, device='cuda:0')
Server loss: 22.698287963867188
end Update
server_global_time: 36.8779796436429
only_train_time: 650.8763633966446

-------------Global Round number: 42-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9273
Averaged Test Accuracy (Prototype Model): 0.9230
Averaged Train Loss (Regular Model): 0.3573
Averaged Train Loss (Regular + Proto): 4.1185
Std Test Accuracy (Regular Model): 0.2054
Std Test Accuracy (Prototype Model): 0.2094
tobetrained:
[6, 0, 7, 8, 2, 4, 5, 9, 3, 1]
Edge 6 begin training
Edge 0 begin training
Edge 7 begin training
Edge 8 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 7, 8, 2, 0, 4, 5, 9, 3, 1]
aggregation_buffer:
[6, 7, 8, 2, 0, 4, 5, 9, 3, 1]
class-wise minimum distance tensor([56.9772, 59.7713, 65.1337, 55.4013, 51.7188, 55.4153, 63.2638, 54.2914,
        54.2474, 51.7188], device='cuda:0')
min_gap tensor(51.7188, device='cuda:0')
max_gap tensor(65.1337, device='cuda:0')
Server loss: 21.910913467407227
end Update
server_global_time: 37.75894068181515
only_train_time: 665.7287955880165

-------------Global Round number: 43-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9478
Averaged Test Accuracy (Prototype Model): 0.9040
Averaged Train Loss (Regular Model): 0.1556
Averaged Train Loss (Regular + Proto): 4.4554
Std Test Accuracy (Regular Model): 0.1243
Std Test Accuracy (Prototype Model): 0.2507
tobetrained:
[6, 7, 8, 2, 0, 4, 5, 9, 3, 1]
Edge 6 begin training
Edge 7 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 7, 8, 0, 2, 4, 9, 3, 5, 1]
aggregation_buffer:
[6, 7, 8, 0, 2, 4, 9, 3, 5, 1]
class-wise minimum distance tensor([62.0966, 62.0152, 67.7514, 59.0523, 54.4977, 59.0523, 66.7399, 59.0199,
        58.8305, 54.4977], device='cuda:0')
min_gap tensor(54.4977, device='cuda:0')
max_gap tensor(67.7514, device='cuda:0')
Server loss: 25.06832504272461
end Update
server_global_time: 38.60600531846285
only_train_time: 681.3062433600426

-------------Global Round number: 44-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9117
Averaged Test Accuracy (Prototype Model): 0.8795
Averaged Train Loss (Regular Model): 0.5792
Averaged Train Loss (Regular + Proto): 5.8030
Std Test Accuracy (Regular Model): 0.1854
Std Test Accuracy (Prototype Model): 0.2608
tobetrained:
[6, 7, 8, 0, 2, 4, 9, 3, 5, 1]
Edge 6 begin training
Edge 7 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
Edge 5 begin training
Edge 1 begin training
readyList:
[6, 0, 2, 7, 8, 4, 9, 3, 5, 1]
aggregation_buffer:
[6, 0, 2, 7, 8, 4, 9, 3, 5, 1]
class-wise minimum distance tensor([62.9675, 61.0615, 65.9319, 57.5374, 53.7336, 57.5374, 65.9613, 56.5616,
        57.7685, 53.7336], device='cuda:0')
min_gap tensor(53.7336, device='cuda:0')
max_gap tensor(65.9613, device='cuda:0')
Server loss: 16.271228790283203
end Update
server_global_time: 39.488884426653385
only_train_time: 696.368981488049

-------------Global Round number: 45-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9342
Averaged Test Accuracy (Prototype Model): 0.8925
Averaged Train Loss (Regular Model): 0.2111
Averaged Train Loss (Regular + Proto): 5.2676
Std Test Accuracy (Regular Model): 0.1378
Std Test Accuracy (Prototype Model): 0.2619
tobetrained:
[6, 0, 2, 7, 8, 4, 9, 3, 5, 1]
Edge 6 begin training
Edge 0 begin training
Edge 2 begin training
Edge 7 begin training
Edge 8 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
Edge 5 begin training
Edge 1 begin training
readyList:
[6, 8, 7, 2, 0, 5, 4, 9, 1, 3]
aggregation_buffer:
[6, 8, 7, 2, 0, 5, 4, 9, 1, 3]
class-wise minimum distance tensor([66.3309, 64.1326, 68.7619, 61.0170, 57.3111, 61.0170, 70.1577, 62.1773,
        61.4245, 57.3111], device='cuda:0')
min_gap tensor(57.3111, device='cuda:0')
max_gap tensor(70.1577, device='cuda:0')
Server loss: 19.562583923339844
end Update
server_global_time: 40.36372162401676
only_train_time: 711.8083667457104

-------------Global Round number: 46-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9364
Averaged Test Accuracy (Prototype Model): 0.8986
Averaged Train Loss (Regular Model): 0.2450
Averaged Train Loss (Regular + Proto): 5.3851
Std Test Accuracy (Regular Model): 0.1346
Std Test Accuracy (Prototype Model): 0.2528
tobetrained:
[6, 8, 7, 2, 0, 5, 4, 9, 1, 3]
Edge 6 begin training
Edge 8 begin training
Edge 7 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 1 begin training
Edge 3 begin training
readyList:
[6, 0, 8, 7, 2, 4, 5, 9, 3, 1]
aggregation_buffer:
[6, 0, 8, 7, 2, 4, 5, 9, 3, 1]
class-wise minimum distance tensor([69.3470, 63.8336, 70.8600, 63.3717, 58.5744, 63.3717, 70.7523, 61.3198,
        63.1671, 58.5744], device='cuda:0')
min_gap tensor(58.5744, device='cuda:0')
max_gap tensor(70.8600, device='cuda:0')
Server loss: 18.94155502319336
end Update
server_global_time: 41.196186155080795
only_train_time: 726.3454918190837

-------------Global Round number: 47-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9274
Averaged Test Accuracy (Prototype Model): 0.8816
Averaged Train Loss (Regular Model): 0.2087
Averaged Train Loss (Regular + Proto): 5.4374
Std Test Accuracy (Regular Model): 0.1607
Std Test Accuracy (Prototype Model): 0.2848
tobetrained:
[6, 0, 8, 7, 2, 4, 5, 9, 3, 1]
Edge 6 begin training
Edge 0 begin training
Edge 8 begin training
Edge 7 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[0, 8, 6, 2, 7, 4, 5, 9, 3, 1]
aggregation_buffer:
[0, 8, 6, 2, 7, 4, 5, 9, 3, 1]
class-wise minimum distance tensor([70.6287, 67.5396, 75.0483, 66.0695, 62.3804, 66.9285, 74.2525, 67.1333,
        65.6236, 62.3804], device='cuda:0')
min_gap tensor(62.3804, device='cuda:0')
max_gap tensor(75.0483, device='cuda:0')
Server loss: 23.43728256225586
end Update
server_global_time: 42.032164223492146
only_train_time: 741.2887133583426

-------------Global Round number: 48-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9258
Averaged Test Accuracy (Prototype Model): 0.8863
Averaged Train Loss (Regular Model): 0.2611
Averaged Train Loss (Regular + Proto): 6.2469
Std Test Accuracy (Regular Model): 0.1414
Std Test Accuracy (Prototype Model): 0.2663
tobetrained:
[0, 8, 6, 2, 7, 4, 5, 9, 3, 1]
Edge 0 begin training
Edge 8 begin training
Edge 6 begin training
Edge 2 begin training
Edge 7 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 7, 8, 2, 0, 4, 5, 9, 3, 1]
aggregation_buffer:
[6, 7, 8, 2, 0, 4, 5, 9, 3, 1]
class-wise minimum distance tensor([71.5616, 67.7045, 74.1987, 66.4267, 63.0176, 66.4267, 75.4756, 65.1498,
        65.3676, 63.0176], device='cuda:0')
min_gap tensor(63.0176, device='cuda:0')
max_gap tensor(75.4756, device='cuda:0')
Server loss: 21.834407806396484
end Update
server_global_time: 42.86404284834862
only_train_time: 756.1402547731996

-------------Global Round number: 49-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9085
Averaged Test Accuracy (Prototype Model): 0.8784
Averaged Train Loss (Regular Model): 0.3659
Averaged Train Loss (Regular + Proto): 6.6084
Std Test Accuracy (Regular Model): 0.1788
Std Test Accuracy (Prototype Model): 0.2441
tobetrained:
[6, 7, 8, 2, 0, 4, 5, 9, 3, 1]
Edge 6 begin training
Edge 7 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 0, 8, 2, 7, 4, 5, 9, 3, 1]
aggregation_buffer:
[6, 0, 8, 2, 7, 4, 5, 9, 3, 1]
class-wise minimum distance tensor([73.1191, 67.4370, 76.8121, 68.5254, 68.1566, 68.5254, 75.0658, 71.1735,
        67.4370, 68.1566], device='cuda:0')
min_gap tensor(67.4370, device='cuda:0')
max_gap tensor(76.8121, device='cuda:0')
Server loss: 24.437427520751953
end Update
server_global_time: 43.69918617606163
only_train_time: 770.9595431163907

-------------Global Round number: 50-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9059
Averaged Test Accuracy (Prototype Model): 0.8627
Averaged Train Loss (Regular Model): 0.6544
Averaged Train Loss (Regular + Proto): 7.6320
Std Test Accuracy (Regular Model): 0.1654
Std Test Accuracy (Prototype Model): 0.2988
tobetrained:
[6, 0, 8, 2, 7, 4, 5, 9, 3, 1]
Edge 6 begin training
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 7 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 0, 7, 8, 2, 4, 5, 9, 3, 1]
aggregation_buffer:
[6, 0, 7, 8, 2, 4, 5, 9, 3, 1]
class-wise minimum distance tensor([74.4240, 66.0189, 74.2551, 67.5095, 66.0148, 68.2853, 73.5221, 64.1073,
        62.9814, 62.9814], device='cuda:0')
min_gap tensor(62.9814, device='cuda:0')
max_gap tensor(74.4240, device='cuda:0')
Server loss: 23.22909164428711
end Update
server_global_time: 44.52733116596937
only_train_time: 785.6994315981865

-------------Global Round number: 51-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.8861
Averaged Test Accuracy (Prototype Model): 0.8733
Averaged Train Loss (Regular Model): 0.2891
Averaged Train Loss (Regular + Proto): 7.1257
Std Test Accuracy (Regular Model): 0.2067
Std Test Accuracy (Prototype Model): 0.2742
tobetrained:
[6, 0, 7, 8, 2, 4, 5, 9, 3, 1]
Edge 6 begin training
Edge 0 begin training
Edge 7 begin training
Edge 8 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 0, 2, 7, 4, 8, 5, 9, 3, 1]
aggregation_buffer:
[6, 0, 2, 7, 4, 8, 5, 9, 3, 1]
class-wise minimum distance tensor([76.4108, 69.6538, 77.4144, 70.4757, 70.1099, 70.4757, 75.4375, 70.9901,
        67.0316, 67.0316], device='cuda:0')
min_gap tensor(67.0316, device='cuda:0')
max_gap tensor(77.4144, device='cuda:0')
Server loss: 18.543725967407227
end Update
server_global_time: 45.35988441109657
only_train_time: 800.6959694102407

-------------Global Round number: 52-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9203
Averaged Test Accuracy (Prototype Model): 0.8640
Averaged Train Loss (Regular Model): 0.3053
Averaged Train Loss (Regular + Proto): 6.9051
Std Test Accuracy (Regular Model): 0.1421
Std Test Accuracy (Prototype Model): 0.2763
tobetrained:
[6, 0, 2, 7, 4, 8, 5, 9, 3, 1]
Edge 6 begin training
Edge 0 begin training
Edge 2 begin training
Edge 7 begin training
Edge 4 begin training
Edge 8 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 0, 8, 7, 2, 4, 9, 5, 3, 1]
aggregation_buffer:
[6, 0, 8, 7, 2, 4, 9, 5, 3, 1]
class-wise minimum distance tensor([77.7241, 68.8506, 77.1840, 72.0553, 68.3620, 72.0553, 75.1420, 69.9939,
        67.4158, 67.4158], device='cuda:0')
min_gap tensor(67.4158, device='cuda:0')
max_gap tensor(77.7241, device='cuda:0')
Server loss: 15.678284645080566
end Update
server_global_time: 46.15546854585409
only_train_time: 815.4252767562866

-------------Global Round number: 53-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.8936
Averaged Test Accuracy (Prototype Model): 0.8696
Averaged Train Loss (Regular Model): 0.2861
Averaged Train Loss (Regular + Proto): 7.0077
Std Test Accuracy (Regular Model): 0.2169
Std Test Accuracy (Prototype Model): 0.2694
tobetrained:
[6, 0, 8, 7, 2, 4, 9, 5, 3, 1]
Edge 6 begin training
Edge 0 begin training
Edge 8 begin training
Edge 7 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 5 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[0, 7, 8, 2, 6, 4, 5, 9, 3, 1]
aggregation_buffer:
[0, 7, 8, 2, 6, 4, 5, 9, 3, 1]
class-wise minimum distance tensor([79.4809, 72.0545, 80.1312, 74.3449, 73.1161, 74.3449, 77.8394, 79.3512,
        72.0545, 72.8571], device='cuda:0')
min_gap tensor(72.0545, device='cuda:0')
max_gap tensor(80.1312, device='cuda:0')
Server loss: 28.50580596923828
end Update
server_global_time: 47.04465655237436
only_train_time: 831.3849412724376

-------------Global Round number: 54-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9038
Averaged Test Accuracy (Prototype Model): 0.8677
Averaged Train Loss (Regular Model): 0.2476
Averaged Train Loss (Regular + Proto): 7.3945
Std Test Accuracy (Regular Model): 0.1747
Std Test Accuracy (Prototype Model): 0.2692
tobetrained:
[0, 7, 8, 2, 6, 4, 5, 9, 3, 1]
Edge 0 begin training
Edge 7 begin training
Edge 8 begin training
Edge 2 begin training
Edge 6 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 0, 7, 2, 8, 4, 9, 5, 3, 1]
aggregation_buffer:
[6, 0, 7, 2, 8, 4, 9, 5, 3, 1]
class-wise minimum distance tensor([79.5450, 71.2828, 79.9729, 79.5000, 72.8022, 79.5000, 78.3663, 76.1104,
        71.2828, 72.8022], device='cuda:0')
min_gap tensor(71.2828, device='cuda:0')
max_gap tensor(79.9729, device='cuda:0')
Server loss: 18.905744552612305
end Update
server_global_time: 47.885079957544804
only_train_time: 846.6697374731302

-------------Global Round number: 55-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9045
Averaged Test Accuracy (Prototype Model): 0.8938
Averaged Train Loss (Regular Model): 0.3626
Averaged Train Loss (Regular + Proto): 7.5758
Std Test Accuracy (Regular Model): 0.1778
Std Test Accuracy (Prototype Model): 0.2405
tobetrained:
[6, 0, 7, 2, 8, 4, 9, 5, 3, 1]
Edge 6 begin training
Edge 0 begin training
Edge 7 begin training
Edge 2 begin training
Edge 8 begin training
Edge 4 begin training
Edge 9 begin training
Edge 5 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 8, 7, 0, 2, 4, 5, 9, 3, 1]
aggregation_buffer:
[6, 8, 7, 0, 2, 4, 5, 9, 3, 1]
class-wise minimum distance tensor([85.2013, 78.0769, 85.8605, 79.1602, 82.4939, 79.1602, 84.6107, 84.6255,
        78.0769, 80.1509], device='cuda:0')
min_gap tensor(78.0769, device='cuda:0')
max_gap tensor(85.8605, device='cuda:0')
Server loss: 20.19133949279785
end Update
server_global_time: 48.72605191171169
only_train_time: 861.5049322247505

-------------Global Round number: 56-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9016
Averaged Test Accuracy (Prototype Model): 0.8781
Averaged Train Loss (Regular Model): 0.3252
Averaged Train Loss (Regular + Proto): 8.0030
Std Test Accuracy (Regular Model): 0.1811
Std Test Accuracy (Prototype Model): 0.2580
tobetrained:
[6, 8, 7, 0, 2, 4, 5, 9, 3, 1]
Edge 6 begin training
Edge 8 begin training
Edge 7 begin training
Edge 0 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 0, 7, 8, 2, 4, 5, 9, 3, 1]
aggregation_buffer:
[6, 0, 7, 8, 2, 4, 5, 9, 3, 1]
class-wise minimum distance tensor([86.1727, 83.9875, 87.3097, 85.0918, 83.4252, 84.5328, 87.9858, 84.3365,
        82.9855, 82.9855], device='cuda:0')
min_gap tensor(82.9855, device='cuda:0')
max_gap tensor(87.9858, device='cuda:0')
Server loss: 17.45055389404297
end Update
server_global_time: 49.532764472067356
only_train_time: 876.4152005761862

-------------Global Round number: 57-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.8471
Averaged Test Accuracy (Prototype Model): 0.7897
Averaged Train Loss (Regular Model): nan
Averaged Train Loss (Regular + Proto): nan
Std Test Accuracy (Regular Model): 0.2346
Std Test Accuracy (Prototype Model): 0.3476
tobetrained:
[6, 0, 7, 8, 2, 4, 5, 9, 3, 1]
Edge 6 begin training
Edge 0 begin training
Edge 7 begin training
Edge 8 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 0, 7, 2, 8, 4, 9, 5, 3, 1]
aggregation_buffer:
[6, 0, 7, 2, 8, 4, 9, 5, 3, 1]
class-wise minimum distance tensor([nan, nan, nan, nan, nan, nan, nan, nan, nan, nan], device='cuda:0')
min_gap tensor(nan, device='cuda:0')
max_gap tensor(nan, device='cuda:0')
Server loss: nan
end Update
server_global_time: 50.369596257805824
only_train_time: 891.2209983095527

-------------Global Round number: 58-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.8560
Averaged Test Accuracy (Prototype Model): 0.0982
Averaged Train Loss (Regular Model): nan
Averaged Train Loss (Regular + Proto): nan
Std Test Accuracy (Regular Model): 0.2397
Std Test Accuracy (Prototype Model): 0.1486
tobetrained:
[6, 0, 7, 2, 8, 4, 9, 5, 3, 1]
Edge 6 begin training
Edge 0 begin training
Edge 7 begin training
Edge 2 begin training
Edge 8 begin training
Edge 4 begin training
Edge 9 begin training
Edge 5 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 0, 8, 7, 2, 4, 5, 9, 3, 1]
aggregation_buffer:
[6, 0, 8, 7, 2, 4, 5, 9, 3, 1]
class-wise minimum distance tensor([nan, nan, nan, nan, nan, nan, nan, nan, nan, nan], device='cuda:0')
min_gap tensor(nan, device='cuda:0')
max_gap tensor(nan, device='cuda:0')
Server loss: nan
end Update
server_global_time: 51.455264657735825
only_train_time: 906.1099292561412

-------------Global Round number: 59-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.0982
Averaged Test Accuracy (Prototype Model): 0.0982
Averaged Train Loss (Regular Model): nan
Averaged Train Loss (Regular + Proto): nan
Std Test Accuracy (Regular Model): 0.1486
Std Test Accuracy (Prototype Model): 0.1486
tobetrained:
[6, 0, 8, 7, 2, 4, 5, 9, 3, 1]
Edge 6 begin training
Edge 0 begin training
Edge 8 begin training
Edge 7 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
readyList:
[6, 0, 7, 8, 2, 4, 5, 9, 3, 1]
aggregation_buffer:
[6, 0, 7, 8, 2, 4, 5, 9, 3, 1]
class-wise minimum distance tensor([nan, nan, nan, nan, nan, nan, nan, nan, nan, nan], device='cuda:0')
min_gap tensor(nan, device='cuda:0')
max_gap tensor(nan, device='cuda:0')
Server loss: nan
Number of samples: 311
Traceback (most recent call last):
  File "main.py", line 510, in <module>
    run(args)
  File "main.py", line 270, in run
    server.train()
  File "/root/autodl-tmp/SAE-FedProto-CEC/system/flcore/servers/servertgp.py", line 92, in train
    self.cloudUpdate()
  File "/root/autodl-tmp/SAE-FedProto-CEC/system/flcore/servers/servertgp.py", line 129, in cloudUpdate
    self.save_tsne_with_agg(
  File "/root/autodl-tmp/SAE-FedProto-CEC/system/flcore/servers/serverbase.py", line 578, in save_tsne_with_agg
    reduced_features = tsne.fit_transform(all_features)
  File "/root/miniconda3/lib/python3.8/site-packages/sklearn/utils/_set_output.py", line 157, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "/root/miniconda3/lib/python3.8/site-packages/sklearn/base.py", line 1152, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "/root/miniconda3/lib/python3.8/site-packages/sklearn/manifold/_t_sne.py", line 1111, in fit_transform
    embedding = self._fit(X)
  File "/root/miniconda3/lib/python3.8/site-packages/sklearn/manifold/_t_sne.py", line 841, in _fit
    X = self._validate_data(
  File "/root/miniconda3/lib/python3.8/site-packages/sklearn/base.py", line 605, in _validate_data
    out = check_array(X, input_name="X", **check_params)
  File "/root/miniconda3/lib/python3.8/site-packages/sklearn/utils/validation.py", line 957, in check_array
    _assert_all_finite(
  File "/root/miniconda3/lib/python3.8/site-packages/sklearn/utils/validation.py", line 122, in _assert_all_finite
    _assert_all_finite_element_wise(
  File "/root/miniconda3/lib/python3.8/site-packages/sklearn/utils/validation.py", line 171, in _assert_all_finite_element_wise
    raise ValueError(msg_err)
ValueError: Input X contains NaN.
TSNE does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
