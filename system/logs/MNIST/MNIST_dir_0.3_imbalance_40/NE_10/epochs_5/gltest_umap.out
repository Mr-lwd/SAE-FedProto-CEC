==================================================
goal = gltest_umap
device = cuda
device_id = 0
dataset = MNIST_dir_0.3_imbalance_40
jetson = 0
DVFS = 0
drawGMM = 0
num_classes = 10
model_family = HCNNs8
batch_size = 256
num_workers = 0
local_learning_rate = 0.06
use_decay_scheduler = False
learning_rate_decay = False
learning_rate_decay_gamma = 0.99
global_rounds = 200
edge_epochs = 1
local_epochs = 5
algorithm = FedProto
join_ratio = 1.0
edge_join_ratio = 1.0
random_join_ratio = False
num_clients = 40
num_edges = 10
prev = 0
times = 1
eval_gap = 1
save_folder_name = STATIC
auto_break = False
feature_dim = 512
vocab_size = 98635
max_len = 200
client_drop_rate = 0.0
train_slow_rate = 0.0
send_slow_rate = 0.0
time_select = False
time_threthold = 10000
optimizer = SGD
lamda = 1.0
weight_decay = 0
trans_delay_simulate = False
momentum = 0.8
agg_type = 0
buffersize = 10
gl_use_clients = 1
test_useglclassifier = 1
gamma = 1
extra_loss = 0
delta = 1
drawtsne = 1
drawround = 20
noise_dim = 512
generator_learning_rate = 0.0001
hidden_dim = 512
server_epochs = 100
alpha = 1.0
beta = 1.0
mentee_learning_rate = 0.005
T_start = 0.95
T_end = 0.98
server_learning_rate = 0.01
margin_threthold = 100.0
generator_path = stylegan/stylegan-xl-models/imagenet64.pkl
stable_diffusion_prompt = a cat
server_batch_size = 100
gen_batch_size = 4
mu = 50.0
buffer_size = 10
==================================================
Random seed set as 42
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes)
temp/MNIST_dir_0.3_imbalance_40/NE_10/featuredim_512/FedProto/SGD/lr_0.06/wd_0/momentum_0.8/lbs_256/lamda_1.0/localepoch_5/buffer_10/gamma_1_usegltest_1/
id 0
label_counts: defaultdict(<class 'int'>, {7: 555, 4: 125, 6: 217, 8: 476, 2: 31, 1: 39, 5: 11, 0: 3})
id 1
label_counts: defaultdict(<class 'int'>, {7: 261, 8: 357, 1: 333, 3: 105, 4: 47, 0: 228, 5: 6, 6: 4, 2: 9})
id 2
label_counts: defaultdict(<class 'int'>, {4: 458, 2: 150, 9: 589, 8: 35, 3: 26, 0: 77, 5: 3, 6: 53, 1: 6})
id 3
label_counts: defaultdict(<class 'int'>, {3: 113, 1: 495, 8: 254, 0: 158, 2: 22, 9: 1, 6: 7, 7: 3})
id 4
label_counts: defaultdict(<class 'int'>, {7: 207, 3: 297, 0: 55, 6: 69, 8: 302, 1: 31, 9: 14, 5: 7, 4: 1})
id 5
label_counts: defaultdict(<class 'int'>, {3: 545, 5: 312, 0: 12, 7: 8, 8: 47, 2: 45, 9: 3, 4: 1})
id 6
label_counts: defaultdict(<class 'int'>, {9: 46, 3: 547, 1: 25, 6: 90, 5: 74, 7: 41, 2: 55, 8: 15, 0: 1})
id 7
label_counts: defaultdict(<class 'int'>, {3: 1041, 2: 54, 8: 546, 6: 71, 4: 19, 7: 55})
id 8
label_counts: defaultdict(<class 'int'>, {5: 291, 2: 159, 4: 87, 7: 322, 9: 119, 6: 92, 8: 140, 1: 6, 0: 24, 3: 8})
id 9
label_counts: defaultdict(<class 'int'>, {0: 199, 7: 464, 3: 101, 4: 138, 5: 114, 2: 203, 8: 47, 9: 4, 1: 5})
id 10
label_counts: defaultdict(<class 'int'>, {7: 951, 2: 980, 6: 188, 5: 8, 3: 39, 0: 3})
id 11
label_counts: defaultdict(<class 'int'>, {0: 803, 4: 100, 5: 579, 2: 58, 1: 11})
id 12
label_counts: defaultdict(<class 'int'>, {9: 1822, 6: 311, 4: 240, 5: 107, 3: 372, 0: 46, 2: 2, 8: 10})
id 13
label_counts: defaultdict(<class 'int'>, {3: 198, 6: 708, 7: 402, 2: 62, 0: 22, 4: 126, 5: 9, 1: 1})
id 14
label_counts: defaultdict(<class 'int'>, {7: 628, 4: 393, 3: 380, 1: 54, 6: 54, 0: 2})
id 15
label_counts: defaultdict(<class 'int'>, {7: 199, 1: 279, 8: 107, 4: 57, 9: 294, 0: 5, 6: 16, 3: 8, 2: 4})
id 16
label_counts: defaultdict(<class 'int'>, {2: 565, 6: 243, 9: 192, 8: 72, 5: 22, 0: 75, 1: 61, 7: 16, 3: 36, 4: 2})
id 17
label_counts: defaultdict(<class 'int'>, {1: 376, 0: 255, 6: 102, 2: 14, 3: 14, 5: 4, 9: 3})
id 18
label_counts: defaultdict(<class 'int'>, {3: 407, 4: 749, 5: 258, 2: 7})
id 19
label_counts: defaultdict(<class 'int'>, {0: 220, 1: 74, 4: 122, 2: 76, 6: 106, 5: 93, 3: 4, 9: 2, 7: 1})
id 20
label_counts: defaultdict(<class 'int'>, {5: 1231, 1: 467, 3: 238, 4: 386, 2: 21})
id 21
label_counts: defaultdict(<class 'int'>, {2: 419, 6: 399, 9: 130, 8: 99, 1: 46, 5: 12, 3: 3, 7: 5, 0: 1})
id 22
label_counts: defaultdict(<class 'int'>, {2: 285, 1: 834, 0: 234})
id 23
label_counts: defaultdict(<class 'int'>, {1: 86, 6: 331, 0: 170, 2: 150, 3: 37, 4: 12, 9: 27, 7: 1, 5: 1})
id 24
label_counts: defaultdict(<class 'int'>, {7: 429, 4: 95, 6: 73, 3: 14, 1: 62, 9: 14, 5: 3, 8: 2})
id 25
label_counts: defaultdict(<class 'int'>, {1: 744, 4: 387, 2: 154, 5: 21, 7: 9, 3: 4})
id 26
label_counts: defaultdict(<class 'int'>, {2: 274, 0: 436, 3: 244, 6: 80, 7: 42, 1: 73, 8: 11, 9: 48, 5: 7, 4: 2})
id 27
label_counts: defaultdict(<class 'int'>, {7: 274, 5: 449, 9: 408, 4: 214, 1: 18, 0: 44, 6: 2, 2: 3})
id 28
label_counts: defaultdict(<class 'int'>, {3: 404, 0: 534, 2: 383})
id 29
label_counts: defaultdict(<class 'int'>, {4: 882, 0: 186, 8: 790, 2: 135, 1: 27, 6: 3, 3: 4, 5: 1})
id 30
label_counts: defaultdict(<class 'int'>, {5: 528, 0: 298, 2: 457, 1: 164, 4: 44, 3: 15})
id 31
label_counts: defaultdict(<class 'int'>, {1: 451, 9: 275, 4: 110, 6: 12, 7: 1, 8: 27, 0: 8, 3: 2})
id 32
label_counts: defaultdict(<class 'int'>, {3: 29, 0: 68, 9: 625, 5: 252, 6: 3, 2: 70, 7: 9, 8: 6, 1: 1})
id 33
label_counts: defaultdict(<class 'int'>, {6: 877, 2: 252, 1: 72, 0: 237, 3: 55, 4: 42, 5: 1})
id 34
label_counts: defaultdict(<class 'int'>, {0: 675, 9: 128, 6: 57, 4: 234, 2: 44, 5: 20, 1: 71, 7: 6, 3: 1})
id 35
label_counts: defaultdict(<class 'int'>, {8: 134, 7: 73, 6: 421, 2: 59, 9: 67, 5: 7, 3: 3, 1: 1})
id 36
label_counts: defaultdict(<class 'int'>, {6: 467, 4: 63, 1: 212, 8: 24, 7: 126, 2: 79, 9: 45, 3: 18, 0: 13})
id 37
label_counts: defaultdict(<class 'int'>, {7: 77, 8: 1474, 6: 84, 5: 70, 3: 15, 2: 10, 1: 2, 0: 7})
id 38
label_counts: defaultdict(<class 'int'>, {3: 44, 1: 734, 6: 28, 7: 245, 8: 100, 4: 8, 5: 28, 9: 7})
id 39
label_counts: defaultdict(<class 'int'>, {9: 354, 5: 192, 0: 84, 8: 33, 1: 7, 3: 1, 6: 1, 4: 4})

Join ratio / total clients: 1.0 / 40
Finished creating server and clients.
X shape: (486, 512), Y shape: (486,)
X shape: (450, 512), Y shape: (450,)
X shape: (466, 512), Y shape: (466,)
X shape: (351, 512), Y shape: (351,)
X shape: (328, 512), Y shape: (328,)
X shape: (325, 512), Y shape: (325,)
X shape: (298, 512), Y shape: (298,)
X shape: (596, 512), Y shape: (596,)
X shape: (416, 512), Y shape: (416,)
X shape: (426, 512), Y shape: (426,)
X shape: (723, 512), Y shape: (723,)
X shape: (517, 512), Y shape: (517,)
X shape: (971, 512), Y shape: (971,)
X shape: (510, 512), Y shape: (510,)
X shape: (504, 512), Y shape: (504,)
X shape: (323, 512), Y shape: (323,)
X shape: (428, 512), Y shape: (428,)
X shape: (256, 512), Y shape: (256,)
X shape: (474, 512), Y shape: (474,)
X shape: (233, 512), Y shape: (233,)
X shape: (782, 512), Y shape: (782,)
X shape: (372, 512), Y shape: (372,)
X shape: (451, 512), Y shape: (451,)
X shape: (272, 512), Y shape: (272,)
X shape: (231, 512), Y shape: (231,)
X shape: (440, 512), Y shape: (440,)
X shape: (406, 512), Y shape: (406,)
X shape: (471, 512), Y shape: (471,)
X shape: (441, 512), Y shape: (441,)
X shape: (677, 512), Y shape: (677,)
X shape: (503, 512), Y shape: (503,)
X shape: (296, 512), Y shape: (296,)
X shape: (355, 512), Y shape: (355,)
X shape: (513, 512), Y shape: (513,)
X shape: (413, 512), Y shape: (413,)
X shape: (256, 512), Y shape: (256,)
X shape: (349, 512), Y shape: (349,)
X shape: (580, 512), Y shape: (580,)
X shape: (398, 512), Y shape: (398,)
X shape: (226, 512), Y shape: (226,)
Averaged Test Accuracy (Regular Model): 0.9784
Averaged Test Accuracy (Prototype Model): 0.9796
Averaged Train Loss (Regular Model): 0.0000
Averaged Train Loss (Regular + Proto): 0.0000
Std Test Accuracy (Regular Model): 0.0131
Std Test Accuracy (Prototype Model): 0.0124
umap_features map
d: 39
d: 39
d: 22
d: 22
