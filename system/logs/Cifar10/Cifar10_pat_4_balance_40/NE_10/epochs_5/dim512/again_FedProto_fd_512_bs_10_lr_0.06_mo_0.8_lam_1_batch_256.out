==================================================
goal = test
device = cuda
device_id = 0
dataset = Cifar10_pat_4_balance_40
jetson = 0
DVFS = 0
static_estimate = 0
drawGMM = 0
num_classes = 10
model_family = HtFE8
batch_size = 256
num_workers = 0
local_learning_rate = 0.06
use_decay_scheduler = False
learning_rate_decay = False
learning_rate_decay_gamma = 0.99
global_rounds = 200
edge_epochs = 1
local_epochs = 5
algorithm = FedProto
join_ratio = 1.0
edge_join_ratio = 1.0
random_join_ratio = False
num_clients = 40
num_edges = 10
prev = 0
times = 1
eval_gap = 1
save_folder_name = temp
auto_break = False
feature_dim = 512
vocab_size = 98635
max_len = 200
client_drop_rate = 0.0
train_slow_rate = 0.0
send_slow_rate = 0.0
time_select = False
time_threthold = 10000
optimizer = SGD
lamda = 1.0
weight_decay = 0
trans_delay_simulate = False
momentum = 0.8
agg_type = 0
buffersize = 10
gl_use_clients = 1
test_useglclassifier = 1
gamma = 1
virtual_feature_numbers = 4000
extra_loss = 0
delta = 1
drawtsne = 1
drawround = 20
noise_dim = 32
generator_learning_rate = 0.0001
hidden_dim = 512
server_epochs = 100
alpha = 1.0
beta = 1.0
mentee_learning_rate = 0.005
T_start = 0.95
T_end = 0.98
server_learning_rate = 0.01
margin_threthold = 100.0
generator_path = stylegan/stylegan-xl-models/imagenet64.pkl
stable_diffusion_prompt = a cat
server_batch_size = 100
gen_batch_size = 4
mu = 50.0
buffer_size = 10
==================================================
Random seed set as 42

============= Running time: 0th =============
Creating server and clients ...
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600)
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes)
mobilenet_v2(pretrained=False, num_classes=args.num_classes)
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes)
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes)
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes)
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes)
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes)
temp/Cifar10_pat_4_balance_40/NE_10/featuredim_512/FedProto/SGD/lr_0.06/wd_0/momentum_0.8/lbs_256/lamda_1.0/localepoch_5/buffer_10/gamma_1_usegltest_1/1739947308.19234
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600) model chosen!
id 0
label_counts: defaultdict(<class 'int'>, {1: 284, 0: 284, 3: 276, 2: 281})
trans_simu_time 15.04
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes) model chosen!
id 1
label_counts: defaultdict(<class 'int'>, {1: 286, 0: 268, 2: 293, 3: 278})
trans_simu_time 15.04
mobilenet_v2(pretrained=False, num_classes=args.num_classes) model chosen!
id 2
label_counts: defaultdict(<class 'int'>, {3: 297, 2: 273, 1: 287, 0: 268})
trans_simu_time 15.04
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes) model chosen!
id 3
label_counts: defaultdict(<class 'int'>, {1: 287, 3: 278, 2: 290, 0: 270})
trans_simu_time 15.04
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes) model chosen!
id 4
label_counts: defaultdict(<class 'int'>, {1: 280, 3: 283, 2: 279, 0: 283})
trans_simu_time 15.04
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes) model chosen!
id 5
label_counts: defaultdict(<class 'int'>, {0: 289, 1: 278, 2: 267, 3: 291})
trans_simu_time 15.04
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes) model chosen!
id 6
label_counts: defaultdict(<class 'int'>, {0: 295, 1: 279, 2: 272, 3: 279})
trans_simu_time 15.04
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes) model chosen!
id 7
label_counts: defaultdict(<class 'int'>, {0: 258, 1: 289, 2: 292, 3: 286})
trans_simu_time 15.04
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600) model chosen!
id 8
label_counts: defaultdict(<class 'int'>, {3: 277, 2: 278, 0: 270, 1: 300})
trans_simu_time 15.04
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes) model chosen!
id 9
label_counts: defaultdict(<class 'int'>, {1: 282, 2: 290, 0: 270, 3: 283})
trans_simu_time 15.04
mobilenet_v2(pretrained=False, num_classes=args.num_classes) model chosen!
id 10
label_counts: defaultdict(<class 'int'>, {2: 280, 3: 283, 1: 281, 0: 281})
trans_simu_time 15.04
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes) model chosen!
id 11
label_counts: defaultdict(<class 'int'>, {0: 286, 2: 279, 1: 289, 3: 271})
trans_simu_time 15.04
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes) model chosen!
id 12
label_counts: defaultdict(<class 'int'>, {2: 293, 1: 276, 0: 276, 3: 280})
trans_simu_time 15.04
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes) model chosen!
id 13
label_counts: defaultdict(<class 'int'>, {3: 277, 0: 274, 1: 288, 2: 286})
trans_simu_time 15.04
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes) model chosen!
id 14
label_counts: defaultdict(<class 'int'>, {0: 277, 3: 289, 2: 279, 1: 280})
trans_simu_time 15.04
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes) model chosen!
id 15
label_counts: defaultdict(<class 'int'>, {2: 279, 3: 276, 1: 288, 0: 282})
trans_simu_time 15.04
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600) model chosen!
id 16
label_counts: defaultdict(<class 'int'>, {7: 264, 5: 289, 6: 287, 4: 285})
trans_simu_time 15.04
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes) model chosen!
id 17
label_counts: defaultdict(<class 'int'>, {5: 281, 7: 274, 4: 291, 6: 279})
trans_simu_time 15.04
mobilenet_v2(pretrained=False, num_classes=args.num_classes) model chosen!
id 18
label_counts: defaultdict(<class 'int'>, {6: 275, 4: 269, 5: 286, 7: 295})
trans_simu_time 15.04
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes) model chosen!
id 19
label_counts: defaultdict(<class 'int'>, {4: 295, 6: 280, 5: 280, 7: 270})
trans_simu_time 15.04
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes) model chosen!
id 20
label_counts: defaultdict(<class 'int'>, {4: 284, 7: 282, 5: 277, 6: 282})
trans_simu_time 15.04
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes) model chosen!
id 21
label_counts: defaultdict(<class 'int'>, {4: 269, 7: 296, 6: 283, 5: 277})
trans_simu_time 15.04
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes) model chosen!
id 22
label_counts: defaultdict(<class 'int'>, {7: 266, 4: 279, 5: 277, 6: 303})
trans_simu_time 15.04
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes) model chosen!
id 23
label_counts: defaultdict(<class 'int'>, {6: 273, 5: 293, 4: 281, 7: 278})
trans_simu_time 15.04
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600) model chosen!
id 24
label_counts: defaultdict(<class 'int'>, {7: 273, 6: 284, 4: 283, 5: 285})
trans_simu_time 15.04
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes) model chosen!
id 25
label_counts: defaultdict(<class 'int'>, {5: 287, 4: 268, 6: 280, 7: 290})
trans_simu_time 15.04
mobilenet_v2(pretrained=False, num_classes=args.num_classes) model chosen!
id 26
label_counts: defaultdict(<class 'int'>, {5: 279, 7: 290, 4: 273, 6: 283})
trans_simu_time 15.04
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes) model chosen!
id 27
label_counts: defaultdict(<class 'int'>, {6: 268, 5: 277, 7: 291, 4: 289})
trans_simu_time 15.04
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes) model chosen!
id 28
label_counts: defaultdict(<class 'int'>, {5: 278, 7: 283, 6: 290, 4: 274})
trans_simu_time 15.04
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes) model chosen!
id 29
label_counts: defaultdict(<class 'int'>, {7: 275, 5: 278, 4: 296, 6: 276})
trans_simu_time 15.04
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes) model chosen!
id 30
label_counts: defaultdict(<class 'int'>, {6: 285, 4: 276, 7: 287, 5: 277})
trans_simu_time 15.04
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes) model chosen!
id 31
label_counts: defaultdict(<class 'int'>, {7: 284, 4: 278, 6: 278, 5: 285})
trans_simu_time 15.04
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600) model chosen!
id 32
label_counts: defaultdict(<class 'int'>, {9: 560, 8: 565})
trans_simu_time 15.04
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes) model chosen!
id 33
label_counts: defaultdict(<class 'int'>, {9: 561, 8: 564})
trans_simu_time 15.04
mobilenet_v2(pretrained=False, num_classes=args.num_classes) model chosen!
id 34
label_counts: defaultdict(<class 'int'>, {9: 547, 8: 578})
trans_simu_time 15.04
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes) model chosen!
id 35
label_counts: defaultdict(<class 'int'>, {9: 555, 8: 570})
trans_simu_time 15.04
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes) model chosen!
id 36
label_counts: defaultdict(<class 'int'>, {8: 556, 9: 569})
trans_simu_time 15.04
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes) model chosen!
id 37
label_counts: defaultdict(<class 'int'>, {8: 568, 9: 557})
trans_simu_time 15.04
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes) model chosen!
id 38
label_counts: defaultdict(<class 'int'>, {8: 573, 9: 552})
trans_simu_time 15.04
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes) model chosen!
id 39
label_counts: defaultdict(<class 'int'>, {9: 555, 8: 570})
trans_simu_time 15.04

Join ratio / total clients: 1.0 / 40
Finished creating server and clients.
tobetrained:
[9, 8, 7, 6, 5, 4, 3, 2, 1, 0]
Edge 9 begin training
Edge 8 begin training
Edge 7 begin training
Edge 6 begin training
