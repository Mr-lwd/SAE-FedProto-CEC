==================================================
goal = test
device = cuda
device_id = 0
dataset = Cifar10_dir_0.3_imbalance_40
num_classes = 10
model_family = HtFE8
batch_size = 256
local_learning_rate = 0.06
use_decay_scheduler = False
learning_rate_decay = False
learning_rate_decay_gamma = 0.99
global_rounds = 400
edge_epochs = 1
local_epochs = 5
algorithm = FedSAE
join_ratio = 1.0
random_join_ratio = False
num_clients = 40
num_edges = 10
prev = 0
times = 1
eval_gap = 1
save_folder_name = temp
auto_break = False
feature_dim = 512
vocab_size = 98635
max_len = 200
client_drop_rate = 0.0
train_slow_rate = 0.0
send_slow_rate = 0.0
time_select = False
time_threthold = 10000
optimizer = SGD
lamda = 1.0
weight_decay = 0
trans_delay_simulate = False
momentum = 0.8
agg_type = 0
buffersize = 5
gl_use_clients = 1
test_useglclassifier = 1
gamma = 1.0
drawtsne = 1
drawround = 20
noise_dim = 512
generator_learning_rate = 0.0001
hidden_dim = 512
server_epochs = 100
alpha = 1.0
beta = 1.0
mentee_learning_rate = 0.005
T_start = 0.95
T_end = 0.98
server_learning_rate = 0.01
margin_threthold = 100.0
generator_path = stylegan/stylegan-xl-models/imagenet64.pkl
stable_diffusion_prompt = a cat
server_batch_size = 100
gen_batch_size = 4
mu = 50.0
==================================================
Random seed set as 42

============= Running time: 0th =============
Creating server and clients ...
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600)
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes)
mobilenet_v2(pretrained=False, num_classes=args.num_classes)
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes)
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes)
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes)
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes)
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes)
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600) model chosen!
id 0
label_counts: defaultdict(<class 'int'>, {6: 87, 7: 347, 3: 400, 1: 47, 4: 179, 8: 41, 2: 1, 5: 2, 9: 2, 0: 2})
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes) model chosen!
id 1
label_counts: defaultdict(<class 'int'>, {2: 855, 4: 327, 0: 5, 3: 3})
mobilenet_v2(pretrained=False, num_classes=args.num_classes) model chosen!
id 2
label_counts: defaultdict(<class 'int'>, {5: 141, 9: 71, 4: 177, 8: 162, 6: 36, 2: 95, 1: 9, 7: 49, 0: 23, 3: 2})
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes) model chosen!
id 3
label_counts: defaultdict(<class 'int'>, {9: 347, 4: 88, 5: 394, 8: 32, 7: 415, 2: 15, 0: 3})
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes) model chosen!
id 4
label_counts: defaultdict(<class 'int'>, {8: 172, 2: 591, 3: 83, 7: 30, 5: 234, 1: 3, 4: 18, 0: 18})
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes) model chosen!
id 5
label_counts: defaultdict(<class 'int'>, {0: 841, 5: 565, 1: 70, 3: 35})
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes) model chosen!
id 6
label_counts: defaultdict(<class 'int'>, {3: 381, 6: 154, 8: 143, 9: 43, 0: 93, 1: 15, 2: 1, 4: 2, 7: 1})
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes) model chosen!
id 7
label_counts: defaultdict(<class 'int'>, {9: 1519, 4: 349, 3: 115, 2: 76, 0: 78, 7: 79, 5: 29, 1: 6, 6: 1})
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600) model chosen!
id 8
label_counts: defaultdict(<class 'int'>, {4: 425, 1: 15, 3: 83, 8: 161, 0: 4, 2: 115, 7: 92, 9: 10, 6: 5, 5: 2})
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes) model chosen!
id 9
label_counts: defaultdict(<class 'int'>, {7: 286, 1: 64, 4: 95, 0: 7, 2: 80, 3: 14, 9: 28, 5: 7})
mobilenet_v2(pretrained=False, num_classes=args.num_classes) model chosen!
id 10
label_counts: defaultdict(<class 'int'>, {8: 906, 0: 830, 4: 108, 1: 17, 3: 11, 2: 10, 6: 6, 5: 5})
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes) model chosen!
id 11
label_counts: defaultdict(<class 'int'>, {8: 208, 7: 8, 1: 227, 2: 238, 3: 16, 9: 48, 5: 2, 6: 2, 4: 1})
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes) model chosen!
id 12
label_counts: defaultdict(<class 'int'>, {4: 354, 6: 681, 1: 47, 0: 50, 3: 4, 5: 1, 2: 2})
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes) model chosen!
id 13
label_counts: defaultdict(<class 'int'>, {0: 464, 6: 426, 3: 90, 2: 271, 1: 67, 4: 10})
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes) model chosen!
id 14
label_counts: defaultdict(<class 'int'>, {5: 746, 1: 509, 4: 104, 3: 17, 0: 30, 2: 1})
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes) model chosen!
id 15
label_counts: defaultdict(<class 'int'>, {4: 973, 2: 843, 1: 155, 0: 75, 3: 45})
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600) model chosen!
id 16
label_counts: defaultdict(<class 'int'>, {6: 120, 1: 2, 3: 448, 0: 8, 8: 77, 9: 202, 4: 43, 5: 71})
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes) model chosen!
id 17
label_counts: defaultdict(<class 'int'>, {7: 978, 0: 8, 6: 42, 3: 84, 2: 130, 5: 9, 4: 48})
mobilenet_v2(pretrained=False, num_classes=args.num_classes) model chosen!
id 18
label_counts: defaultdict(<class 'int'>, {0: 260, 5: 179, 1: 196, 4: 82, 3: 53, 7: 8, 8: 51, 6: 3, 2: 2})
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes) model chosen!
id 19
label_counts: defaultdict(<class 'int'>, {1: 456, 5: 56, 9: 86, 8: 150, 2: 46, 6: 20, 7: 10, 3: 7})
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes) model chosen!
id 20
label_counts: defaultdict(<class 'int'>, {3: 362, 0: 218, 4: 48, 8: 358, 7: 24, 6: 242, 2: 17, 5: 6})
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes) model chosen!
id 21
label_counts: defaultdict(<class 'int'>, {1: 276, 0: 436, 5: 44, 4: 131, 2: 72, 3: 93, 8: 33, 9: 2, 6: 2})
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes) model chosen!
id 22
label_counts: defaultdict(<class 'int'>, {3: 97, 6: 159, 8: 459, 9: 131, 5: 64, 1: 82, 7: 22, 4: 2, 2: 1})
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes) model chosen!
id 23
label_counts: defaultdict(<class 'int'>, {2: 510, 3: 373, 1: 205, 0: 170})
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600) model chosen!
id 24
label_counts: defaultdict(<class 'int'>, {4: 111, 7: 407, 6: 231, 2: 21, 1: 151, 8: 68, 3: 19, 9: 44, 0: 4})
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes) model chosen!
id 25
label_counts: defaultdict(<class 'int'>, {7: 336, 4: 100, 1: 353, 5: 197, 6: 83, 3: 29, 2: 11, 9: 2, 8: 3, 0: 2})
mobilenet_v2(pretrained=False, num_classes=args.num_classes) model chosen!
id 26
label_counts: defaultdict(<class 'int'>, {9: 885, 0: 276, 3: 116, 5: 59, 8: 57, 1: 18, 6: 2, 4: 3})
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes) model chosen!
id 27
label_counts: defaultdict(<class 'int'>, {6: 360, 5: 140, 1: 24, 3: 12, 4: 28, 9: 54, 2: 15})
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes) model chosen!
id 28
label_counts: defaultdict(<class 'int'>, {8: 31, 5: 486, 1: 148, 0: 87, 4: 71, 7: 29, 6: 12, 2: 2, 3: 1})
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes) model chosen!
id 29
label_counts: defaultdict(<class 'int'>, {5: 380, 7: 932, 1: 46, 6: 48, 4: 10, 3: 54, 2: 10})
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes) model chosen!
id 30
label_counts: defaultdict(<class 'int'>, {3: 724, 2: 19, 6: 555, 0: 95, 5: 89, 4: 8, 1: 1})
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes) model chosen!
id 31
label_counts: defaultdict(<class 'int'>, {6: 65, 0: 185, 9: 201, 1: 130, 7: 52, 3: 7, 4: 61, 2: 12, 5: 41})
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600) model chosen!
id 32
label_counts: defaultdict(<class 'int'>, {0: 33, 5: 339, 8: 81, 9: 53, 2: 65, 1: 9, 3: 3, 7: 1, 6: 11})
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes) model chosen!
id 33
label_counts: defaultdict(<class 'int'>, {6: 249, 1: 688, 8: 63, 4: 82, 5: 32, 7: 39, 0: 10, 2: 2})
mobilenet_v2(pretrained=False, num_classes=args.num_classes) model chosen!
id 34
label_counts: defaultdict(<class 'int'>, {8: 782, 6: 180, 4: 26, 1: 196, 3: 124, 7: 25, 2: 5})
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes) model chosen!
id 35
label_counts: defaultdict(<class 'int'>, {0: 69, 2: 255, 9: 362, 3: 64, 6: 20, 7: 151, 8: 12, 1: 7, 4: 8})
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes) model chosen!
id 36
label_counts: defaultdict(<class 'int'>, {5: 152, 8: 159, 1: 70, 9: 83, 4: 109, 2: 15, 7: 10, 0: 1})
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes) model chosen!
id 37
label_counts: defaultdict(<class 'int'>, {1: 171, 0: 116, 4: 82, 6: 519, 9: 20, 3: 58, 7: 10, 5: 16, 2: 10})
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes) model chosen!
id 38
label_counts: defaultdict(<class 'int'>, {2: 125, 7: 141, 6: 156, 5: 29, 8: 27, 3: 111, 1: 29, 9: 20, 0: 6})
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes) model chosen!
id 39
label_counts: defaultdict(<class 'int'>, {3: 345, 8: 216, 9: 312, 4: 217, 0: 3, 5: 5, 7: 4, 2: 1, 1: 1})

Join ratio / total clients: 1.0 / 40
Finished creating server and clients.
Trainable_prototypes(
  (embedings): Embedding(10, 512)
  (middle): Sequential(
    (0): Sequential(
      (0): Linear(in_features=512, out_features=512, bias=True)
      (1): ReLU()
    )
  )
  (fc): Linear(in_features=512, out_features=512, bias=True)
)
tobetrained:
[9, 8, 7, 6, 5, 4, 3, 2, 1, 0]
Edge 9 begin training
Server global_protos Not Found
Server glclassifier Not Found
Client_5 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_31 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_13 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_0 protos Not Found
Edge 8 begin training
Server global_protos Not Found
Server glclassifier Not Found
Client_16 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_1 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_26 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_36 protos Not Found
Edge 7 begin training
Server global_protos Not Found
Server glclassifier Not Found
Client_24 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_7 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_27 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_2 protos Not Found
Edge 6 begin training
Server global_protos Not Found
Server glclassifier Not Found
Client_32 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_38 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_8 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_23 protos Not Found
Edge 5 begin training
Server global_protos Not Found
Server glclassifier Not Found
Client_9 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_33 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_29 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_6 protos Not Found
Edge 4 begin training
Server global_protos Not Found
Server glclassifier Not Found
Client_30 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_10 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_18 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_17 protos Not Found
Edge 3 begin training
Server global_protos Not Found
Server glclassifier Not Found
Client_14 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_15 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_39 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_35 protos Not Found
Edge 2 begin training
Server global_protos Not Found
Server glclassifier Not Found
Client_21 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_3 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_19 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_11 protos Not Found
Edge 1 begin training
Server global_protos Not Found
Server glclassifier Not Found
Client_12 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_20 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_22 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_25 protos Not Found
Edge 0 begin training
Server global_protos Not Found
Server glclassifier Not Found
Client_37 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_34 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_28 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_4 protos Not Found
readyList:
[8, 0, 2, 1, 5, 9, 4, 6, 7, 3]
aggregation_buffer:
[8, 0, 2, 1, 5]
Edge_3 cloud_mean_cov Not Found
Edge_4 cloud_mean_cov Not Found
Edge_6 cloud_mean_cov Not Found
Edge_7 cloud_mean_cov Not Found
Edge_9 cloud_mean_cov Not Found
train global classifier
train glclassifier time: 4.703658744692802
global classifier accuracy in train virtual: 56.8525
Number of samples: 326
end Update
server_global_time: 2.4568860307335854
only_train_time: 77.40395876765251

-------------Global Round number: 0-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.2455
Averaged Test Accuracy (Prototype Model): 0.1499
Averaged Train Loss (Regular Model): 1.3855
Averaged Train Loss (Regular + Proto): 1.3855
Std Test Accuracy (Regular Model): 0.1860
Std Test Accuracy (Prototype Model): 0.1406
tobetrained:
[8, 0, 2, 1, 5]
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
readyList:
[9, 4, 0, 8, 2, 6, 5, 1, 7, 3]
aggregation_buffer:
[9, 4, 0, 8, 2]
Edge_3 cloud_mean_cov Not Found
Edge_6 cloud_mean_cov Not Found
Edge_7 cloud_mean_cov Not Found
train global classifier
train glclassifier time: 4.227551162242889
global classifier accuracy in train virtual: 64.22
end Update
server_global_time: 4.331166595220566
only_train_time: 107.06223149597645

-------------Global Round number: 1-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.3750
Averaged Test Accuracy (Prototype Model): 0.2342
Averaged Train Loss (Regular Model): 1.1781
Averaged Train Loss (Regular + Proto): 1.4333
Std Test Accuracy (Regular Model): 0.2677
Std Test Accuracy (Prototype Model): 0.1903
tobetrained:
[9, 4, 0, 8, 2]
Edge 9 begin training
Edge 4 begin training
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
readyList:
[6, 5, 1, 0, 2, 8, 9, 7, 4, 3]
aggregation_buffer:
[6, 5, 1, 0, 2]
Edge_3 cloud_mean_cov Not Found
Edge_7 cloud_mean_cov Not Found
train global classifier
train glclassifier time: 4.902525022625923
global classifier accuracy in train virtual: 69.99
end Update
server_global_time: 6.131535932421684
only_train_time: 139.96817672997713

-------------Global Round number: 2-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.4600
Averaged Test Accuracy (Prototype Model): 0.3583
Averaged Train Loss (Regular Model): 1.0556
Averaged Train Loss (Regular + Proto): 1.3415
Std Test Accuracy (Regular Model): 0.2505
Std Test Accuracy (Prototype Model): 0.2183
tobetrained:
[6, 5, 1, 0, 2]
Edge 6 begin training
Edge 5 begin training
Edge 1 begin training
Edge 0 begin training
Edge 2 begin training
readyList:
[8, 9, 0, 2, 7, 4, 5, 1, 3, 6]
aggregation_buffer:
[8, 9, 0, 2, 7]
Edge_3 cloud_mean_cov Not Found
train global classifier
train glclassifier time: 4.835813790559769
global classifier accuracy in train virtual: 72.8675
end Update
server_global_time: 8.102012120187283
only_train_time: 172.53176422417164

-------------Global Round number: 3-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.5126
Averaged Test Accuracy (Prototype Model): 0.3723
Averaged Train Loss (Regular Model): 0.9431
Averaged Train Loss (Regular + Proto): 1.2098
Std Test Accuracy (Regular Model): 0.2252
Std Test Accuracy (Prototype Model): 0.2235
tobetrained:
[8, 9, 0, 2, 7]
Edge 8 begin training
Edge 9 begin training
Edge 0 begin training
Edge 2 begin training
Edge 7 begin training
readyList:
[4, 5, 1, 3, 0, 2, 8, 6, 9, 7]
aggregation_buffer:
[4, 5, 1, 3, 0]
train global classifier
train glclassifier time: 4.208409883081913
global classifier accuracy in train virtual: 74.5375
end Update
server_global_time: 9.651442386209965
only_train_time: 205.4586337953806

-------------Global Round number: 4-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.5738
Averaged Test Accuracy (Prototype Model): 0.4269
Averaged Train Loss (Regular Model): 0.8399
Averaged Train Loss (Regular + Proto): 1.1039
Std Test Accuracy (Regular Model): 0.1710
Std Test Accuracy (Prototype Model): 0.2300
tobetrained:
[4, 5, 1, 3, 0]
Edge 4 begin training
Edge 5 begin training
Edge 1 begin training
Edge 3 begin training
Edge 0 begin training
readyList:
[2, 8, 6, 9, 0, 1, 5, 4, 7, 3]
aggregation_buffer:
[2, 8, 6, 9, 0]
train global classifier
train glclassifier time: 4.202491298317909
global classifier accuracy in train virtual: 76.86
end Update
server_global_time: 11.215788893401623
only_train_time: 253.06121982634068

-------------Global Round number: 5-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6017
Averaged Test Accuracy (Prototype Model): 0.4581
Averaged Train Loss (Regular Model): 0.7140
Averaged Train Loss (Regular + Proto): 1.0188
Std Test Accuracy (Regular Model): 0.1355
Std Test Accuracy (Prototype Model): 0.2260
tobetrained:
[2, 8, 6, 9, 0]
Edge 2 begin training
Edge 8 begin training
Edge 6 begin training
Edge 9 begin training
Edge 0 begin training
readyList:
[1, 5, 0, 8, 2, 4, 9, 6, 7, 3]
aggregation_buffer:
[1, 5, 0, 8, 2]
train global classifier
train glclassifier time: 4.159860767424107
global classifier accuracy in train virtual: 79.255
end Update
server_global_time: 13.248777873814106
only_train_time: 283.37439892441034

-------------Global Round number: 6-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.5993
Averaged Test Accuracy (Prototype Model): 0.4822
Averaged Train Loss (Regular Model): 0.6464
Averaged Train Loss (Regular + Proto): 0.9304
Std Test Accuracy (Regular Model): 0.1432
Std Test Accuracy (Prototype Model): 0.2077
tobetrained:
[1, 5, 0, 8, 2]
Edge 1 begin training
Edge 5 begin training
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
readyList:
[4, 9, 8, 0, 2, 6, 1, 5, 7, 3]
aggregation_buffer:
[4, 9, 8, 0, 2]
train global classifier
train glclassifier time: 4.991501368582249
global classifier accuracy in train virtual: 81.89
end Update
server_global_time: 15.180476926267147
only_train_time: 314.48112984001637

-------------Global Round number: 7-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6082
Averaged Test Accuracy (Prototype Model): 0.4996
Averaged Train Loss (Regular Model): 0.6043
Averaged Train Loss (Regular + Proto): 0.8676
Std Test Accuracy (Regular Model): 0.1275
Std Test Accuracy (Prototype Model): 0.2044
tobetrained:
[4, 9, 8, 0, 2]
Edge 4 begin training
Edge 9 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
readyList:
[6, 1, 5, 7, 0, 8, 2, 9, 3, 4]
aggregation_buffer:
[6, 1, 5, 7, 0]
train global classifier
train glclassifier time: 3.9324388951063156
global classifier accuracy in train virtual: 84.4425
end Update
server_global_time: 16.818391904234886
only_train_time: 345.6309295594692

-------------Global Round number: 8-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.5883
Averaged Test Accuracy (Prototype Model): 0.5082
Averaged Train Loss (Regular Model): 0.5688
Averaged Train Loss (Regular + Proto): 0.8189
Std Test Accuracy (Regular Model): 0.1540
Std Test Accuracy (Prototype Model): 0.1848
tobetrained:
[6, 1, 5, 7, 0]
Edge 6 begin training
Edge 1 begin training
Edge 5 begin training
Edge 7 begin training
Edge 0 begin training
readyList:
[8, 2, 9, 3, 0, 4, 5, 1, 6, 7]
aggregation_buffer:
[8, 2, 9, 3, 0]
train global classifier
train glclassifier time: 3.912931650876999
global classifier accuracy in train virtual: 88.7675
end Update
server_global_time: 18.47653330862522
only_train_time: 384.5561291575432

-------------Global Round number: 9-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.5957
Averaged Test Accuracy (Prototype Model): 0.5179
Averaged Train Loss (Regular Model): 0.4560
Averaged Train Loss (Regular + Proto): 0.6855
Std Test Accuracy (Regular Model): 0.1410
Std Test Accuracy (Prototype Model): 0.1910
tobetrained:
[8, 2, 9, 3, 0]
Edge 8 begin training
Edge 2 begin training
Edge 9 begin training
Edge 3 begin training
Edge 0 begin training
readyList:
[4, 5, 1, 0, 8, 2, 9, 6, 7, 3]
aggregation_buffer:
[4, 5, 1, 0, 8]
train global classifier
train glclassifier time: 4.078780122101307
global classifier accuracy in train virtual: 90.4125
end Update
server_global_time: 20.396688394248486
only_train_time: 425.07697408646345

-------------Global Round number: 10-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.5966
Averaged Test Accuracy (Prototype Model): 0.5284
Averaged Train Loss (Regular Model): 0.4237
Averaged Train Loss (Regular + Proto): 0.6331
Std Test Accuracy (Regular Model): 0.1422
Std Test Accuracy (Prototype Model): 0.1731
tobetrained:
[4, 5, 1, 0, 8]
Edge 4 begin training
Edge 5 begin training
Edge 1 begin training
Edge 0 begin training
Edge 8 begin training
readyList:
[2, 9, 6, 0, 8, 5, 1, 4, 7, 3]
aggregation_buffer:
[2, 9, 6, 0, 8]
train global classifier
train glclassifier time: 4.0420771315693855
global classifier accuracy in train virtual: 91.1375
end Update
server_global_time: 22.154772385954857
only_train_time: 459.5367399379611

-------------Global Round number: 11-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6137
Averaged Test Accuracy (Prototype Model): 0.5341
Averaged Train Loss (Regular Model): 0.4025
Averaged Train Loss (Regular + Proto): 0.6005
Std Test Accuracy (Regular Model): 0.1264
Std Test Accuracy (Prototype Model): 0.1748
tobetrained:
[2, 9, 6, 0, 8]
Edge 2 begin training
Edge 9 begin training
Edge 6 begin training
Edge 0 begin training
Edge 8 begin training
readyList:
[5, 1, 0, 8, 2, 4, 9, 7, 3, 6]
aggregation_buffer:
[5, 1, 0, 8, 2]
train global classifier
train glclassifier time: 4.009729132056236
global classifier accuracy in train virtual: 91.685
end Update
server_global_time: 23.9610363766551
only_train_time: 489.6585193797946

-------------Global Round number: 12-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6208
Averaged Test Accuracy (Prototype Model): 0.5507
Averaged Train Loss (Regular Model): 0.3569
Averaged Train Loss (Regular + Proto): 0.5462
Std Test Accuracy (Regular Model): 0.1316
Std Test Accuracy (Prototype Model): 0.1690
tobetrained:
[5, 1, 0, 8, 2]
Edge 5 begin training
Edge 1 begin training
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
readyList:
[4, 9, 0, 8, 2, 7, 5, 1, 3, 6]
aggregation_buffer:
[4, 9, 0, 8, 2]
train global classifier
train glclassifier time: 4.0069602727890015
global classifier accuracy in train virtual: 92.125
end Update
server_global_time: 25.940655536949635
only_train_time: 519.7617081329226

-------------Global Round number: 13-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6180
Averaged Test Accuracy (Prototype Model): 0.5485
Averaged Train Loss (Regular Model): 0.3402
Averaged Train Loss (Regular + Proto): 0.5220
Std Test Accuracy (Regular Model): 0.1313
Std Test Accuracy (Prototype Model): 0.1661
tobetrained:
[4, 9, 0, 8, 2]
Edge 4 begin training
Edge 9 begin training
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
readyList:
[7, 5, 1, 3, 6, 0, 2, 8, 9, 4]
aggregation_buffer:
[7, 5, 1, 3, 6]
train global classifier
train glclassifier time: 4.129140570759773
global classifier accuracy in train virtual: 94.1575
end Update
server_global_time: 26.816815473139286
only_train_time: 551.4253621548414

-------------Global Round number: 14-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6234
Averaged Test Accuracy (Prototype Model): 0.5764
Averaged Train Loss (Regular Model): 0.3198
Averaged Train Loss (Regular + Proto): 0.4956
Std Test Accuracy (Regular Model): 0.1260
Std Test Accuracy (Prototype Model): 0.1444
tobetrained:
[7, 5, 1, 3, 6]
Edge 7 begin training
Edge 5 begin training
Edge 1 begin training
Edge 3 begin training
Edge 6 begin training
readyList:
[0, 2, 8, 9, 5, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 9, 5]
train global classifier
train glclassifier time: 3.9280648306012154
global classifier accuracy in train virtual: 94.5675
end Update
server_global_time: 29.326661832630634
only_train_time: 602.1052096709609

-------------Global Round number: 15-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6222
Averaged Test Accuracy (Prototype Model): 0.5959
Averaged Train Loss (Regular Model): 0.2441
Averaged Train Loss (Regular + Proto): 0.3991
Std Test Accuracy (Regular Model): 0.1173
Std Test Accuracy (Prototype Model): 0.1365
tobetrained:
[0, 2, 8, 9, 5]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 9 begin training
Edge 5 begin training
readyList:
[1, 4, 0, 8, 2, 6, 5, 9, 3, 7]
aggregation_buffer:
[1, 4, 0, 8, 2]
train global classifier
train glclassifier time: 4.06104339659214
global classifier accuracy in train virtual: 95.17
end Update
server_global_time: 31.145589001476765
only_train_time: 632.4140014350414

-------------Global Round number: 16-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6206
Averaged Test Accuracy (Prototype Model): 0.5887
Averaged Train Loss (Regular Model): 0.2423
Averaged Train Loss (Regular + Proto): 0.3920
Std Test Accuracy (Regular Model): 0.1165
Std Test Accuracy (Prototype Model): 0.1353
tobetrained:
[1, 4, 0, 8, 2]
Edge 1 begin training
Edge 4 begin training
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
readyList:
[6, 5, 9, 0, 8, 2, 1, 4, 3, 7]
aggregation_buffer:
[6, 5, 9, 0, 8]
train global classifier
train glclassifier time: 3.9391490668058395
global classifier accuracy in train virtual: 95.9675
end Update
server_global_time: 32.93591070175171
only_train_time: 663.6495462879539

-------------Global Round number: 17-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6234
Averaged Test Accuracy (Prototype Model): 0.5933
Averaged Train Loss (Regular Model): 0.2353
Averaged Train Loss (Regular + Proto): 0.3794
Std Test Accuracy (Regular Model): 0.1173
Std Test Accuracy (Prototype Model): 0.1353
tobetrained:
[6, 5, 9, 0, 8]
Edge 6 begin training
Edge 5 begin training
Edge 9 begin training
Edge 0 begin training
Edge 8 begin training
readyList:
[2, 1, 0, 8, 4, 3, 5, 9, 7, 6]
aggregation_buffer:
[2, 1, 0, 8, 4]
train global classifier
train glclassifier time: 3.947322852909565
global classifier accuracy in train virtual: 96.115
end Update
server_global_time: 35.03567051142454
only_train_time: 697.0547838881612

-------------Global Round number: 18-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6278
Averaged Test Accuracy (Prototype Model): 0.5991
Averaged Train Loss (Regular Model): 0.2167
Averaged Train Loss (Regular + Proto): 0.3546
Std Test Accuracy (Regular Model): 0.1181
Std Test Accuracy (Prototype Model): 0.1328
tobetrained:
[2, 1, 0, 8, 4]
Edge 2 begin training
Edge 1 begin training
Edge 0 begin training
Edge 8 begin training
Edge 4 begin training
readyList:
[3, 5, 9, 7, 0, 8, 2, 6, 1, 4]
aggregation_buffer:
[3, 5, 9, 7, 0]
train global classifier
train glclassifier time: 4.304114878177643
global classifier accuracy in train virtual: 96.7675
end Update
server_global_time: 36.756121180951595
only_train_time: 728.9223851114511

-------------Global Round number: 19-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6247
Averaged Test Accuracy (Prototype Model): 0.6007
Averaged Train Loss (Regular Model): 0.2107
Averaged Train Loss (Regular + Proto): 0.3449
Std Test Accuracy (Regular Model): 0.1175
Std Test Accuracy (Prototype Model): 0.1305
tobetrained:
[3, 5, 9, 7, 0]
Edge 3 begin training
Edge 5 begin training
Edge 9 begin training
Edge 7 begin training
Edge 0 begin training
readyList:
[8, 2, 6, 1, 0, 4, 5, 9, 3, 7]
aggregation_buffer:
[8, 2, 6, 1, 0]
train global classifier
train glclassifier time: 4.115694560110569
global classifier accuracy in train virtual: 97.1525
Number of samples: 326
end Update
server_global_time: 38.29611660540104
only_train_time: 778.1988896206021

-------------Global Round number: 20-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6366
Averaged Test Accuracy (Prototype Model): 0.6097
Averaged Train Loss (Regular Model): 0.1742
Averaged Train Loss (Regular + Proto): 0.2974
Std Test Accuracy (Regular Model): 0.1042
Std Test Accuracy (Prototype Model): 0.1158
tobetrained:
[8, 2, 6, 1, 0]
Edge 8 begin training
Edge 2 begin training
Edge 6 begin training
Edge 1 begin training
Edge 0 begin training
readyList:
[4, 5, 9, 0, 8, 2, 1, 6, 3, 7]
aggregation_buffer:
[4, 5, 9, 0, 8]
train global classifier
train glclassifier time: 4.902272880077362
global classifier accuracy in train virtual: 97.575
end Update
server_global_time: 40.07965859770775
only_train_time: 807.6068432182074

-------------Global Round number: 21-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6378
Averaged Test Accuracy (Prototype Model): 0.6119
Averaged Train Loss (Regular Model): 0.1581
Averaged Train Loss (Regular + Proto): 0.2772
Std Test Accuracy (Regular Model): 0.1078
Std Test Accuracy (Prototype Model): 0.1200
tobetrained:
[4, 5, 9, 0, 8]
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 0 begin training
Edge 8 begin training
readyList:
[2, 1, 0, 8, 5, 9, 6, 4, 3, 7]
aggregation_buffer:
[2, 1, 0, 8, 5]
train global classifier
train glclassifier time: 3.982874996960163
global classifier accuracy in train virtual: 97.3975
end Update
server_global_time: 42.65369924902916
only_train_time: 842.127012193203

-------------Global Round number: 22-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6382
Averaged Test Accuracy (Prototype Model): 0.6162
Averaged Train Loss (Regular Model): 0.1594
Averaged Train Loss (Regular + Proto): 0.2752
Std Test Accuracy (Regular Model): 0.1060
Std Test Accuracy (Prototype Model): 0.1194
tobetrained:
[2, 1, 0, 8, 5]
Edge 2 begin training
Edge 1 begin training
Edge 0 begin training
Edge 8 begin training
Edge 5 begin training
readyList:
[9, 6, 4, 0, 8, 2, 3, 5, 7, 1]
aggregation_buffer:
[9, 6, 4, 0, 8]
train global classifier
train glclassifier time: 4.775236070156097
global classifier accuracy in train virtual: 97.6125
end Update
server_global_time: 44.44135207682848
only_train_time: 871.4139666110277

-------------Global Round number: 23-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6412
Averaged Test Accuracy (Prototype Model): 0.6176
Averaged Train Loss (Regular Model): 0.1548
Averaged Train Loss (Regular + Proto): 0.2686
Std Test Accuracy (Regular Model): 0.1028
Std Test Accuracy (Prototype Model): 0.1155
tobetrained:
[9, 6, 4, 0, 8]
Edge 9 begin training
Edge 6 begin training
Edge 4 begin training
Edge 0 begin training
Edge 8 begin training
readyList:
[2, 3, 5, 7, 1, 0, 8, 9, 4, 6]
aggregation_buffer:
[2, 3, 5, 7, 1]
train global classifier
train glclassifier time: 4.030669003725052
global classifier accuracy in train virtual: 98.31
end Update
server_global_time: 45.273854821920395
only_train_time: 905.9960589036345

-------------Global Round number: 24-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6442
Averaged Test Accuracy (Prototype Model): 0.6201
Averaged Train Loss (Regular Model): 0.1490
Averaged Train Loss (Regular + Proto): 0.2583
Std Test Accuracy (Regular Model): 0.0941
Std Test Accuracy (Prototype Model): 0.1087
tobetrained:
[2, 3, 5, 7, 1]
Edge 2 begin training
Edge 3 begin training
Edge 5 begin training
Edge 7 begin training
Edge 1 begin training
readyList:
[0, 8, 2, 9, 5, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 9, 5]
train global classifier
train glclassifier time: 4.254301555454731
global classifier accuracy in train virtual: 98.3025
end Update
server_global_time: 47.784953854978085
only_train_time: 952.7421188428998

-------------Global Round number: 25-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6444
Averaged Test Accuracy (Prototype Model): 0.6239
Averaged Train Loss (Regular Model): 0.1287
Averaged Train Loss (Regular + Proto): 0.2293
Std Test Accuracy (Regular Model): 0.0919
Std Test Accuracy (Prototype Model): 0.1041
tobetrained:
[0, 8, 2, 9, 5]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 9 begin training
Edge 5 begin training
readyList:
[1, 4, 6, 0, 8, 2, 5, 9, 3, 7]
aggregation_buffer:
[1, 4, 6, 0, 8]
train global classifier
train glclassifier time: 4.016935050487518
global classifier accuracy in train virtual: 98.39
end Update
server_global_time: 49.519217394292355
only_train_time: 982.9252940416336

-------------Global Round number: 26-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6402
Averaged Test Accuracy (Prototype Model): 0.6235
Averaged Train Loss (Regular Model): 0.1267
Averaged Train Loss (Regular + Proto): 0.2257
Std Test Accuracy (Regular Model): 0.0980
Std Test Accuracy (Prototype Model): 0.1062
tobetrained:
[1, 4, 6, 0, 8]
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 0 begin training
Edge 8 begin training
readyList:
[2, 5, 9, 0, 8, 1, 3, 7, 4, 6]
aggregation_buffer:
[2, 5, 9, 0, 8]
train global classifier
train glclassifier time: 4.059376090764999
global classifier accuracy in train virtual: 98.455
end Update
server_global_time: 51.270704343914986
only_train_time: 1016.9625181034207

-------------Global Round number: 27-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6420
Averaged Test Accuracy (Prototype Model): 0.6262
Averaged Train Loss (Regular Model): 0.1229
Averaged Train Loss (Regular + Proto): 0.2186
Std Test Accuracy (Regular Model): 0.1019
Std Test Accuracy (Prototype Model): 0.1116
tobetrained:
[2, 5, 9, 0, 8]
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 0 begin training
Edge 8 begin training
readyList:
[1, 0, 8, 2, 3, 7, 4, 5, 9, 6]
aggregation_buffer:
[1, 0, 8, 2, 3]
train global classifier
train glclassifier time: 4.437993690371513
global classifier accuracy in train virtual: 98.8675
end Update
server_global_time: 53.32323205471039
only_train_time: 1047.3019064962864

-------------Global Round number: 28-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6459
Averaged Test Accuracy (Prototype Model): 0.6298
Averaged Train Loss (Regular Model): 0.1359
Averaged Train Loss (Regular + Proto): 0.2302
Std Test Accuracy (Regular Model): 0.1003
Std Test Accuracy (Prototype Model): 0.1110
tobetrained:
[1, 0, 8, 2, 3]
Edge 1 begin training
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 3 begin training
readyList:
[7, 4, 5, 9, 6, 8, 0, 2, 1, 3]
aggregation_buffer:
[7, 4, 5, 9, 6]
train global classifier
train glclassifier time: 3.9697326496243477
global classifier accuracy in train virtual: 98.9825
end Update
server_global_time: 54.16351719945669
only_train_time: 1087.8615654930472

-------------Global Round number: 29-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6436
Averaged Test Accuracy (Prototype Model): 0.6372
Averaged Train Loss (Regular Model): 0.1330
Averaged Train Loss (Regular + Proto): 0.2226
Std Test Accuracy (Regular Model): 0.0994
Std Test Accuracy (Prototype Model): 0.0971
tobetrained:
[7, 4, 5, 9, 6]
Edge 7 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 6 begin training
readyList:
[8, 0, 2, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[8, 0, 2, 1, 5]
train global classifier
train glclassifier time: 4.036242924630642
global classifier accuracy in train virtual: 98.945
end Update
server_global_time: 56.75804691016674
only_train_time: 1130.40760127455

-------------Global Round number: 30-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6462
Averaged Test Accuracy (Prototype Model): 0.6389
Averaged Train Loss (Regular Model): 0.1046
Averaged Train Loss (Regular + Proto): 0.1894
Std Test Accuracy (Regular Model): 0.0986
Std Test Accuracy (Prototype Model): 0.0976
tobetrained:
[8, 0, 2, 1, 5]
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
readyList:
[9, 0, 8, 2, 4, 6, 5, 1, 3, 7]
aggregation_buffer:
[9, 0, 8, 2, 4]
train global classifier
train glclassifier time: 3.974513992667198
global classifier accuracy in train virtual: 99.0975
end Update
server_global_time: 58.56037151068449
only_train_time: 1160.3666162490845

-------------Global Round number: 31-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6460
Averaged Test Accuracy (Prototype Model): 0.6362
Averaged Train Loss (Regular Model): 0.1036
Averaged Train Loss (Regular + Proto): 0.1875
Std Test Accuracy (Regular Model): 0.0974
Std Test Accuracy (Prototype Model): 0.0956
tobetrained:
[9, 0, 8, 2, 4]
Edge 9 begin training
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 4 begin training
readyList:
[6, 5, 1, 0, 8, 2, 9, 3, 4, 7]
aggregation_buffer:
[6, 5, 1, 0, 8]
train global classifier
train glclassifier time: 4.1328171119093895
global classifier accuracy in train virtual: 99.0425
end Update
server_global_time: 60.30447890609503
only_train_time: 1191.976298801601

-------------Global Round number: 32-------------

Evaluate heterogeneous models
