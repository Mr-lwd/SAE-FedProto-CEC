==================================================
goal = test
device = cuda
device_id = 0
dataset = Cifar10_dir_0.3_imbalance_40
num_classes = 10
model_family = HtFE8
batch_size = 256
local_learning_rate = 0.06
use_decay_scheduler = False
learning_rate_decay = False
learning_rate_decay_gamma = 0.99
global_rounds = 200
edge_epochs = 1
local_epochs = 10
algorithm = FedTGP
join_ratio = 1.0
random_join_ratio = False
num_clients = 40
num_edges = 10
prev = 0
times = 1
eval_gap = 1
save_folder_name = temp
auto_break = False
feature_dim = 512
vocab_size = 98635
max_len = 200
client_drop_rate = 0.0
train_slow_rate = 0.0
send_slow_rate = 0.0
time_select = False
time_threthold = 10000
optimizer = SGD
lamda = 1.0
adam_weight_decay = 0.0001
trans_delay_simulate = False
momentum = 0.5
agg_type = 0
buffersize = 10
mixclassifier = 0
gl_use_clients = 1
test_useglclassifier = 1
tgpaddmse = 0
addmse = 0
gamma = 1
addTGP = 0
SAEbeta = 0
drawtsne = 1
drawround = 10
noise_dim = 512
generator_learning_rate = 0.005
hidden_dim = 512
server_epochs = 100
alpha = 1.0
beta = 1.0
mentee_learning_rate = 0.005
T_start = 0.95
T_end = 0.98
server_learning_rate = 0.01
margin_threthold = 100.0
generator_path = stylegan/stylegan-xl-models/imagenet64.pkl
stable_diffusion_prompt = a cat
server_batch_size = 100
gen_batch_size = 4
mu = 50.0
==================================================
Random seed set as 42

============= Running time: 0th =============
Creating server and clients ...
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600)
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes)
mobilenet_v2(pretrained=False, num_classes=args.num_classes)
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes)
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes)
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes)
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes)
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes)
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600) model chosen!
id 0
label_counts: defaultdict(<class 'int'>, {6: 87, 7: 347, 3: 400, 1: 47, 4: 179, 8: 41, 2: 1, 5: 2, 9: 2, 0: 2})
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes) model chosen!
id 1
label_counts: defaultdict(<class 'int'>, {2: 855, 4: 327, 0: 5, 3: 3})
mobilenet_v2(pretrained=False, num_classes=args.num_classes) model chosen!
id 2
label_counts: defaultdict(<class 'int'>, {5: 141, 9: 71, 4: 177, 8: 162, 6: 36, 2: 95, 1: 9, 7: 49, 0: 23, 3: 2})
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes) model chosen!
id 3
label_counts: defaultdict(<class 'int'>, {9: 347, 4: 88, 5: 394, 8: 32, 7: 415, 2: 15, 0: 3})
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes) model chosen!
id 4
label_counts: defaultdict(<class 'int'>, {8: 172, 2: 591, 3: 83, 7: 30, 5: 234, 1: 3, 4: 18, 0: 18})
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes) model chosen!
id 5
label_counts: defaultdict(<class 'int'>, {0: 841, 5: 565, 1: 70, 3: 35})
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes) model chosen!
id 6
label_counts: defaultdict(<class 'int'>, {3: 381, 6: 154, 8: 143, 9: 43, 0: 93, 1: 15, 2: 1, 4: 2, 7: 1})
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes) model chosen!
id 7
label_counts: defaultdict(<class 'int'>, {9: 1519, 4: 349, 3: 115, 2: 76, 0: 78, 7: 79, 5: 29, 1: 6, 6: 1})
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600) model chosen!
id 8
label_counts: defaultdict(<class 'int'>, {4: 425, 1: 15, 3: 83, 8: 161, 0: 4, 2: 115, 7: 92, 9: 10, 6: 5, 5: 2})
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes) model chosen!
id 9
label_counts: defaultdict(<class 'int'>, {7: 286, 1: 64, 4: 95, 0: 7, 2: 80, 3: 14, 9: 28, 5: 7})
mobilenet_v2(pretrained=False, num_classes=args.num_classes) model chosen!
id 10
label_counts: defaultdict(<class 'int'>, {8: 906, 0: 830, 4: 108, 1: 17, 3: 11, 2: 10, 6: 6, 5: 5})
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes) model chosen!
id 11
label_counts: defaultdict(<class 'int'>, {8: 208, 7: 8, 1: 227, 2: 238, 3: 16, 9: 48, 5: 2, 6: 2, 4: 1})
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes) model chosen!
id 12
label_counts: defaultdict(<class 'int'>, {4: 354, 6: 681, 1: 47, 0: 50, 3: 4, 5: 1, 2: 2})
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes) model chosen!
id 13
label_counts: defaultdict(<class 'int'>, {0: 464, 6: 426, 3: 90, 2: 271, 1: 67, 4: 10})
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes) model chosen!
id 14
label_counts: defaultdict(<class 'int'>, {5: 746, 1: 509, 4: 104, 3: 17, 0: 30, 2: 1})
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes) model chosen!
id 15
label_counts: defaultdict(<class 'int'>, {4: 973, 2: 843, 1: 155, 0: 75, 3: 45})
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600) model chosen!
id 16
label_counts: defaultdict(<class 'int'>, {6: 120, 1: 2, 3: 448, 0: 8, 8: 77, 9: 202, 4: 43, 5: 71})
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes) model chosen!
id 17
label_counts: defaultdict(<class 'int'>, {7: 978, 0: 8, 6: 42, 3: 84, 2: 130, 5: 9, 4: 48})
mobilenet_v2(pretrained=False, num_classes=args.num_classes) model chosen!
id 18
label_counts: defaultdict(<class 'int'>, {0: 260, 5: 179, 1: 196, 4: 82, 3: 53, 7: 8, 8: 51, 6: 3, 2: 2})
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes) model chosen!
id 19
label_counts: defaultdict(<class 'int'>, {1: 456, 5: 56, 9: 86, 8: 150, 2: 46, 6: 20, 7: 10, 3: 7})
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes) model chosen!
id 20
label_counts: defaultdict(<class 'int'>, {3: 362, 0: 218, 4: 48, 8: 358, 7: 24, 6: 242, 2: 17, 5: 6})
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes) model chosen!
id 21
label_counts: defaultdict(<class 'int'>, {1: 276, 0: 436, 5: 44, 4: 131, 2: 72, 3: 93, 8: 33, 9: 2, 6: 2})
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes) model chosen!
id 22
label_counts: defaultdict(<class 'int'>, {3: 97, 6: 159, 8: 459, 9: 131, 5: 64, 1: 82, 7: 22, 4: 2, 2: 1})
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes) model chosen!
id 23
label_counts: defaultdict(<class 'int'>, {2: 510, 3: 373, 1: 205, 0: 170})
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600) model chosen!
id 24
label_counts: defaultdict(<class 'int'>, {4: 111, 7: 407, 6: 231, 2: 21, 1: 151, 8: 68, 3: 19, 9: 44, 0: 4})
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes) model chosen!
id 25
label_counts: defaultdict(<class 'int'>, {7: 336, 4: 100, 1: 353, 5: 197, 6: 83, 3: 29, 2: 11, 9: 2, 8: 3, 0: 2})
mobilenet_v2(pretrained=False, num_classes=args.num_classes) model chosen!
id 26
label_counts: defaultdict(<class 'int'>, {9: 885, 0: 276, 3: 116, 5: 59, 8: 57, 1: 18, 6: 2, 4: 3})
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes) model chosen!
id 27
label_counts: defaultdict(<class 'int'>, {6: 360, 5: 140, 1: 24, 3: 12, 4: 28, 9: 54, 2: 15})
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes) model chosen!
id 28
label_counts: defaultdict(<class 'int'>, {8: 31, 5: 486, 1: 148, 0: 87, 4: 71, 7: 29, 6: 12, 2: 2, 3: 1})
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes) model chosen!
id 29
label_counts: defaultdict(<class 'int'>, {5: 380, 7: 932, 1: 46, 6: 48, 4: 10, 3: 54, 2: 10})
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes) model chosen!
id 30
label_counts: defaultdict(<class 'int'>, {3: 724, 2: 19, 6: 555, 0: 95, 5: 89, 4: 8, 1: 1})
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes) model chosen!
id 31
label_counts: defaultdict(<class 'int'>, {6: 65, 0: 185, 9: 201, 1: 130, 7: 52, 3: 7, 4: 61, 2: 12, 5: 41})
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600) model chosen!
id 32
label_counts: defaultdict(<class 'int'>, {0: 33, 5: 339, 8: 81, 9: 53, 2: 65, 1: 9, 3: 3, 7: 1, 6: 11})
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes) model chosen!
id 33
label_counts: defaultdict(<class 'int'>, {6: 249, 1: 688, 8: 63, 4: 82, 5: 32, 7: 39, 0: 10, 2: 2})
mobilenet_v2(pretrained=False, num_classes=args.num_classes) model chosen!
id 34
label_counts: defaultdict(<class 'int'>, {8: 782, 6: 180, 4: 26, 1: 196, 3: 124, 7: 25, 2: 5})
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes) model chosen!
id 35
label_counts: defaultdict(<class 'int'>, {0: 69, 2: 255, 9: 362, 3: 64, 6: 20, 7: 151, 8: 12, 1: 7, 4: 8})
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes) model chosen!
id 36
label_counts: defaultdict(<class 'int'>, {5: 152, 8: 159, 1: 70, 9: 83, 4: 109, 2: 15, 7: 10, 0: 1})
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes) model chosen!
id 37
label_counts: defaultdict(<class 'int'>, {1: 171, 0: 116, 4: 82, 6: 519, 9: 20, 3: 58, 7: 10, 5: 16, 2: 10})
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes) model chosen!
id 38
label_counts: defaultdict(<class 'int'>, {2: 125, 7: 141, 6: 156, 5: 29, 8: 27, 3: 111, 1: 29, 9: 20, 0: 6})
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes) model chosen!
id 39
label_counts: defaultdict(<class 'int'>, {3: 345, 8: 216, 9: 312, 4: 217, 0: 3, 5: 5, 7: 4, 2: 1, 1: 1})

Join ratio / total clients: 1.0 / 40
Finished creating server and clients.
Trainable_prototypes(
  (embedings): Embedding(10, 512)
  (middle): Sequential(
    (0): Sequential(
      (0): Linear(in_features=512, out_features=512, bias=True)
      (1): ReLU()
    )
  )
  (fc): Linear(in_features=512, out_features=512, bias=True)
)
tobetrained:
[9, 8, 7, 6, 5, 4, 3, 2, 1, 0]
Edge 9 begin training
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Edge 8 begin training
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Edge 7 begin training
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Edge 6 begin training
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Edge 5 begin training
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Edge 4 begin training
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Edge 3 begin training
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Edge 2 begin training
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Edge 1 begin training
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Edge 0 begin training
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
class-wise minimum distance tensor([ 1684.5195,  2469.5190,  3331.0950,  1727.2036,  1211.7136,  1211.7136,
        12466.5801,  7713.7754, 17341.8535,  1684.5195], device='cuda:0')
min_gap tensor(1211.7136, device='cuda:0')
max_gap tensor(17341.8535, device='cuda:0')
Server loss: 102.14473724365234
Number of samples: 326
end Update
server_global_time: 15.855917003937066
only_train_time: 149.90906181558967

-------------Global Round number: 0-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.5800
Averaged Test Accuracy (Prototype Model): 0.0829
Averaged Train Loss (Regular Model): 0.7587
Averaged Train Loss (Regular + Proto): 0.7587
Std Test Accuracy (Regular Model): 0.1293
Std Test Accuracy (Prototype Model): 0.0718
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
class-wise minimum distance tensor([1.2787, 1.2787, 1.3004, 1.3004, 1.4572, 1.4485, 1.4469, 1.5366, 1.7541,
        1.7215], device='cuda:0')
min_gap tensor(1.2787, device='cuda:0')
max_gap tensor(1.7541, device='cuda:0')
Server loss: 3.800673007965088
end Update
server_global_time: 32.552900035865605
only_train_time: 311.30709126684815

-------------Global Round number: 1-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6215
Averaged Test Accuracy (Prototype Model): 0.4316
Averaged Train Loss (Regular Model): 0.3778
Averaged Train Loss (Regular + Proto): 0.6890
Std Test Accuracy (Regular Model): 0.1093
Std Test Accuracy (Prototype Model): 0.1733
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
class-wise minimum distance tensor([1.5933, 1.6450, 1.4205, 1.6058, 1.4444, 1.4205, 1.6305, 1.5724, 1.7105,
        1.8276], device='cuda:0')
min_gap tensor(1.4205, device='cuda:0')
max_gap tensor(1.8276, device='cuda:0')
Server loss: 3.2312707901000977
end Update
server_global_time: 49.19869253784418
only_train_time: 472.22260920051485

-------------Global Round number: 2-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6390
Averaged Test Accuracy (Prototype Model): 0.5771
Averaged Train Loss (Regular Model): 0.2629
Averaged Train Loss (Regular + Proto): 0.4972
Std Test Accuracy (Regular Model): 0.0966
Std Test Accuracy (Prototype Model): 0.1099
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[8, 0, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[8, 0, 2, 5, 1, 9, 4, 6, 3, 7]
class-wise minimum distance tensor([1.9663, 2.1178, 1.7268, 1.9517, 1.7268, 1.9154, 1.9867, 2.0462, 2.2143,
        2.2833], device='cuda:0')
min_gap tensor(1.7268, device='cuda:0')
max_gap tensor(2.2833, device='cuda:0')
Server loss: 3.293409585952759
end Update
server_global_time: 66.0382821392268
only_train_time: 631.3575984472409

-------------Global Round number: 3-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6404
Averaged Test Accuracy (Prototype Model): 0.6152
Averaged Train Loss (Regular Model): 0.1961
Averaged Train Loss (Regular + Proto): 0.3861
Std Test Accuracy (Regular Model): 0.0894
Std Test Accuracy (Prototype Model): 0.0911
tobetrained:
[8, 0, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
class-wise minimum distance tensor([2.7842, 3.2032, 2.5237, 2.7013, 2.5237, 2.7800, 2.7802, 2.7915, 3.0790,
        3.2029], device='cuda:0')
min_gap tensor(2.5237, device='cuda:0')
max_gap tensor(3.2032, device='cuda:0')
Server loss: 3.191450834274292
end Update
server_global_time: 82.44104603119195
only_train_time: 791.9164727935567

-------------Global Round number: 4-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6388
Averaged Test Accuracy (Prototype Model): 0.6153
Averaged Train Loss (Regular Model): 0.1842
Averaged Train Loss (Regular + Proto): 0.3743
Std Test Accuracy (Regular Model): 0.0938
Std Test Accuracy (Prototype Model): 0.0931
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
class-wise minimum distance tensor([3.8792, 4.4642, 3.3376, 3.8641, 3.3376, 3.7901, 3.6109, 3.7740, 4.2735,
        4.4880], device='cuda:0')
min_gap tensor(3.3376, device='cuda:0')
max_gap tensor(4.4880, device='cuda:0')
Server loss: 3.3223466873168945
end Update
server_global_time: 99.19506706111133
only_train_time: 952.9540865458548

-------------Global Round number: 5-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6436
Averaged Test Accuracy (Prototype Model): 0.6258
Averaged Train Loss (Regular Model): 0.1409
Averaged Train Loss (Regular + Proto): 0.3472
Std Test Accuracy (Regular Model): 0.0854
Std Test Accuracy (Prototype Model): 0.0845
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
class-wise minimum distance tensor([5.1843, 5.8653, 4.6128, 5.2707, 4.6128, 5.2004, 4.9130, 5.1950, 5.7341,
        5.8653], device='cuda:0')
min_gap tensor(4.6128, device='cuda:0')
max_gap tensor(5.8653, device='cuda:0')
Server loss: 4.857208728790283
end Update
server_global_time: 115.94471926055849
only_train_time: 1114.3335619876161

-------------Global Round number: 6-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6434
Averaged Test Accuracy (Prototype Model): 0.6323
Averaged Train Loss (Regular Model): 0.1226
Averaged Train Loss (Regular + Proto): 0.3479
Std Test Accuracy (Regular Model): 0.0932
Std Test Accuracy (Prototype Model): 0.0934
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
class-wise minimum distance tensor([6.4084, 7.4426, 5.8093, 6.6287, 5.8093, 6.3563, 6.0061, 6.3252, 7.5744,
        7.4517], device='cuda:0')
min_gap tensor(5.8093, device='cuda:0')
max_gap tensor(7.5744, device='cuda:0')
Server loss: 4.061156749725342
end Update
server_global_time: 132.4304069597274
only_train_time: 1276.674369807355

-------------Global Round number: 7-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6553
Averaged Test Accuracy (Prototype Model): 0.6438
Averaged Train Loss (Regular Model): 0.0708
Averaged Train Loss (Regular + Proto): 0.3084
Std Test Accuracy (Regular Model): 0.0884
Std Test Accuracy (Prototype Model): 0.0853
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
class-wise minimum distance tensor([7.7445, 8.9436, 7.2522, 8.0193, 7.3447, 7.6377, 7.2522, 7.8862, 8.9524,
        9.0815], device='cuda:0')
min_gap tensor(7.2522, device='cuda:0')
max_gap tensor(9.0815, device='cuda:0')
Server loss: 6.083915710449219
end Update
server_global_time: 149.39334416016936
only_train_time: 1437.8332253778353

-------------Global Round number: 8-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6539
Averaged Test Accuracy (Prototype Model): 0.6410
Averaged Train Loss (Regular Model): 0.0539
Averaged Train Loss (Regular + Proto): 0.2997
Std Test Accuracy (Regular Model): 0.0895
Std Test Accuracy (Prototype Model): 0.0897
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
class-wise minimum distance tensor([ 9.2530, 10.5352,  8.4504,  9.7206,  8.7536,  9.0462,  8.4504,  9.4465,
        10.4050, 10.7821], device='cuda:0')
min_gap tensor(8.4504, device='cuda:0')
max_gap tensor(10.7821, device='cuda:0')
Server loss: 5.166370868682861
end Update
server_global_time: 166.23910842183977
only_train_time: 1599.3732279622927

-------------Global Round number: 9-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6545
Averaged Test Accuracy (Prototype Model): 0.6470
Averaged Train Loss (Regular Model): 0.0631
Averaged Train Loss (Regular + Proto): 0.3378
Std Test Accuracy (Regular Model): 0.0910
Std Test Accuracy (Prototype Model): 0.0880
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
class-wise minimum distance tensor([ 9.8783, 11.3145,  9.2715, 10.2508,  9.4286,  9.7759,  9.2715, 10.1107,
        11.5240, 11.5037], device='cuda:0')
min_gap tensor(9.2715, device='cuda:0')
max_gap tensor(11.5240, device='cuda:0')
Server loss: 5.317361354827881
Number of samples: 326
end Update
server_global_time: 183.02522462327033
only_train_time: 1762.1386165041476

-------------Global Round number: 10-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6580
Averaged Test Accuracy (Prototype Model): 0.6470
Averaged Train Loss (Regular Model): 0.0567
Averaged Train Loss (Regular + Proto): 0.3384
Std Test Accuracy (Regular Model): 0.0945
Std Test Accuracy (Prototype Model): 0.0925
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
class-wise minimum distance tensor([10.9914, 12.4628, 10.7512, 11.7510, 10.9932, 11.2716, 10.7512, 11.5705,
        12.9816, 13.1370], device='cuda:0')
min_gap tensor(10.7512, device='cuda:0')
max_gap tensor(13.1370, device='cuda:0')
Server loss: 6.133728981018066
end Update
server_global_time: 200.64334371313453
only_train_time: 1927.3247242541984

-------------Global Round number: 11-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6603
Averaged Test Accuracy (Prototype Model): 0.6501
Averaged Train Loss (Regular Model): 0.0249
Averaged Train Loss (Regular + Proto): 0.2991
Std Test Accuracy (Regular Model): 0.0907
Std Test Accuracy (Prototype Model): 0.0903
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
class-wise minimum distance tensor([12.2771, 13.7244, 12.1399, 13.3554, 12.1399, 12.5490, 12.1635, 12.9567,
        14.6496, 14.5885], device='cuda:0')
min_gap tensor(12.1399, device='cuda:0')
max_gap tensor(14.6496, device='cuda:0')
Server loss: 6.379282474517822
end Update
server_global_time: 217.1487189969048
only_train_time: 2087.225643022917

-------------Global Round number: 12-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6591
Averaged Test Accuracy (Prototype Model): 0.6478
Averaged Train Loss (Regular Model): 0.0379
Averaged Train Loss (Regular + Proto): 0.3314
Std Test Accuracy (Regular Model): 0.0963
Std Test Accuracy (Prototype Model): 0.0984
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
class-wise minimum distance tensor([13.0489, 14.8176, 12.9648, 14.4817, 13.0624, 13.5999, 12.9648, 14.2834,
        15.5022, 15.5382], device='cuda:0')
min_gap tensor(12.9648, device='cuda:0')
max_gap tensor(15.5382, device='cuda:0')
Server loss: 6.2764668464660645
end Update
server_global_time: 235.53471670672297
only_train_time: 2254.4671936323866

-------------Global Round number: 13-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6638
Averaged Test Accuracy (Prototype Model): 0.6501
Averaged Train Loss (Regular Model): 0.0373
Averaged Train Loss (Regular + Proto): 0.3452
Std Test Accuracy (Regular Model): 0.0898
Std Test Accuracy (Prototype Model): 0.0915
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
class-wise minimum distance tensor([13.9722, 15.9587, 13.9722, 15.3042, 14.2105, 14.5317, 14.0573, 15.4467,
        16.6528, 16.4560], device='cuda:0')
min_gap tensor(13.9722, device='cuda:0')
max_gap tensor(16.6528, device='cuda:0')
Server loss: 5.98354959487915
end Update
server_global_time: 252.38789187557995
only_train_time: 2417.1132618216798

-------------Global Round number: 14-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6613
Averaged Test Accuracy (Prototype Model): 0.6494
Averaged Train Loss (Regular Model): 0.0307
Averaged Train Loss (Regular + Proto): 0.3470
Std Test Accuracy (Regular Model): 0.0892
Std Test Accuracy (Prototype Model): 0.0934
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
class-wise minimum distance tensor([15.0569, 17.0991, 15.0087, 16.2180, 15.3755, 15.8102, 15.0087, 16.3842,
        17.8414, 17.6128], device='cuda:0')
min_gap tensor(15.0087, device='cuda:0')
max_gap tensor(17.8414, device='cuda:0')
Server loss: 9.451051712036133
end Update
server_global_time: 269.21999702602625
only_train_time: 2580.063555823639

-------------Global Round number: 15-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6563
Averaged Test Accuracy (Prototype Model): 0.6467
Averaged Train Loss (Regular Model): 0.0416
Averaged Train Loss (Regular + Proto): 0.3771
Std Test Accuracy (Regular Model): 0.0915
Std Test Accuracy (Prototype Model): 0.0975
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
class-wise minimum distance tensor([15.3994, 17.6390, 15.3994, 16.7464, 15.5144, 16.6627, 15.4604, 16.9914,
        18.2706, 18.3320], device='cuda:0')
min_gap tensor(15.3994, device='cuda:0')
max_gap tensor(18.3320, device='cuda:0')
Server loss: 6.10092830657959
end Update
server_global_time: 286.00042479205877
only_train_time: 2742.8816925017163

-------------Global Round number: 16-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6607
Averaged Test Accuracy (Prototype Model): 0.6494
Averaged Train Loss (Regular Model): 0.0211
Averaged Train Loss (Regular + Proto): 0.3621
Std Test Accuracy (Regular Model): 0.0889
Std Test Accuracy (Prototype Model): 0.0954
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
class-wise minimum distance tensor([16.8696, 18.9092, 16.8150, 18.2271, 17.1847, 17.9863, 16.8150, 18.6886,
        19.6352, 19.3246], device='cuda:0')
min_gap tensor(16.8150, device='cuda:0')
max_gap tensor(19.6352, device='cuda:0')
Server loss: 5.843272686004639
end Update
server_global_time: 303.09551411122084
only_train_time: 2905.848076997325

-------------Global Round number: 17-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6555
Averaged Test Accuracy (Prototype Model): 0.6472
Averaged Train Loss (Regular Model): 0.0179
Averaged Train Loss (Regular + Proto): 0.3646
Std Test Accuracy (Regular Model): 0.0942
Std Test Accuracy (Prototype Model): 0.0964
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
class-wise minimum distance tensor([17.3548, 19.4251, 17.2861, 18.8806, 17.8504, 18.9370, 17.2861, 19.5044,
        20.3537, 20.0488], device='cuda:0')
min_gap tensor(17.2861, device='cuda:0')
max_gap tensor(20.3537, device='cuda:0')
Server loss: 8.261469841003418
end Update
server_global_time: 319.88488563895226
only_train_time: 3069.967602202669

-------------Global Round number: 18-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6552
Averaged Test Accuracy (Prototype Model): 0.6437
Averaged Train Loss (Regular Model): 0.0631
Averaged Train Loss (Regular + Proto): 0.4443
Std Test Accuracy (Regular Model): 0.1009
Std Test Accuracy (Prototype Model): 0.1047
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
class-wise minimum distance tensor([17.7360, 19.6676, 17.6067, 19.1075, 18.0869, 18.8278, 17.6067, 19.6946,
        19.8120, 20.0197], device='cuda:0')
min_gap tensor(17.6067, device='cuda:0')
max_gap tensor(20.0197, device='cuda:0')
Server loss: 8.395750999450684
end Update
server_global_time: 336.9170545209199
only_train_time: 3232.1054027369246

-------------Global Round number: 19-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6534
Averaged Test Accuracy (Prototype Model): 0.6411
Averaged Train Loss (Regular Model): 0.0475
Averaged Train Loss (Regular + Proto): 0.4321
Std Test Accuracy (Regular Model): 0.0940
Std Test Accuracy (Prototype Model): 0.0972
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
class-wise minimum distance tensor([17.9641, 20.6382, 17.9641, 19.6815, 18.5412, 19.5287, 18.7875, 20.9491,
        21.0586, 21.3126], device='cuda:0')
min_gap tensor(17.9641, device='cuda:0')
max_gap tensor(21.3126, device='cuda:0')
Server loss: 7.073127746582031
Number of samples: 326
end Update
server_global_time: 353.5563707854599
only_train_time: 3397.9914023801684

-------------Global Round number: 20-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6583
Averaged Test Accuracy (Prototype Model): 0.6486
Averaged Train Loss (Regular Model): 0.0142
Averaged Train Loss (Regular + Proto): 0.3803
Std Test Accuracy (Regular Model): 0.0896
Std Test Accuracy (Prototype Model): 0.0927
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
class-wise minimum distance tensor([19.3251, 21.9273, 19.3251, 21.3794, 20.3794, 20.7299, 19.6566, 22.0066,
        22.2104, 21.8537], device='cuda:0')
min_gap tensor(19.3251, device='cuda:0')
max_gap tensor(22.2104, device='cuda:0')
Server loss: 6.210732936859131
end Update
server_global_time: 370.43640388920903
only_train_time: 3561.4774710750207

-------------Global Round number: 21-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6537
Averaged Test Accuracy (Prototype Model): 0.6449
Averaged Train Loss (Regular Model): 0.0550
Averaged Train Loss (Regular + Proto): 0.4505
Std Test Accuracy (Regular Model): 0.0924
Std Test Accuracy (Prototype Model): 0.0969
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 9, 5, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 9, 5, 1, 4, 6, 3, 7]
class-wise minimum distance tensor([19.7133, 21.8095, 19.3646, 21.5405, 20.0901, 20.7681, 19.3646, 21.8385,
        22.8946, 22.4698], device='cuda:0')
min_gap tensor(19.3646, device='cuda:0')
max_gap tensor(22.8946, device='cuda:0')
Server loss: 9.253358840942383
end Update
server_global_time: 387.24080190062523
only_train_time: 3729.341337554157

-------------Global Round number: 22-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6595
Averaged Test Accuracy (Prototype Model): 0.6456
Averaged Train Loss (Regular Model): 0.0440
Averaged Train Loss (Regular + Proto): 0.4367
Std Test Accuracy (Regular Model): 0.0946
Std Test Accuracy (Prototype Model): 0.0953
tobetrained:
[0, 2, 8, 9, 5, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 9 begin training
Edge 5 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
class-wise minimum distance tensor([20.3020, 22.7305, 20.3020, 22.7266, 21.0407, 22.1419, 20.4879, 23.2973,
        23.2372, 22.3652], device='cuda:0')
min_gap tensor(20.3020, device='cuda:0')
max_gap tensor(23.2973, device='cuda:0')
Server loss: 6.950456619262695
end Update
server_global_time: 403.929395490326
only_train_time: 3893.64834111277

-------------Global Round number: 23-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6501
Averaged Test Accuracy (Prototype Model): 0.6464
Averaged Train Loss (Regular Model): 0.0507
Averaged Train Loss (Regular + Proto): 0.4466
Std Test Accuracy (Regular Model): 0.0909
Std Test Accuracy (Prototype Model): 0.0954
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 6, 4, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 6, 4, 7, 3]
class-wise minimum distance tensor([20.7901, 23.3768, 20.7901, 22.5278, 21.5726, 22.2222, 20.9545, 23.4490,
        23.1457, 23.5659], device='cuda:0')
min_gap tensor(20.7901, device='cuda:0')
max_gap tensor(23.5659, device='cuda:0')
Server loss: 6.219527721405029
end Update
server_global_time: 420.61501589789987
only_train_time: 4059.3675686065108

-------------Global Round number: 24-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6582
Averaged Test Accuracy (Prototype Model): 0.6505
Averaged Train Loss (Regular Model): 0.0203
Averaged Train Loss (Regular + Proto): 0.4039
Std Test Accuracy (Regular Model): 0.0934
Std Test Accuracy (Prototype Model): 0.0955
tobetrained:
[0, 8, 2, 5, 1, 9, 6, 4, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 6 begin training
Edge 4 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
class-wise minimum distance tensor([22.3578, 24.5571, 22.0293, 24.1017, 22.5065, 23.8292, 22.0293, 25.2717,
        24.1808, 24.4151], device='cuda:0')
min_gap tensor(22.0293, device='cuda:0')
max_gap tensor(25.2717, device='cuda:0')
Server loss: 9.889168739318848
end Update
server_global_time: 437.4871347453445
only_train_time: 4224.546642096713

-------------Global Round number: 25-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6593
Averaged Test Accuracy (Prototype Model): 0.6569
Averaged Train Loss (Regular Model): 0.0143
Averaged Train Loss (Regular + Proto): 0.3920
Std Test Accuracy (Regular Model): 0.0906
Std Test Accuracy (Prototype Model): 0.0932
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
class-wise minimum distance tensor([22.1879, 25.1822, 22.1879, 24.0013, 22.7250, 24.1646, 22.3182, 25.4692,
        25.1362, 24.7203], device='cuda:0')
min_gap tensor(22.1879, device='cuda:0')
max_gap tensor(25.4692, device='cuda:0')
Server loss: 5.901426315307617
end Update
server_global_time: 454.2342713950202
only_train_time: 4386.5272569982335

-------------Global Round number: 26-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6569
Averaged Test Accuracy (Prototype Model): 0.6540
Averaged Train Loss (Regular Model): 0.0256
Averaged Train Loss (Regular + Proto): 0.4152
Std Test Accuracy (Regular Model): 0.0938
Std Test Accuracy (Prototype Model): 0.0970
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[8, 0, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[8, 0, 2, 5, 1, 9, 4, 6, 7, 3]
class-wise minimum distance tensor([23.2483, 26.1881, 23.0322, 25.1488, 23.5807, 24.9980, 23.0322, 26.2296,
        25.7493, 25.5706], device='cuda:0')
min_gap tensor(23.0322, device='cuda:0')
max_gap tensor(26.2296, device='cuda:0')
Server loss: 6.882588863372803
end Update
server_global_time: 470.94204442575574
only_train_time: 4551.962374594994

-------------Global Round number: 27-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6605
Averaged Test Accuracy (Prototype Model): 0.6557
Averaged Train Loss (Regular Model): 0.0210
Averaged Train Loss (Regular + Proto): 0.4001
Std Test Accuracy (Regular Model): 0.0916
Std Test Accuracy (Prototype Model): 0.0925
tobetrained:
[8, 0, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[8, 0, 2, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[8, 0, 2, 1, 5, 9, 4, 6, 3, 7]
class-wise minimum distance tensor([23.8357, 26.2798, 23.8357, 25.4992, 24.4141, 25.5274, 23.8367, 26.8489,
        26.8587, 26.2858], device='cuda:0')
min_gap tensor(23.8357, device='cuda:0')
max_gap tensor(26.8587, device='cuda:0')
Server loss: 5.132108688354492
end Update
server_global_time: 487.7546142023057
only_train_time: 4715.360746309161

-------------Global Round number: 28-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6568
Averaged Test Accuracy (Prototype Model): 0.6442
Averaged Train Loss (Regular Model): 0.0542
Averaged Train Loss (Regular + Proto): 0.4786
Std Test Accuracy (Regular Model): 0.0984
Std Test Accuracy (Prototype Model): 0.1324
tobetrained:
[8, 0, 2, 1, 5, 9, 4, 6, 3, 7]
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
class-wise minimum distance tensor([24.6112, 27.3056, 24.3445, 26.4295, 24.6307, 26.0366, 24.3445, 27.6567,
        26.6141, 25.8043], device='cuda:0')
min_gap tensor(24.3445, device='cuda:0')
max_gap tensor(27.6567, device='cuda:0')
Server loss: 7.125655651092529
end Update
server_global_time: 504.6935981074348
only_train_time: 4878.754934440367

-------------Global Round number: 29-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6462
Averaged Test Accuracy (Prototype Model): 0.6310
Averaged Train Loss (Regular Model): 0.1672
Averaged Train Loss (Regular + Proto): 0.6337
Std Test Accuracy (Regular Model): 0.1244
Std Test Accuracy (Prototype Model): 0.1547
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
class-wise minimum distance tensor([25.2113, 28.0636, 24.6647, 26.3626, 24.8278, 26.5209, 24.6647, 27.9410,
        27.1120, 26.6965], device='cuda:0')
min_gap tensor(24.6647, device='cuda:0')
max_gap tensor(28.0636, device='cuda:0')
Server loss: 9.011996269226074
Number of samples: 326
end Update
server_global_time: 521.8472919417545
only_train_time: 5042.324327431619

-------------Global Round number: 30-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6520
Averaged Test Accuracy (Prototype Model): 0.6274
Averaged Train Loss (Regular Model): 0.1067
Averaged Train Loss (Regular + Proto): 0.6087
Std Test Accuracy (Regular Model): 0.0969
Std Test Accuracy (Prototype Model): 0.1666
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 7, 3]
class-wise minimum distance tensor([24.9593, 27.6670, 24.7368, 26.4182, 25.4968, 26.8354, 24.7368, 27.5247,
        26.7211, 26.3560], device='cuda:0')
min_gap tensor(24.7368, device='cuda:0')
max_gap tensor(27.6670, device='cuda:0')
Server loss: 8.803455352783203
end Update
server_global_time: 539.2992697628215
only_train_time: 5205.911331273615

-------------Global Round number: 31-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6527
Averaged Test Accuracy (Prototype Model): 0.6312
Averaged Train Loss (Regular Model): 0.1082
Averaged Train Loss (Regular + Proto): 0.6205
Std Test Accuracy (Regular Model): 0.0986
Std Test Accuracy (Prototype Model): 0.1509
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
class-wise minimum distance tensor([25.1975, 28.3363, 25.1975, 26.8515, 26.2596, 27.4795, 25.5231, 28.3259,
        26.9209, 26.4289], device='cuda:0')
min_gap tensor(25.1975, device='cuda:0')
max_gap tensor(28.3363, device='cuda:0')
Server loss: 5.4908294677734375
end Update
server_global_time: 555.9099870948121
only_train_time: 5368.063408112153

-------------Global Round number: 32-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6553
Averaged Test Accuracy (Prototype Model): 0.6446
Averaged Train Loss (Regular Model): 0.1234
Averaged Train Loss (Regular + Proto): 0.6422
Std Test Accuracy (Regular Model): 0.1050
Std Test Accuracy (Prototype Model): 0.1196
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
class-wise minimum distance tensor([25.3910, 27.7589, 25.3910, 26.9379, 26.3300, 27.4109, 25.4953, 28.0011,
        28.1276, 26.0431], device='cuda:0')
min_gap tensor(25.3910, device='cuda:0')
max_gap tensor(28.1276, device='cuda:0')
Server loss: 8.55710506439209
end Update
server_global_time: 572.593477750197
only_train_time: 5530.316465782933

-------------Global Round number: 33-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6578
Averaged Test Accuracy (Prototype Model): 0.6374
Averaged Train Loss (Regular Model): 0.0836
Averaged Train Loss (Regular + Proto): 0.5934
Std Test Accuracy (Regular Model): 0.0978
Std Test Accuracy (Prototype Model): 0.1600
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
class-wise minimum distance tensor([27.0247, 29.5906, 26.7955, 28.2593, 27.4920, 28.8545, 26.7955, 29.5924,
        29.0846, 28.0349], device='cuda:0')
min_gap tensor(26.7955, device='cuda:0')
max_gap tensor(29.5924, device='cuda:0')
Server loss: 9.459026336669922
end Update
server_global_time: 589.254235717468
only_train_time: 5692.731320405379

-------------Global Round number: 34-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6516
Averaged Test Accuracy (Prototype Model): 0.6386
Averaged Train Loss (Regular Model): 0.1195
Averaged Train Loss (Regular + Proto): 0.6488
Std Test Accuracy (Regular Model): 0.1038
Std Test Accuracy (Prototype Model): 0.1286
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 7, 3]
class-wise minimum distance tensor([26.6561, 29.6121, 26.2915, 28.0112, 27.3853, 28.0599, 26.2915, 29.1096,
        27.9795, 28.6986], device='cuda:0')
min_gap tensor(26.2915, device='cuda:0')
max_gap tensor(29.6121, device='cuda:0')
Server loss: 11.658591270446777
end Update
server_global_time: 605.9618477085605
only_train_time: 5854.918253540993

-------------Global Round number: 35-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6587
Averaged Test Accuracy (Prototype Model): 0.6519
Averaged Train Loss (Regular Model): 0.0809
Averaged Train Loss (Regular + Proto): 0.5881
Std Test Accuracy (Regular Model): 0.0964
Std Test Accuracy (Prototype Model): 0.1008
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
class-wise minimum distance tensor([28.2292, 30.9669, 27.8550, 29.6126, 28.2295, 29.7980, 27.8550, 30.8707,
        30.3717, 29.5472], device='cuda:0')
min_gap tensor(27.8550, device='cuda:0')
max_gap tensor(30.9669, device='cuda:0')
Server loss: 6.6063971519470215
end Update
server_global_time: 625.4351039445028
only_train_time: 6019.982321988791

-------------Global Round number: 36-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6592
Averaged Test Accuracy (Prototype Model): 0.6532
Averaged Train Loss (Regular Model): 0.0995
Averaged Train Loss (Regular + Proto): 0.6310
Std Test Accuracy (Regular Model): 0.1029
Std Test Accuracy (Prototype Model): 0.1102
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
class-wise minimum distance tensor([28.3267, 31.1665, 28.0732, 30.1465, 29.0541, 29.6596, 28.0732, 30.9326,
        29.9417, 29.3681], device='cuda:0')
min_gap tensor(28.0732, device='cuda:0')
max_gap tensor(31.1665, device='cuda:0')
Server loss: 10.541960716247559
end Update
server_global_time: 641.9638072568923
only_train_time: 6181.882121570408

-------------Global Round number: 37-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6599
Averaged Test Accuracy (Prototype Model): 0.6555
Averaged Train Loss (Regular Model): 0.0858
Averaged Train Loss (Regular + Proto): 0.6376
Std Test Accuracy (Regular Model): 0.0990
Std Test Accuracy (Prototype Model): 0.1004
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
