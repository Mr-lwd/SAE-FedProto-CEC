==================================================
goal = test
device = cuda
device_id = 0
dataset = Cifar10_dir_0.3_imbalance_40
num_classes = 10
model_family = HtFE8
batch_size = 256
local_learning_rate = 0.06
use_decay_scheduler = False
learning_rate_decay = False
learning_rate_decay_gamma = 0.99
global_rounds = 200
edge_epochs = 1
local_epochs = 10
algorithm = FedSAE
join_ratio = 1.0
random_join_ratio = False
num_clients = 40
num_edges = 10
prev = 0
times = 1
eval_gap = 1
save_folder_name = temp
auto_break = False
feature_dim = 512
vocab_size = 98635
max_len = 200
client_drop_rate = 0.0
train_slow_rate = 0.0
send_slow_rate = 0.0
time_select = False
time_threthold = 10000
lamda = 2
trans_delay_simulate = False
agg_type = 0
buffersize = 10
mixclassifier = 1
test_useglclassifier = 0
gamma = 1.0
use_beta = True
SAEbeta = 1.0
addTGP = True
drawtsne = True
drawround = 10
noise_dim = 512
generator_learning_rate = 0.005
hidden_dim = 512
server_epochs = 100
alpha = 1.0
beta = 1.0
mentee_learning_rate = 0.005
T_start = 0.95
T_end = 0.98
server_learning_rate = 0.01
margin_threthold = 100.0
generator_path = stylegan/stylegan-xl-models/imagenet64.pkl
stable_diffusion_prompt = a cat
server_batch_size = 100
gen_batch_size = 4
mu = 50.0
==================================================
Random seed set as 42

============= Running time: 0th =============
Creating server and clients ...
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600)
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes)
mobilenet_v2(pretrained=False, num_classes=args.num_classes)
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes)
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes)
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes)
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes)
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes)
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600) model chosen!
id 0
label_counts: defaultdict(<class 'int'>, {3: 400, 7: 347, 1: 47, 4: 179, 6: 87, 8: 41, 0: 2, 9: 2, 5: 2, 2: 1})
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes) model chosen!
id 1
label_counts: defaultdict(<class 'int'>, {2: 855, 4: 327, 0: 5, 3: 3})
mobilenet_v2(pretrained=False, num_classes=args.num_classes) model chosen!
id 2
label_counts: defaultdict(<class 'int'>, {6: 36, 5: 141, 8: 162, 9: 71, 4: 177, 2: 95, 0: 23, 1: 9, 7: 49, 3: 2})
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes) model chosen!
id 3
label_counts: defaultdict(<class 'int'>, {9: 347, 5: 394, 7: 415, 4: 88, 0: 3, 2: 15, 8: 32})
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes) model chosen!
id 4
label_counts: defaultdict(<class 'int'>, {3: 83, 2: 591, 5: 234, 8: 172, 4: 18, 7: 30, 0: 18, 1: 3})
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes) model chosen!
id 5
label_counts: defaultdict(<class 'int'>, {5: 565, 0: 841, 1: 70, 3: 35})
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes) model chosen!
id 6
label_counts: defaultdict(<class 'int'>, {3: 381, 6: 154, 8: 143, 1: 15, 9: 43, 0: 93, 4: 2, 7: 1, 2: 1})
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes) model chosen!
id 7
label_counts: defaultdict(<class 'int'>, {9: 1519, 4: 349, 7: 79, 3: 115, 0: 78, 2: 76, 5: 29, 1: 6, 6: 1})
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600) model chosen!
id 8
label_counts: defaultdict(<class 'int'>, {3: 83, 2: 115, 8: 161, 4: 425, 7: 92, 1: 15, 6: 5, 9: 10, 0: 4, 5: 2})
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes) model chosen!
id 9
label_counts: defaultdict(<class 'int'>, {5: 7, 1: 64, 7: 286, 4: 95, 3: 14, 2: 80, 9: 28, 0: 7})
mobilenet_v2(pretrained=False, num_classes=args.num_classes) model chosen!
id 10
label_counts: defaultdict(<class 'int'>, {8: 906, 0: 830, 4: 108, 5: 5, 2: 10, 6: 6, 1: 17, 3: 11})
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes) model chosen!
id 11
label_counts: defaultdict(<class 'int'>, {1: 227, 8: 208, 2: 238, 9: 48, 3: 16, 4: 1, 7: 8, 6: 2, 5: 2})
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes) model chosen!
id 12
label_counts: defaultdict(<class 'int'>, {6: 681, 1: 47, 0: 50, 4: 354, 3: 4, 2: 2, 5: 1})
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes) model chosen!
id 13
label_counts: defaultdict(<class 'int'>, {6: 426, 4: 10, 0: 464, 3: 90, 2: 271, 1: 67})
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes) model chosen!
id 14
label_counts: defaultdict(<class 'int'>, {5: 746, 1: 509, 4: 104, 3: 17, 0: 30, 2: 1})
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes) model chosen!
id 15
label_counts: defaultdict(<class 'int'>, {4: 973, 2: 843, 1: 155, 0: 75, 3: 45})
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600) model chosen!
id 16
label_counts: defaultdict(<class 'int'>, {3: 448, 9: 202, 4: 43, 5: 71, 6: 120, 8: 77, 0: 8, 1: 2})
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes) model chosen!
id 17
label_counts: defaultdict(<class 'int'>, {3: 84, 7: 978, 2: 130, 6: 42, 4: 48, 0: 8, 5: 9})
mobilenet_v2(pretrained=False, num_classes=args.num_classes) model chosen!
id 18
label_counts: defaultdict(<class 'int'>, {0: 260, 1: 196, 4: 82, 5: 179, 3: 53, 8: 51, 7: 8, 6: 3, 2: 2})
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes) model chosen!
id 19
label_counts: defaultdict(<class 'int'>, {1: 456, 8: 150, 3: 7, 9: 86, 2: 46, 6: 20, 5: 56, 7: 10})
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes) model chosen!
id 20
label_counts: defaultdict(<class 'int'>, {0: 218, 6: 242, 4: 48, 8: 358, 7: 24, 3: 362, 2: 17, 5: 6})
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes) model chosen!
id 21
label_counts: defaultdict(<class 'int'>, {3: 93, 0: 436, 1: 276, 4: 131, 8: 33, 2: 72, 5: 44, 9: 2, 6: 2})
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes) model chosen!
id 22
label_counts: defaultdict(<class 'int'>, {8: 459, 6: 159, 3: 97, 9: 131, 1: 82, 5: 64, 7: 22, 4: 2, 2: 1})
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes) model chosen!
id 23
label_counts: defaultdict(<class 'int'>, {2: 510, 1: 205, 0: 170, 3: 373})
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600) model chosen!
id 24
label_counts: defaultdict(<class 'int'>, {7: 407, 4: 111, 2: 21, 8: 68, 6: 231, 1: 151, 9: 44, 3: 19, 0: 4})
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes) model chosen!
id 25
label_counts: defaultdict(<class 'int'>, {7: 336, 1: 353, 6: 83, 5: 197, 4: 100, 2: 11, 0: 2, 3: 29, 8: 3, 9: 2})
mobilenet_v2(pretrained=False, num_classes=args.num_classes) model chosen!
id 26
label_counts: defaultdict(<class 'int'>, {3: 116, 9: 885, 0: 276, 5: 59, 8: 57, 1: 18, 4: 3, 6: 2})
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes) model chosen!
id 27
label_counts: defaultdict(<class 'int'>, {6: 360, 9: 54, 4: 28, 1: 24, 5: 140, 2: 15, 3: 12})
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes) model chosen!
id 28
label_counts: defaultdict(<class 'int'>, {8: 31, 5: 486, 0: 87, 4: 71, 1: 148, 2: 2, 7: 29, 6: 12, 3: 1})
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes) model chosen!
id 29
label_counts: defaultdict(<class 'int'>, {5: 380, 7: 932, 3: 54, 1: 46, 6: 48, 4: 10, 2: 10})
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes) model chosen!
id 30
label_counts: defaultdict(<class 'int'>, {3: 724, 6: 555, 0: 95, 5: 89, 4: 8, 2: 19, 1: 1})
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes) model chosen!
id 31
label_counts: defaultdict(<class 'int'>, {7: 52, 9: 201, 1: 130, 0: 185, 4: 61, 6: 65, 5: 41, 2: 12, 3: 7})
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600) model chosen!
id 32
label_counts: defaultdict(<class 'int'>, {5: 339, 6: 11, 8: 81, 9: 53, 2: 65, 3: 3, 0: 33, 1: 9, 7: 1})
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes) model chosen!
id 33
label_counts: defaultdict(<class 'int'>, {4: 82, 1: 688, 6: 249, 0: 10, 8: 63, 7: 39, 5: 32, 2: 2})
mobilenet_v2(pretrained=False, num_classes=args.num_classes) model chosen!
id 34
label_counts: defaultdict(<class 'int'>, {8: 782, 1: 196, 6: 180, 3: 124, 2: 5, 4: 26, 7: 25})
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes) model chosen!
id 35
label_counts: defaultdict(<class 'int'>, {2: 255, 9: 362, 8: 12, 7: 151, 3: 64, 0: 69, 6: 20, 1: 7, 4: 8})
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes) model chosen!
id 36
label_counts: defaultdict(<class 'int'>, {5: 152, 8: 159, 7: 10, 4: 109, 9: 83, 1: 70, 2: 15, 0: 1})
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes) model chosen!
id 37
label_counts: defaultdict(<class 'int'>, {1: 171, 3: 58, 6: 519, 0: 116, 4: 82, 5: 16, 7: 10, 9: 20, 2: 10})
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes) model chosen!
id 38
label_counts: defaultdict(<class 'int'>, {6: 156, 3: 111, 1: 29, 2: 125, 7: 141, 8: 27, 9: 20, 0: 6, 5: 29})
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes) model chosen!
id 39
label_counts: defaultdict(<class 'int'>, {9: 312, 3: 345, 8: 216, 4: 217, 0: 3, 7: 4, 5: 5, 1: 1, 2: 1})

Join ratio / total clients: 1.0 / 40
Finished creating server and clients.
Trainable_prototypes(
  (embedings): Embedding(10, 512)
  (middle): Sequential(
    (0): Sequential(
      (0): Linear(in_features=512, out_features=512, bias=True)
      (1): ReLU()
    )
  )
  (fc): Linear(in_features=512, out_features=512, bias=True)
)
tobetrained:
[9, 8, 7, 6, 5, 4, 3, 2, 1, 0]
Edge 9 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_5 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_31 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_13 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_0 protos Not Found
Client_5 prev_protos Not Found
Client_0 prev_protos Not Found
Client_13 prev_protos Not Found
Client_31 prev_protos Not Found
Edge 8 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_16 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_1 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_26 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_36 protos Not Found
Client_26 prev_protos Not Found
Client_36 prev_protos Not Found
Client_1 prev_protos Not Found
Client_16 prev_protos Not Found
Edge 7 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_24 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_7 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_27 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_2 protos Not Found
Client_2 prev_protos Not Found
Client_24 prev_protos Not Found
Client_27 prev_protos Not Found
Client_7 prev_protos Not Found
Edge 6 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_32 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_38 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_8 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_23 protos Not Found
Client_38 prev_protos Not Found
Client_23 prev_protos Not Found
Client_8 prev_protos Not Found
Client_32 prev_protos Not Found
Edge 5 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_9 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_33 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_29 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_6 protos Not Found
Client_29 prev_protos Not Found
Client_6 prev_protos Not Found
Client_9 prev_protos Not Found
Client_33 prev_protos Not Found
Edge 4 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_30 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_10 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_18 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_17 protos Not Found
Client_30 prev_protos Not Found
Client_17 prev_protos Not Found
Client_18 prev_protos Not Found
Client_10 prev_protos Not Found
Edge 3 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_14 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_15 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_39 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_35 protos Not Found
Client_14 prev_protos Not Found
Client_39 prev_protos Not Found
Client_15 prev_protos Not Found
Client_35 prev_protos Not Found
Edge 2 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_21 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_3 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_19 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_11 protos Not Found
Client_21 prev_protos Not Found
Client_11 prev_protos Not Found
Client_19 prev_protos Not Found
Client_3 prev_protos Not Found
Edge 1 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_12 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_20 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_22 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_25 protos Not Found
Client_25 prev_protos Not Found
Client_22 prev_protos Not Found
Client_20 prev_protos Not Found
Client_12 prev_protos Not Found
Edge 0 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_37 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_34 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_28 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_4 protos Not Found
Client_4 prev_protos Not Found
Client_28 prev_protos Not Found
Client_37 prev_protos Not Found
Client_34 prev_protos Not Found
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge_0 prev_protos Not Found
Edge_1 prev_protos Not Found
Edge_2 prev_protos Not Found
Edge_3 prev_protos Not Found
Edge_4 prev_protos Not Found
Edge_5 prev_protos Not Found
Edge_6 prev_protos Not Found
Edge_7 prev_protos Not Found
Edge_8 prev_protos Not Found
Edge_9 prev_protos Not Found
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([3.9864, 2.5491, 2.2446, 2.0699, 3.4147, 2.7722, 2.3389, 2.0699, 2.6666,
        3.1330], device='cuda:0')
Server loss: 5.8171234130859375
train global classifier
train glclassifier time: 3.7535331398248672
global classifier accuracy: 97.3525
Number of samples: 326
end Update
server_global_time: 15.809864707291126
only_train_time: 142.15097103267908

-------------Global Round number: 0-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.5744
Averaged Test Accuracy (Prototype Model): 0.2396
Std Test Accuracy (Regular Model): 0.1344
Std Test Accuracy (Prototype Model): 0.1949
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([3.6300, 3.0811, 2.9805, 2.8973, 2.6237, 3.1135, 3.1509, 2.6237, 2.7825,
        2.7825], device='cuda:0')
Server loss: 3.687110424041748
train global classifier
train glclassifier time: 3.7776546478271484
global classifier accuracy: 99.895
end Update
server_global_time: 31.683296114206314
only_train_time: 302.51381266117096

-------------Global Round number: 1-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6163
Averaged Test Accuracy (Prototype Model): 0.5193
Std Test Accuracy (Regular Model): 0.1143
Std Test Accuracy (Prototype Model): 0.1420
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([6.1126, 4.7825, 4.0134, 4.3598, 3.6143, 4.9231, 4.7920, 3.6143, 4.2665,
        4.5913], device='cuda:0')
Server loss: 4.383679389953613
train global classifier
train glclassifier time: 4.084023714065552
global classifier accuracy: 99.9475
end Update
server_global_time: 47.90042235702276
only_train_time: 460.753426425159

-------------Global Round number: 2-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6288
Averaged Test Accuracy (Prototype Model): 0.5732
Std Test Accuracy (Regular Model): 0.0954
Std Test Accuracy (Prototype Model): 0.1109
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([7.9694, 6.4450, 5.4968, 5.9438, 4.9307, 6.6777, 6.2311, 4.9307, 5.7260,
        6.3657], device='cuda:0')
Server loss: 4.733432769775391
train global classifier
train glclassifier time: 3.7844281792640686
global classifier accuracy: 99.98
end Update
server_global_time: 63.60673290491104
only_train_time: 622.2807266637683

-------------Global Round number: 3-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6246
Averaged Test Accuracy (Prototype Model): 0.5816
Std Test Accuracy (Regular Model): 0.0988
Std Test Accuracy (Prototype Model): 0.1193
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.1622, 7.5292, 6.9644, 7.2048, 5.9867, 8.0213, 7.4728, 5.9867, 6.7760,
        7.5620], device='cuda:0')
Server loss: 4.761388778686523
train global classifier
train glclassifier time: 3.7019396126270294
global classifier accuracy: 99.985
end Update
server_global_time: 79.56536604464054
only_train_time: 784.3633839637041

-------------Global Round number: 4-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6308
Averaged Test Accuracy (Prototype Model): 0.5978
Std Test Accuracy (Regular Model): 0.1007
Std Test Accuracy (Prototype Model): 0.1107
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.9783, 8.4689, 8.1369, 8.2832, 7.0287, 9.1361, 8.5866, 7.0287, 7.6993,
        8.5047], device='cuda:0')
Server loss: 4.562247276306152
train global classifier
train glclassifier time: 4.258188426494598
global classifier accuracy: 99.99
end Update
server_global_time: 95.52445679157972
only_train_time: 945.5391157642007

-------------Global Round number: 5-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6246
Averaged Test Accuracy (Prototype Model): 0.6023
Std Test Accuracy (Regular Model): 0.1004
Std Test Accuracy (Prototype Model): 0.1018
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 1, 9, 5, 4, 6, 7, 3]
aggregation_buffer:
[0, 2, 8, 1, 9, 5, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.6379,  9.1629,  9.1422,  9.2039,  7.9799, 10.0264,  9.4331,  7.9799,
         8.4586,  9.2836], device='cuda:0')
Server loss: 4.333881855010986
train global classifier
train glclassifier time: 3.7950446978211403
global classifier accuracy: 100.0
end Update
server_global_time: 111.36178218573332
only_train_time: 1105.8229273483157

-------------Global Round number: 6-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6256
Averaged Test Accuracy (Prototype Model): 0.6044
Std Test Accuracy (Regular Model): 0.0949
Std Test Accuracy (Prototype Model): 0.0976
tobetrained:
[0, 2, 8, 1, 9, 5, 4, 6, 7, 3]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 1 begin training
Edge 9 begin training
Edge 5 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.1896,  9.7258,  9.8632,  9.8831,  8.7128, 10.7656, 10.0480,  8.7128,
         9.0481,  9.9218], device='cuda:0')
Server loss: 4.174036979675293
train global classifier
train glclassifier time: 4.126863680779934
global classifier accuracy: 100.0
end Update
server_global_time: 128.96150194853544
only_train_time: 1268.227014631033

-------------Global Round number: 7-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6262
Averaged Test Accuracy (Prototype Model): 0.6078
Std Test Accuracy (Regular Model): 0.0959
Std Test Accuracy (Prototype Model): 0.0957
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.6641, 10.2410, 10.4111, 10.5694,  9.3480, 11.3831, 10.6145,  9.3480,
         9.5707, 10.4992], device='cuda:0')
Server loss: 4.008650779724121
train global classifier
train glclassifier time: 3.706112287938595
global classifier accuracy: 100.0
end Update
server_global_time: 145.3295690715313
only_train_time: 1429.3492006137967

-------------Global Round number: 8-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6254
Averaged Test Accuracy (Prototype Model): 0.6061
Std Test Accuracy (Regular Model): 0.0974
Std Test Accuracy (Prototype Model): 0.0968
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([12.0904, 10.6635, 10.8778, 11.1089,  9.9012, 11.8926, 11.1071,  9.9012,
        10.0122, 10.9926], device='cuda:0')
Server loss: 3.8857767581939697
train global classifier
train glclassifier time: 3.6649732664227486
global classifier accuracy: 99.9975
end Update
server_global_time: 161.30315548926592
only_train_time: 1590.8108073323965

-------------Global Round number: 9-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6256
Averaged Test Accuracy (Prototype Model): 0.6085
Std Test Accuracy (Regular Model): 0.0978
Std Test Accuracy (Prototype Model): 0.0963
tobetrained:
[0, 2, 8, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([12.4675, 11.0856, 11.3062, 11.6353, 10.4150, 12.3505, 11.5656, 10.4150,
        10.4216, 11.4467], device='cuda:0')
Server loss: 3.7625603675842285
train global classifier
train glclassifier time: 3.6175308153033257
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 177.05656880885363
only_train_time: 1751.1920696869493

-------------Global Round number: 10-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6250
Averaged Test Accuracy (Prototype Model): 0.6089
Std Test Accuracy (Regular Model): 0.0991
Std Test Accuracy (Prototype Model): 0.0979
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([12.8216, 11.4606, 11.6942, 12.0773, 10.8582, 12.7531, 11.9897, 10.8097,
        10.8097, 11.8526], device='cuda:0')
Server loss: 3.6702961921691895
train global classifier
train glclassifier time: 3.702082134783268
global classifier accuracy: 100.0
end Update
server_global_time: 193.77241481095552
only_train_time: 1910.7279422283173

-------------Global Round number: 11-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6224
Averaged Test Accuracy (Prototype Model): 0.6090
Std Test Accuracy (Regular Model): 0.1002
Std Test Accuracy (Prototype Model): 0.0980
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([13.1361, 11.7999, 12.0531, 12.5394, 11.2678, 13.1227, 12.3937, 11.1607,
        11.1607, 12.2375], device='cuda:0')
Server loss: 3.570478916168213
train global classifier
train glclassifier time: 4.369921684265137
global classifier accuracy: 100.0
end Update
server_global_time: 209.53328678756952
only_train_time: 2069.5983610525727

-------------Global Round number: 12-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6228
Averaged Test Accuracy (Prototype Model): 0.6100
Std Test Accuracy (Regular Model): 0.1000
Std Test Accuracy (Prototype Model): 0.0988
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([13.4219, 12.1025, 12.3803, 12.9315, 11.6251, 13.4614, 12.7329, 11.4764,
        11.4764, 12.5851], device='cuda:0')
Server loss: 3.513441324234009
train global classifier
train glclassifier time: 3.8124390468001366
global classifier accuracy: 100.0
end Update
server_global_time: 225.05399794131517
only_train_time: 2227.2152441889048

-------------Global Round number: 13-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6216
Averaged Test Accuracy (Prototype Model): 0.6089
Std Test Accuracy (Regular Model): 0.1009
Std Test Accuracy (Prototype Model): 0.0987
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([13.6853, 12.4017, 12.6923, 13.2973, 11.9786, 13.7821, 13.0747, 11.7837,
        11.7837, 12.8941], device='cuda:0')
Server loss: 3.4767954349517822
train global classifier
train glclassifier time: 3.740643233060837
global classifier accuracy: 100.0
end Update
server_global_time: 240.54975757747889
only_train_time: 2385.7708152979612

-------------Global Round number: 14-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6214
Averaged Test Accuracy (Prototype Model): 0.6098
Std Test Accuracy (Regular Model): 0.0996
Std Test Accuracy (Prototype Model): 0.0991
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([13.9309, 12.6842, 12.9702, 13.6348, 12.2986, 14.0781, 13.3933, 12.0735,
        12.0735, 13.1893], device='cuda:0')
Server loss: 3.444370985031128
train global classifier
train glclassifier time: 3.7310259863734245
global classifier accuracy: 99.9975
end Update
server_global_time: 256.33177910745144
only_train_time: 2545.330325253308

-------------Global Round number: 15-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6213
Averaged Test Accuracy (Prototype Model): 0.6099
Std Test Accuracy (Regular Model): 0.1017
Std Test Accuracy (Prototype Model): 0.0991
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([14.1676, 12.9481, 13.2362, 13.9474, 12.5964, 14.3550, 13.7015, 12.3384,
        12.3384, 13.4623], device='cuda:0')
Server loss: 3.4059109687805176
train global classifier
train glclassifier time: 3.80070348829031
global classifier accuracy: 100.0
end Update
server_global_time: 273.55450630933046
only_train_time: 2707.679681941867

-------------Global Round number: 16-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6214
Averaged Test Accuracy (Prototype Model): 0.6090
Std Test Accuracy (Regular Model): 0.1010
Std Test Accuracy (Prototype Model): 0.0996
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([14.3854, 13.1811, 13.4845, 14.2297, 12.8805, 14.6130, 13.9797, 12.5833,
        12.5833, 13.7272], device='cuda:0')
Server loss: 3.373987913131714
train global classifier
train glclassifier time: 3.7723222821950912
global classifier accuracy: 100.0
end Update
server_global_time: 289.35890401154757
only_train_time: 2868.2091203406453

-------------Global Round number: 17-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6216
Averaged Test Accuracy (Prototype Model): 0.6096
Std Test Accuracy (Regular Model): 0.1002
Std Test Accuracy (Prototype Model): 0.0994
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([14.5951, 13.4241, 13.7221, 14.5111, 13.1445, 14.8548, 14.2360, 12.8222,
        12.8222, 13.9702], device='cuda:0')
Server loss: 3.341679334640503
train global classifier
train glclassifier time: 3.7393602654337883
global classifier accuracy: 100.0
end Update
server_global_time: 305.4955424144864
only_train_time: 3029.985620431602

-------------Global Round number: 18-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6207
Averaged Test Accuracy (Prototype Model): 0.6087
Std Test Accuracy (Regular Model): 0.0993
Std Test Accuracy (Prototype Model): 0.0998
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([14.7896, 13.6524, 13.9480, 14.7711, 13.3925, 15.0961, 14.4967, 13.0474,
        13.0474, 14.2032], device='cuda:0')
Server loss: 3.3207337856292725
train global classifier
train glclassifier time: 3.760373927652836
global classifier accuracy: 100.0
end Update
server_global_time: 322.05251302570105
only_train_time: 3190.2500470876694

-------------Global Round number: 19-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6200
Averaged Test Accuracy (Prototype Model): 0.6089
Std Test Accuracy (Regular Model): 0.1000
Std Test Accuracy (Prototype Model): 0.1017
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 9, 1, 5, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 9, 1, 5, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([14.9547, 13.8584, 14.1372, 14.9805, 13.6373, 15.3076, 14.7302, 13.2504,
        13.2504, 14.4090], device='cuda:0')
Server loss: 3.313108205795288
train global classifier
train glclassifier time: 3.823995277285576
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 337.9907885417342
only_train_time: 3353.4959987327456

-------------Global Round number: 20-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6196
Averaged Test Accuracy (Prototype Model): 0.6088
Std Test Accuracy (Regular Model): 0.1011
Std Test Accuracy (Prototype Model): 0.1020
tobetrained:
[0, 8, 2, 9, 1, 5, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 9 begin training
Edge 1 begin training
Edge 5 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([15.1322, 14.0582, 14.3486, 15.2447, 13.8647, 15.5250, 14.9671, 13.4697,
        13.4697, 14.6158], device='cuda:0')
Server loss: 3.2756240367889404
train global classifier
train glclassifier time: 3.6924170777201653
global classifier accuracy: 100.0
end Update
server_global_time: 353.7283239737153
only_train_time: 3511.8350911214948

-------------Global Round number: 21-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6190
Averaged Test Accuracy (Prototype Model): 0.6089
Std Test Accuracy (Regular Model): 0.1004
Std Test Accuracy (Prototype Model): 0.1020
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([15.3088, 14.2548, 14.5332, 15.4774, 14.0841, 15.7210, 15.1933, 13.6644,
        13.6644, 14.8248], device='cuda:0')
Server loss: 3.250621795654297
train global classifier
train glclassifier time: 4.098741129040718
global classifier accuracy: 100.0
end Update
server_global_time: 370.5563822463155
only_train_time: 3672.89976336807

-------------Global Round number: 22-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6188
Averaged Test Accuracy (Prototype Model): 0.6078
Std Test Accuracy (Regular Model): 0.1005
Std Test Accuracy (Prototype Model): 0.1034
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([15.4720, 14.4402, 14.7069, 15.6988, 14.2816, 15.9050, 15.4077, 13.8579,
        13.8579, 15.0083], device='cuda:0')
Server loss: 3.2241199016571045
train global classifier
train glclassifier time: 3.6535815075039864
global classifier accuracy: 100.0
end Update
server_global_time: 386.2518868893385
only_train_time: 3830.7187950238585

-------------Global Round number: 23-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6184
Averaged Test Accuracy (Prototype Model): 0.6078
Std Test Accuracy (Regular Model): 0.1012
Std Test Accuracy (Prototype Model): 0.1041
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([15.6242, 14.6145, 14.8725, 15.9045, 14.4821, 16.0776, 15.6018, 14.0397,
        14.0397, 15.1897], device='cuda:0')
Server loss: 3.197981119155884
train global classifier
train glclassifier time: 3.9241763055324554
global classifier accuracy: 100.0
end Update
server_global_time: 402.2759676501155
only_train_time: 3986.6026904135942

-------------Global Round number: 24-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6174
Averaged Test Accuracy (Prototype Model): 0.6075
Std Test Accuracy (Regular Model): 0.1010
Std Test Accuracy (Prototype Model): 0.1039
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([15.7783, 14.7964, 15.0497, 16.1102, 14.6799, 16.2575, 15.7986, 14.2148,
        14.2148, 15.3642], device='cuda:0')
Server loss: 3.1834046840667725
train global classifier
train glclassifier time: 4.050755500793457
global classifier accuracy: 100.0
end Update
server_global_time: 418.7266981527209
only_train_time: 4143.917322583497

-------------Global Round number: 25-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6157
Averaged Test Accuracy (Prototype Model): 0.6072
Std Test Accuracy (Regular Model): 0.1007
Std Test Accuracy (Prototype Model): 0.1040
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([15.9280, 14.9596, 15.2083, 16.2891, 14.8581, 16.4237, 15.9735, 14.3764,
        14.3764, 15.5246], device='cuda:0')
Server loss: 3.1625559329986572
train global classifier
train glclassifier time: 3.703397862613201
global classifier accuracy: 100.0
end Update
server_global_time: 434.34573677927256
only_train_time: 4303.970067754388

-------------Global Round number: 26-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6159
Averaged Test Accuracy (Prototype Model): 0.6079
Std Test Accuracy (Regular Model): 0.1011
Std Test Accuracy (Prototype Model): 0.1045
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([16.0617, 15.1302, 15.3572, 16.4806, 15.0563, 16.5707, 16.1594, 14.5487,
        14.5487, 15.6830], device='cuda:0')
Server loss: 3.1359622478485107
train global classifier
train glclassifier time: 3.694241590797901
global classifier accuracy: 100.0
end Update
server_global_time: 449.82145500183105
only_train_time: 4461.320812024176

-------------Global Round number: 27-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6151
Averaged Test Accuracy (Prototype Model): 0.6081
Std Test Accuracy (Regular Model): 0.1008
Std Test Accuracy (Prototype Model): 0.1035
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([16.2010, 15.2766, 15.5108, 16.6484, 15.2158, 16.7353, 16.3266, 14.6994,
        14.6994, 15.8431], device='cuda:0')
Server loss: 3.1279044151306152
train global classifier
train glclassifier time: 3.7660214602947235
global classifier accuracy: 100.0
end Update
server_global_time: 465.5329420045018
only_train_time: 4619.054002679884

-------------Global Round number: 28-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6155
Averaged Test Accuracy (Prototype Model): 0.6084
Std Test Accuracy (Regular Model): 0.1015
Std Test Accuracy (Prototype Model): 0.1037
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[8, 0, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[8, 0, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([16.3354, 15.4397, 15.6609, 16.8200, 15.4070, 16.8822, 16.4869, 14.8695,
        14.8695, 15.9993], device='cuda:0')
Server loss: 3.1018059253692627
train global classifier
train glclassifier time: 3.753123104572296
global classifier accuracy: 100.0
end Update
server_global_time: 481.89308293908834
only_train_time: 4775.954630076885

-------------Global Round number: 29-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6149
Averaged Test Accuracy (Prototype Model): 0.6080
Std Test Accuracy (Regular Model): 0.1014
Std Test Accuracy (Prototype Model): 0.1042
tobetrained:
[8, 0, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[8, 2, 0, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[8, 2, 0, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([16.4408, 15.5869, 15.7727, 16.9743, 15.5709, 17.0288, 16.6031, 14.9849,
        14.9849, 16.1087], device='cuda:0')
Server loss: 3.0913498401641846
train global classifier
train glclassifier time: 3.6964906752109528
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 498.029177069664
only_train_time: 4936.71303396672

-------------Global Round number: 30-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6141
Averaged Test Accuracy (Prototype Model): 0.6080
Std Test Accuracy (Regular Model): 0.1019
Std Test Accuracy (Prototype Model): 0.1050
tobetrained:
[8, 2, 0, 5, 1, 9, 4, 6, 3, 7]
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([16.5579, 15.7317, 15.9239, 17.0575, 15.7177, 17.1681, 16.7015, 15.1361,
        15.1361, 16.1804], device='cuda:0')
Server loss: 3.154188394546509
train global classifier
train glclassifier time: 3.726518765091896
global classifier accuracy: 100.0
end Update
server_global_time: 515.0495662838221
only_train_time: 5097.724089853466

-------------Global Round number: 31-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6144
Averaged Test Accuracy (Prototype Model): 0.6074
Std Test Accuracy (Regular Model): 0.1029
Std Test Accuracy (Prototype Model): 0.1047
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([16.6896, 15.8712, 16.0605, 17.2689, 15.8813, 17.3010, 16.8789, 15.2938,
        15.2938, 16.3709], device='cuda:0')
Server loss: 3.0865373611450195
train global classifier
train glclassifier time: 3.757888540625572
global classifier accuracy: 100.0
end Update
server_global_time: 530.6632746905088
only_train_time: 5254.96661002934

-------------Global Round number: 32-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6143
Averaged Test Accuracy (Prototype Model): 0.6075
Std Test Accuracy (Regular Model): 0.1025
Std Test Accuracy (Prototype Model): 0.1054
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([16.8011, 15.9949, 16.1844, 17.4151, 16.0190, 17.4277, 17.0420, 15.4295,
        15.4295, 16.5206], device='cuda:0')
Server loss: 3.0576012134552
train global classifier
train glclassifier time: 4.741280525922775
global classifier accuracy: 100.0
end Update
server_global_time: 546.2839782088995
only_train_time: 5414.828271910548

-------------Global Round number: 33-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6144
Averaged Test Accuracy (Prototype Model): 0.6082
Std Test Accuracy (Regular Model): 0.1018
Std Test Accuracy (Prototype Model): 0.1051
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([16.9154, 16.1291, 16.3146, 17.5491, 16.1682, 17.5580, 17.1842, 15.5673,
        15.5673, 16.6540], device='cuda:0')
Server loss: 3.047988176345825
train global classifier
train glclassifier time: 3.674849145114422
global classifier accuracy: 100.0
end Update
server_global_time: 561.8661928325891
only_train_time: 5572.817355275154

-------------Global Round number: 34-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6139
Averaged Test Accuracy (Prototype Model): 0.6079
Std Test Accuracy (Regular Model): 0.1016
Std Test Accuracy (Prototype Model): 0.1051
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 2, 8, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([17.0222, 16.2495, 16.4235, 17.6829, 16.3050, 17.6705, 17.3283, 15.7078,
        15.7078, 16.7839], device='cuda:0')
Server loss: 3.032963991165161
train global classifier
train glclassifier time: 3.9793716743588448
global classifier accuracy: 100.0
end Update
server_global_time: 577.6581802219152
only_train_time: 5734.633119560778

-------------Global Round number: 35-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6152
Averaged Test Accuracy (Prototype Model): 0.6081
Std Test Accuracy (Regular Model): 0.1010
Std Test Accuracy (Prototype Model): 0.1056
tobetrained:
[0, 2, 8, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([17.0183, 16.3215, 16.3433, 17.6391, 16.2185, 17.7857, 17.2977, 15.6094,
        15.6094, 16.7844], device='cuda:0')
Server loss: 3.1552317142486572
train global classifier
train glclassifier time: 3.968356139957905
global classifier accuracy: 100.0
end Update
server_global_time: 593.1526209488511
only_train_time: 5893.822798363864

-------------Global Round number: 36-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6141
Averaged Test Accuracy (Prototype Model): 0.6073
Std Test Accuracy (Regular Model): 0.1010
Std Test Accuracy (Prototype Model): 0.1056
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([17.1932, 16.4687, 16.5995, 17.8637, 16.5296, 17.9388, 17.5266, 15.8653,
        15.8653, 16.9874], device='cuda:0')
Server loss: 3.078726053237915
train global classifier
train glclassifier time: 3.7815318778157234
global classifier accuracy: 100.0
end Update
server_global_time: 608.9306756779552
only_train_time: 6053.178896993399

-------------Global Round number: 37-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6141
Averaged Test Accuracy (Prototype Model): 0.6076
Std Test Accuracy (Regular Model): 0.1006
Std Test Accuracy (Prototype Model): 0.1052
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[8, 0, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[8, 0, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([17.3172, 16.6025, 16.7508, 18.0147, 16.6888, 18.0581, 17.6795, 16.0197,
        16.0197, 17.1212], device='cuda:0')
Server loss: 3.0487136840820312
train global classifier
train glclassifier time: 3.6810828000307083
global classifier accuracy: 100.0
end Update
server_global_time: 625.7131940573454
only_train_time: 6212.35427121073

-------------Global Round number: 38-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6142
Averaged Test Accuracy (Prototype Model): 0.6074
Std Test Accuracy (Regular Model): 0.1011
Std Test Accuracy (Prototype Model): 0.1056
tobetrained:
[8, 0, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([17.4295, 16.7265, 16.8719, 18.1441, 16.8319, 18.1752, 17.8131, 16.1517,
        16.1517, 17.2513], device='cuda:0')
Server loss: 3.02536678314209
train global classifier
train glclassifier time: 3.8941007032990456
global classifier accuracy: 100.0
end Update
server_global_time: 641.3507585674524
only_train_time: 6370.831958420575

-------------Global Round number: 39-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6143
Averaged Test Accuracy (Prototype Model): 0.6071
Std Test Accuracy (Regular Model): 0.1017
Std Test Accuracy (Prototype Model): 0.1057
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([17.5393, 16.8308, 16.9837, 18.2747, 16.9652, 18.2988, 17.9431, 16.2695,
        16.2695, 17.3676], device='cuda:0')
Server loss: 3.021026611328125
train global classifier
train glclassifier time: 3.652997076511383
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 657.1017659157515
only_train_time: 6531.714616790414

-------------Global Round number: 40-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6139
Averaged Test Accuracy (Prototype Model): 0.6073
Std Test Accuracy (Regular Model): 0.1014
Std Test Accuracy (Prototype Model): 0.1063
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([17.6381, 16.9412, 17.0920, 18.3951, 17.0875, 18.4115, 18.0633, 16.3763,
        16.3763, 17.4842], device='cuda:0')
Server loss: 3.009596586227417
train global classifier
train glclassifier time: 4.205218188464642
global classifier accuracy: 100.0
end Update
server_global_time: 672.6532440930605
only_train_time: 6690.371733888984

-------------Global Round number: 41-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6146
Averaged Test Accuracy (Prototype Model): 0.6071
Std Test Accuracy (Regular Model): 0.1012
Std Test Accuracy (Prototype Model): 0.1058
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([17.7466, 17.0517, 17.2036, 18.5193, 17.2307, 18.5257, 18.1858, 16.4983,
        16.4983, 17.5939], device='cuda:0')
Server loss: 2.991513967514038
train global classifier
train glclassifier time: 4.578538700938225
global classifier accuracy: 100.0
end Update
server_global_time: 689.5012652128935
only_train_time: 6849.6614052429795

-------------Global Round number: 42-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6151
Averaged Test Accuracy (Prototype Model): 0.6079
Std Test Accuracy (Regular Model): 0.1018
Std Test Accuracy (Prototype Model): 0.1061
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([17.8448, 17.1611, 17.3161, 18.6389, 17.3559, 18.6381, 18.3087, 16.6153,
        16.6153, 17.7117], device='cuda:0')
Server loss: 2.9873533248901367
train global classifier
train glclassifier time: 3.706422157585621
global classifier accuracy: 100.0
end Update
server_global_time: 705.2566754743457
only_train_time: 7010.553889878094

-------------Global Round number: 43-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6149
Averaged Test Accuracy (Prototype Model): 0.6081
Std Test Accuracy (Regular Model): 0.1014
Std Test Accuracy (Prototype Model): 0.1048
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([17.9403, 17.2578, 17.4234, 18.7502, 17.4716, 18.7372, 18.4258, 16.7209,
        16.7209, 17.8239], device='cuda:0')
Server loss: 2.9833855628967285
train global classifier
train glclassifier time: 3.672983005642891
global classifier accuracy: 100.0
end Update
server_global_time: 720.940785177052
only_train_time: 7169.454981654882

-------------Global Round number: 44-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6150
Averaged Test Accuracy (Prototype Model): 0.6070
Std Test Accuracy (Regular Model): 0.1017
Std Test Accuracy (Prototype Model): 0.1052
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([18.0294, 17.3629, 17.4803, 18.8361, 17.5581, 18.8012, 18.5314, 16.8279,
        16.8279, 17.9220], device='cuda:0')
Server loss: 2.961092948913574
train global classifier
train glclassifier time: 3.630650080740452
global classifier accuracy: 100.0
end Update
server_global_time: 736.844845533371
only_train_time: 7327.927602246404

-------------Global Round number: 45-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6152
Averaged Test Accuracy (Prototype Model): 0.6076
Std Test Accuracy (Regular Model): 0.1015
Std Test Accuracy (Prototype Model): 0.1049
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([18.1080, 17.4515, 17.6128, 18.9182, 17.6924, 18.9240, 18.6336, 16.9243,
        16.9243, 18.0215], device='cuda:0')
Server loss: 2.9679131507873535
train global classifier
train glclassifier time: 3.7383453100919724
global classifier accuracy: 100.0
end Update
server_global_time: 752.5166108235717
only_train_time: 7485.468906983733

-------------Global Round number: 46-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6147
Averaged Test Accuracy (Prototype Model): 0.6083
Std Test Accuracy (Regular Model): 0.1025
Std Test Accuracy (Prototype Model): 0.1049
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([18.2135, 17.5635, 17.7175, 19.0520, 17.8266, 19.0303, 18.7526, 17.0431,
        17.0431, 18.1261], device='cuda:0')
Server loss: 2.959909439086914
train global classifier
train glclassifier time: 3.845895431935787
global classifier accuracy: 100.0
end Update
server_global_time: 768.5586756467819
only_train_time: 7644.161067150533

-------------Global Round number: 47-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6141
Averaged Test Accuracy (Prototype Model): 0.6081
Std Test Accuracy (Regular Model): 0.1026
Std Test Accuracy (Prototype Model): 0.1049
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 1, 5, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 2, 8, 1, 5, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([18.3155, 17.6672, 17.8246, 19.1643, 17.9475, 19.1414, 18.8563, 17.1487,
        17.1487, 18.2316], device='cuda:0')
Server loss: 2.956057071685791
train global classifier
train glclassifier time: 3.6904606968164444
global classifier accuracy: 100.0
end Update
server_global_time: 784.8561604171991
only_train_time: 7804.282413363457

-------------Global Round number: 48-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6139
Averaged Test Accuracy (Prototype Model): 0.6077
Std Test Accuracy (Regular Model): 0.1024
Std Test Accuracy (Prototype Model): 0.1058
tobetrained:
[0, 2, 8, 1, 5, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([18.3994, 17.7738, 17.9148, 19.2711, 18.0454, 19.2340, 18.9526, 17.2482,
        17.2482, 18.3232], device='cuda:0')
Server loss: 2.9507648944854736
train global classifier
train glclassifier time: 3.684364967048168
global classifier accuracy: 100.0
end Update
server_global_time: 800.5717743709683
only_train_time: 7963.158554643393

-------------Global Round number: 49-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6135
Averaged Test Accuracy (Prototype Model): 0.6074
Std Test Accuracy (Regular Model): 0.1019
Std Test Accuracy (Prototype Model): 0.1063
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([18.4996, 17.8610, 18.0145, 19.3803, 18.1711, 19.3251, 19.0620, 17.3512,
        17.3512, 18.4199], device='cuda:0')
Server loss: 2.9526469707489014
train global classifier
train glclassifier time: 3.7530954405665398
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 816.2622766122222
only_train_time: 8123.100732587278

-------------Global Round number: 50-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6137
Averaged Test Accuracy (Prototype Model): 0.6086
Std Test Accuracy (Regular Model): 0.1030
Std Test Accuracy (Prototype Model): 0.1062
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([18.5782, 17.9566, 18.1104, 19.4773, 18.2768, 19.4267, 19.1660, 17.4511,
        17.4511, 18.5191], device='cuda:0')
Server loss: 2.9491889476776123
train global classifier
train glclassifier time: 3.957926146686077
global classifier accuracy: 100.0
end Update
server_global_time: 833.1319983899593
only_train_time: 8285.4595676139

-------------Global Round number: 51-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6143
Averaged Test Accuracy (Prototype Model): 0.6078
Std Test Accuracy (Regular Model): 0.1028
Std Test Accuracy (Prototype Model): 0.1065
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([18.6694, 18.0503, 18.2113, 19.5816, 18.3857, 19.5227, 19.2549, 17.5398,
        17.5398, 18.6162], device='cuda:0')
Server loss: 2.945276975631714
train global classifier
train glclassifier time: 3.54653562605381
global classifier accuracy: 100.0
end Update
server_global_time: 849.6528795659542
only_train_time: 8447.028353191912

-------------Global Round number: 52-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6145
Averaged Test Accuracy (Prototype Model): 0.6080
Std Test Accuracy (Regular Model): 0.1028
Std Test Accuracy (Prototype Model): 0.1062
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([18.7631, 18.1659, 18.3036, 19.6730, 18.4849, 19.6191, 19.3531, 17.6493,
        17.6493, 18.7078], device='cuda:0')
Server loss: 2.9403908252716064
train global classifier
train glclassifier time: 4.233270309865475
global classifier accuracy: 100.0
end Update
server_global_time: 865.0496867671609
only_train_time: 8604.570881702006

-------------Global Round number: 53-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6135
Averaged Test Accuracy (Prototype Model): 0.6078
Std Test Accuracy (Regular Model): 0.1023
Std Test Accuracy (Prototype Model): 0.1065
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([18.8498, 18.2505, 18.4013, 19.7766, 18.6041, 19.7052, 19.4580, 17.7489,
        17.7489, 18.8077], device='cuda:0')
Server loss: 2.9403300285339355
train global classifier
train glclassifier time: 4.0215393006801605
global classifier accuracy: 100.0
end Update
server_global_time: 880.6809139922261
only_train_time: 8762.799233809114

-------------Global Round number: 54-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6138
Averaged Test Accuracy (Prototype Model): 0.6078
Std Test Accuracy (Regular Model): 0.1030
Std Test Accuracy (Prototype Model): 0.1076
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([18.9285, 18.3469, 18.4810, 19.8588, 18.6960, 19.7986, 19.5633, 17.8351,
        17.8351, 18.9031], device='cuda:0')
Server loss: 2.931596517562866
train global classifier
train glclassifier time: 3.769743360579014
global classifier accuracy: 100.0
end Update
server_global_time: 897.1298110038042
only_train_time: 8918.178733684123

-------------Global Round number: 55-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6139
Averaged Test Accuracy (Prototype Model): 0.6085
Std Test Accuracy (Regular Model): 0.1026
Std Test Accuracy (Prototype Model): 0.1059
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([19.0180, 18.4331, 18.5833, 19.9618, 18.8168, 19.8823, 19.6601, 17.9357,
        17.9357, 18.9972], device='cuda:0')
Server loss: 2.9258580207824707
train global classifier
train glclassifier time: 3.9368989169597626
global classifier accuracy: 100.0
end Update
server_global_time: 912.7685069069266
only_train_time: 9076.284580558538

-------------Global Round number: 56-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6146
Averaged Test Accuracy (Prototype Model): 0.6089
Std Test Accuracy (Regular Model): 0.1034
Std Test Accuracy (Prototype Model): 0.1068
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([19.1034, 18.5251, 18.6728, 20.0468, 18.8933, 19.9801, 19.7548, 18.0327,
        18.0327, 19.0843], device='cuda:0')
Server loss: 2.9195241928100586
train global classifier
train glclassifier time: 3.7205779403448105
global classifier accuracy: 100.0
end Update
server_global_time: 929.7339203208685
only_train_time: 9237.302290894091

-------------Global Round number: 57-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6133
Averaged Test Accuracy (Prototype Model): 0.6084
Std Test Accuracy (Regular Model): 0.1032
Std Test Accuracy (Prototype Model): 0.1067
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([18.4815, 17.4964, 18.6020, 19.4020, 18.0815, 19.6379, 18.8933, 17.1374,
        17.1374, 19.1738], device='cuda:0')
Server loss: 2.7783002853393555
train global classifier
train glclassifier time: 3.8276840820908546
global classifier accuracy: 100.0
end Update
server_global_time: 945.6955960616469
only_train_time: 9396.345326945186

-------------Global Round number: 58-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6170
Averaged Test Accuracy (Prototype Model): 0.6075
Std Test Accuracy (Regular Model): 0.1034
Std Test Accuracy (Prototype Model): 0.1083
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[8, 0, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[8, 0, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([19.0622, 18.3635, 18.8151, 20.1332, 18.7913, 19.9867, 19.6759, 17.8634,
        17.8634, 19.2406], device='cuda:0')
Server loss: 2.9175195693969727
train global classifier
train glclassifier time: 3.7913216650485992
global classifier accuracy: 100.0
end Update
server_global_time: 961.3638341650367
only_train_time: 9553.995353929698

-------------Global Round number: 59-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6170
Averaged Test Accuracy (Prototype Model): 0.6111
Std Test Accuracy (Regular Model): 0.1026
Std Test Accuracy (Prototype Model): 0.1070
tobetrained:
[8, 0, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([19.2457, 18.5698, 18.8963, 20.2664, 19.0100, 20.1042, 19.8823, 18.0792,
        18.0792, 19.3128], device='cuda:0')
Server loss: 2.9401183128356934
train global classifier
train glclassifier time: 3.7678603529930115
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 977.1475547328591
only_train_time: 9711.338143222034

-------------Global Round number: 60-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6168
Averaged Test Accuracy (Prototype Model): 0.6109
Std Test Accuracy (Regular Model): 0.1020
Std Test Accuracy (Prototype Model): 0.1065
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([19.3794, 18.7138, 18.9936, 20.3601, 19.1368, 20.2397, 20.0219, 18.2280,
        18.2280, 19.4074], device='cuda:0')
Server loss: 2.9099159240722656
train global classifier
train glclassifier time: 3.6755148470401764
global classifier accuracy: 100.0
end Update
server_global_time: 993.5563842952251
only_train_time: 9870.877179026604

-------------Global Round number: 61-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6162
Averaged Test Accuracy (Prototype Model): 0.6115
Std Test Accuracy (Regular Model): 0.1010
Std Test Accuracy (Prototype Model): 0.1061
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([19.4819, 18.8279, 19.0798, 20.4631, 19.2972, 20.3386, 20.1448, 18.3632,
        18.3632, 19.4928], device='cuda:0')
Server loss: 2.9103474617004395
train global classifier
train glclassifier time: 3.631346955895424
global classifier accuracy: 100.0
end Update
server_global_time: 1009.1954018548131
only_train_time: 10028.900242008269

-------------Global Round number: 62-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6163
Averaged Test Accuracy (Prototype Model): 0.6111
Std Test Accuracy (Regular Model): 0.1009
Std Test Accuracy (Prototype Model): 0.1061
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([19.5560, 18.9413, 19.1706, 20.5396, 19.4035, 20.4199, 20.2468, 18.4752,
        18.4752, 19.5759], device='cuda:0')
Server loss: 2.8945913314819336
train global classifier
train glclassifier time: 3.7040402442216873
global classifier accuracy: 100.0
end Update
server_global_time: 1024.8225956112146
only_train_time: 10187.14506047219

-------------Global Round number: 63-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6165
Averaged Test Accuracy (Prototype Model): 0.6115
Std Test Accuracy (Regular Model): 0.1011
Std Test Accuracy (Prototype Model): 0.1065
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 9, 5, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 9, 5, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([19.6228, 19.0406, 19.2506, 20.6271, 19.5102, 20.4988, 20.3525, 18.5704,
        18.5704, 19.6644], device='cuda:0')
Server loss: 2.8889589309692383
train global classifier
train glclassifier time: 3.6709664314985275
global classifier accuracy: 100.0
end Update
server_global_time: 1040.469293102622
only_train_time: 10346.5716586411

-------------Global Round number: 64-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6163
Averaged Test Accuracy (Prototype Model): 0.6107
Std Test Accuracy (Regular Model): 0.1014
Std Test Accuracy (Prototype Model): 0.1059
tobetrained:
[0, 8, 2, 1, 9, 5, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 9 begin training
Edge 5 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([19.6907, 19.1314, 19.3281, 20.6847, 19.6097, 20.5509, 20.4302, 18.6719,
        18.6719, 19.7397], device='cuda:0')
Server loss: 2.8799383640289307
train global classifier
train glclassifier time: 3.75698896497488
global classifier accuracy: 100.0
end Update
server_global_time: 1056.201409228146
only_train_time: 10504.350492350757

-------------Global Round number: 65-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6172
Averaged Test Accuracy (Prototype Model): 0.6116
Std Test Accuracy (Regular Model): 0.1013
Std Test Accuracy (Prototype Model): 0.1062
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([19.7583, 19.2238, 19.4141, 20.7881, 19.7247, 20.6298, 20.5198, 18.7650,
        18.7650, 19.8210], device='cuda:0')
Server loss: 2.8858516216278076
train global classifier
train glclassifier time: 3.679579868912697
global classifier accuracy: 100.0
end Update
server_global_time: 1071.8528220057487
only_train_time: 10662.105098873377

-------------Global Round number: 66-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6172
Averaged Test Accuracy (Prototype Model): 0.6108
Std Test Accuracy (Regular Model): 0.1013
Std Test Accuracy (Prototype Model): 0.1058
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[8, 0, 2, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[8, 0, 2, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([19.6375, 18.9910, 19.4568, 20.7335, 19.6226, 19.8828, 20.5256, 18.7583,
        18.7583, 19.8686], device='cuda:0')
Server loss: 3.0714995861053467
train global classifier
train glclassifier time: 3.704782336950302
global classifier accuracy: 100.0
end Update
server_global_time: 1087.5189876705408
only_train_time: 10820.5053621158

-------------Global Round number: 67-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6188
Averaged Test Accuracy (Prototype Model): 0.6112
Std Test Accuracy (Regular Model): 0.1034
Std Test Accuracy (Prototype Model): 0.1096
tobetrained:
[8, 0, 2, 5, 9, 1, 4, 6, 3, 7]
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([19.8326, 19.2882, 19.5691, 20.8707, 19.7909, 20.5446, 20.6366, 18.8933,
        18.8933, 19.9710], device='cuda:0')
Server loss: 2.9065279960632324
train global classifier
train glclassifier time: 3.6891739070415497
global classifier accuracy: 100.0
end Update
server_global_time: 1103.251486338675
only_train_time: 10981.175352931023

-------------Global Round number: 68-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6212
Averaged Test Accuracy (Prototype Model): 0.6149
Std Test Accuracy (Regular Model): 0.1043
Std Test Accuracy (Prototype Model): 0.1095
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([19.9370, 19.3906, 19.6474, 20.9928, 19.9359, 20.6859, 20.7432, 18.9896,
        18.9896, 20.0510], device='cuda:0')
Server loss: 2.901824712753296
train global classifier
train glclassifier time: 3.650960884988308
global classifier accuracy: 100.0
end Update
server_global_time: 1118.8829519078135
only_train_time: 11139.475985258818

-------------Global Round number: 69-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6204
Averaged Test Accuracy (Prototype Model): 0.6153
Std Test Accuracy (Regular Model): 0.1047
Std Test Accuracy (Prototype Model): 0.1101
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([20.0081, 19.4909, 19.7133, 21.0863, 20.0300, 20.8007, 20.8280, 19.0720,
        19.0720, 20.1233], device='cuda:0')
Server loss: 2.8965847492218018
train global classifier
train glclassifier time: 3.748973101377487
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 1134.411068789661
only_train_time: 11298.282298617065

-------------Global Round number: 70-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6212
Averaged Test Accuracy (Prototype Model): 0.6149
Std Test Accuracy (Regular Model): 0.1053
Std Test Accuracy (Prototype Model): 0.1099
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([19.8747, 19.5269, 19.2468, 20.5709, 19.4836, 20.5032, 20.6723, 19.1541,
        19.1541, 20.1982], device='cuda:0')
Server loss: 2.6663923263549805
train global classifier
train glclassifier time: 3.6789681017398834
global classifier accuracy: 100.0
end Update
server_global_time: 1150.1224792674184
only_train_time: 11458.322577610612

-------------Global Round number: 71-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6218
Averaged Test Accuracy (Prototype Model): 0.6155
Std Test Accuracy (Regular Model): 0.1050
Std Test Accuracy (Prototype Model): 0.1095
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([20.0681, 19.6092, 19.6717, 21.0109, 19.9607, 20.8930, 20.9583, 19.2103,
        19.2103, 20.2569], device='cuda:0')
Server loss: 2.7801246643066406
train global classifier
train glclassifier time: 3.685566782951355
global classifier accuracy: 100.0
end Update
server_global_time: 1165.8230828642845
only_train_time: 11618.025502547622

-------------Global Round number: 72-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6223
Averaged Test Accuracy (Prototype Model): 0.6159
Std Test Accuracy (Regular Model): 0.1043
Std Test Accuracy (Prototype Model): 0.1095
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([20.1581, 19.6965, 19.8338, 21.1910, 20.1628, 21.0383, 21.0351, 19.2810,
        19.2810, 20.3327], device='cuda:0')
Server loss: 2.827028751373291
train global classifier
train glclassifier time: 3.7497992143034935
global classifier accuracy: 100.0
end Update
server_global_time: 1181.911847062409
only_train_time: 11777.614808946848

-------------Global Round number: 73-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6216
Averaged Test Accuracy (Prototype Model): 0.6161
Std Test Accuracy (Regular Model): 0.1053
Std Test Accuracy (Prototype Model): 0.1099
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([20.2428, 19.7946, 19.9381, 21.2956, 20.3141, 21.1344, 21.0988, 19.3809,
        19.3809, 20.4033], device='cuda:0')
Server loss: 2.829936981201172
train global classifier
train glclassifier time: 3.945188947021961
global classifier accuracy: 100.0
end Update
server_global_time: 1197.5232134759426
only_train_time: 11935.390216737986

-------------Global Round number: 74-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6227
Averaged Test Accuracy (Prototype Model): 0.6170
Std Test Accuracy (Regular Model): 0.1037
Std Test Accuracy (Prototype Model): 0.1105
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([20.3209, 19.8646, 20.0185, 21.3686, 20.3939, 21.2142, 21.1694, 19.4447,
        19.4447, 20.4745], device='cuda:0')
Server loss: 2.8234424591064453
train global classifier
train glclassifier time: 3.672828361392021
global classifier accuracy: 100.0
end Update
server_global_time: 1213.4482407793403
only_train_time: 12095.16478471458

-------------Global Round number: 75-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6224
Averaged Test Accuracy (Prototype Model): 0.6157
Std Test Accuracy (Regular Model): 0.1049
Std Test Accuracy (Prototype Model): 0.1096
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([20.3914, 19.9550, 20.1089, 21.4522, 20.5200, 21.3061, 21.2487, 19.5416,
        19.5416, 20.5427], device='cuda:0')
Server loss: 2.8163514137268066
train global classifier
train glclassifier time: 3.6601155772805214
global classifier accuracy: 100.0
end Update
server_global_time: 1229.06453923136
only_train_time: 12256.05125246942

-------------Global Round number: 76-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6215
Averaged Test Accuracy (Prototype Model): 0.6154
Std Test Accuracy (Regular Model): 0.1041
Std Test Accuracy (Prototype Model): 0.1095
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([20.2698, 20.0418, 20.1405, 20.6033, 20.5723, 21.1896, 20.5827, 19.6280,
        19.6280, 20.6230], device='cuda:0')
Server loss: 2.890122652053833
train global classifier
train glclassifier time: 3.7049305960536003
global classifier accuracy: 100.0
end Update
server_global_time: 1244.6468058526516
only_train_time: 12414.54614624381

-------------Global Round number: 77-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6212
Averaged Test Accuracy (Prototype Model): 0.6159
Std Test Accuracy (Regular Model): 0.1052
Std Test Accuracy (Prototype Model): 0.1084
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([20.4946, 20.1065, 20.2243, 21.3438, 20.6694, 21.4272, 21.1772, 19.6956,
        19.6956, 20.6865], device='cuda:0')
Server loss: 2.769214391708374
train global classifier
train glclassifier time: 4.260697603225708
global classifier accuracy: 100.0
end Update
server_global_time: 1260.3278909549117
only_train_time: 12574.8151634112

-------------Global Round number: 78-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6252
Averaged Test Accuracy (Prototype Model): 0.6189
Std Test Accuracy (Regular Model): 0.1044
Std Test Accuracy (Prototype Model): 0.1089
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([20.5424, 20.1568, 20.2979, 21.5473, 20.7520, 21.4915, 21.3410, 19.7215,
        19.7215, 20.7303], device='cuda:0')
Server loss: 2.7881886959075928
train global classifier
train glclassifier time: 3.632263921201229
global classifier accuracy: 100.0
end Update
server_global_time: 1276.5056847035885
only_train_time: 12734.030390270054

-------------Global Round number: 79-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6251
Averaged Test Accuracy (Prototype Model): 0.6186
Std Test Accuracy (Regular Model): 0.1043
Std Test Accuracy (Prototype Model): 0.1090
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([20.6344, 20.2439, 20.3934, 21.6846, 20.8537, 21.5814, 21.4586, 19.8212,
        19.8212, 20.8142], device='cuda:0')
Server loss: 2.7973978519439697
train global classifier
train glclassifier time: 3.662581644952297
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 1292.7972116544843
only_train_time: 12892.98273767531

-------------Global Round number: 80-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6248
Averaged Test Accuracy (Prototype Model): 0.6188
Std Test Accuracy (Regular Model): 0.1046
Std Test Accuracy (Prototype Model): 0.1092
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([20.7092, 20.3164, 20.4751, 21.7719, 20.9217, 21.6613, 21.5580, 19.9090,
        19.9090, 20.9013], device='cuda:0')
Server loss: 2.799245595932007
train global classifier
train glclassifier time: 4.02108608931303
global classifier accuracy: 100.0
end Update
server_global_time: 1308.7278109565377
only_train_time: 13052.519547984004

-------------Global Round number: 81-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6240
Averaged Test Accuracy (Prototype Model): 0.6182
Std Test Accuracy (Regular Model): 0.1041
Std Test Accuracy (Prototype Model): 0.1087
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([20.7636, 20.3763, 20.5434, 21.8581, 21.0017, 21.7153, 21.6455, 19.9636,
        19.9636, 20.9590], device='cuda:0')
Server loss: 2.814610004425049
train global classifier
train glclassifier time: 3.853894867002964
global classifier accuracy: 100.0
end Update
server_global_time: 1324.314641624689
only_train_time: 13211.848818585277

-------------Global Round number: 82-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6235
Averaged Test Accuracy (Prototype Model): 0.6174
Std Test Accuracy (Regular Model): 0.1028
Std Test Accuracy (Prototype Model): 0.1077
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([20.8436, 20.4448, 20.6215, 21.9413, 21.0891, 21.7876, 21.7362, 20.0362,
        20.0362, 21.0385], device='cuda:0')
Server loss: 2.809077739715576
train global classifier
train glclassifier time: 3.7942987754940987
global classifier accuracy: 100.0
end Update
server_global_time: 1340.0968704596162
only_train_time: 13371.11385589093

-------------Global Round number: 83-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6237
Averaged Test Accuracy (Prototype Model): 0.6178
Std Test Accuracy (Regular Model): 0.1035
Std Test Accuracy (Prototype Model): 0.1081
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([20.8980, 20.5181, 20.6968, 22.0241, 21.1686, 21.8417, 21.8040, 20.1106,
        20.1106, 21.1094], device='cuda:0')
Server loss: 2.820808172225952
train global classifier
train glclassifier time: 3.631313219666481
global classifier accuracy: 100.0
end Update
server_global_time: 1355.9998454526067
only_train_time: 13529.320606552064

-------------Global Round number: 84-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6234
Averaged Test Accuracy (Prototype Model): 0.6171
Std Test Accuracy (Regular Model): 0.1036
Std Test Accuracy (Prototype Model): 0.1086
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([20.9820, 20.5826, 20.7717, 22.1152, 21.2580, 21.8856, 21.8737, 20.1814,
        20.1814, 21.1799], device='cuda:0')
Server loss: 2.823035955429077
train global classifier
train glclassifier time: 3.787531152367592
global classifier accuracy: 100.0
end Update
server_global_time: 1371.8249220699072
only_train_time: 13686.064749985933

-------------Global Round number: 85-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6238
Averaged Test Accuracy (Prototype Model): 0.6178
Std Test Accuracy (Regular Model): 0.1028
Std Test Accuracy (Prototype Model): 0.1086
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([21.0297, 20.6746, 20.8363, 22.1792, 21.3371, 21.9457, 21.9306, 20.2482,
        20.2482, 21.2350], device='cuda:0')
Server loss: 2.8248698711395264
train global classifier
train glclassifier time: 3.7097978219389915
global classifier accuracy: 100.0
end Update
server_global_time: 1387.7483967095613
only_train_time: 13845.434661053121

-------------Global Round number: 86-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6239
Averaged Test Accuracy (Prototype Model): 0.6184
Std Test Accuracy (Regular Model): 0.1030
Std Test Accuracy (Prototype Model): 0.1073
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([21.1071, 20.7570, 20.9172, 22.2593, 21.4365, 22.0223, 22.0187, 20.3403,
        20.3403, 21.3171], device='cuda:0')
Server loss: 2.826436758041382
train global classifier
train glclassifier time: 4.015764586627483
global classifier accuracy: 100.0
end Update
server_global_time: 1403.2521371170878
only_train_time: 14004.494232304394

-------------Global Round number: 87-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6232
Averaged Test Accuracy (Prototype Model): 0.6180
Std Test Accuracy (Regular Model): 0.1035
Std Test Accuracy (Prototype Model): 0.1084
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([21.1739, 20.7996, 20.9839, 22.3157, 21.4992, 22.0774, 22.0859, 20.3991,
        20.3991, 21.3910], device='cuda:0')
Server loss: 2.820169448852539
train global classifier
train glclassifier time: 3.7253217920660973
global classifier accuracy: 100.0
end Update
server_global_time: 1420.4519611224532
only_train_time: 14165.121544077992

-------------Global Round number: 88-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6238
Averaged Test Accuracy (Prototype Model): 0.6181
Std Test Accuracy (Regular Model): 0.1040
Std Test Accuracy (Prototype Model): 0.1086
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([21.2392, 20.8747, 21.0629, 22.4018, 21.5749, 22.1475, 22.1693, 20.4739,
        20.4739, 21.4640], device='cuda:0')
Server loss: 2.8214385509490967
train global classifier
train glclassifier time: 3.574324257671833
global classifier accuracy: 100.0
end Update
server_global_time: 1436.2485880553722
only_train_time: 14323.074061527848

-------------Global Round number: 89-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6229
Averaged Test Accuracy (Prototype Model): 0.6175
Std Test Accuracy (Regular Model): 0.1031
Std Test Accuracy (Prototype Model): 0.1067
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([21.3097, 20.9509, 21.1403, 22.4459, 21.6407, 22.2250, 22.2329, 20.5552,
        20.5552, 21.5391], device='cuda:0')
Server loss: 2.8064582347869873
train global classifier
train glclassifier time: 4.080183155834675
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 1451.7589470371604
only_train_time: 14479.420254774392

-------------Global Round number: 90-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6224
Averaged Test Accuracy (Prototype Model): 0.6183
Std Test Accuracy (Regular Model): 0.1034
Std Test Accuracy (Prototype Model): 0.1069
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([21.3817, 21.0149, 21.2203, 22.5399, 21.7293, 22.2827, 22.3115, 20.6222,
        20.6222, 21.6096], device='cuda:0')
Server loss: 2.809516668319702
train global classifier
train glclassifier time: 4.075166203081608
global classifier accuracy: 100.0
end Update
server_global_time: 1467.218490101397
only_train_time: 14635.896494157612

-------------Global Round number: 91-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6220
Averaged Test Accuracy (Prototype Model): 0.6174
Std Test Accuracy (Regular Model): 0.1043
Std Test Accuracy (Prototype Model): 0.1079
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([21.1057, 21.0291, 20.9111, 22.4411, 21.7695, 22.1782, 21.9536, 20.6762,
        20.6762, 21.6745], device='cuda:0')
Server loss: 2.9390318393707275
train global classifier
train glclassifier time: 3.649452492594719
global classifier accuracy: 100.0
end Update
server_global_time: 1482.6072888597846
only_train_time: 14791.47262198478

-------------Global Round number: 92-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6238
Averaged Test Accuracy (Prototype Model): 0.6189
Std Test Accuracy (Regular Model): 0.1027
Std Test Accuracy (Prototype Model): 0.1057
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([21.3824, 21.1235, 21.2346, 22.6066, 21.8538, 22.4022, 22.3188, 20.7484,
        20.7484, 21.7365], device='cuda:0')
Server loss: 2.8304152488708496
train global classifier
train glclassifier time: 4.080669045448303
global classifier accuracy: 100.0
end Update
server_global_time: 1497.846391044557
only_train_time: 14948.585048340261

-------------Global Round number: 93-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6242
Averaged Test Accuracy (Prototype Model): 0.6193
Std Test Accuracy (Regular Model): 0.1041
Std Test Accuracy (Prototype Model): 0.1071
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 1, 9, 5, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 9, 5, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([21.4616, 21.2225, 21.3191, 22.6868, 21.9437, 22.4592, 22.4204, 20.8389,
        20.8389, 21.8109], device='cuda:0')
Server loss: 2.8224034309387207
train global classifier
train glclassifier time: 3.9913855716586113
global classifier accuracy: 100.0
end Update
server_global_time: 1513.3158412575722
only_train_time: 15105.936831861734

-------------Global Round number: 94-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6248
Averaged Test Accuracy (Prototype Model): 0.6194
Std Test Accuracy (Regular Model): 0.1028
Std Test Accuracy (Prototype Model): 0.1072
tobetrained:
[0, 8, 2, 1, 9, 5, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 9 begin training
Edge 5 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([21.5519, 21.2635, 21.3991, 22.7522, 21.9895, 22.5064, 22.5140, 20.8856,
        20.8856, 21.8707], device='cuda:0')
Server loss: 2.8177030086517334
train global classifier
train glclassifier time: 3.9491985961794853
global classifier accuracy: 100.0
end Update
server_global_time: 1529.0789835378528
only_train_time: 15264.890421673656

-------------Global Round number: 95-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6242
Averaged Test Accuracy (Prototype Model): 0.6201
Std Test Accuracy (Regular Model): 0.1035
Std Test Accuracy (Prototype Model): 0.1066
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 1, 5, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([21.6184, 21.3250, 21.4799, 22.8410, 22.0730, 22.5783, 22.5803, 20.9517,
        20.9517, 21.9381], device='cuda:0')
Server loss: 2.823199987411499
train global classifier
train glclassifier time: 4.664842396974564
global classifier accuracy: 100.0
end Update
server_global_time: 1545.834376230836
only_train_time: 15421.939404010773

-------------Global Round number: 96-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6241
Averaged Test Accuracy (Prototype Model): 0.6197
Std Test Accuracy (Regular Model): 0.1029
Std Test Accuracy (Prototype Model): 0.1061
tobetrained:
[0, 2, 8, 1, 5, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([21.6808, 21.3772, 21.5498, 22.8803, 22.1303, 22.6272, 22.6396, 20.9932,
        20.9932, 21.9891], device='cuda:0')
Server loss: 2.8040318489074707
train global classifier
train glclassifier time: 3.6326858401298523
global classifier accuracy: 100.0
end Update
server_global_time: 1561.363865479827
only_train_time: 15577.214391700923

-------------Global Round number: 97-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6236
Averaged Test Accuracy (Prototype Model): 0.6203
Std Test Accuracy (Regular Model): 0.1033
Std Test Accuracy (Prototype Model): 0.1065
tobetrained:
[0, 2, 8, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([21.7636, 21.4624, 21.6259, 22.9592, 22.2039, 22.6902, 22.7323, 21.0834,
        21.0834, 22.0670], device='cuda:0')
Server loss: 2.8072023391723633
train global classifier
train glclassifier time: 3.6516284570097923
global classifier accuracy: 100.0
end Update
server_global_time: 1577.5112896636128
only_train_time: 15733.904841266572

-------------Global Round number: 98-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6248
Averaged Test Accuracy (Prototype Model): 0.6208
Std Test Accuracy (Regular Model): 0.1026
Std Test Accuracy (Prototype Model): 0.1069
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[8, 0, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[8, 0, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([21.8253, 21.5415, 21.6901, 23.0226, 22.2795, 22.7608, 22.7930, 21.1599,
        21.1599, 22.1362], device='cuda:0')
Server loss: 2.801698684692383
train global classifier
train glclassifier time: 3.6439448073506355
global classifier accuracy: 100.0
end Update
server_global_time: 1593.4626492634416
only_train_time: 15890.882930889726

-------------Global Round number: 99-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6235
Averaged Test Accuracy (Prototype Model): 0.6190
Std Test Accuracy (Regular Model): 0.1026
Std Test Accuracy (Prototype Model): 0.1063
tobetrained:
[8, 0, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([21.8818, 21.6021, 21.7529, 23.1002, 22.3506, 22.8335, 22.8659, 21.2222,
        21.2222, 22.1931], device='cuda:0')
Server loss: 2.8033976554870605
train global classifier
train glclassifier time: 3.8575372472405434
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 1608.9353022649884
only_train_time: 16047.424074359238

-------------Global Round number: 100-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6238
Averaged Test Accuracy (Prototype Model): 0.6198
Std Test Accuracy (Regular Model): 0.1029
Std Test Accuracy (Prototype Model): 0.1063
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([21.9318, 21.6709, 21.8084, 23.1460, 22.4251, 22.9057, 22.9155, 21.2842,
        21.2842, 22.2464], device='cuda:0')
Server loss: 2.79118275642395
train global classifier
train glclassifier time: 3.7263178303837776
global classifier accuracy: 100.0
end Update
server_global_time: 1624.3144318982959
only_train_time: 16202.930374845862

-------------Global Round number: 101-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6238
Averaged Test Accuracy (Prototype Model): 0.6194
Std Test Accuracy (Regular Model): 0.1037
Std Test Accuracy (Prototype Model): 0.1066
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([21.9957, 21.7128, 21.8716, 23.1937, 22.4835, 22.9829, 22.9778, 21.3349,
        21.3349, 22.3107], device='cuda:0')
Server loss: 2.782310724258423
train global classifier
train glclassifier time: 3.655575856566429
global classifier accuracy: 100.0
end Update
server_global_time: 1639.5752651691437
only_train_time: 16357.974153451622

-------------Global Round number: 102-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6235
Averaged Test Accuracy (Prototype Model): 0.6198
Std Test Accuracy (Regular Model): 0.1027
Std Test Accuracy (Prototype Model): 0.1056
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([22.0680, 21.7809, 21.9414, 23.2722, 22.5382, 23.0523, 23.0524, 21.4079,
        21.4079, 22.3828], device='cuda:0')
Server loss: 2.7860324382781982
train global classifier
train glclassifier time: 3.912154905498028
global classifier accuracy: 100.0
end Update
server_global_time: 1655.343998208642
only_train_time: 16517.29922668636

-------------Global Round number: 103-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6230
Averaged Test Accuracy (Prototype Model): 0.6198
Std Test Accuracy (Regular Model): 0.1039
Std Test Accuracy (Prototype Model): 0.1060
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([22.1305, 21.8579, 22.0018, 23.3494, 22.6228, 23.1179, 23.1206, 21.4803,
        21.4803, 22.4425], device='cuda:0')
Server loss: 2.7945380210876465
train global classifier
train glclassifier time: 3.9415803104639053
global classifier accuracy: 100.0
end Update
server_global_time: 1671.1742554977536
only_train_time: 16680.626836925745

-------------Global Round number: 104-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6232
Averaged Test Accuracy (Prototype Model): 0.6194
Std Test Accuracy (Regular Model): 0.1033
Std Test Accuracy (Prototype Model): 0.1057
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([22.0082, 21.8597, 21.3692, 23.2807, 22.6185, 22.5558, 22.9855, 21.3898,
        21.3692, 22.3950], device='cuda:0')
Server loss: 2.948215961456299
train global classifier
train glclassifier time: 3.658476710319519
global classifier accuracy: 100.0
end Update
server_global_time: 1687.0688476264477
only_train_time: 16842.306397929788

-------------Global Round number: 105-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6230
Averaged Test Accuracy (Prototype Model): 0.6184
Std Test Accuracy (Regular Model): 0.1033
Std Test Accuracy (Prototype Model): 0.1063
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([22.2092, 21.9701, 22.0311, 23.4425, 22.7227, 23.1931, 23.2519, 21.6006,
        21.6006, 22.5786], device='cuda:0')
Server loss: 2.800630807876587
train global classifier
train glclassifier time: 3.7194261103868484
global classifier accuracy: 100.0
end Update
server_global_time: 1702.8364088907838
only_train_time: 17003.063496299088

-------------Global Round number: 106-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6252
Averaged Test Accuracy (Prototype Model): 0.6218
Std Test Accuracy (Regular Model): 0.1030
Std Test Accuracy (Prototype Model): 0.1055
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([22.2618, 22.0170, 22.0781, 23.4968, 22.8060, 23.2512, 23.2969, 21.6544,
        21.6544, 22.6150], device='cuda:0')
Server loss: 2.807098388671875
train global classifier
train glclassifier time: 4.114808917045593
global classifier accuracy: 100.0
end Update
server_global_time: 1718.6717287153006
only_train_time: 17163.013454772532

-------------Global Round number: 107-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6258
Averaged Test Accuracy (Prototype Model): 0.6220
Std Test Accuracy (Regular Model): 0.1033
Std Test Accuracy (Prototype Model): 0.1056
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([22.3352, 22.0598, 22.1905, 23.5616, 22.8454, 23.3427, 23.3723, 21.7194,
        21.7194, 22.6910], device='cuda:0')
Server loss: 2.7941346168518066
train global classifier
train glclassifier time: 3.7990699112415314
global classifier accuracy: 100.0
end Update
server_global_time: 1734.4871541932225
only_train_time: 17325.523120120168

-------------Global Round number: 108-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6250
Averaged Test Accuracy (Prototype Model): 0.6214
Std Test Accuracy (Regular Model): 0.1026
Std Test Accuracy (Prototype Model): 0.1049
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([22.3962, 22.1289, 22.2669, 23.6269, 22.9237, 23.3851, 23.4220, 21.7754,
        21.7754, 22.7418], device='cuda:0')
Server loss: 2.7910311222076416
train global classifier
train glclassifier time: 3.832021586596966
global classifier accuracy: 100.0
end Update
server_global_time: 1750.2638873159885
only_train_time: 17484.80135667324

-------------Global Round number: 109-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6258
Averaged Test Accuracy (Prototype Model): 0.6224
Std Test Accuracy (Regular Model): 0.1034
Std Test Accuracy (Prototype Model): 0.1051
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([22.4552, 22.1824, 22.3278, 23.7117, 22.9843, 23.4616, 23.4889, 21.8285,
        21.8285, 22.8038], device='cuda:0')
Server loss: 2.798879861831665
train global classifier
train glclassifier time: 3.7316573932766914
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 1766.1848670840263
only_train_time: 17647.7619869709

-------------Global Round number: 110-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6262
Averaged Test Accuracy (Prototype Model): 0.6231
Std Test Accuracy (Regular Model): 0.1040
Std Test Accuracy (Prototype Model): 0.1054
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([22.5215, 22.2629, 22.4116, 23.7415, 23.0684, 23.5361, 23.5511, 21.9098,
        21.9098, 22.8748], device='cuda:0')
Server loss: 2.7784390449523926
train global classifier
train glclassifier time: 4.155492186546326
global classifier accuracy: 100.0
end Update
server_global_time: 1782.0447396859527
only_train_time: 17807.278111629188

-------------Global Round number: 111-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6254
Averaged Test Accuracy (Prototype Model): 0.6218
Std Test Accuracy (Regular Model): 0.1033
Std Test Accuracy (Prototype Model): 0.1049
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([22.5867, 22.3378, 22.4924, 23.8195, 23.1370, 23.5904, 23.6049, 21.9995,
        21.9995, 22.9394], device='cuda:0')
Server loss: 2.7809932231903076
train global classifier
train glclassifier time: 3.7627972438931465
global classifier accuracy: 100.0
end Update
server_global_time: 1799.216087602079
only_train_time: 17969.246357172728

-------------Global Round number: 112-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6256
Averaged Test Accuracy (Prototype Model): 0.6215
Std Test Accuracy (Regular Model): 0.1038
Std Test Accuracy (Prototype Model): 0.1049
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([22.6482, 22.3988, 22.5575, 23.8851, 23.2157, 23.6554, 23.6639, 22.0777,
        22.0777, 23.0163], device='cuda:0')
Server loss: 2.7821896076202393
train global classifier
train glclassifier time: 3.9935415536165237
global classifier accuracy: 100.0
end Update
server_global_time: 1815.4446600079536
only_train_time: 18131.504436425865

-------------Global Round number: 113-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6261
Averaged Test Accuracy (Prototype Model): 0.6232
Std Test Accuracy (Regular Model): 0.1033
Std Test Accuracy (Prototype Model): 0.1050
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([22.6872, 22.4653, 22.6100, 23.9272, 23.2569, 23.7002, 23.7103, 22.1069,
        22.1069, 23.0601], device='cuda:0')
Server loss: 2.767610549926758
train global classifier
train glclassifier time: 3.701134577393532
global classifier accuracy: 100.0
end Update
server_global_time: 1831.3095503374934
only_train_time: 18293.563597872853

-------------Global Round number: 114-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6251
Averaged Test Accuracy (Prototype Model): 0.6222
Std Test Accuracy (Regular Model): 0.1036
Std Test Accuracy (Prototype Model): 0.1042
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([22.7516, 22.4917, 22.6797, 24.0059, 23.2911, 23.7570, 23.7795, 22.1470,
        22.1470, 23.1283], device='cuda:0')
Server loss: 2.7877373695373535
train global classifier
train glclassifier time: 3.9157641604542732
global classifier accuracy: 100.0
end Update
server_global_time: 1847.1375038325787
only_train_time: 18455.44473322481

-------------Global Round number: 115-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6258
Averaged Test Accuracy (Prototype Model): 0.6220
Std Test Accuracy (Regular Model): 0.1032
Std Test Accuracy (Prototype Model): 0.1044
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 9, 5, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 1, 9, 5, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([22.8109, 22.5557, 22.7355, 24.0683, 23.3818, 23.8181, 23.8304, 22.2193,
        22.2193, 23.1684], device='cuda:0')
Server loss: 2.796052932739258
train global classifier
train glclassifier time: 3.7480119690299034
global classifier accuracy: 100.0
end Update
server_global_time: 1864.0809955596924
only_train_time: 18618.409780099988

-------------Global Round number: 116-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6261
Averaged Test Accuracy (Prototype Model): 0.6226
Std Test Accuracy (Regular Model): 0.1037
Std Test Accuracy (Prototype Model): 0.1054
tobetrained:
[0, 8, 2, 1, 9, 5, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 9 begin training
Edge 5 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([22.8731, 22.6168, 22.8020, 24.1362, 23.4584, 23.8835, 23.9144, 22.2953,
        22.2953, 23.2421], device='cuda:0')
Server loss: 2.7966856956481934
train global classifier
train glclassifier time: 3.9839518517255783
global classifier accuracy: 100.0
end Update
server_global_time: 1880.6990794464946
only_train_time: 18780.27181018889

-------------Global Round number: 117-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6252
Averaged Test Accuracy (Prototype Model): 0.6222
Std Test Accuracy (Regular Model): 0.1045
Std Test Accuracy (Prototype Model): 0.1043
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([22.9223, 22.6848, 22.8625, 24.1753, 23.5272, 23.9273, 23.9727, 22.3571,
        22.3571, 23.3006], device='cuda:0')
Server loss: 2.7854864597320557
train global classifier
train glclassifier time: 3.894283525645733
global classifier accuracy: 100.0
end Update
server_global_time: 1896.6284889876842
only_train_time: 18942.882252447307

-------------Global Round number: 118-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6246
Averaged Test Accuracy (Prototype Model): 0.6225
Std Test Accuracy (Regular Model): 0.1040
Std Test Accuracy (Prototype Model): 0.1044
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([22.9831, 22.7482, 22.9213, 24.2324, 23.5697, 23.9870, 24.0314, 22.4015,
        22.4015, 23.3627], device='cuda:0')
Server loss: 2.7736897468566895
train global classifier
train glclassifier time: 4.839733742177486
global classifier accuracy: 100.0
end Update
server_global_time: 1912.4347775653005
only_train_time: 19105.025629639626

-------------Global Round number: 119-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6248
Averaged Test Accuracy (Prototype Model): 0.6224
Std Test Accuracy (Regular Model): 0.1032
Std Test Accuracy (Prototype Model): 0.1044
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([23.0385, 22.7972, 22.9992, 24.2992, 23.6251, 24.0566, 24.0972, 22.4650,
        22.4650, 23.4340], device='cuda:0')
Server loss: 2.775277853012085
train global classifier
train glclassifier time: 4.1002194210886955
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 1929.4729051813483
only_train_time: 19269.478578403592

-------------Global Round number: 120-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6256
Averaged Test Accuracy (Prototype Model): 0.6234
Std Test Accuracy (Regular Model): 0.1032
Std Test Accuracy (Prototype Model): 0.1044
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([23.1002, 22.8700, 23.0455, 24.3503, 23.6999, 24.1081, 24.1427, 22.5270,
        22.5270, 23.4820], device='cuda:0')
Server loss: 2.776014566421509
train global classifier
train glclassifier time: 4.083575569093227
global classifier accuracy: 100.0
end Update
server_global_time: 1945.3055782690644
only_train_time: 19430.487820252776

-------------Global Round number: 121-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6258
Averaged Test Accuracy (Prototype Model): 0.6231
Std Test Accuracy (Regular Model): 0.1036
Std Test Accuracy (Prototype Model): 0.1062
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([23.1492, 22.9489, 23.1088, 24.3903, 23.7661, 24.1585, 24.2074, 22.6135,
        22.6135, 23.5441], device='cuda:0')
Server loss: 2.766449213027954
train global classifier
train glclassifier time: 4.160304829478264
global classifier accuracy: 100.0
end Update
server_global_time: 1961.4614667147398
only_train_time: 19592.487484522164

-------------Global Round number: 122-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6244
Averaged Test Accuracy (Prototype Model): 0.6220
Std Test Accuracy (Regular Model): 0.1033
Std Test Accuracy (Prototype Model): 0.1039
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([23.2153, 22.9927, 23.1919, 24.4670, 23.8257, 24.2313, 24.2754, 22.6665,
        22.6665, 23.6082], device='cuda:0')
Server loss: 2.772887945175171
train global classifier
train glclassifier time: 4.098600663244724
global classifier accuracy: 100.0
end Update
server_global_time: 1977.2559440135956
only_train_time: 19752.460104338825

-------------Global Round number: 123-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6259
Averaged Test Accuracy (Prototype Model): 0.6231
Std Test Accuracy (Regular Model): 0.1029
Std Test Accuracy (Prototype Model): 0.1051
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([23.2729, 23.0623, 23.2348, 24.5423, 23.8975, 24.2803, 24.3199, 22.7289,
        22.7289, 23.6608], device='cuda:0')
Server loss: 2.775552749633789
train global classifier
train glclassifier time: 3.7163197994232178
global classifier accuracy: 100.0
end Update
server_global_time: 1993.766150303185
only_train_time: 19914.022379793227

-------------Global Round number: 124-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6261
Averaged Test Accuracy (Prototype Model): 0.6222
Std Test Accuracy (Regular Model): 0.1037
Std Test Accuracy (Prototype Model): 0.1051
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[8, 0, 2, 1, 9, 5, 4, 6, 3, 7]
aggregation_buffer:
[8, 0, 2, 1, 9, 5, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([23.2606, 23.0637, 23.2246, 24.5857, 23.9598, 24.2601, 24.2866, 22.7103,
        22.7103, 23.6394], device='cuda:0')
Server loss: 2.8095226287841797
train global classifier
train glclassifier time: 3.734819732606411
global classifier accuracy: 100.0
end Update
server_global_time: 2011.060430392623
only_train_time: 20077.28054717928

-------------Global Round number: 125-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6259
Averaged Test Accuracy (Prototype Model): 0.6221
Std Test Accuracy (Regular Model): 0.1038
Std Test Accuracy (Prototype Model): 0.1053
tobetrained:
[8, 0, 2, 1, 9, 5, 4, 6, 3, 7]
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 1 begin training
Edge 9 begin training
Edge 5 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([23.3637, 23.1732, 23.3431, 24.6404, 24.0056, 24.3852, 24.4273, 22.8354,
        22.8354, 23.7478], device='cuda:0')
Server loss: 2.7695209980010986
train global classifier
train glclassifier time: 4.052842788398266
global classifier accuracy: 100.0
end Update
server_global_time: 2026.9395012110472
only_train_time: 20238.58910611272

-------------Global Round number: 126-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6250
Averaged Test Accuracy (Prototype Model): 0.6230
Std Test Accuracy (Regular Model): 0.1036
Std Test Accuracy (Prototype Model): 0.1054
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([23.4264, 23.2251, 23.4177, 24.7001, 24.0727, 24.4440, 24.4992, 22.9022,
        22.9022, 23.8276], device='cuda:0')
Server loss: 2.774538040161133
train global classifier
train glclassifier time: 4.033946983516216
global classifier accuracy: 100.0
end Update
server_global_time: 2043.8802799284458
only_train_time: 20399.213942460716

-------------Global Round number: 127-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6252
Averaged Test Accuracy (Prototype Model): 0.6224
Std Test Accuracy (Regular Model): 0.1031
Std Test Accuracy (Prototype Model): 0.1052
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([23.4772, 23.2812, 23.4683, 24.7591, 24.1357, 24.5017, 24.5582, 22.9501,
        22.9501, 23.8835], device='cuda:0')
Server loss: 2.776247262954712
train global classifier
train glclassifier time: 4.118580795824528
global classifier accuracy: 100.0
end Update
server_global_time: 2059.784318499267
only_train_time: 20559.267774567008

-------------Global Round number: 128-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6252
Averaged Test Accuracy (Prototype Model): 0.6229
Std Test Accuracy (Regular Model): 0.1024
Std Test Accuracy (Prototype Model): 0.1047
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([23.5443, 23.3476, 23.5403, 24.8372, 24.2173, 24.5774, 24.6257, 23.0328,
        23.0328, 23.9516], device='cuda:0')
Server loss: 2.783466100692749
train global classifier
train glclassifier time: 4.082697249948978
global classifier accuracy: 100.0
end Update
server_global_time: 2076.2040619030595
only_train_time: 20721.99771196395

-------------Global Round number: 129-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6258
Averaged Test Accuracy (Prototype Model): 0.6233
Std Test Accuracy (Regular Model): 0.1036
Std Test Accuracy (Prototype Model): 0.1065
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([23.6173, 23.4203, 23.6014, 24.8947, 24.2753, 24.6426, 24.7019, 23.1114,
        23.1114, 24.0285], device='cuda:0')
Server loss: 2.77797269821167
train global classifier
train glclassifier time: 3.989896923303604
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 2092.8286544531584
only_train_time: 20879.68952448666

-------------Global Round number: 130-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6260
Averaged Test Accuracy (Prototype Model): 0.6230
Std Test Accuracy (Regular Model): 0.1029
Std Test Accuracy (Prototype Model): 0.1052
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([23.6599, 23.4677, 23.6551, 24.9433, 24.3057, 24.6893, 24.7552, 23.1565,
        23.1565, 24.0777], device='cuda:0')
Server loss: 2.773974895477295
train global classifier
train glclassifier time: 3.587904177606106
global classifier accuracy: 100.0
end Update
server_global_time: 2107.946428075433
only_train_time: 21033.474832065403

-------------Global Round number: 131-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6257
Averaged Test Accuracy (Prototype Model): 0.6228
Std Test Accuracy (Regular Model): 0.1033
Std Test Accuracy (Prototype Model): 0.1049
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[8, 0, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[8, 0, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([23.7223, 23.5175, 23.7213, 25.0006, 24.3809, 24.7458, 24.8094, 23.2222,
        23.2222, 24.1464], device='cuda:0')
Server loss: 2.7789862155914307
train global classifier
train glclassifier time: 4.568314515054226
global classifier accuracy: 100.0
end Update
server_global_time: 2123.1900578662753
only_train_time: 21186.606319591403

-------------Global Round number: 132-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6248
Averaged Test Accuracy (Prototype Model): 0.6224
Std Test Accuracy (Regular Model): 0.1032
Std Test Accuracy (Prototype Model): 0.1063
tobetrained:
[8, 0, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([23.7800, 23.5561, 23.7752, 25.0544, 24.4126, 24.7906, 24.8547, 23.2643,
        23.2643, 24.1936], device='cuda:0')
Server loss: 2.792703628540039
train global classifier
train glclassifier time: 4.088145583868027
global classifier accuracy: 100.0
end Update
server_global_time: 2139.664224766195
only_train_time: 21344.79999728501

-------------Global Round number: 133-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6251
Averaged Test Accuracy (Prototype Model): 0.6228
Std Test Accuracy (Regular Model): 0.1031
Std Test Accuracy (Prototype Model): 0.1051
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([23.8194, 23.5869, 23.8293, 25.1049, 24.4689, 24.8437, 24.9226, 23.3141,
        23.3141, 24.2468], device='cuda:0')
Server loss: 2.785273790359497
train global classifier
train glclassifier time: 3.897829107940197
global classifier accuracy: 100.0
end Update
server_global_time: 2156.7658899724483
only_train_time: 21504.428648903966

-------------Global Round number: 134-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6256
Averaged Test Accuracy (Prototype Model): 0.6230
Std Test Accuracy (Regular Model): 0.1030
Std Test Accuracy (Prototype Model): 0.1062
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([23.5601, 23.6086, 23.8723, 25.0808, 24.5382, 24.6295, 24.9711, 23.3687,
        23.3687, 24.2952], device='cuda:0')
Server loss: 2.806406021118164
train global classifier
train glclassifier time: 3.9422710612416267
global classifier accuracy: 100.0
end Update
server_global_time: 2172.1259985491633
only_train_time: 21663.20757459849

-------------Global Round number: 135-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6288
Averaged Test Accuracy (Prototype Model): 0.6268
Std Test Accuracy (Regular Model): 0.1060
Std Test Accuracy (Prototype Model): 0.1093
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[8, 0, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[8, 0, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([23.8219, 23.7162, 23.9319, 25.1858, 24.5914, 24.8667, 25.0168, 23.4324,
        23.4324, 24.3589], device='cuda:0')
Server loss: 2.7778103351593018
train global classifier
train glclassifier time: 3.8558212965726852
global classifier accuracy: 100.0
end Update
server_global_time: 2189.298608146608
only_train_time: 21824.044146746397

-------------Global Round number: 136-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6301
Averaged Test Accuracy (Prototype Model): 0.6278
Std Test Accuracy (Regular Model): 0.1073
Std Test Accuracy (Prototype Model): 0.1098
tobetrained:
[8, 0, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([23.9147, 23.7635, 24.0008, 25.2357, 24.6253, 24.9514, 25.0811, 23.4762,
        23.4762, 24.4019], device='cuda:0')
Server loss: 2.775808334350586
train global classifier
train glclassifier time: 3.840062916278839
global classifier accuracy: 100.0
end Update
server_global_time: 2204.417581036687
only_train_time: 21979.82062636316

-------------Global Round number: 137-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6306
Averaged Test Accuracy (Prototype Model): 0.6267
Std Test Accuracy (Regular Model): 0.1078
Std Test Accuracy (Prototype Model): 0.1094
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([23.9778, 23.8230, 24.0442, 25.2946, 24.6844, 25.0119, 25.1259, 23.5297,
        23.5297, 24.4674], device='cuda:0')
Server loss: 2.776395559310913
train global classifier
train glclassifier time: 3.773369237780571
global classifier accuracy: 100.0
end Update
server_global_time: 2220.7473301514983
only_train_time: 22138.14760374278

-------------Global Round number: 138-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6294
Averaged Test Accuracy (Prototype Model): 0.6273
Std Test Accuracy (Regular Model): 0.1080
Std Test Accuracy (Prototype Model): 0.1098
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([24.0304, 23.8616, 24.0849, 25.3353, 24.7387, 25.0692, 25.1784, 23.5739,
        23.5739, 24.5145], device='cuda:0')
Server loss: 2.785212278366089
train global classifier
train glclassifier time: 4.071511074900627
global classifier accuracy: 100.0
end Update
server_global_time: 2236.5636316239834
only_train_time: 22299.732233308256

-------------Global Round number: 139-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6301
Averaged Test Accuracy (Prototype Model): 0.6277
Std Test Accuracy (Regular Model): 0.1082
Std Test Accuracy (Prototype Model): 0.1098
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([24.1143, 23.9257, 24.1605, 25.3963, 24.7968, 25.1506, 25.2499, 23.6618,
        23.6618, 24.5883], device='cuda:0')
Server loss: 2.7650251388549805
train global classifier
train glclassifier time: 3.6343111991882324
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 2251.7721665352583
only_train_time: 22454.49736148864

-------------Global Round number: 140-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6308
Averaged Test Accuracy (Prototype Model): 0.6267
Std Test Accuracy (Regular Model): 0.1078
Std Test Accuracy (Prototype Model): 0.1093
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[8, 0, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[8, 0, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([24.1663, 23.9762, 24.1957, 25.4537, 24.8486, 25.1935, 25.2496, 23.6992,
        23.6992, 24.6366], device='cuda:0')
Server loss: 2.7774224281311035
train global classifier
train glclassifier time: 4.156771741807461
global classifier accuracy: 100.0
end Update
server_global_time: 2266.8643927946687
only_train_time: 22611.012938156724

-------------Global Round number: 141-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6297
Averaged Test Accuracy (Prototype Model): 0.6268
Std Test Accuracy (Regular Model): 0.1072
Std Test Accuracy (Prototype Model): 0.1087
tobetrained:
[8, 0, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([24.2070, 24.0412, 24.2524, 25.4878, 24.9054, 25.2406, 25.3154, 23.7487,
        23.7487, 24.6794], device='cuda:0')
Server loss: 2.751460313796997
train global classifier
train glclassifier time: 4.066057071089745
global classifier accuracy: 100.0
end Update
server_global_time: 2283.1852722913027
only_train_time: 22766.46136558056

-------------Global Round number: 142-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6296
Averaged Test Accuracy (Prototype Model): 0.6266
Std Test Accuracy (Regular Model): 0.1072
Std Test Accuracy (Prototype Model): 0.1082
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([24.2630, 24.0838, 24.3004, 25.4973, 24.9199, 25.2880, 25.3696, 23.7911,
        23.7911, 24.7231], device='cuda:0')
Server loss: 2.7378485202789307
train global classifier
train glclassifier time: 4.204688623547554
global classifier accuracy: 100.0
end Update
server_global_time: 2298.2454715892673
only_train_time: 22922.488944277167

-------------Global Round number: 143-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6287
Averaged Test Accuracy (Prototype Model): 0.6267
Std Test Accuracy (Regular Model): 0.1077
Std Test Accuracy (Prototype Model): 0.1091
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([24.3234, 24.1228, 24.3420, 25.5711, 24.9777, 25.3452, 25.4363, 23.8540,
        23.8540, 24.7880], device='cuda:0')
Server loss: 2.7492148876190186
train global classifier
train glclassifier time: 3.7801906913518906
global classifier accuracy: 100.0
end Update
server_global_time: 2314.121169283986
only_train_time: 23077.036375574768

-------------Global Round number: 144-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6292
Averaged Test Accuracy (Prototype Model): 0.6266
Std Test Accuracy (Regular Model): 0.1076
Std Test Accuracy (Prototype Model): 0.1093
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([24.3719, 24.1875, 24.4068, 25.6102, 25.0561, 25.4063, 25.4956, 23.9279,
        23.9279, 24.8464], device='cuda:0')
Server loss: 2.7395265102386475
train global classifier
train glclassifier time: 4.121148683130741
global classifier accuracy: 100.0
end Update
server_global_time: 2329.567931868136
only_train_time: 23236.653657719493

-------------Global Round number: 145-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6298
Averaged Test Accuracy (Prototype Model): 0.6266
Std Test Accuracy (Regular Model): 0.1084
Std Test Accuracy (Prototype Model): 0.1086
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([24.4199, 24.2598, 24.4545, 25.6880, 25.1382, 25.4457, 25.5481, 23.9844,
        23.9844, 24.8893], device='cuda:0')
Server loss: 2.7498576641082764
train global classifier
train glclassifier time: 4.108151227235794
global classifier accuracy: 100.0
end Update
server_global_time: 2345.020532168448
only_train_time: 23393.30805630982

-------------Global Round number: 146-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6301
Averaged Test Accuracy (Prototype Model): 0.6264
Std Test Accuracy (Regular Model): 0.1066
Std Test Accuracy (Prototype Model): 0.1085
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 9, 5, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 9, 5, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([24.4705, 24.3105, 24.4995, 25.7651, 25.1914, 25.4909, 25.5919, 24.0402,
        24.0402, 24.9431], device='cuda:0')
Server loss: 2.7713279724121094
train global classifier
train glclassifier time: 3.96334145963192
global classifier accuracy: 100.0
end Update
server_global_time: 2361.603384114802
only_train_time: 23553.760635606945

-------------Global Round number: 147-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6305
Averaged Test Accuracy (Prototype Model): 0.6268
Std Test Accuracy (Regular Model): 0.1082
Std Test Accuracy (Prototype Model): 0.1096
tobetrained:
[0, 8, 2, 1, 9, 5, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 9 begin training
Edge 5 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([24.5146, 24.3797, 24.5535, 25.7991, 25.2306, 25.5523, 25.6455, 24.0912,
        24.0912, 24.9923], device='cuda:0')
Server loss: 2.7452926635742188
train global classifier
train glclassifier time: 3.850439839065075
global classifier accuracy: 100.0
end Update
server_global_time: 2377.019808471203
only_train_time: 23709.828964062035

-------------Global Round number: 148-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6287
Averaged Test Accuracy (Prototype Model): 0.6262
Std Test Accuracy (Regular Model): 0.1070
Std Test Accuracy (Prototype Model): 0.1082
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([24.5803, 24.4172, 24.6360, 25.8670, 25.2933, 25.6202, 25.7222, 24.1696,
        24.1696, 25.0623], device='cuda:0')
Server loss: 2.7670395374298096
train global classifier
train glclassifier time: 3.917589172720909
global classifier accuracy: 100.0
end Update
server_global_time: 2392.564505830407
only_train_time: 23866.250875249505

-------------Global Round number: 149-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6299
Averaged Test Accuracy (Prototype Model): 0.6268
Std Test Accuracy (Regular Model): 0.1074
Std Test Accuracy (Prototype Model): 0.1090
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
