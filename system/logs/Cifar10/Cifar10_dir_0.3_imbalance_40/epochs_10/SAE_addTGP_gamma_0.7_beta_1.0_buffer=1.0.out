==================================================
goal = test
device = cuda
device_id = 0
dataset = Cifar10_dir_0.3_imbalance_40
num_classes = 10
model_family = HtFE8
batch_size = 256
local_learning_rate = 0.06
use_decay_scheduler = False
learning_rate_decay = False
learning_rate_decay_gamma = 0.99
global_rounds = 200
edge_epochs = 1
local_epochs = 10
algorithm = FedSAE
join_ratio = 1.0
random_join_ratio = False
num_clients = 40
num_edges = 10
prev = 0
times = 1
eval_gap = 1
save_folder_name = temp
auto_break = False
feature_dim = 512
vocab_size = 98635
max_len = 200
client_drop_rate = 0.0
train_slow_rate = 0.0
send_slow_rate = 0.0
time_select = False
time_threthold = 10000
lamda = 2
trans_delay_simulate = False
agg_type = 0
buffersize = 10
mixclassifier = 0
test_useglclassifier = 0
gamma = 0.7
use_beta = True
SAEbeta = 1.0
addTGP = True
drawtsne = True
drawround = 10
noise_dim = 512
generator_learning_rate = 0.005
hidden_dim = 512
server_epochs = 100
alpha = 1.0
beta = 1.0
mentee_learning_rate = 0.005
T_start = 0.95
T_end = 0.98
server_learning_rate = 0.01
margin_threthold = 100.0
generator_path = stylegan/stylegan-xl-models/imagenet64.pkl
stable_diffusion_prompt = a cat
server_batch_size = 100
gen_batch_size = 4
mu = 50.0
==================================================
Random seed set as 42

============= Running time: 0th =============
Creating server and clients ...
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600)
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes)
mobilenet_v2(pretrained=False, num_classes=args.num_classes)
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes)
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes)
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes)
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes)
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes)
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600) model chosen!
id 0
label_counts: defaultdict(<class 'int'>, {3: 400, 7: 347, 1: 47, 4: 179, 6: 87, 8: 41, 0: 2, 9: 2, 5: 2, 2: 1})
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes) model chosen!
id 1
label_counts: defaultdict(<class 'int'>, {2: 855, 4: 327, 0: 5, 3: 3})
mobilenet_v2(pretrained=False, num_classes=args.num_classes) model chosen!
id 2
label_counts: defaultdict(<class 'int'>, {6: 36, 5: 141, 8: 162, 9: 71, 4: 177, 2: 95, 0: 23, 1: 9, 7: 49, 3: 2})
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes) model chosen!
id 3
label_counts: defaultdict(<class 'int'>, {9: 347, 5: 394, 7: 415, 4: 88, 0: 3, 2: 15, 8: 32})
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes) model chosen!
id 4
label_counts: defaultdict(<class 'int'>, {3: 83, 2: 591, 5: 234, 8: 172, 4: 18, 7: 30, 0: 18, 1: 3})
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes) model chosen!
id 5
label_counts: defaultdict(<class 'int'>, {5: 565, 0: 841, 1: 70, 3: 35})
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes) model chosen!
id 6
label_counts: defaultdict(<class 'int'>, {3: 381, 6: 154, 8: 143, 1: 15, 9: 43, 0: 93, 4: 2, 7: 1, 2: 1})
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes) model chosen!
id 7
label_counts: defaultdict(<class 'int'>, {9: 1519, 4: 349, 7: 79, 3: 115, 0: 78, 2: 76, 5: 29, 1: 6, 6: 1})
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600) model chosen!
id 8
label_counts: defaultdict(<class 'int'>, {3: 83, 2: 115, 8: 161, 4: 425, 7: 92, 1: 15, 6: 5, 9: 10, 0: 4, 5: 2})
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes) model chosen!
id 9
label_counts: defaultdict(<class 'int'>, {5: 7, 1: 64, 7: 286, 4: 95, 3: 14, 2: 80, 9: 28, 0: 7})
mobilenet_v2(pretrained=False, num_classes=args.num_classes) model chosen!
id 10
label_counts: defaultdict(<class 'int'>, {8: 906, 0: 830, 4: 108, 5: 5, 2: 10, 6: 6, 1: 17, 3: 11})
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes) model chosen!
id 11
label_counts: defaultdict(<class 'int'>, {1: 227, 8: 208, 2: 238, 9: 48, 3: 16, 4: 1, 7: 8, 6: 2, 5: 2})
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes) model chosen!
id 12
label_counts: defaultdict(<class 'int'>, {6: 681, 1: 47, 0: 50, 4: 354, 3: 4, 2: 2, 5: 1})
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes) model chosen!
id 13
label_counts: defaultdict(<class 'int'>, {6: 426, 4: 10, 0: 464, 3: 90, 2: 271, 1: 67})
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes) model chosen!
id 14
label_counts: defaultdict(<class 'int'>, {5: 746, 1: 509, 4: 104, 3: 17, 0: 30, 2: 1})
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes) model chosen!
id 15
label_counts: defaultdict(<class 'int'>, {4: 973, 2: 843, 1: 155, 0: 75, 3: 45})
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600) model chosen!
id 16
label_counts: defaultdict(<class 'int'>, {3: 448, 9: 202, 4: 43, 5: 71, 6: 120, 8: 77, 0: 8, 1: 2})
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes) model chosen!
id 17
label_counts: defaultdict(<class 'int'>, {3: 84, 7: 978, 2: 130, 6: 42, 4: 48, 0: 8, 5: 9})
mobilenet_v2(pretrained=False, num_classes=args.num_classes) model chosen!
id 18
label_counts: defaultdict(<class 'int'>, {0: 260, 1: 196, 4: 82, 5: 179, 3: 53, 8: 51, 7: 8, 6: 3, 2: 2})
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes) model chosen!
id 19
label_counts: defaultdict(<class 'int'>, {1: 456, 8: 150, 3: 7, 9: 86, 2: 46, 6: 20, 5: 56, 7: 10})
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes) model chosen!
id 20
label_counts: defaultdict(<class 'int'>, {0: 218, 6: 242, 4: 48, 8: 358, 7: 24, 3: 362, 2: 17, 5: 6})
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes) model chosen!
id 21
label_counts: defaultdict(<class 'int'>, {3: 93, 0: 436, 1: 276, 4: 131, 8: 33, 2: 72, 5: 44, 9: 2, 6: 2})
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes) model chosen!
id 22
label_counts: defaultdict(<class 'int'>, {8: 459, 6: 159, 3: 97, 9: 131, 1: 82, 5: 64, 7: 22, 4: 2, 2: 1})
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes) model chosen!
id 23
label_counts: defaultdict(<class 'int'>, {2: 510, 1: 205, 0: 170, 3: 373})
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600) model chosen!
id 24
label_counts: defaultdict(<class 'int'>, {7: 407, 4: 111, 2: 21, 8: 68, 6: 231, 1: 151, 9: 44, 3: 19, 0: 4})
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes) model chosen!
id 25
label_counts: defaultdict(<class 'int'>, {7: 336, 1: 353, 6: 83, 5: 197, 4: 100, 2: 11, 0: 2, 3: 29, 8: 3, 9: 2})
mobilenet_v2(pretrained=False, num_classes=args.num_classes) model chosen!
id 26
label_counts: defaultdict(<class 'int'>, {3: 116, 9: 885, 0: 276, 5: 59, 8: 57, 1: 18, 4: 3, 6: 2})
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes) model chosen!
id 27
label_counts: defaultdict(<class 'int'>, {6: 360, 9: 54, 4: 28, 1: 24, 5: 140, 2: 15, 3: 12})
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes) model chosen!
id 28
label_counts: defaultdict(<class 'int'>, {8: 31, 5: 486, 0: 87, 4: 71, 1: 148, 2: 2, 7: 29, 6: 12, 3: 1})
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes) model chosen!
id 29
label_counts: defaultdict(<class 'int'>, {5: 380, 7: 932, 3: 54, 1: 46, 6: 48, 4: 10, 2: 10})
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes) model chosen!
id 30
label_counts: defaultdict(<class 'int'>, {3: 724, 6: 555, 0: 95, 5: 89, 4: 8, 2: 19, 1: 1})
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes) model chosen!
id 31
label_counts: defaultdict(<class 'int'>, {7: 52, 9: 201, 1: 130, 0: 185, 4: 61, 6: 65, 5: 41, 2: 12, 3: 7})
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600) model chosen!
id 32
label_counts: defaultdict(<class 'int'>, {5: 339, 6: 11, 8: 81, 9: 53, 2: 65, 3: 3, 0: 33, 1: 9, 7: 1})
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes) model chosen!
id 33
label_counts: defaultdict(<class 'int'>, {4: 82, 1: 688, 6: 249, 0: 10, 8: 63, 7: 39, 5: 32, 2: 2})
mobilenet_v2(pretrained=False, num_classes=args.num_classes) model chosen!
id 34
label_counts: defaultdict(<class 'int'>, {8: 782, 1: 196, 6: 180, 3: 124, 2: 5, 4: 26, 7: 25})
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes) model chosen!
id 35
label_counts: defaultdict(<class 'int'>, {2: 255, 9: 362, 8: 12, 7: 151, 3: 64, 0: 69, 6: 20, 1: 7, 4: 8})
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes) model chosen!
id 36
label_counts: defaultdict(<class 'int'>, {5: 152, 8: 159, 7: 10, 4: 109, 9: 83, 1: 70, 2: 15, 0: 1})
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes) model chosen!
id 37
label_counts: defaultdict(<class 'int'>, {1: 171, 3: 58, 6: 519, 0: 116, 4: 82, 5: 16, 7: 10, 9: 20, 2: 10})
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes) model chosen!
id 38
label_counts: defaultdict(<class 'int'>, {6: 156, 3: 111, 1: 29, 2: 125, 7: 141, 8: 27, 9: 20, 0: 6, 5: 29})
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes) model chosen!
id 39
label_counts: defaultdict(<class 'int'>, {9: 312, 3: 345, 8: 216, 4: 217, 0: 3, 7: 4, 5: 5, 1: 1, 2: 1})

Join ratio / total clients: 1.0 / 40
Finished creating server and clients.
Trainable_prototypes(
  (embedings): Embedding(10, 512)
  (middle): Sequential(
    (0): Sequential(
      (0): Linear(in_features=512, out_features=512, bias=True)
      (1): ReLU()
    )
  )
  (fc): Linear(in_features=512, out_features=512, bias=True)
)
tobetrained:
[9, 8, 7, 6, 5, 4, 3, 2, 1, 0]
Edge 9 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_5 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_31 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_13 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_0 protos Not Found
Client_5 prev_protos Not Found
Client_0 prev_protos Not Found
Client_13 prev_protos Not Found
Client_31 prev_protos Not Found
Edge 8 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_16 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_1 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_26 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_36 protos Not Found
Client_26 prev_protos Not Found
Client_36 prev_protos Not Found
Client_1 prev_protos Not Found
Client_16 prev_protos Not Found
Edge 7 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_24 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_7 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_27 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_2 protos Not Found
Client_2 prev_protos Not Found
Client_24 prev_protos Not Found
Client_27 prev_protos Not Found
Client_7 prev_protos Not Found
Edge 6 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_32 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_38 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_8 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_23 protos Not Found
Client_38 prev_protos Not Found
Client_23 prev_protos Not Found
Client_8 prev_protos Not Found
Client_32 prev_protos Not Found
Edge 5 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_9 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_33 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_29 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_6 protos Not Found
Client_29 prev_protos Not Found
Client_6 prev_protos Not Found
Client_9 prev_protos Not Found
Client_33 prev_protos Not Found
Edge 4 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_30 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_10 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_18 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_17 protos Not Found
Client_30 prev_protos Not Found
Client_17 prev_protos Not Found
Client_18 prev_protos Not Found
Client_10 prev_protos Not Found
Edge 3 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_14 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_15 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_39 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_35 protos Not Found
Client_14 prev_protos Not Found
Client_39 prev_protos Not Found
Client_15 prev_protos Not Found
Client_35 prev_protos Not Found
Edge 2 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_21 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_3 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_19 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_11 protos Not Found
Client_21 prev_protos Not Found
Client_11 prev_protos Not Found
Client_19 prev_protos Not Found
Client_3 prev_protos Not Found
Edge 1 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_12 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_20 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_22 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_25 protos Not Found
Client_25 prev_protos Not Found
Client_22 prev_protos Not Found
Client_20 prev_protos Not Found
Client_12 prev_protos Not Found
Edge 0 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_37 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_34 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_28 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_4 protos Not Found
Client_4 prev_protos Not Found
Client_28 prev_protos Not Found
Client_37 prev_protos Not Found
Client_34 prev_protos Not Found
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
Edge_0 prev_protos Not Found
Edge_1 prev_protos Not Found
Edge_2 prev_protos Not Found
Edge_3 prev_protos Not Found
Edge_4 prev_protos Not Found
Edge_5 prev_protos Not Found
Edge_6 prev_protos Not Found
Edge_7 prev_protos Not Found
Edge_8 prev_protos Not Found
Edge_9 prev_protos Not Found
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([3.9864, 2.5491, 2.2446, 2.0699, 3.4147, 2.7722, 2.3389, 2.0699, 2.6666,
        3.1330], device='cuda:0')
Server loss: 5.8171234130859375
train global classifier
train glclassifier time: 3.8309178054332733
global classifier accuracy: 97.3525
Number of samples: 326
end Update
server_global_time: 15.0001727566123
only_train_time: 141.29920199513435

-------------Global Round number: 0-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.5744
Averaged Test Accuracy (Prototype Model): 0.2396
Std Test Accuracy (Regular Model): 0.1344
Std Test Accuracy (Prototype Model): 0.1949
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 9, 5, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 1, 9, 5, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([4.1198, 3.2973, 2.8628, 2.9056, 2.6568, 3.2490, 3.1160, 2.6568, 3.2195,
        3.3814], device='cuda:0')
Server loss: 4.295659065246582
train global classifier
train glclassifier time: 5.29584089666605
global classifier accuracy: 99.8375
end Update
server_global_time: 32.25860522687435
only_train_time: 309.425426453352

-------------Global Round number: 1-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6244
Averaged Test Accuracy (Prototype Model): 0.5328
Std Test Accuracy (Regular Model): 0.1155
Std Test Accuracy (Prototype Model): 0.1750
tobetrained:
[0, 8, 2, 1, 9, 5, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 9 begin training
Edge 5 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([6.8403, 5.1052, 3.9751, 4.2830, 3.6209, 5.2278, 4.7857, 3.6209, 4.3645,
        5.3303], device='cuda:0')
Server loss: 5.0243048667907715
train global classifier
train glclassifier time: 3.671543814241886
global classifier accuracy: 99.9425
end Update
server_global_time: 48.376146487891674
only_train_time: 471.74571438878775

-------------Global Round number: 2-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6309
Averaged Test Accuracy (Prototype Model): 0.5728
Std Test Accuracy (Regular Model): 0.0985
Std Test Accuracy (Prototype Model): 0.1308
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([8.8983, 7.0931, 5.6710, 6.3322, 5.0142, 7.5224, 6.8093, 5.0142, 6.0571,
        7.3642], device='cuda:0')
Server loss: 5.211911201477051
train global classifier
train glclassifier time: 3.6013768762350082
global classifier accuracy: 99.9275
end Update
server_global_time: 64.58662427961826
only_train_time: 633.625440761447

-------------Global Round number: 3-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6363
Averaged Test Accuracy (Prototype Model): 0.5915
Std Test Accuracy (Regular Model): 0.0952
Std Test Accuracy (Prototype Model): 0.1046
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.3170,  8.6351,  7.4331,  8.0552,  6.5701,  9.4669,  8.5406,  6.5701,
         7.5235,  8.9276], device='cuda:0')
Server loss: 4.9812798500061035
train global classifier
train glclassifier time: 3.7519137412309647
global classifier accuracy: 99.95
end Update
server_global_time: 80.4796894043684
only_train_time: 793.555492438376

-------------Global Round number: 4-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6390
Averaged Test Accuracy (Prototype Model): 0.6011
Std Test Accuracy (Regular Model): 0.0960
Std Test Accuracy (Prototype Model): 0.0946
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.4684,  9.8357,  9.2485,  9.4394,  7.9738, 10.9801,  9.9142,  7.9738,
         8.6728, 10.1730], device='cuda:0')
Server loss: 4.75040864944458
train global classifier
train glclassifier time: 3.6835174411535263
global classifier accuracy: 99.9875
end Update
server_global_time: 96.3501937314868
only_train_time: 954.838467054069

-------------Global Round number: 5-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6396
Averaged Test Accuracy (Prototype Model): 0.6059
Std Test Accuracy (Regular Model): 0.0985
Std Test Accuracy (Prototype Model): 0.0993
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 9, 5, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 9, 5, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([12.2318, 10.6781, 10.4632, 10.5114,  8.9810, 12.1686, 10.9248,  8.9810,
         9.4976, 11.0869], device='cuda:0')
Server loss: 4.540585041046143
train global classifier
train glclassifier time: 3.781363032758236
global classifier accuracy: 99.98
end Update
server_global_time: 112.15154127776623
only_train_time: 1113.5574090629816

-------------Global Round number: 6-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6376
Averaged Test Accuracy (Prototype Model): 0.6056
Std Test Accuracy (Regular Model): 0.0987
Std Test Accuracy (Prototype Model): 0.0979
tobetrained:
[0, 8, 2, 1, 9, 5, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 9 begin training
Edge 5 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([12.9800, 11.5064, 11.6116, 11.6602, 10.0918, 13.0324, 11.7995, 10.0918,
        10.3545, 11.9393], device='cuda:0')
Server loss: 4.335594654083252
train global classifier
train glclassifier time: 3.642778053879738
global classifier accuracy: 99.995
end Update
server_global_time: 128.0340062752366
only_train_time: 1272.8431835919619

-------------Global Round number: 7-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6368
Averaged Test Accuracy (Prototype Model): 0.6091
Std Test Accuracy (Regular Model): 0.0976
Std Test Accuracy (Prototype Model): 0.0964
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([13.5358, 12.1176, 12.3385, 12.4272, 10.9464, 13.7945, 12.5467, 10.9464,
        10.9827, 12.6202], device='cuda:0')
Server loss: 4.258199214935303
train global classifier
train glclassifier time: 3.605437569320202
global classifier accuracy: 99.995
end Update
server_global_time: 143.7577264904976
only_train_time: 1432.0414244905114

-------------Global Round number: 8-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6378
Averaged Test Accuracy (Prototype Model): 0.6115
Std Test Accuracy (Regular Model): 0.0995
Std Test Accuracy (Prototype Model): 0.1007
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([14.0799, 12.6159, 12.8487, 13.2267, 11.6007, 14.2810, 13.2688, 11.4018,
        11.4018, 12.8827], device='cuda:0')
Server loss: 4.324178218841553
train global classifier
train glclassifier time: 3.7953888550400734
global classifier accuracy: 99.9975
end Update
server_global_time: 159.82779712975025
only_train_time: 1591.0853787139058

-------------Global Round number: 9-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6364
Averaged Test Accuracy (Prototype Model): 0.6120
Std Test Accuracy (Regular Model): 0.1026
Std Test Accuracy (Prototype Model): 0.1005
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([14.5289, 13.1982, 13.5077, 13.8807, 12.3137, 14.9685, 13.8536, 12.0487,
        12.0487, 13.6747], device='cuda:0')
Server loss: 4.137277603149414
train global classifier
train glclassifier time: 3.7503084391355515
global classifier accuracy: 99.9975
Number of samples: 326
end Update
server_global_time: 176.4921152740717
only_train_time: 1753.5661021992564

-------------Global Round number: 10-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6362
Averaged Test Accuracy (Prototype Model): 0.6120
Std Test Accuracy (Regular Model): 0.0995
Std Test Accuracy (Prototype Model): 0.0971
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([14.9267, 13.6543, 13.9867, 14.4594, 12.9197, 15.4730, 14.3596, 12.5366,
        12.5366, 14.1797], device='cuda:0')
Server loss: 4.079369068145752
train global classifier
train glclassifier time: 3.7615967765450478
global classifier accuracy: 100.0
end Update
server_global_time: 193.24912648648024
only_train_time: 1920.3906306996942

-------------Global Round number: 11-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6357
Averaged Test Accuracy (Prototype Model): 0.6123
Std Test Accuracy (Regular Model): 0.0982
Std Test Accuracy (Prototype Model): 0.0974
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([15.3015, 14.0587, 14.3844, 14.9634, 13.3847, 15.8882, 14.8115, 12.9662,
        12.9662, 14.6031], device='cuda:0')
Server loss: 4.013972759246826
train global classifier
train glclassifier time: 3.744380034506321
global classifier accuracy: 100.0
end Update
server_global_time: 209.9878844693303
only_train_time: 2081.9215679988265

-------------Global Round number: 12-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6364
Averaged Test Accuracy (Prototype Model): 0.6125
Std Test Accuracy (Regular Model): 0.0990
Std Test Accuracy (Prototype Model): 0.0969
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([15.6227, 14.4362, 14.7596, 15.4354, 13.8295, 16.2832, 15.2517, 13.3440,
        13.3440, 14.9898], device='cuda:0')
Server loss: 3.9553730487823486
train global classifier
train glclassifier time: 3.6554455384612083
global classifier accuracy: 99.9975
end Update
server_global_time: 225.684455960989
only_train_time: 2240.4579389095306

-------------Global Round number: 13-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6360
Averaged Test Accuracy (Prototype Model): 0.6129
Std Test Accuracy (Regular Model): 0.0989
Std Test Accuracy (Prototype Model): 0.0966
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([15.9396, 14.7729, 15.1059, 15.8677, 14.2460, 16.6428, 15.6415, 13.7212,
        13.7212, 15.3469], device='cuda:0')
Server loss: 3.9105560779571533
train global classifier
train glclassifier time: 3.7583328783512115
global classifier accuracy: 100.0
end Update
server_global_time: 242.2849604561925
only_train_time: 2403.7461376562715

-------------Global Round number: 14-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6355
Averaged Test Accuracy (Prototype Model): 0.6143
Std Test Accuracy (Regular Model): 0.0991
Std Test Accuracy (Prototype Model): 0.0974
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([16.2137, 15.0963, 15.4184, 16.2911, 14.6226, 16.9651, 16.0247, 14.0635,
        14.0635, 15.6876], device='cuda:0')
Server loss: 3.8523635864257812
train global classifier
train glclassifier time: 3.8830272033810616
global classifier accuracy: 100.0
end Update
server_global_time: 258.54431165754795
only_train_time: 2568.4093079566956

-------------Global Round number: 15-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6348
Averaged Test Accuracy (Prototype Model): 0.6129
Std Test Accuracy (Regular Model): 0.1013
Std Test Accuracy (Prototype Model): 0.0987
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([16.4637, 15.3788, 15.6905, 16.6596, 14.9248, 17.2612, 16.3575, 14.3514,
        14.3514, 15.9784], device='cuda:0')
Server loss: 3.8056395053863525
train global classifier
train glclassifier time: 3.9807204008102417
global classifier accuracy: 100.0
end Update
server_global_time: 275.96232321858406
only_train_time: 2734.4332885220647

-------------Global Round number: 16-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6348
Averaged Test Accuracy (Prototype Model): 0.6129
Std Test Accuracy (Regular Model): 0.1014
Std Test Accuracy (Prototype Model): 0.0994
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([16.7252, 15.6568, 15.9498, 16.9837, 15.2484, 17.5306, 16.6904, 14.6479,
        14.6479, 16.2595], device='cuda:0')
Server loss: 3.7537124156951904
train global classifier
train glclassifier time: 4.102095857262611
global classifier accuracy: 100.0
end Update
server_global_time: 291.7311722487211
only_train_time: 2896.5796301066875

-------------Global Round number: 17-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6329
Averaged Test Accuracy (Prototype Model): 0.6131
Std Test Accuracy (Regular Model): 0.1017
Std Test Accuracy (Prototype Model): 0.1001
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([16.9561, 15.9148, 16.2030, 17.3230, 15.5330, 17.7898, 16.9908, 14.9150,
        14.9150, 16.5206], device='cuda:0')
Server loss: 3.7070908546447754
train global classifier
train glclassifier time: 3.6153247356414795
global classifier accuracy: 100.0
end Update
server_global_time: 307.18958996236324
only_train_time: 3057.455716431141

-------------Global Round number: 18-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6332
Averaged Test Accuracy (Prototype Model): 0.6123
Std Test Accuracy (Regular Model): 0.1019
Std Test Accuracy (Prototype Model): 0.1021
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([17.1762, 16.1488, 16.4296, 17.5082, 15.8056, 18.0261, 17.2330, 15.1710,
        15.1710, 16.7401], device='cuda:0')
Server loss: 3.701953887939453
train global classifier
train glclassifier time: 3.6316714957356453
global classifier accuracy: 100.0
end Update
server_global_time: 322.874766305089
only_train_time: 3216.087708607316

-------------Global Round number: 19-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6288
Averaged Test Accuracy (Prototype Model): 0.6109
Std Test Accuracy (Regular Model): 0.1025
Std Test Accuracy (Prototype Model): 0.1009
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([17.1522, 16.2718, 16.5422, 17.4971, 15.5292, 18.1141, 17.4330, 15.3144,
        15.3144, 16.0033], device='cuda:0')
Server loss: 3.9473140239715576
train global classifier
train glclassifier time: 3.7083215713500977
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 338.7008329182863
only_train_time: 3376.7528430223465

-------------Global Round number: 20-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6317
Averaged Test Accuracy (Prototype Model): 0.6131
Std Test Accuracy (Regular Model): 0.1021
Std Test Accuracy (Prototype Model): 0.1034
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([17.5191, 16.5670, 16.8225, 18.1062, 16.2190, 18.4367, 17.7796, 15.6329,
        15.6329, 16.8897], device='cuda:0')
Server loss: 3.6610450744628906
train global classifier
train glclassifier time: 3.691698521375656
global classifier accuracy: 100.0
end Update
server_global_time: 355.2452952489257
only_train_time: 3536.0687755197287

-------------Global Round number: 21-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6328
Averaged Test Accuracy (Prototype Model): 0.6139
Std Test Accuracy (Regular Model): 0.1036
Std Test Accuracy (Prototype Model): 0.1024
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([17.7367, 16.7708, 17.0217, 18.3799, 16.5009, 18.6592, 18.0015, 15.8279,
        15.8279, 17.2653], device='cuda:0')
Server loss: 3.599276065826416
train global classifier
train glclassifier time: 4.150734439492226
global classifier accuracy: 100.0
end Update
server_global_time: 372.2030402198434
only_train_time: 3696.134199768305

-------------Global Round number: 22-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6328
Averaged Test Accuracy (Prototype Model): 0.6139
Std Test Accuracy (Regular Model): 0.1033
Std Test Accuracy (Prototype Model): 0.1032
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([17.9251, 16.9671, 17.2134, 18.6347, 16.7369, 18.8571, 18.2385, 16.0586,
        16.0586, 17.5439], device='cuda:0')
Server loss: 3.553971529006958
train global classifier
train glclassifier time: 4.658257327973843
global classifier accuracy: 100.0
end Update
server_global_time: 388.39912647753954
only_train_time: 3857.7698996663094

-------------Global Round number: 23-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6314
Averaged Test Accuracy (Prototype Model): 0.6143
Std Test Accuracy (Regular Model): 0.1034
Std Test Accuracy (Prototype Model): 0.1039
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([18.0978, 17.1507, 17.3937, 18.8560, 16.9448, 19.0465, 18.4315, 16.2540,
        16.2540, 17.7723], device='cuda:0')
Server loss: 3.5211048126220703
train global classifier
train glclassifier time: 3.7450114339590073
global classifier accuracy: 100.0
end Update
server_global_time: 405.28571593016386
only_train_time: 4018.115137346089

-------------Global Round number: 24-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6312
Averaged Test Accuracy (Prototype Model): 0.6139
Std Test Accuracy (Regular Model): 0.1042
Std Test Accuracy (Prototype Model): 0.1040
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([18.2632, 17.3335, 17.5529, 19.0549, 17.1487, 19.2266, 18.6201, 16.4394,
        16.4394, 17.9638], device='cuda:0')
Server loss: 3.5047249794006348
train global classifier
train glclassifier time: 4.692741364240646
global classifier accuracy: 100.0
end Update
server_global_time: 420.87899865210056
only_train_time: 4175.446268849075

-------------Global Round number: 25-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6306
Averaged Test Accuracy (Prototype Model): 0.6145
Std Test Accuracy (Regular Model): 0.1036
Std Test Accuracy (Prototype Model): 0.1052
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([18.4238, 17.5069, 17.7284, 19.2659, 17.3554, 19.3934, 18.8070, 16.6226,
        16.6226, 18.1506], device='cuda:0')
Server loss: 3.4680287837982178
train global classifier
train glclassifier time: 3.6945521235466003
global classifier accuracy: 100.0
end Update
server_global_time: 436.89137525111437
only_train_time: 4333.787392966449

-------------Global Round number: 26-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6294
Averaged Test Accuracy (Prototype Model): 0.6142
Std Test Accuracy (Regular Model): 0.1034
Std Test Accuracy (Prototype Model): 0.1056
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([18.5630, 17.5088, 17.8386, 19.4476, 17.5225, 19.5079, 18.9360, 16.7530,
        16.7530, 18.1991], device='cuda:0')
Server loss: 3.503932476043701
train global classifier
train glclassifier time: 3.7588832676410675
global classifier accuracy: 100.0
end Update
server_global_time: 452.4624331817031
only_train_time: 4494.031347721815

-------------Global Round number: 27-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6257
Averaged Test Accuracy (Prototype Model): 0.6085
Std Test Accuracy (Regular Model): 0.1078
Std Test Accuracy (Prototype Model): 0.1126
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([18.6922, 17.7068, 17.9839, 19.6144, 17.6879, 19.6597, 19.0916, 16.9164,
        16.9164, 18.4234], device='cuda:0')
Server loss: 3.4361047744750977
train global classifier
train glclassifier time: 3.9584966897964478
global classifier accuracy: 100.0
end Update
server_global_time: 468.9757885783911
only_train_time: 4653.489015363157

-------------Global Round number: 28-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6296
Averaged Test Accuracy (Prototype Model): 0.6138
Std Test Accuracy (Regular Model): 0.1033
Std Test Accuracy (Prototype Model): 0.1058
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([18.8315, 17.8982, 18.1468, 19.7882, 17.8577, 19.8114, 19.2811, 17.0964,
        17.0964, 18.6092], device='cuda:0')
Server loss: 3.393493890762329
train global classifier
train glclassifier time: 3.8515392914414406
global classifier accuracy: 100.0
end Update
server_global_time: 484.6050904095173
only_train_time: 4812.808450251818

-------------Global Round number: 29-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6292
Averaged Test Accuracy (Prototype Model): 0.6136
Std Test Accuracy (Regular Model): 0.1030
Std Test Accuracy (Prototype Model): 0.1063
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([18.9619, 18.0631, 18.2938, 19.9446, 18.0170, 19.9705, 19.4310, 17.2491,
        17.2491, 18.7690], device='cuda:0')
Server loss: 3.3859095573425293
train global classifier
train glclassifier time: 3.8364380672574043
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 501.23023437708616
only_train_time: 4971.090723969042

-------------Global Round number: 30-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6295
Averaged Test Accuracy (Prototype Model): 0.6142
Std Test Accuracy (Regular Model): 0.1034
Std Test Accuracy (Prototype Model): 0.1069
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([19.0746, 18.2027, 18.4201, 20.0967, 18.1585, 20.0897, 19.5817, 17.3912,
        17.3912, 18.9124], device='cuda:0')
Server loss: 3.362138509750366
train global classifier
train glclassifier time: 3.943853460252285
global classifier accuracy: 100.0
end Update
server_global_time: 516.297674998641
only_train_time: 5127.605054058135

-------------Global Round number: 31-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6290
Averaged Test Accuracy (Prototype Model): 0.6133
Std Test Accuracy (Regular Model): 0.1036
Std Test Accuracy (Prototype Model): 0.1050
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 2, 8, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 1, 5, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([19.2026, 18.3425, 18.5353, 20.2396, 18.3259, 20.2213, 19.7040, 17.5150,
        17.5150, 19.0441], device='cuda:0')
Server loss: 3.3537111282348633
train global classifier
train glclassifier time: 3.6385990604758263
global classifier accuracy: 100.0
end Update
server_global_time: 531.7438991740346
only_train_time: 5284.1778394803405

-------------Global Round number: 32-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6292
Averaged Test Accuracy (Prototype Model): 0.6147
Std Test Accuracy (Regular Model): 0.1035
Std Test Accuracy (Prototype Model): 0.1060
tobetrained:
[0, 2, 8, 1, 5, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([19.3225, 18.4795, 18.6634, 20.3883, 18.4812, 20.3454, 19.8568, 17.6615,
        17.6615, 19.1795], device='cuda:0')
Server loss: 3.3451087474823
train global classifier
train glclassifier time: 3.9446990489959717
global classifier accuracy: 100.0
end Update
server_global_time: 548.6622409969568
only_train_time: 5445.443080887198

-------------Global Round number: 33-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6292
Averaged Test Accuracy (Prototype Model): 0.6144
Std Test Accuracy (Regular Model): 0.1041
Std Test Accuracy (Prototype Model): 0.1056
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([19.4524, 18.6234, 18.7990, 20.5420, 18.6347, 20.4738, 19.9966, 17.8083,
        17.8083, 19.3237], device='cuda:0')
Server loss: 3.34731388092041
train global classifier
train glclassifier time: 3.8783497139811516
global classifier accuracy: 100.0
end Update
server_global_time: 564.191387347877
only_train_time: 5601.682563714683

-------------Global Round number: 34-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6299
Averaged Test Accuracy (Prototype Model): 0.6141
Std Test Accuracy (Regular Model): 0.1041
Std Test Accuracy (Prototype Model): 0.1058
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([19.4160, 18.6626, 18.5278, 20.4850, 18.3583, 20.3917, 19.8608, 17.5300,
        17.5300, 19.2131], device='cuda:0')
Server loss: 3.4517662525177
train global classifier
train glclassifier time: 3.866191402077675
global classifier accuracy: 100.0
end Update
server_global_time: 580.2105982378125
only_train_time: 5761.089338801801

-------------Global Round number: 35-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6284
Averaged Test Accuracy (Prototype Model): 0.6136
Std Test Accuracy (Regular Model): 0.1044
Std Test Accuracy (Prototype Model): 0.1051
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([19.5324, 18.8144, 18.7299, 20.7121, 18.6929, 20.5318, 20.0138, 17.7222,
        17.7222, 19.3482], device='cuda:0')
Server loss: 3.4437952041625977
train global classifier
train glclassifier time: 3.8722497522830963
global classifier accuracy: 100.0
end Update
server_global_time: 596.0911837667227
only_train_time: 5921.340064793825

-------------Global Round number: 36-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6284
Averaged Test Accuracy (Prototype Model): 0.6133
Std Test Accuracy (Regular Model): 0.1050
Std Test Accuracy (Prototype Model): 0.1054
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([19.6515, 18.9465, 18.8708, 20.8621, 18.8962, 20.6587, 20.1412, 17.8686,
        17.8686, 19.4909], device='cuda:0')
Server loss: 3.4260494709014893
train global classifier
train glclassifier time: 3.8415918350219727
global classifier accuracy: 100.0
end Update
server_global_time: 611.80343375355
only_train_time: 6079.211716070771

-------------Global Round number: 37-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6282
Averaged Test Accuracy (Prototype Model): 0.6143
Std Test Accuracy (Regular Model): 0.1050
Std Test Accuracy (Prototype Model): 0.1063
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
