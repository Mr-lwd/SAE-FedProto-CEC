==================================================
goal = test
device = cuda
device_id = 0
dataset = Cifar10_dir_0.3_imbalance_40
num_classes = 10
model_family = HtFE8
batch_size = 256
local_learning_rate = 0.06
use_decay_scheduler = False
learning_rate_decay = False
learning_rate_decay_gamma = 0.99
global_rounds = 150
edge_epochs = 1
local_epochs = 10
algorithm = FedSAE
join_ratio = 1.0
random_join_ratio = False
num_clients = 40
num_edges = 10
prev = 0
times = 1
eval_gap = 1
save_folder_name = temp
auto_break = False
feature_dim = 512
vocab_size = 98635
max_len = 200
client_drop_rate = 0.0
train_slow_rate = 0.0
send_slow_rate = 0.0
time_select = False
time_threthold = 10000
lamda = 2
trans_delay_simulate = False
agg_type = 0
buffersize = 10
test_useglclassifier = 1
gamma = 1.0
use_beta = True
SAEbeta = 0.2
addTGP = True
drawtsne = True
drawround = 10
noise_dim = 512
generator_learning_rate = 0.005
hidden_dim = 512
server_epochs = 100
alpha = 1.0
beta = 1.0
mentee_learning_rate = 0.005
T_start = 0.95
T_end = 0.98
server_learning_rate = 0.01
margin_threthold = 100.0
generator_path = stylegan/stylegan-xl-models/imagenet64.pkl
stable_diffusion_prompt = a cat
server_batch_size = 100
gen_batch_size = 4
mu = 50.0
==================================================
Random seed set as 42

============= Running time: 0th =============
Creating server and clients ...
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600)
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes)
mobilenet_v2(pretrained=False, num_classes=args.num_classes)
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes)
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes)
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes)
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes)
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes)
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600) model chosen!
id 0
label_counts: defaultdict(<class 'int'>, {3: 400, 7: 347, 1: 47, 4: 179, 6: 87, 8: 41, 0: 2, 9: 2, 5: 2, 2: 1})
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes) model chosen!
id 1
label_counts: defaultdict(<class 'int'>, {2: 855, 4: 327, 0: 5, 3: 3})
mobilenet_v2(pretrained=False, num_classes=args.num_classes) model chosen!
id 2
label_counts: defaultdict(<class 'int'>, {6: 36, 5: 141, 8: 162, 9: 71, 4: 177, 2: 95, 0: 23, 1: 9, 7: 49, 3: 2})
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes) model chosen!
id 3
label_counts: defaultdict(<class 'int'>, {9: 347, 5: 394, 7: 415, 4: 88, 0: 3, 2: 15, 8: 32})
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes) model chosen!
id 4
label_counts: defaultdict(<class 'int'>, {3: 83, 2: 591, 5: 234, 8: 172, 4: 18, 7: 30, 0: 18, 1: 3})
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes) model chosen!
id 5
label_counts: defaultdict(<class 'int'>, {5: 565, 0: 841, 1: 70, 3: 35})
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes) model chosen!
id 6
label_counts: defaultdict(<class 'int'>, {3: 381, 6: 154, 8: 143, 1: 15, 9: 43, 0: 93, 4: 2, 7: 1, 2: 1})
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes) model chosen!
id 7
label_counts: defaultdict(<class 'int'>, {9: 1519, 4: 349, 7: 79, 3: 115, 0: 78, 2: 76, 5: 29, 1: 6, 6: 1})
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600) model chosen!
id 8
label_counts: defaultdict(<class 'int'>, {3: 83, 2: 115, 8: 161, 4: 425, 7: 92, 1: 15, 6: 5, 9: 10, 0: 4, 5: 2})
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes) model chosen!
id 9
label_counts: defaultdict(<class 'int'>, {5: 7, 1: 64, 7: 286, 4: 95, 3: 14, 2: 80, 9: 28, 0: 7})
mobilenet_v2(pretrained=False, num_classes=args.num_classes) model chosen!
id 10
label_counts: defaultdict(<class 'int'>, {8: 906, 0: 830, 4: 108, 5: 5, 2: 10, 6: 6, 1: 17, 3: 11})
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes) model chosen!
id 11
label_counts: defaultdict(<class 'int'>, {1: 227, 8: 208, 2: 238, 9: 48, 3: 16, 4: 1, 7: 8, 6: 2, 5: 2})
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes) model chosen!
id 12
label_counts: defaultdict(<class 'int'>, {6: 681, 1: 47, 0: 50, 4: 354, 3: 4, 2: 2, 5: 1})
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes) model chosen!
id 13
label_counts: defaultdict(<class 'int'>, {6: 426, 4: 10, 0: 464, 3: 90, 2: 271, 1: 67})
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes) model chosen!
id 14
label_counts: defaultdict(<class 'int'>, {5: 746, 1: 509, 4: 104, 3: 17, 0: 30, 2: 1})
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes) model chosen!
id 15
label_counts: defaultdict(<class 'int'>, {4: 973, 2: 843, 1: 155, 0: 75, 3: 45})
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600) model chosen!
id 16
label_counts: defaultdict(<class 'int'>, {3: 448, 9: 202, 4: 43, 5: 71, 6: 120, 8: 77, 0: 8, 1: 2})
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes) model chosen!
id 17
label_counts: defaultdict(<class 'int'>, {3: 84, 7: 978, 2: 130, 6: 42, 4: 48, 0: 8, 5: 9})
mobilenet_v2(pretrained=False, num_classes=args.num_classes) model chosen!
id 18
label_counts: defaultdict(<class 'int'>, {0: 260, 1: 196, 4: 82, 5: 179, 3: 53, 8: 51, 7: 8, 6: 3, 2: 2})
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes) model chosen!
id 19
label_counts: defaultdict(<class 'int'>, {1: 456, 8: 150, 3: 7, 9: 86, 2: 46, 6: 20, 5: 56, 7: 10})
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes) model chosen!
id 20
label_counts: defaultdict(<class 'int'>, {0: 218, 6: 242, 4: 48, 8: 358, 7: 24, 3: 362, 2: 17, 5: 6})
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes) model chosen!
id 21
label_counts: defaultdict(<class 'int'>, {3: 93, 0: 436, 1: 276, 4: 131, 8: 33, 2: 72, 5: 44, 9: 2, 6: 2})
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes) model chosen!
id 22
label_counts: defaultdict(<class 'int'>, {8: 459, 6: 159, 3: 97, 9: 131, 1: 82, 5: 64, 7: 22, 4: 2, 2: 1})
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes) model chosen!
id 23
label_counts: defaultdict(<class 'int'>, {2: 510, 1: 205, 0: 170, 3: 373})
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600) model chosen!
id 24
label_counts: defaultdict(<class 'int'>, {7: 407, 4: 111, 2: 21, 8: 68, 6: 231, 1: 151, 9: 44, 3: 19, 0: 4})
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes) model chosen!
id 25
label_counts: defaultdict(<class 'int'>, {7: 336, 1: 353, 6: 83, 5: 197, 4: 100, 2: 11, 0: 2, 3: 29, 8: 3, 9: 2})
mobilenet_v2(pretrained=False, num_classes=args.num_classes) model chosen!
id 26
label_counts: defaultdict(<class 'int'>, {3: 116, 9: 885, 0: 276, 5: 59, 8: 57, 1: 18, 4: 3, 6: 2})
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes) model chosen!
id 27
label_counts: defaultdict(<class 'int'>, {6: 360, 9: 54, 4: 28, 1: 24, 5: 140, 2: 15, 3: 12})
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes) model chosen!
id 28
label_counts: defaultdict(<class 'int'>, {8: 31, 5: 486, 0: 87, 4: 71, 1: 148, 2: 2, 7: 29, 6: 12, 3: 1})
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes) model chosen!
id 29
label_counts: defaultdict(<class 'int'>, {5: 380, 7: 932, 3: 54, 1: 46, 6: 48, 4: 10, 2: 10})
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes) model chosen!
id 30
label_counts: defaultdict(<class 'int'>, {3: 724, 6: 555, 0: 95, 5: 89, 4: 8, 2: 19, 1: 1})
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes) model chosen!
id 31
label_counts: defaultdict(<class 'int'>, {7: 52, 9: 201, 1: 130, 0: 185, 4: 61, 6: 65, 5: 41, 2: 12, 3: 7})
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600) model chosen!
id 32
label_counts: defaultdict(<class 'int'>, {5: 339, 6: 11, 8: 81, 9: 53, 2: 65, 3: 3, 0: 33, 1: 9, 7: 1})
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes) model chosen!
id 33
label_counts: defaultdict(<class 'int'>, {4: 82, 1: 688, 6: 249, 0: 10, 8: 63, 7: 39, 5: 32, 2: 2})
mobilenet_v2(pretrained=False, num_classes=args.num_classes) model chosen!
id 34
label_counts: defaultdict(<class 'int'>, {8: 782, 1: 196, 6: 180, 3: 124, 2: 5, 4: 26, 7: 25})
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes) model chosen!
id 35
label_counts: defaultdict(<class 'int'>, {2: 255, 9: 362, 8: 12, 7: 151, 3: 64, 0: 69, 6: 20, 1: 7, 4: 8})
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes) model chosen!
id 36
label_counts: defaultdict(<class 'int'>, {5: 152, 8: 159, 7: 10, 4: 109, 9: 83, 1: 70, 2: 15, 0: 1})
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes) model chosen!
id 37
label_counts: defaultdict(<class 'int'>, {1: 171, 3: 58, 6: 519, 0: 116, 4: 82, 5: 16, 7: 10, 9: 20, 2: 10})
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes) model chosen!
id 38
label_counts: defaultdict(<class 'int'>, {6: 156, 3: 111, 1: 29, 2: 125, 7: 141, 8: 27, 9: 20, 0: 6, 5: 29})
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes) model chosen!
id 39
label_counts: defaultdict(<class 'int'>, {9: 312, 3: 345, 8: 216, 4: 217, 0: 3, 7: 4, 5: 5, 1: 1, 2: 1})

Join ratio / total clients: 1.0 / 40
Finished creating server and clients.
Trainable_prototypes(
  (embedings): Embedding(10, 512)
  (middle): Sequential(
    (0): Sequential(
      (0): Linear(in_features=512, out_features=512, bias=True)
      (1): ReLU()
    )
  )
  (fc): Linear(in_features=512, out_features=512, bias=True)
)
tobetrained:
[9, 8, 7, 6, 5, 4, 3, 2, 1, 0]
Edge 9 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_5 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_31 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_13 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_0 protos Not Found
Client_5 prev_protos Not Found
Client_0 prev_protos Not Found
Client_13 prev_protos Not Found
Client_31 prev_protos Not Found
Edge 8 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_16 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_1 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_26 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_36 protos Not Found
Client_26 prev_protos Not Found
Client_36 prev_protos Not Found
Client_1 prev_protos Not Found
Client_16 prev_protos Not Found
Edge 7 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_24 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_7 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_27 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_2 protos Not Found
Client_2 prev_protos Not Found
Client_24 prev_protos Not Found
Client_27 prev_protos Not Found
Client_7 prev_protos Not Found
Edge 6 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_32 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_38 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_8 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_23 protos Not Found
Client_38 prev_protos Not Found
Client_23 prev_protos Not Found
Client_8 prev_protos Not Found
Client_32 prev_protos Not Found
Edge 5 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_9 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_33 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_29 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_6 protos Not Found
Client_29 prev_protos Not Found
Client_6 prev_protos Not Found
Client_9 prev_protos Not Found
Client_33 prev_protos Not Found
Edge 4 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_30 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_10 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_18 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_17 protos Not Found
Client_30 prev_protos Not Found
Client_17 prev_protos Not Found
Client_18 prev_protos Not Found
Client_10 prev_protos Not Found
Edge 3 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_14 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_15 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_39 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_35 protos Not Found
Client_14 prev_protos Not Found
Client_39 prev_protos Not Found
Client_15 prev_protos Not Found
Client_35 prev_protos Not Found
Edge 2 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_21 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_3 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_19 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_11 protos Not Found
Client_21 prev_protos Not Found
Client_11 prev_protos Not Found
Client_19 prev_protos Not Found
Client_3 prev_protos Not Found
Edge 1 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_12 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_20 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_22 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_25 protos Not Found
Client_25 prev_protos Not Found
Client_22 prev_protos Not Found
Client_20 prev_protos Not Found
Client_12 prev_protos Not Found
Edge 0 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_37 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_34 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_28 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_4 protos Not Found
Client_4 prev_protos Not Found
Client_28 prev_protos Not Found
Client_37 prev_protos Not Found
Client_34 prev_protos Not Found
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge_0 prev_protos Not Found
Edge_1 prev_protos Not Found
Edge_2 prev_protos Not Found
Edge_3 prev_protos Not Found
Edge_4 prev_protos Not Found
Edge_5 prev_protos Not Found
Edge_6 prev_protos Not Found
Edge_7 prev_protos Not Found
Edge_8 prev_protos Not Found
Edge_9 prev_protos Not Found
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([3.9864, 2.5491, 2.2446, 2.0699, 3.4147, 2.7722, 2.3389, 2.0699, 2.6666,
        3.1330], device='cuda:0')
Server loss: 5.8171234130859375
train global classifier
train glclassifier time: 3.752456046640873
global classifier accuracy: 97.3525
Number of samples: 326
end Update
server_global_time: 14.90336886048317
only_train_time: 139.80781399458647

-------------Global Round number: 0-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.4511
Averaged Test Accuracy (Prototype Model): 0.2767
Std Test Accuracy (Regular Model): 0.1589
Std Test Accuracy (Prototype Model): 0.1501
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([4.1944, 3.0817, 2.8763, 2.8973, 2.7297, 3.2405, 2.8988, 2.7297, 3.0741,
        3.3106], device='cuda:0')
Server loss: 5.012228488922119
train global classifier
train glclassifier time: 4.139276459813118
global classifier accuracy: 99.895
end Update
server_global_time: 30.804737627506256
only_train_time: 299.53879903256893

-------------Global Round number: 1-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6047
Averaged Test Accuracy (Prototype Model): 0.5034
Std Test Accuracy (Regular Model): 0.1078
Std Test Accuracy (Prototype Model): 0.1497
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([5.0132, 3.8120, 3.2784, 3.2205, 2.7732, 3.6232, 3.4249, 2.7732, 3.4922,
        3.8661], device='cuda:0')
Server loss: 4.538386344909668
train global classifier
train glclassifier time: 3.725604362785816
global classifier accuracy: 99.9725
end Update
server_global_time: 47.060096971690655
only_train_time: 460.942709736526

-------------Global Round number: 2-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6252
Averaged Test Accuracy (Prototype Model): 0.5735
Std Test Accuracy (Regular Model): 0.0993
Std Test Accuracy (Prototype Model): 0.1415
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([5.8416, 4.5024, 3.6889, 3.7448, 2.9827, 4.1496, 3.9683, 2.9827, 4.0034,
        4.5178], device='cuda:0')
Server loss: 4.598642826080322
train global classifier
train glclassifier time: 3.6423580646514893
global classifier accuracy: 99.9825
end Update
server_global_time: 62.98290569335222
only_train_time: 622.4103001505136

-------------Global Round number: 3-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6330
Averaged Test Accuracy (Prototype Model): 0.5998
Std Test Accuracy (Regular Model): 0.0941
Std Test Accuracy (Prototype Model): 0.1258
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([6.5081, 5.0421, 4.0087, 4.1459, 3.3364, 4.6476, 4.5260, 3.3364, 4.4169,
        5.0861], device='cuda:0')
Server loss: 4.7178473472595215
train global classifier
train glclassifier time: 3.6664878353476524
global classifier accuracy: 100.0
end Update
server_global_time: 78.75237008184195
only_train_time: 781.732550829649

-------------Global Round number: 4-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6356
Averaged Test Accuracy (Prototype Model): 0.6167
Std Test Accuracy (Regular Model): 0.0951
Std Test Accuracy (Prototype Model): 0.1038
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([7.0503, 5.5110, 4.4449, 4.6478, 3.7521, 5.0901, 5.0098, 3.7521, 4.8453,
        5.5912], device='cuda:0')
Server loss: 4.763479709625244
train global classifier
train glclassifier time: 3.920346774160862
global classifier accuracy: 100.0
end Update
server_global_time: 94.45787141472101
only_train_time: 941.9125819131732

-------------Global Round number: 5-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6372
Averaged Test Accuracy (Prototype Model): 0.6244
Std Test Accuracy (Regular Model): 0.0966
Std Test Accuracy (Prototype Model): 0.1029
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([7.4616, 5.8938, 4.9014, 4.9571, 4.0795, 5.4437, 5.3697, 4.0795, 5.1728,
        5.9290], device='cuda:0')
Server loss: 4.8068413734436035
train global classifier
train glclassifier time: 3.8702519834041595
global classifier accuracy: 100.0
end Update
server_global_time: 110.24033063650131
only_train_time: 1101.4704825282097

-------------Global Round number: 6-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6365
Averaged Test Accuracy (Prototype Model): 0.6282
Std Test Accuracy (Regular Model): 0.0972
Std Test Accuracy (Prototype Model): 0.1039
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([7.7969, 6.1984, 5.3130, 5.2851, 4.4864, 5.8059, 5.7121, 4.4864, 5.4987,
        6.1966], device='cuda:0')
Server loss: 4.742502212524414
train global classifier
train glclassifier time: 3.7601379975676537
global classifier accuracy: 100.0
end Update
server_global_time: 126.46966218203306
only_train_time: 1263.7607429847121

-------------Global Round number: 7-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6288
Averaged Test Accuracy (Prototype Model): 0.6232
Std Test Accuracy (Regular Model): 0.0984
Std Test Accuracy (Prototype Model): 0.1046
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([8.0317, 6.4539, 5.6384, 5.5112, 4.7840, 6.1017, 6.0005, 4.7840, 5.7664,
        6.4088], device='cuda:0')
Server loss: 4.6822309494018555
train global classifier
train glclassifier time: 4.05977114289999
global classifier accuracy: 100.0
end Update
server_global_time: 142.17147082090378
only_train_time: 1423.542824037373

-------------Global Round number: 8-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6291
Averaged Test Accuracy (Prototype Model): 0.6231
Std Test Accuracy (Regular Model): 0.0993
Std Test Accuracy (Prototype Model): 0.1045
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([8.2136, 6.6574, 5.9324, 5.7629, 5.1278, 6.3801, 6.2641, 5.1278, 6.0523,
        6.6145], device='cuda:0')
Server loss: 4.580193519592285
train global classifier
train glclassifier time: 3.7044782042503357
global classifier accuracy: 100.0
end Update
server_global_time: 158.06388888508081
only_train_time: 1584.546714283526

-------------Global Round number: 9-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6364
Averaged Test Accuracy (Prototype Model): 0.6326
Std Test Accuracy (Regular Model): 0.0979
Std Test Accuracy (Prototype Model): 0.1037
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([8.3700, 6.8266, 6.2109, 5.9768, 5.3972, 6.6177, 6.5031, 5.3972, 6.2751,
        6.7902], device='cuda:0')
Server loss: 4.493355751037598
train global classifier
train glclassifier time: 3.792785719037056
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 173.8209176287055
only_train_time: 1743.7555248439312

-------------Global Round number: 10-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6364
Averaged Test Accuracy (Prototype Model): 0.6344
Std Test Accuracy (Regular Model): 0.0994
Std Test Accuracy (Prototype Model): 0.1020
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([8.5020, 6.9739, 6.4409, 6.1666, 5.6221, 6.8223, 6.6986, 5.6221, 6.4529,
        6.9378], device='cuda:0')
Server loss: 4.421772480010986
train global classifier
train glclassifier time: 4.411758653819561
global classifier accuracy: 100.0
end Update
server_global_time: 189.69465269893408
only_train_time: 1902.2842508330941

-------------Global Round number: 11-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6364
Averaged Test Accuracy (Prototype Model): 0.6336
Std Test Accuracy (Regular Model): 0.0986
Std Test Accuracy (Prototype Model): 0.1009
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([8.6103, 7.1039, 6.5995, 6.3102, 5.7578, 6.9732, 6.8401, 5.7578, 6.5733,
        7.0726], device='cuda:0')
Server loss: 4.373359680175781
train global classifier
train glclassifier time: 4.542573861777782
global classifier accuracy: 100.0
end Update
server_global_time: 205.26526107639074
only_train_time: 2061.364151611924

-------------Global Round number: 12-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6365
Averaged Test Accuracy (Prototype Model): 0.6331
Std Test Accuracy (Regular Model): 0.0995
Std Test Accuracy (Prototype Model): 0.1005
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([8.7308, 7.1993, 6.7762, 6.4821, 5.9652, 7.1527, 7.0290, 5.9652, 6.7285,
        7.1869], device='cuda:0')
Server loss: 4.3202805519104
train global classifier
train glclassifier time: 4.128381721675396
global classifier accuracy: 100.0
end Update
server_global_time: 220.99604220688343
only_train_time: 2220.4291141703725

-------------Global Round number: 13-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6358
Averaged Test Accuracy (Prototype Model): 0.6333
Std Test Accuracy (Regular Model): 0.1004
Std Test Accuracy (Prototype Model): 0.1002
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([8.8280, 7.2948, 6.9292, 6.6258, 6.1165, 7.3066, 7.1812, 6.1165, 6.8469,
        7.2952], device='cuda:0')
Server loss: 4.2729644775390625
train global classifier
train glclassifier time: 3.78904540091753
global classifier accuracy: 100.0
end Update
server_global_time: 236.69249250739813
only_train_time: 2379.7399223297834

-------------Global Round number: 14-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6351
Averaged Test Accuracy (Prototype Model): 0.6336
Std Test Accuracy (Regular Model): 0.1006
Std Test Accuracy (Prototype Model): 0.1000
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([8.9095, 7.3808, 7.0725, 6.7585, 6.2524, 7.4407, 7.3179, 6.2524, 6.9443,
        7.3974], device='cuda:0')
Server loss: 4.223522186279297
train global classifier
train glclassifier time: 4.041491203010082
global classifier accuracy: 100.0
end Update
server_global_time: 252.49917504936457
only_train_time: 2539.631701104343

-------------Global Round number: 15-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6352
Averaged Test Accuracy (Prototype Model): 0.6335
Std Test Accuracy (Regular Model): 0.1009
Std Test Accuracy (Prototype Model): 0.0998
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([8.9977, 7.4599, 7.1841, 6.8748, 6.3716, 7.5572, 7.4338, 6.3716, 7.0324,
        7.4877], device='cuda:0')
Server loss: 4.1980109214782715
train global classifier
train glclassifier time: 3.889654651284218
global classifier accuracy: 100.0
end Update
server_global_time: 268.4651268571615
only_train_time: 2699.3056059628725

-------------Global Round number: 16-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6356
Averaged Test Accuracy (Prototype Model): 0.6340
Std Test Accuracy (Regular Model): 0.1003
Std Test Accuracy (Prototype Model): 0.0991
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.0759, 7.5339, 7.2942, 6.9931, 6.4793, 7.6814, 7.5478, 6.4793, 7.1057,
        7.5697], device='cuda:0')
Server loss: 4.1671223640441895
train global classifier
train glclassifier time: 4.527115769684315
global classifier accuracy: 100.0
end Update
server_global_time: 284.18161722272635
only_train_time: 2856.903641231358

-------------Global Round number: 17-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6353
Averaged Test Accuracy (Prototype Model): 0.6344
Std Test Accuracy (Regular Model): 0.1005
Std Test Accuracy (Prototype Model): 0.0995
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.1052, 7.5753, 7.3499, 7.0818, 6.5823, 7.7661, 7.6248, 6.5823, 7.1600,
        7.6224], device='cuda:0')
Server loss: 4.132678508758545
train global classifier
train glclassifier time: 3.6994867101311684
global classifier accuracy: 100.0
end Update
server_global_time: 300.08109252899885
only_train_time: 3016.7378497049212

-------------Global Round number: 18-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6347
Averaged Test Accuracy (Prototype Model): 0.6344
Std Test Accuracy (Regular Model): 0.1007
Std Test Accuracy (Prototype Model): 0.1003
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.1753, 7.6356, 7.4109, 7.1782, 6.6769, 7.8600, 7.7277, 6.6769, 7.2257,
        7.6995], device='cuda:0')
Server loss: 4.093603134155273
train global classifier
train glclassifier time: 3.833570256829262
global classifier accuracy: 100.0
end Update
server_global_time: 315.85560911148787
only_train_time: 3174.7927582114935

-------------Global Round number: 19-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6351
Averaged Test Accuracy (Prototype Model): 0.6338
Std Test Accuracy (Regular Model): 0.1020
Std Test Accuracy (Prototype Model): 0.0998
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.2173, 7.6822, 7.4648, 7.2690, 6.7668, 7.9546, 7.8040, 6.7668, 7.2786,
        7.7749], device='cuda:0')
Server loss: 4.049544811248779
train global classifier
train glclassifier time: 3.9676475524902344
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 331.5746129974723
only_train_time: 3336.169880785048

-------------Global Round number: 20-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6347
Averaged Test Accuracy (Prototype Model): 0.6343
Std Test Accuracy (Regular Model): 0.1015
Std Test Accuracy (Prototype Model): 0.0995
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.2533, 7.7265, 7.5001, 7.3537, 6.8539, 8.0419, 7.8770, 6.8539, 7.3335,
        7.8250], device='cuda:0')
Server loss: 4.009000301361084
train global classifier
train glclassifier time: 3.7479144409298897
global classifier accuracy: 100.0
end Update
server_global_time: 347.2737280577421
only_train_time: 3495.0306841805577

-------------Global Round number: 21-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6345
Averaged Test Accuracy (Prototype Model): 0.6340
Std Test Accuracy (Regular Model): 0.1014
Std Test Accuracy (Prototype Model): 0.0987
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.2918, 7.7689, 7.5439, 7.4285, 6.9220, 8.1170, 7.9341, 6.9220, 7.3734,
        7.8820], device='cuda:0')
Server loss: 3.9789836406707764
train global classifier
train glclassifier time: 4.334315828979015
global classifier accuracy: 100.0
end Update
server_global_time: 363.5300987511873
only_train_time: 3655.9120356217027

-------------Global Round number: 22-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6349
Averaged Test Accuracy (Prototype Model): 0.6344
Std Test Accuracy (Regular Model): 0.1009
Std Test Accuracy (Prototype Model): 0.0988
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.3275, 7.7985, 7.5868, 7.4998, 6.9914, 8.1844, 7.9933, 6.9914, 7.4140,
        7.9377], device='cuda:0')
Server loss: 3.9467148780822754
train global classifier
train glclassifier time: 3.689952552318573
global classifier accuracy: 100.0
end Update
server_global_time: 379.31734205037355
only_train_time: 3816.5963876396418

-------------Global Round number: 23-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6352
Averaged Test Accuracy (Prototype Model): 0.6346
Std Test Accuracy (Regular Model): 0.1002
Std Test Accuracy (Prototype Model): 0.0999
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.3451, 7.8361, 7.6235, 7.5592, 7.0480, 8.2473, 8.0414, 7.0480, 7.4567,
        7.9842], device='cuda:0')
Server loss: 3.909773588180542
train global classifier
train glclassifier time: 3.7918276488780975
global classifier accuracy: 100.0
end Update
server_global_time: 395.35699117928743
only_train_time: 3975.6924012824893

-------------Global Round number: 24-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6349
Averaged Test Accuracy (Prototype Model): 0.6345
Std Test Accuracy (Regular Model): 0.1004
Std Test Accuracy (Prototype Model): 0.1002
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.3756, 7.8691, 7.6586, 7.6241, 7.1154, 8.3147, 8.0916, 7.1154, 7.4996,
        8.0299], device='cuda:0')
Server loss: 3.8767144680023193
train global classifier
train glclassifier time: 3.7235242053866386
global classifier accuracy: 100.0
end Update
server_global_time: 411.0713564902544
only_train_time: 4135.714513070881

-------------Global Round number: 25-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6347
Averaged Test Accuracy (Prototype Model): 0.6346
Std Test Accuracy (Regular Model): 0.1018
Std Test Accuracy (Prototype Model): 0.1023
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.3978, 7.8966, 7.6917, 7.6820, 7.1769, 8.3703, 8.1435, 7.1769, 7.5317,
        8.0671], device='cuda:0')
Server loss: 3.844501495361328
train global classifier
train glclassifier time: 3.791330374777317
global classifier accuracy: 100.0
end Update
server_global_time: 427.2186173722148
only_train_time: 4295.417749375105

-------------Global Round number: 26-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6348
Averaged Test Accuracy (Prototype Model): 0.6344
Std Test Accuracy (Regular Model): 0.1018
Std Test Accuracy (Prototype Model): 0.1016
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.4250, 7.9276, 7.7248, 7.7337, 7.2306, 8.4247, 8.1920, 7.2306, 7.5665,
        8.1011], device='cuda:0')
Server loss: 3.8217594623565674
train global classifier
train glclassifier time: 4.075181484222412
global classifier accuracy: 100.0
end Update
server_global_time: 443.01335679739714
only_train_time: 4454.620796389878

-------------Global Round number: 27-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6346
Averaged Test Accuracy (Prototype Model): 0.6344
Std Test Accuracy (Regular Model): 0.1015
Std Test Accuracy (Prototype Model): 0.1014
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.4441, 7.9523, 7.7509, 7.7887, 7.2746, 8.4704, 8.2312, 7.2746, 7.5927,
        8.1474], device='cuda:0')
Server loss: 3.7934131622314453
train global classifier
train glclassifier time: 3.9442484825849533
global classifier accuracy: 100.0
end Update
server_global_time: 459.20383246243
only_train_time: 4613.975390665233

-------------Global Round number: 28-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6350
Averaged Test Accuracy (Prototype Model): 0.6348
Std Test Accuracy (Regular Model): 0.1023
Std Test Accuracy (Prototype Model): 0.1025
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.4620, 7.9792, 7.7828, 7.8339, 7.3192, 8.5212, 8.2656, 7.3192, 7.6216,
        8.1881], device='cuda:0')
Server loss: 3.7674672603607178
train global classifier
train glclassifier time: 3.845751032233238
global classifier accuracy: 100.0
end Update
server_global_time: 475.1639657393098
only_train_time: 4772.440011888742

-------------Global Round number: 29-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6347
Averaged Test Accuracy (Prototype Model): 0.6349
Std Test Accuracy (Regular Model): 0.1020
Std Test Accuracy (Prototype Model): 0.1023
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.4746, 8.0024, 7.8107, 7.8828, 7.3671, 8.5723, 8.3031, 7.3671, 7.6423,
        8.2196], device='cuda:0')
Server loss: 3.735917568206787
train global classifier
train glclassifier time: 3.768489144742489
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 491.25956328958273
only_train_time: 4932.493772372603

-------------Global Round number: 30-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6345
Averaged Test Accuracy (Prototype Model): 0.6348
Std Test Accuracy (Regular Model): 0.1021
Std Test Accuracy (Prototype Model): 0.1024
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[8, 0, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[8, 0, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.4889, 8.0284, 7.8311, 7.9285, 7.4061, 8.6170, 8.3433, 7.4061, 7.6673,
        8.2460], device='cuda:0')
Server loss: 3.709419012069702
train global classifier
train glclassifier time: 3.7882292196154594
global classifier accuracy: 100.0
end Update
server_global_time: 507.01285587251186
only_train_time: 5090.164049111307

-------------Global Round number: 31-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6342
Averaged Test Accuracy (Prototype Model): 0.6340
Std Test Accuracy (Regular Model): 0.1022
Std Test Accuracy (Prototype Model): 0.1032
tobetrained:
[8, 0, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.5046, 8.0471, 7.8497, 7.9668, 7.4455, 8.6517, 8.3757, 7.4455, 7.6864,
        8.2745], device='cuda:0')
Server loss: 3.6896986961364746
train global classifier
train glclassifier time: 3.703322149813175
global classifier accuracy: 100.0
end Update
server_global_time: 522.642022550106
only_train_time: 5250.1501596421

-------------Global Round number: 32-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6340
Averaged Test Accuracy (Prototype Model): 0.6339
Std Test Accuracy (Regular Model): 0.1030
Std Test Accuracy (Prototype Model): 0.1022
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.5140, 8.0647, 7.8762, 8.0064, 7.4865, 8.6958, 8.4024, 7.4865, 7.7183,
        8.3062], device='cuda:0')
Server loss: 3.6605091094970703
train global classifier
train glclassifier time: 3.769957982003689
global classifier accuracy: 100.0
end Update
server_global_time: 538.7118799760938
only_train_time: 5409.519783049822

-------------Global Round number: 33-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6344
Averaged Test Accuracy (Prototype Model): 0.6332
Std Test Accuracy (Regular Model): 0.1026
Std Test Accuracy (Prototype Model): 0.1027
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.5306, 8.0772, 7.8972, 8.0458, 7.5279, 8.7383, 8.4354, 7.5279, 7.7380,
        8.3292], device='cuda:0')
Server loss: 3.641742467880249
train global classifier
train glclassifier time: 3.917557343840599
global classifier accuracy: 100.0
end Update
server_global_time: 554.8524505645037
only_train_time: 5570.022881932557

-------------Global Round number: 34-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6342
Averaged Test Accuracy (Prototype Model): 0.6326
Std Test Accuracy (Regular Model): 0.1030
Std Test Accuracy (Prototype Model): 0.1026
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.5372, 8.0891, 7.9183, 8.0834, 7.5653, 8.7721, 8.4658, 7.5653, 7.7632,
        8.3635], device='cuda:0')
Server loss: 3.615922212600708
train global classifier
train glclassifier time: 3.717114172875881
global classifier accuracy: 100.0
end Update
server_global_time: 570.8533016070724
only_train_time: 5727.17387907207

-------------Global Round number: 35-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6338
Averaged Test Accuracy (Prototype Model): 0.6324
Std Test Accuracy (Regular Model): 0.1026
Std Test Accuracy (Prototype Model): 0.1020
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.5472, 8.1046, 7.9390, 8.1187, 7.5990, 8.8053, 8.4950, 7.5990, 7.7814,
        8.3838], device='cuda:0')
Server loss: 3.5943427085876465
train global classifier
train glclassifier time: 3.809847556054592
global classifier accuracy: 100.0
end Update
server_global_time: 586.7390604242682
only_train_time: 5887.966459862888

-------------Global Round number: 36-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6343
Averaged Test Accuracy (Prototype Model): 0.6327
Std Test Accuracy (Regular Model): 0.1025
Std Test Accuracy (Prototype Model): 0.1022
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.5503, 8.1206, 7.9547, 8.1511, 7.6308, 8.8428, 8.5244, 7.6308, 7.8000,
        8.4101], device='cuda:0')
Server loss: 3.5684149265289307
train global classifier
train glclassifier time: 3.8882520496845245
global classifier accuracy: 100.0
end Update
server_global_time: 602.5178484544158
only_train_time: 6047.320887036622

-------------Global Round number: 37-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6346
Averaged Test Accuracy (Prototype Model): 0.6329
Std Test Accuracy (Regular Model): 0.1024
Std Test Accuracy (Prototype Model): 0.1028
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.5607, 8.1303, 7.9673, 8.1832, 7.6673, 8.8759, 8.5482, 7.6673, 7.8193,
        8.4290], device='cuda:0')
Server loss: 3.551628351211548
train global classifier
train glclassifier time: 3.9390998631715775
global classifier accuracy: 100.0
end Update
server_global_time: 618.4447877183557
only_train_time: 6206.534043736756

-------------Global Round number: 38-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6346
Averaged Test Accuracy (Prototype Model): 0.6331
Std Test Accuracy (Regular Model): 0.1021
Std Test Accuracy (Prototype Model): 0.1031
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[8, 0, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[8, 0, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.5730, 8.1414, 7.9892, 8.2127, 7.6935, 8.9059, 8.5667, 7.6935, 7.8372,
        8.4466], device='cuda:0')
Server loss: 3.536172866821289
train global classifier
train glclassifier time: 3.712415911257267
global classifier accuracy: 100.0
end Update
server_global_time: 634.2974200844765
only_train_time: 6364.286225348711

-------------Global Round number: 39-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6334
Averaged Test Accuracy (Prototype Model): 0.6329
Std Test Accuracy (Regular Model): 0.1027
Std Test Accuracy (Prototype Model): 0.1031
tobetrained:
[8, 0, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.5786, 8.1606, 8.0046, 8.2373, 7.7172, 8.9318, 8.5851, 7.7172, 7.8553,
        8.4685], device='cuda:0')
Server loss: 3.5159177780151367
train global classifier
train glclassifier time: 4.064053140580654
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 649.9131656438112
only_train_time: 6522.85644685477

-------------Global Round number: 40-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6340
Averaged Test Accuracy (Prototype Model): 0.6332
Std Test Accuracy (Regular Model): 0.1031
Std Test Accuracy (Prototype Model): 0.1030
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.5962, 8.1639, 8.0181, 8.2657, 7.7411, 8.9630, 8.6084, 7.7411, 7.8650,
        8.4896], device='cuda:0')
Server loss: 3.507293462753296
train global classifier
train glclassifier time: 3.7063078358769417
global classifier accuracy: 100.0
end Update
server_global_time: 666.1846509575844
only_train_time: 6683.718230776489

-------------Global Round number: 41-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6348
Averaged Test Accuracy (Prototype Model): 0.6331
Std Test Accuracy (Regular Model): 0.1030
Std Test Accuracy (Prototype Model): 0.1037
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.5981, 8.1740, 8.0242, 8.2961, 7.7664, 8.9905, 8.6282, 7.7664, 7.8781,
        8.5076], device='cuda:0')
Server loss: 3.4871654510498047
train global classifier
train glclassifier time: 3.7181791588664055
global classifier accuracy: 100.0
end Update
server_global_time: 682.4730398356915
only_train_time: 6843.911703698337

-------------Global Round number: 42-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6336
Averaged Test Accuracy (Prototype Model): 0.6335
Std Test Accuracy (Regular Model): 0.1039
Std Test Accuracy (Prototype Model): 0.1035
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.6009, 8.1853, 8.0367, 8.3210, 7.7870, 9.0163, 8.6439, 7.7870, 7.8935,
        8.5274], device='cuda:0')
Server loss: 3.466386079788208
train global classifier
train glclassifier time: 4.20687123388052
global classifier accuracy: 100.0
end Update
server_global_time: 698.466156616807
only_train_time: 7002.503412343562

-------------Global Round number: 43-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6339
Averaged Test Accuracy (Prototype Model): 0.6332
Std Test Accuracy (Regular Model): 0.1045
Std Test Accuracy (Prototype Model): 0.1035
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.6017, 8.1974, 8.0456, 8.3382, 7.8045, 9.0406, 8.6559, 7.8045, 7.9036,
        8.5479], device='cuda:0')
Server loss: 3.4487521648406982
train global classifier
train glclassifier time: 3.9979357868433
global classifier accuracy: 100.0
end Update
server_global_time: 714.0848699137568
only_train_time: 7160.390465497971

-------------Global Round number: 44-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6335
Averaged Test Accuracy (Prototype Model): 0.6329
Std Test Accuracy (Regular Model): 0.1043
Std Test Accuracy (Prototype Model): 0.1037
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.6089, 8.2121, 8.0553, 8.3625, 7.8257, 9.0659, 8.6676, 7.8257, 7.9165,
        8.5574], device='cuda:0')
Server loss: 3.434438705444336
train global classifier
train glclassifier time: 3.9067699909210205
global classifier accuracy: 100.0
end Update
server_global_time: 729.7800974994898
only_train_time: 7318.812194235623

-------------Global Round number: 45-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6344
Averaged Test Accuracy (Prototype Model): 0.6330
Std Test Accuracy (Regular Model): 0.1035
Std Test Accuracy (Prototype Model): 0.1026
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.6184, 8.2241, 8.0643, 8.3858, 7.8433, 9.0862, 8.6828, 7.8433, 7.9294,
        8.5803], device='cuda:0')
Server loss: 3.4231369495391846
train global classifier
train glclassifier time: 4.000642992556095
global classifier accuracy: 100.0
end Update
server_global_time: 745.608567237854
only_train_time: 7476.821532890201

-------------Global Round number: 46-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6338
Averaged Test Accuracy (Prototype Model): 0.6330
Std Test Accuracy (Regular Model): 0.1033
Std Test Accuracy (Prototype Model): 0.1026
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.6251, 8.2269, 8.0701, 8.4054, 7.8620, 9.1052, 8.7005, 7.8620, 7.9451,
        8.5841], device='cuda:0')
Server loss: 3.416489362716675
train global classifier
train glclassifier time: 3.8546075224876404
global classifier accuracy: 100.0
end Update
server_global_time: 761.8579131513834
only_train_time: 7636.870712041855

-------------Global Round number: 47-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6346
Averaged Test Accuracy (Prototype Model): 0.6336
Std Test Accuracy (Regular Model): 0.1035
Std Test Accuracy (Prototype Model): 0.1019
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.6357, 8.2476, 8.0829, 8.4320, 7.8834, 9.1196, 8.7171, 7.8834, 7.9618,
        8.6027], device='cuda:0')
Server loss: 3.4019856452941895
train global classifier
train glclassifier time: 4.210394941270351
global classifier accuracy: 100.0
end Update
server_global_time: 777.7877955958247
only_train_time: 7794.56764511019

-------------Global Round number: 48-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6338
Averaged Test Accuracy (Prototype Model): 0.6339
Std Test Accuracy (Regular Model): 0.1036
Std Test Accuracy (Prototype Model): 0.1022
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.6357, 8.2578, 8.0937, 8.4520, 7.9014, 9.1335, 8.7291, 7.9014, 7.9692,
        8.6128], device='cuda:0')
Server loss: 3.3856592178344727
train global classifier
train glclassifier time: 3.7125384360551834
global classifier accuracy: 100.0
end Update
server_global_time: 793.410050958395
only_train_time: 7952.646132938564

-------------Global Round number: 49-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6341
Averaged Test Accuracy (Prototype Model): 0.6334
Std Test Accuracy (Regular Model): 0.1035
Std Test Accuracy (Prototype Model): 0.1025
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.6358, 8.2652, 8.1003, 8.4747, 7.9122, 9.1441, 8.7416, 7.9122, 7.9772,
        8.6260], device='cuda:0')
Server loss: 3.368114948272705
train global classifier
train glclassifier time: 5.056691773235798
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 809.1209714263678
only_train_time: 8111.337511330843

-------------Global Round number: 50-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6340
Averaged Test Accuracy (Prototype Model): 0.6336
Std Test Accuracy (Regular Model): 0.1041
Std Test Accuracy (Prototype Model): 0.1026
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.3269, 8.2184, 7.4987, 8.1258, 7.4987, 8.8722, 8.3928, 7.5173, 7.7587,
        8.6414], device='cuda:0')
Server loss: 3.1823971271514893
train global classifier
train glclassifier time: 4.03055626899004
global classifier accuracy: 100.0
end Update
server_global_time: 825.0676576346159
only_train_time: 8271.371118366718

-------------Global Round number: 51-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6320
Averaged Test Accuracy (Prototype Model): 0.6317
Std Test Accuracy (Regular Model): 0.1044
Std Test Accuracy (Prototype Model): 0.1034
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.4951, 8.2531, 7.8860, 8.2776, 7.6523, 8.9881, 8.5171, 7.6523, 7.8860,
        8.6398], device='cuda:0')
Server loss: 3.313601493835449
train global classifier
train glclassifier time: 3.8105235397815704
global classifier accuracy: 100.0
end Update
server_global_time: 841.2225490063429
only_train_time: 8430.816915504634

-------------Global Round number: 52-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6343
Averaged Test Accuracy (Prototype Model): 0.6336
Std Test Accuracy (Regular Model): 0.1036
Std Test Accuracy (Prototype Model): 0.1025
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.5771, 8.2698, 7.9828, 8.3661, 7.7483, 9.0668, 8.6123, 7.7483, 7.9828,
        8.6568], device='cuda:0')
Server loss: 3.3398690223693848
train global classifier
train glclassifier time: 3.769763633608818
global classifier accuracy: 100.0
end Update
server_global_time: 857.2422900050879
only_train_time: 8591.679011568427

-------------Global Round number: 53-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6346
Averaged Test Accuracy (Prototype Model): 0.6332
Std Test Accuracy (Regular Model): 0.1038
Std Test Accuracy (Prototype Model): 0.1032
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.6106, 8.2798, 8.0331, 8.4166, 7.8052, 9.1073, 8.6670, 7.8052, 8.0178,
        8.6710], device='cuda:0')
Server loss: 3.3437395095825195
train global classifier
train glclassifier time: 3.7450587451457977
global classifier accuracy: 100.0
end Update
server_global_time: 873.3397345170379
only_train_time: 8752.011380970478

-------------Global Round number: 54-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6350
Averaged Test Accuracy (Prototype Model): 0.6336
Std Test Accuracy (Regular Model): 0.1041
Std Test Accuracy (Prototype Model): 0.1028
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.6181, 8.2978, 8.0681, 8.4559, 7.8463, 9.1309, 8.7006, 7.8463, 8.0284,
        8.6802], device='cuda:0')
Server loss: 3.3274354934692383
train global classifier
train glclassifier time: 3.85490133613348
global classifier accuracy: 100.0
end Update
server_global_time: 889.4918470308185
only_train_time: 8915.533845849335

-------------Global Round number: 55-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6351
Averaged Test Accuracy (Prototype Model): 0.6341
Std Test Accuracy (Regular Model): 0.1037
Std Test Accuracy (Prototype Model): 0.1032
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.6154, 8.3075, 8.0866, 8.4925, 7.8831, 9.1506, 8.7359, 7.8831, 8.0331,
        8.6946], device='cuda:0')
Server loss: 3.3032867908477783
train global classifier
train glclassifier time: 3.8024729043245316
global classifier accuracy: 100.0
end Update
server_global_time: 905.9610441625118
only_train_time: 9083.43554404378

-------------Global Round number: 56-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6346
Averaged Test Accuracy (Prototype Model): 0.6338
Std Test Accuracy (Regular Model): 0.1042
Std Test Accuracy (Prototype Model): 0.1027
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.6222, 8.3119, 8.1058, 8.5151, 7.9123, 9.1721, 8.7612, 7.9123, 8.0451,
        8.7097], device='cuda:0')
Server loss: 3.2916157245635986
train global classifier
train glclassifier time: 4.040569826960564
global classifier accuracy: 100.0
end Update
server_global_time: 922.708865724504
only_train_time: 9251.68058270961

-------------Global Round number: 57-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6353
Averaged Test Accuracy (Prototype Model): 0.6342
Std Test Accuracy (Regular Model): 0.1039
Std Test Accuracy (Prototype Model): 0.1025
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.6228, 8.3200, 8.1226, 8.5384, 7.9324, 9.1871, 8.7842, 7.9324, 8.0475,
        8.7229], device='cuda:0')
Server loss: 3.276357650756836
train global classifier
train glclassifier time: 4.126069411635399
global classifier accuracy: 100.0
end Update
server_global_time: 939.5456101819873
only_train_time: 9421.63566917181

-------------Global Round number: 58-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6348
Averaged Test Accuracy (Prototype Model): 0.6337
Std Test Accuracy (Regular Model): 0.1038
Std Test Accuracy (Prototype Model): 0.1026
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.6232, 8.3283, 8.1370, 8.5585, 7.9560, 9.2026, 8.8031, 7.9560, 8.0637,
        8.7279], device='cuda:0')
Server loss: 3.260695695877075
train global classifier
train glclassifier time: 3.885637030005455
global classifier accuracy: 100.0
end Update
server_global_time: 955.4876723214984
only_train_time: 9583.645743779838

-------------Global Round number: 59-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6345
Averaged Test Accuracy (Prototype Model): 0.6333
Std Test Accuracy (Regular Model): 0.1033
Std Test Accuracy (Prototype Model): 0.1027
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.6184, 8.3282, 8.1529, 8.5815, 7.9761, 9.2159, 8.8175, 7.9761, 8.0710,
        8.7361], device='cuda:0')
Server loss: 3.2451260089874268
train global classifier
train glclassifier time: 3.7238020673394203
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 971.5986232832074
only_train_time: 9746.726501502097

-------------Global Round number: 60-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6352
Averaged Test Accuracy (Prototype Model): 0.6336
Std Test Accuracy (Regular Model): 0.1040
Std Test Accuracy (Prototype Model): 0.1033
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.6187, 8.3360, 8.1597, 8.6032, 8.0012, 9.2236, 8.8267, 8.0012, 8.0791,
        8.7484], device='cuda:0')
Server loss: 3.2287185192108154
train global classifier
train glclassifier time: 4.726754911243916
global classifier accuracy: 100.0
end Update
server_global_time: 987.5515961945057
only_train_time: 9907.740910105407

-------------Global Round number: 61-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6343
Averaged Test Accuracy (Prototype Model): 0.6337
Std Test Accuracy (Regular Model): 0.1043
Std Test Accuracy (Prototype Model): 0.1034
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.6190, 8.3369, 8.1699, 8.6191, 8.0156, 9.2356, 8.8434, 8.0156, 8.0855,
        8.7557], device='cuda:0')
Server loss: 3.217355489730835
train global classifier
train glclassifier time: 4.052017889916897
global classifier accuracy: 100.0
end Update
server_global_time: 1003.3548252359033
only_train_time: 10069.079403415322

-------------Global Round number: 62-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6340
Averaged Test Accuracy (Prototype Model): 0.6332
Std Test Accuracy (Regular Model): 0.1043
Std Test Accuracy (Prototype Model): 0.1032
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.6268, 8.3457, 8.1841, 8.6367, 8.0401, 9.2480, 8.8576, 8.0401, 8.0971,
        8.7657], device='cuda:0')
Server loss: 3.208712100982666
train global classifier
train glclassifier time: 4.5231336280703545
global classifier accuracy: 100.0
end Update
server_global_time: 1020.6908333897591
only_train_time: 10233.256790325046

-------------Global Round number: 63-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6342
Averaged Test Accuracy (Prototype Model): 0.6334
Std Test Accuracy (Regular Model): 0.1049
Std Test Accuracy (Prototype Model): 0.1029
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.6277, 8.3514, 8.1889, 8.6582, 8.0587, 9.2530, 8.8629, 8.0587, 8.1034,
        8.7766], device='cuda:0')
Server loss: 3.1988093852996826
train global classifier
train glclassifier time: 3.7961351796984673
global classifier accuracy: 100.0
end Update
server_global_time: 1036.4265399426222
only_train_time: 10394.661442115903

-------------Global Round number: 64-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6342
Averaged Test Accuracy (Prototype Model): 0.6338
Std Test Accuracy (Regular Model): 0.1044
Std Test Accuracy (Prototype Model): 0.1022
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.6301, 8.3542, 8.1961, 8.6739, 8.0733, 9.2630, 8.8718, 8.0733, 8.1086,
        8.7840], device='cuda:0')
Server loss: 3.1884238719940186
train global classifier
train glclassifier time: 3.7312561944127083
global classifier accuracy: 100.0
end Update
server_global_time: 1052.055123500526
only_train_time: 10554.084999985993

-------------Global Round number: 65-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6348
Averaged Test Accuracy (Prototype Model): 0.6334
Std Test Accuracy (Regular Model): 0.1045
Std Test Accuracy (Prototype Model): 0.1037
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.6299, 8.3611, 8.2097, 8.6795, 8.0861, 9.2718, 8.8872, 8.0861, 8.1154,
        8.7895], device='cuda:0')
Server loss: 3.1785006523132324
train global classifier
train glclassifier time: 3.780340939760208
global classifier accuracy: 100.0
end Update
server_global_time: 1068.2981158569455
only_train_time: 10713.426863923669

-------------Global Round number: 66-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6350
Averaged Test Accuracy (Prototype Model): 0.6334
Std Test Accuracy (Regular Model): 0.1048
Std Test Accuracy (Prototype Model): 0.1025
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 2, 8, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.6249, 8.3718, 8.2186, 8.6961, 8.0962, 9.2826, 8.8957, 8.0962, 8.1211,
        8.7968], device='cuda:0')
Server loss: 3.161893844604492
train global classifier
train glclassifier time: 3.743590697646141
global classifier accuracy: 100.0
end Update
server_global_time: 1084.1376037746668
only_train_time: 10872.88646518439

-------------Global Round number: 67-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6346
Averaged Test Accuracy (Prototype Model): 0.6334
Std Test Accuracy (Regular Model): 0.1051
Std Test Accuracy (Prototype Model): 0.1029
tobetrained:
[0, 2, 8, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.6264, 8.3705, 8.2267, 8.7092, 8.1092, 9.2888, 8.8997, 8.1092, 8.1248,
        8.8046], device='cuda:0')
Server loss: 3.1550724506378174
train global classifier
train glclassifier time: 3.755620591342449
global classifier accuracy: 100.0
end Update
server_global_time: 1101.4285002201796
only_train_time: 11036.336026467383

-------------Global Round number: 68-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6346
Averaged Test Accuracy (Prototype Model): 0.6336
Std Test Accuracy (Regular Model): 0.1050
Std Test Accuracy (Prototype Model): 0.1032
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.6225, 8.3695, 8.2365, 8.7270, 8.1246, 9.2969, 8.9109, 8.1246, 8.1294,
        8.8122], device='cuda:0')
Server loss: 3.1400671005249023
train global classifier
train glclassifier time: 3.7363835498690605
global classifier accuracy: 100.0
end Update
server_global_time: 1117.1159202754498
only_train_time: 11195.0781128034

-------------Global Round number: 69-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6348
Averaged Test Accuracy (Prototype Model): 0.6332
Std Test Accuracy (Regular Model): 0.1050
Std Test Accuracy (Prototype Model): 0.1033
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.6209, 8.3739, 8.2412, 8.7411, 8.1311, 9.3039, 8.9227, 8.1311, 8.1313,
        8.8160], device='cuda:0')
Server loss: 3.130126953125
train global classifier
train glclassifier time: 3.7346229776740074
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 1132.9260686561465
only_train_time: 11354.928037762642

-------------Global Round number: 70-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6348
Averaged Test Accuracy (Prototype Model): 0.6334
Std Test Accuracy (Regular Model): 0.1048
Std Test Accuracy (Prototype Model): 0.1025
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.6118, 8.3810, 8.2490, 8.7509, 8.1456, 9.3150, 8.9260, 8.1382, 8.1382,
        8.8279], device='cuda:0')
Server loss: 3.110722064971924
train global classifier
train glclassifier time: 3.7926927506923676
global classifier accuracy: 100.0
end Update
server_global_time: 1148.7998735234141
only_train_time: 11514.860770404339

-------------Global Round number: 71-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6346
Averaged Test Accuracy (Prototype Model): 0.6337
Std Test Accuracy (Regular Model): 0.1052
Std Test Accuracy (Prototype Model): 0.1026
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.6082, 8.3807, 8.2530, 8.7603, 8.1548, 9.3179, 8.9388, 8.1444, 8.1444,
        8.8343], device='cuda:0')
Server loss: 3.0998597145080566
train global classifier
train glclassifier time: 4.645280875265598
global classifier accuracy: 100.0
end Update
server_global_time: 1165.8503605052829
only_train_time: 11676.534895949066

-------------Global Round number: 72-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6352
Averaged Test Accuracy (Prototype Model): 0.6335
Std Test Accuracy (Regular Model): 0.1039
Std Test Accuracy (Prototype Model): 0.1028
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.6046, 8.3810, 8.2598, 8.7764, 8.1662, 9.3256, 8.9483, 8.1455, 8.1455,
        8.8394], device='cuda:0')
Server loss: 3.088099718093872
train global classifier
train glclassifier time: 4.251872979104519
global classifier accuracy: 100.0
end Update
server_global_time: 1183.184322066605
only_train_time: 11839.618849478662

-------------Global Round number: 73-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6349
Averaged Test Accuracy (Prototype Model): 0.6339
Std Test Accuracy (Regular Model): 0.1045
Std Test Accuracy (Prototype Model): 0.1029
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.5976, 8.3885, 8.2648, 8.7867, 8.1812, 9.3327, 8.9527, 8.1562, 8.1562,
        8.8496], device='cuda:0')
Server loss: 3.073068857192993
train global classifier
train glclassifier time: 4.080433279275894
global classifier accuracy: 100.0
end Update
server_global_time: 1198.948792912066
only_train_time: 12002.101393058896

-------------Global Round number: 74-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6350
Averaged Test Accuracy (Prototype Model): 0.6338
Std Test Accuracy (Regular Model): 0.1040
Std Test Accuracy (Prototype Model): 0.1026
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.5920, 8.3942, 8.2724, 8.7989, 8.1904, 9.3443, 8.9616, 8.1592, 8.1592,
        8.8580], device='cuda:0')
Server loss: 3.058765172958374
train global classifier
train glclassifier time: 3.736416481435299
global classifier accuracy: 100.0
end Update
server_global_time: 1214.5696446374059
only_train_time: 12161.559880882502

-------------Global Round number: 75-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6353
Averaged Test Accuracy (Prototype Model): 0.6333
Std Test Accuracy (Regular Model): 0.1037
Std Test Accuracy (Prototype Model): 0.1028
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.5857, 8.3960, 8.2820, 8.8126, 8.1980, 9.3530, 8.9674, 8.1678, 8.1678,
        8.8670], device='cuda:0')
Server loss: 3.0422275066375732
train global classifier
train glclassifier time: 3.749726824462414
global classifier accuracy: 100.0
end Update
server_global_time: 1230.3023523837328
only_train_time: 12322.005063720047

-------------Global Round number: 76-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6355
Averaged Test Accuracy (Prototype Model): 0.6340
Std Test Accuracy (Regular Model): 0.1043
Std Test Accuracy (Prototype Model): 0.1028
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.5839, 8.3998, 8.2858, 8.8296, 8.2144, 9.3542, 8.9731, 8.1727, 8.1727,
        8.8713], device='cuda:0')
Server loss: 3.033397674560547
train global classifier
train glclassifier time: 3.809058614075184
global classifier accuracy: 100.0
end Update
server_global_time: 1246.3699080199003
only_train_time: 12480.997871890664

-------------Global Round number: 77-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6355
Averaged Test Accuracy (Prototype Model): 0.6344
Std Test Accuracy (Regular Model): 0.1048
Std Test Accuracy (Prototype Model): 0.1025
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.5791, 8.4030, 8.2971, 8.8398, 8.2256, 9.3597, 8.9852, 8.1795, 8.1795,
        8.8788], device='cuda:0')
Server loss: 3.019056558609009
train global classifier
train glclassifier time: 3.734034612774849
global classifier accuracy: 100.0
end Update
server_global_time: 1262.5714037790895
only_train_time: 12641.65494967252

-------------Global Round number: 78-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6348
Averaged Test Accuracy (Prototype Model): 0.6340
Std Test Accuracy (Regular Model): 0.1056
Std Test Accuracy (Prototype Model): 0.1027
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 9, 5, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 9, 5, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.5744, 8.4041, 8.2973, 8.8539, 8.2354, 9.3571, 8.9882, 8.1762, 8.1762,
        8.8868], device='cuda:0')
Server loss: 3.0100388526916504
train global classifier
train glclassifier time: 3.604555055499077
global classifier accuracy: 100.0
end Update
server_global_time: 1278.1096317321062
only_train_time: 12800.940014347434

-------------Global Round number: 79-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6348
Averaged Test Accuracy (Prototype Model): 0.6344
Std Test Accuracy (Regular Model): 0.1058
Std Test Accuracy (Prototype Model): 0.1026
tobetrained:
[0, 8, 2, 1, 9, 5, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 9 begin training
Edge 5 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.5707, 8.4093, 8.3099, 8.8595, 8.2456, 9.3652, 8.9990, 8.1862, 8.1862,
        8.8985], device='cuda:0')
Server loss: 2.997891426086426
train global classifier
train glclassifier time: 3.6424920186400414
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 1294.015090368688
only_train_time: 12959.263698019087

-------------Global Round number: 80-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6348
Averaged Test Accuracy (Prototype Model): 0.6338
Std Test Accuracy (Regular Model): 0.1053
Std Test Accuracy (Prototype Model): 0.1025
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.5632, 8.4108, 8.3116, 8.8735, 8.2589, 9.3669, 9.0126, 8.1911, 8.1911,
        8.9038], device='cuda:0')
Server loss: 2.9826037883758545
train global classifier
train glclassifier time: 3.7200120836496353
global classifier accuracy: 100.0
end Update
server_global_time: 1309.724146194756
only_train_time: 13120.67386303097

-------------Global Round number: 81-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6350
Averaged Test Accuracy (Prototype Model): 0.6341
Std Test Accuracy (Regular Model): 0.1056
Std Test Accuracy (Prototype Model): 0.1023
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.5565, 8.4147, 8.3198, 8.8820, 8.2661, 9.3737, 9.0172, 8.1950, 8.1950,
        8.9130], device='cuda:0')
Server loss: 2.9692859649658203
train global classifier
train glclassifier time: 3.7471625953912735
global classifier accuracy: 100.0
end Update
server_global_time: 1325.4958761706948
only_train_time: 13280.957415550947

-------------Global Round number: 82-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6348
Averaged Test Accuracy (Prototype Model): 0.6342
Std Test Accuracy (Regular Model): 0.1050
Std Test Accuracy (Prototype Model): 0.1021
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.5554, 8.4137, 8.3199, 8.8972, 8.2760, 9.3825, 9.0247, 8.1880, 8.1880,
        8.9091], device='cuda:0')
Server loss: 2.9611783027648926
train global classifier
train glclassifier time: 3.739590749144554
global classifier accuracy: 100.0
end Update
server_global_time: 1341.2511537149549
only_train_time: 13441.609186910093

-------------Global Round number: 83-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6346
Averaged Test Accuracy (Prototype Model): 0.6341
Std Test Accuracy (Regular Model): 0.1053
Std Test Accuracy (Prototype Model): 0.1031
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.5453, 8.4108, 8.3198, 8.9032, 8.2829, 9.3841, 9.0324, 8.1898, 8.1898,
        8.9157], device='cuda:0')
Server loss: 2.946197271347046
train global classifier
train glclassifier time: 3.7167680859565735
global classifier accuracy: 100.0
end Update
server_global_time: 1357.0537016168237
only_train_time: 13602.381813749671

-------------Global Round number: 84-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6350
Averaged Test Accuracy (Prototype Model): 0.6348
Std Test Accuracy (Regular Model): 0.1054
Std Test Accuracy (Prototype Model): 0.1027
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.5465, 8.4147, 8.3339, 8.9105, 8.2917, 9.3921, 9.0346, 8.2066, 8.2066,
        8.9290], device='cuda:0')
Server loss: 2.9392194747924805
train global classifier
train glclassifier time: 3.6602311730384827
global classifier accuracy: 100.0
end Update
server_global_time: 1372.6803409606218
only_train_time: 13762.519747376442

-------------Global Round number: 85-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6350
Averaged Test Accuracy (Prototype Model): 0.6346
Std Test Accuracy (Regular Model): 0.1052
Std Test Accuracy (Prototype Model): 0.1028
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.5389, 8.4206, 8.3355, 8.9217, 8.2999, 9.3949, 9.0364, 8.2041, 8.2041,
        8.9310], device='cuda:0')
Server loss: 2.9291582107543945
train global classifier
train glclassifier time: 3.691424645483494
global classifier accuracy: 100.0
end Update
server_global_time: 1389.0164672359824
only_train_time: 13922.930621050298

-------------Global Round number: 86-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6348
Averaged Test Accuracy (Prototype Model): 0.6344
Std Test Accuracy (Regular Model): 0.1050
Std Test Accuracy (Prototype Model): 0.1026
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 9, 5, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 9, 5, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.5344, 8.4255, 8.3421, 8.9317, 8.3094, 9.3988, 9.0397, 8.2093, 8.2093,
        8.9386], device='cuda:0')
Server loss: 2.91646409034729
train global classifier
train glclassifier time: 3.7409893944859505
global classifier accuracy: 100.0
end Update
server_global_time: 1404.8085932135582
only_train_time: 14081.389682747424

-------------Global Round number: 87-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6348
Averaged Test Accuracy (Prototype Model): 0.6341
Std Test Accuracy (Regular Model): 0.1057
Std Test Accuracy (Prototype Model): 0.1023
tobetrained:
[0, 8, 2, 1, 9, 5, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 9 begin training
Edge 5 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.5274, 8.4301, 8.3520, 8.9423, 8.3167, 9.4043, 9.0446, 8.2107, 8.2107,
        8.9469], device='cuda:0')
Server loss: 2.9051787853240967
train global classifier
train glclassifier time: 3.7215977013111115
global classifier accuracy: 100.0
end Update
server_global_time: 1420.4954189062119
only_train_time: 14240.942131273448

-------------Global Round number: 88-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6349
Averaged Test Accuracy (Prototype Model): 0.6344
Std Test Accuracy (Regular Model): 0.1049
Std Test Accuracy (Prototype Model): 0.1027
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.5249, 8.4382, 8.3583, 8.9497, 8.3241, 9.4098, 9.0476, 8.2171, 8.2171,
        8.9580], device='cuda:0')
Server loss: 2.8944437503814697
train global classifier
train glclassifier time: 3.641045853495598
global classifier accuracy: 100.0
end Update
server_global_time: 1436.158979587257
only_train_time: 14402.152127444744

-------------Global Round number: 89-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6351
Averaged Test Accuracy (Prototype Model): 0.6342
Std Test Accuracy (Regular Model): 0.1055
Std Test Accuracy (Prototype Model): 0.1027
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.5227, 8.4370, 8.3590, 8.9575, 8.3319, 9.4113, 9.0540, 8.2194, 8.2194,
        8.9627], device='cuda:0')
Server loss: 2.8871853351593018
train global classifier
train glclassifier time: 3.6495043709874153
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 1452.227969288826
only_train_time: 14561.912451595068

-------------Global Round number: 90-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6348
Averaged Test Accuracy (Prototype Model): 0.6341
Std Test Accuracy (Regular Model): 0.1058
Std Test Accuracy (Prototype Model): 0.1027
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.5172, 8.4397, 8.3604, 8.9623, 8.3420, 9.4208, 9.0601, 8.2265, 8.2265,
        8.9678], device='cuda:0')
Server loss: 2.873056173324585
train global classifier
train glclassifier time: 3.705824226140976
global classifier accuracy: 100.0
end Update
server_global_time: 1467.890346430242
only_train_time: 14721.082511603832

-------------Global Round number: 91-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6345
Averaged Test Accuracy (Prototype Model): 0.6348
Std Test Accuracy (Regular Model): 0.1059
Std Test Accuracy (Prototype Model): 0.1023
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.5161, 8.4390, 8.3641, 8.9704, 8.3456, 9.4302, 9.0645, 8.2247, 8.2247,
        8.9728], device='cuda:0')
Server loss: 2.8664653301239014
train global classifier
train glclassifier time: 3.8020590767264366
global classifier accuracy: 100.0
end Update
server_global_time: 1483.8299535363913
only_train_time: 14880.251586906612

-------------Global Round number: 92-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6345
Averaged Test Accuracy (Prototype Model): 0.6343
Std Test Accuracy (Regular Model): 0.1064
Std Test Accuracy (Prototype Model): 0.1021
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.5159, 8.4400, 8.3712, 8.9776, 8.3511, 9.4341, 9.0720, 8.2300, 8.2300,
        8.9779], device='cuda:0')
Server loss: 2.862619400024414
train global classifier
train glclassifier time: 3.7497493773698807
global classifier accuracy: 100.0
end Update
server_global_time: 1499.7862474545836
only_train_time: 15040.593589752913

-------------Global Round number: 93-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6344
Averaged Test Accuracy (Prototype Model): 0.6346
Std Test Accuracy (Regular Model): 0.1057
Std Test Accuracy (Prototype Model): 0.1027
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.5152, 8.4420, 8.3739, 8.9915, 8.3603, 9.4430, 9.0812, 8.2301, 8.2301,
        8.9813], device='cuda:0')
Server loss: 2.8534159660339355
train global classifier
train glclassifier time: 3.777669057250023
global classifier accuracy: 100.0
end Update
server_global_time: 1515.6452332884073
only_train_time: 15199.995134472847

-------------Global Round number: 94-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6347
Averaged Test Accuracy (Prototype Model): 0.6352
Std Test Accuracy (Regular Model): 0.1063
Std Test Accuracy (Prototype Model): 0.1026
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.5092, 8.4463, 8.3795, 8.9962, 8.3669, 9.4404, 9.0865, 8.2376, 8.2376,
        8.9903], device='cuda:0')
Server loss: 2.844266653060913
train global classifier
train glclassifier time: 3.6946911737322807
global classifier accuracy: 100.0
end Update
server_global_time: 1532.5764425471425
only_train_time: 15361.874231256545

-------------Global Round number: 95-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6346
Averaged Test Accuracy (Prototype Model): 0.6349
Std Test Accuracy (Regular Model): 0.1062
Std Test Accuracy (Prototype Model): 0.1026
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.5004, 8.4481, 8.3865, 9.0062, 8.3693, 9.4512, 9.0878, 8.2384, 8.2384,
        8.9886], device='cuda:0')
Server loss: 2.831260919570923
train global classifier
train glclassifier time: 4.437157824635506
global classifier accuracy: 100.0
end Update
server_global_time: 1549.4882918596268
only_train_time: 15527.995085120201

-------------Global Round number: 96-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6347
Averaged Test Accuracy (Prototype Model): 0.6343
Std Test Accuracy (Regular Model): 0.1059
Std Test Accuracy (Prototype Model): 0.1031
tobetrained:
[0, 2, 8, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.4938, 8.4516, 8.3888, 9.0197, 8.3813, 9.4510, 9.0966, 8.2426, 8.2426,
        8.9925], device='cuda:0')
Server loss: 2.8193087577819824
train global classifier
train glclassifier time: 3.6863523572683334
global classifier accuracy: 100.0
end Update
server_global_time: 1565.4662134349346
only_train_time: 15690.094146601856

-------------Global Round number: 97-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6346
Averaged Test Accuracy (Prototype Model): 0.6347
Std Test Accuracy (Regular Model): 0.1061
Std Test Accuracy (Prototype Model): 0.1026
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.4717, 8.2102, 8.3279, 9.0206, 8.3855, 9.4061, 9.0629, 8.2049, 8.2049,
        8.8824], device='cuda:0')
Server loss: 2.8932228088378906
train global classifier
train glclassifier time: 3.7406892627477646
global classifier accuracy: 100.0
end Update
server_global_time: 1581.2185240909457
only_train_time: 15851.439570143819

-------------Global Round number: 98-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6354
Averaged Test Accuracy (Prototype Model): 0.6357
Std Test Accuracy (Regular Model): 0.1058
Std Test Accuracy (Prototype Model): 0.1023
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.4745, 8.3252, 8.3660, 9.0291, 8.3922, 9.4319, 9.0808, 8.2284, 8.2284,
        8.9546], device='cuda:0')
Server loss: 2.846104860305786
train global classifier
train glclassifier time: 3.793791174888611
global classifier accuracy: 100.0
end Update
server_global_time: 1598.03387452662
only_train_time: 16016.482760086656

-------------Global Round number: 99-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6357
Averaged Test Accuracy (Prototype Model): 0.6356
Std Test Accuracy (Regular Model): 0.1059
Std Test Accuracy (Prototype Model): 0.1021
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.4730, 8.3626, 8.3789, 9.0370, 8.4018, 9.4452, 9.0887, 8.2360, 8.2360,
        8.9733], device='cuda:0')
Server loss: 2.8239619731903076
train global classifier
train glclassifier time: 3.8102132454514503
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 1614.330712132156
only_train_time: 16180.653290212154

-------------Global Round number: 100-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6356
Averaged Test Accuracy (Prototype Model): 0.6355
Std Test Accuracy (Regular Model): 0.1060
Std Test Accuracy (Prototype Model): 0.1029
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.4693, 8.3735, 8.3850, 9.0506, 8.4092, 9.4608, 9.0910, 8.2398, 8.2398,
        8.9839], device='cuda:0')
Server loss: 2.8090438842773438
train global classifier
train glclassifier time: 3.766642466187477
global classifier accuracy: 100.0
end Update
server_global_time: 1629.9979667067528
only_train_time: 16341.68333363533

-------------Global Round number: 101-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6359
Averaged Test Accuracy (Prototype Model): 0.6352
Std Test Accuracy (Regular Model): 0.1063
Std Test Accuracy (Prototype Model): 0.1031
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.4674, 8.3870, 8.3936, 9.0548, 8.4144, 9.4696, 9.0948, 8.2416, 8.2416,
        8.9903], device='cuda:0')
Server loss: 2.8007283210754395
train global classifier
train glclassifier time: 3.652655154466629
global classifier accuracy: 100.0
end Update
server_global_time: 1646.1543062925339
only_train_time: 16502.620418451726

-------------Global Round number: 102-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6361
Averaged Test Accuracy (Prototype Model): 0.6351
Std Test Accuracy (Regular Model): 0.1063
Std Test Accuracy (Prototype Model): 0.1027
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.4604, 8.3965, 8.3964, 9.0594, 8.4143, 9.4787, 9.0997, 8.2435, 8.2435,
        9.0017], device='cuda:0')
Server loss: 2.800693988800049
train global classifier
train glclassifier time: 4.808660991489887
global classifier accuracy: 100.0
end Update
server_global_time: 1663.5069034546614
only_train_time: 16666.76693253219

-------------Global Round number: 103-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6364
Averaged Test Accuracy (Prototype Model): 0.6354
Std Test Accuracy (Regular Model): 0.1057
Std Test Accuracy (Prototype Model): 0.1035
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.4553, 8.4082, 8.4033, 9.0658, 8.4258, 9.4807, 9.1032, 8.2537, 8.2537,
        9.0183], device='cuda:0')
Server loss: 2.7925913333892822
train global classifier
train glclassifier time: 3.695931449532509
global classifier accuracy: 100.0
end Update
server_global_time: 1679.396141730249
only_train_time: 16829.074897661805

-------------Global Round number: 104-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6364
Averaged Test Accuracy (Prototype Model): 0.6351
Std Test Accuracy (Regular Model): 0.1057
Std Test Accuracy (Prototype Model): 0.1038
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[8, 0, 2, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[8, 0, 2, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.4540, 8.4151, 8.4090, 9.0751, 8.4397, 9.4851, 9.1111, 8.2533, 8.2533,
        9.0217], device='cuda:0')
Server loss: 2.789729356765747
train global classifier
train glclassifier time: 3.725537955760956
global classifier accuracy: 100.0
end Update
server_global_time: 1696.3468508198857
only_train_time: 16993.035497687757

-------------Global Round number: 105-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6358
Averaged Test Accuracy (Prototype Model): 0.6354
Std Test Accuracy (Regular Model): 0.1058
Std Test Accuracy (Prototype Model): 0.1035
tobetrained:
[8, 0, 2, 5, 9, 1, 4, 6, 3, 7]
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.4461, 8.4187, 8.4127, 9.0879, 8.4468, 9.4888, 9.1095, 8.2587, 8.2587,
        9.0272], device='cuda:0')
Server loss: 2.7893214225769043
train global classifier
train glclassifier time: 4.015042036771774
global classifier accuracy: 100.0
end Update
server_global_time: 1712.2615840807557
only_train_time: 17154.387275405228

-------------Global Round number: 106-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6362
Averaged Test Accuracy (Prototype Model): 0.6353
Std Test Accuracy (Regular Model): 0.1056
Std Test Accuracy (Prototype Model): 0.1034
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.4426, 8.4249, 8.4193, 9.0937, 8.4496, 9.4937, 9.1116, 8.2645, 8.2645,
        9.0362], device='cuda:0')
Server loss: 2.786891222000122
train global classifier
train glclassifier time: 3.888520307838917
global classifier accuracy: 100.0
end Update
server_global_time: 1728.478594392538
only_train_time: 17315.51543596387

-------------Global Round number: 107-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6368
Averaged Test Accuracy (Prototype Model): 0.6357
Std Test Accuracy (Regular Model): 0.1056
Std Test Accuracy (Prototype Model): 0.1034
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.4427, 8.4310, 8.4221, 9.0975, 8.4551, 9.4955, 9.1177, 8.2664, 8.2664,
        9.0424], device='cuda:0')
Server loss: 2.784482955932617
train global classifier
train glclassifier time: 3.7498450949788094
global classifier accuracy: 100.0
end Update
server_global_time: 1744.3564653024077
only_train_time: 17477.055121541023

-------------Global Round number: 108-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6367
Averaged Test Accuracy (Prototype Model): 0.6356
Std Test Accuracy (Regular Model): 0.1052
Std Test Accuracy (Prototype Model): 0.1031
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.4418, 8.4390, 8.4297, 9.1028, 8.4604, 9.4996, 9.1182, 8.2716, 8.2716,
        9.0493], device='cuda:0')
Server loss: 2.782764434814453
train global classifier
train glclassifier time: 3.7162254974246025
global classifier accuracy: 100.0
end Update
server_global_time: 1760.6075405701995
only_train_time: 17638.648697949946

-------------Global Round number: 109-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6363
Averaged Test Accuracy (Prototype Model): 0.6356
Std Test Accuracy (Regular Model): 0.1055
Std Test Accuracy (Prototype Model): 0.1038
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.4347, 8.4463, 8.4315, 9.1087, 8.4680, 9.5056, 9.1257, 8.2781, 8.2781,
        9.0490], device='cuda:0')
Server loss: 2.7815194129943848
train global classifier
train glclassifier time: 3.826114244759083
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 1776.5386820733547
only_train_time: 17800.087024994195

-------------Global Round number: 110-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6365
Averaged Test Accuracy (Prototype Model): 0.6359
Std Test Accuracy (Regular Model): 0.1057
Std Test Accuracy (Prototype Model): 0.1044
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.4366, 8.4527, 8.4328, 9.1177, 8.4779, 9.5113, 9.1237, 8.2807, 8.2807,
        9.0526], device='cuda:0')
Server loss: 2.7802951335906982
train global classifier
train glclassifier time: 3.805799014866352
global classifier accuracy: 100.0
end Update
server_global_time: 1792.6499862745404
only_train_time: 17962.012691907585

-------------Global Round number: 111-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6362
Averaged Test Accuracy (Prototype Model): 0.6356
Std Test Accuracy (Regular Model): 0.1057
Std Test Accuracy (Prototype Model): 0.1037
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.4298, 8.4549, 8.4427, 9.1361, 8.4869, 9.5133, 9.1294, 8.2833, 8.2833,
        9.0592], device='cuda:0')
Server loss: 2.776458978652954
train global classifier
train glclassifier time: 3.6776242181658745
global classifier accuracy: 100.0
end Update
server_global_time: 1808.8500630632043
only_train_time: 18123.254443995655

-------------Global Round number: 112-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6359
Averaged Test Accuracy (Prototype Model): 0.6355
Std Test Accuracy (Regular Model): 0.1054
Std Test Accuracy (Prototype Model): 0.1044
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 1, 9, 5, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 9, 5, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.4288, 8.4566, 8.4429, 9.1432, 8.4903, 9.5146, 9.1306, 8.2888, 8.2888,
        9.0617], device='cuda:0')
Server loss: 2.7747716903686523
train global classifier
train glclassifier time: 3.736028090119362
global classifier accuracy: 100.0
end Update
server_global_time: 1824.8161002844572
only_train_time: 18284.92884297669

-------------Global Round number: 113-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6359
Averaged Test Accuracy (Prototype Model): 0.6354
Std Test Accuracy (Regular Model): 0.1061
Std Test Accuracy (Prototype Model): 0.1046
tobetrained:
[0, 8, 2, 1, 9, 5, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 9 begin training
Edge 5 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.4235, 8.4590, 8.4452, 9.1493, 8.4958, 9.5227, 9.1375, 8.2885, 8.2885,
        9.0665], device='cuda:0')
Server loss: 2.7769105434417725
train global classifier
train glclassifier time: 4.668855778872967
global classifier accuracy: 100.0
end Update
server_global_time: 1841.380997799337
only_train_time: 18447.75831271708

-------------Global Round number: 114-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6356
Averaged Test Accuracy (Prototype Model): 0.6354
Std Test Accuracy (Regular Model): 0.1062
Std Test Accuracy (Prototype Model): 0.1047
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[2, 0, 8, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[2, 0, 8, 1, 5, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.4194, 8.4648, 8.4510, 9.1559, 8.5039, 9.5261, 9.1392, 8.2945, 8.2945,
        9.0716], device='cuda:0')
Server loss: 2.7728164196014404
train global classifier
train glclassifier time: 3.6392434164881706
global classifier accuracy: 100.0
end Update
server_global_time: 1857.1017667800188
only_train_time: 18608.578933738172

-------------Global Round number: 115-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6356
Averaged Test Accuracy (Prototype Model): 0.6350
Std Test Accuracy (Regular Model): 0.1055
Std Test Accuracy (Prototype Model): 0.1042
tobetrained:
[2, 0, 8, 1, 5, 9, 4, 6, 3, 7]
Edge 2 begin training
Edge 0 begin training
Edge 8 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[8, 0, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[8, 0, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.4158, 8.4722, 8.4561, 9.1598, 8.5081, 9.5302, 9.1417, 8.3000, 8.3000,
        9.0756], device='cuda:0')
Server loss: 2.774360418319702
train global classifier
train glclassifier time: 3.7297459468245506
global classifier accuracy: 100.0
end Update
server_global_time: 1872.7079903557897
only_train_time: 18769.05775101483

-------------Global Round number: 116-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6359
Averaged Test Accuracy (Prototype Model): 0.6348
Std Test Accuracy (Regular Model): 0.1058
Std Test Accuracy (Prototype Model): 0.1034
tobetrained:
[8, 0, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.3797, 8.4518, 8.4388, 9.1260, 8.5157, 9.5295, 9.1307, 8.2862, 8.2862,
        9.0398], device='cuda:0')
Server loss: 2.8402488231658936
train global classifier
train glclassifier time: 3.7023980766534805
global classifier accuracy: 100.0
end Update
server_global_time: 1888.1639441028237
only_train_time: 18929.864616580307

-------------Global Round number: 117-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6338
Averaged Test Accuracy (Prototype Model): 0.6332
Std Test Accuracy (Regular Model): 0.1072
Std Test Accuracy (Prototype Model): 0.1065
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 9, 5, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 9, 5, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.3861, 8.4561, 8.4504, 9.1033, 8.5183, 9.5395, 9.1283, 8.2923, 8.2923,
        9.0374], device='cuda:0')
Server loss: 2.8348894119262695
train global classifier
train glclassifier time: 4.394812099635601
global classifier accuracy: 100.0
end Update
server_global_time: 1905.1730885207653
only_train_time: 19090.59010451287

-------------Global Round number: 118-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6355
Averaged Test Accuracy (Prototype Model): 0.6355
Std Test Accuracy (Regular Model): 0.1055
Std Test Accuracy (Prototype Model): 0.1040
tobetrained:
[0, 8, 2, 1, 9, 5, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 9 begin training
Edge 5 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.3923, 8.4653, 8.4605, 9.1156, 8.5255, 9.5406, 9.1415, 8.3041, 8.3041,
        9.0583], device='cuda:0')
Server loss: 2.8099629878997803
train global classifier
train glclassifier time: 3.7086364701390266
global classifier accuracy: 100.0
end Update
server_global_time: 1921.0910357534885
only_train_time: 19255.500145107508

-------------Global Round number: 119-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6354
Averaged Test Accuracy (Prototype Model): 0.6357
Std Test Accuracy (Regular Model): 0.1054
Std Test Accuracy (Prototype Model): 0.1036
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.3906, 8.4774, 8.4668, 9.1290, 8.5273, 9.5418, 9.1436, 8.3078, 8.3078,
        9.0698], device='cuda:0')
Server loss: 2.797830581665039
train global classifier
train glclassifier time: 3.82115089148283
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 1938.0927827209234
only_train_time: 19417.15203884989

-------------Global Round number: 120-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6356
Averaged Test Accuracy (Prototype Model): 0.6360
Std Test Accuracy (Regular Model): 0.1054
Std Test Accuracy (Prototype Model): 0.1036
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.3924, 8.4753, 8.4697, 9.1414, 8.5350, 9.5480, 9.1506, 8.3112, 8.3112,
        9.0721], device='cuda:0')
Server loss: 2.793806791305542
train global classifier
train glclassifier time: 3.6728985011577606
global classifier accuracy: 100.0
end Update
server_global_time: 1954.6233229264617
only_train_time: 19581.88282688707

-------------Global Round number: 121-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6354
Averaged Test Accuracy (Prototype Model): 0.6356
Std Test Accuracy (Regular Model): 0.1050
Std Test Accuracy (Prototype Model): 0.1042
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.3872, 8.4826, 8.4695, 9.1531, 8.5391, 9.5454, 9.1499, 8.3087, 8.3087,
        9.0840], device='cuda:0')
Server loss: 2.7856838703155518
train global classifier
train glclassifier time: 3.737503193318844
global classifier accuracy: 100.0
end Update
server_global_time: 1970.983704276383
only_train_time: 19744.03075608611

-------------Global Round number: 122-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6359
Averaged Test Accuracy (Prototype Model): 0.6360
Std Test Accuracy (Regular Model): 0.1049
Std Test Accuracy (Prototype Model): 0.1037
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.3845, 8.4882, 8.4775, 9.1663, 8.5444, 9.5523, 9.1540, 8.3134, 8.3134,
        9.0866], device='cuda:0')
Server loss: 2.7840628623962402
train global classifier
train glclassifier time: 3.7000733986496925
global classifier accuracy: 100.0
end Update
server_global_time: 1986.7908360660076
only_train_time: 19905.320660673082

-------------Global Round number: 123-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6353
Averaged Test Accuracy (Prototype Model): 0.6359
Std Test Accuracy (Regular Model): 0.1052
Std Test Accuracy (Prototype Model): 0.1036
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.3840, 8.4963, 8.4822, 9.1712, 8.5521, 9.5536, 9.1571, 8.3196, 8.3196,
        9.0918], device='cuda:0')
Server loss: 2.778903007507324
train global classifier
train glclassifier time: 3.728552281856537
global classifier accuracy: 100.0
end Update
server_global_time: 2002.8269817307591
only_train_time: 20066.152155175805

-------------Global Round number: 124-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6352
Averaged Test Accuracy (Prototype Model): 0.6355
Std Test Accuracy (Regular Model): 0.1050
Std Test Accuracy (Prototype Model): 0.1041
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.3801, 8.4952, 8.4817, 9.1837, 8.5527, 9.5562, 9.1615, 8.3169, 8.3169,
        9.0974], device='cuda:0')
Server loss: 2.7760703563690186
train global classifier
train glclassifier time: 3.71382600069046
global classifier accuracy: 100.0
end Update
server_global_time: 2018.669598698616
only_train_time: 20226.791368976235

-------------Global Round number: 125-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6355
Averaged Test Accuracy (Prototype Model): 0.6358
Std Test Accuracy (Regular Model): 0.1047
Std Test Accuracy (Prototype Model): 0.1038
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.3743, 8.4979, 8.4884, 9.1971, 8.5601, 9.5587, 9.1671, 8.3239, 8.3239,
        9.1042], device='cuda:0')
Server loss: 2.7718617916107178
train global classifier
train glclassifier time: 3.7228561863303185
global classifier accuracy: 100.0
end Update
server_global_time: 2034.193484455347
only_train_time: 20387.441337391734

-------------Global Round number: 126-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6350
Averaged Test Accuracy (Prototype Model): 0.6360
Std Test Accuracy (Regular Model): 0.1047
Std Test Accuracy (Prototype Model): 0.1034
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.3702, 8.4979, 8.4912, 9.2090, 8.5680, 9.5624, 9.1742, 8.3220, 8.3220,
        9.1000], device='cuda:0')
Server loss: 2.7726387977600098
train global classifier
train glclassifier time: 3.67309582978487
global classifier accuracy: 100.0
end Update
server_global_time: 2049.7192387655377
only_train_time: 20545.44013133645

-------------Global Round number: 127-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6351
Averaged Test Accuracy (Prototype Model): 0.6360
Std Test Accuracy (Regular Model): 0.1044
Std Test Accuracy (Prototype Model): 0.1032
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.3711, 8.4994, 8.4956, 9.2162, 8.5734, 9.5673, 9.1715, 8.3263, 8.3263,
        9.1075], device='cuda:0')
Server loss: 2.7703092098236084
train global classifier
train glclassifier time: 3.686478815972805
global classifier accuracy: 100.0
end Update
server_global_time: 2065.6949638947845
only_train_time: 20706.612225919962

-------------Global Round number: 128-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6349
Averaged Test Accuracy (Prototype Model): 0.6353
Std Test Accuracy (Regular Model): 0.1051
Std Test Accuracy (Prototype Model): 0.1034
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.3660, 8.4981, 8.4940, 9.2244, 8.5823, 9.5682, 9.1745, 8.3311, 8.3311,
        9.1095], device='cuda:0')
Server loss: 2.768491744995117
train global classifier
train glclassifier time: 3.669801689684391
global classifier accuracy: 100.0
end Update
server_global_time: 2081.747050240636
only_train_time: 20867.73018361628

-------------Global Round number: 129-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6350
Averaged Test Accuracy (Prototype Model): 0.6359
Std Test Accuracy (Regular Model): 0.1052
Std Test Accuracy (Prototype Model): 0.1021
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.3668, 8.5046, 8.5005, 9.2352, 8.5812, 9.5710, 9.1743, 8.3325, 8.3325,
        9.1142], device='cuda:0')
Server loss: 2.7653286457061768
train global classifier
train glclassifier time: 3.616322249174118
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 2097.2841717377305
only_train_time: 21025.766372941434

-------------Global Round number: 130-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6350
Averaged Test Accuracy (Prototype Model): 0.6360
Std Test Accuracy (Regular Model): 0.1055
Std Test Accuracy (Prototype Model): 0.1025
tobetrained:
[0, 2, 8, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.3656, 8.5053, 8.5031, 9.2436, 8.5872, 9.5806, 9.1825, 8.3343, 8.3343,
        9.1127], device='cuda:0')
Server loss: 2.770254373550415
train global classifier
train glclassifier time: 3.6788924857974052
global classifier accuracy: 100.0
end Update
server_global_time: 2112.9439677745104
only_train_time: 21185.849752686918

-------------Global Round number: 131-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6350
Averaged Test Accuracy (Prototype Model): 0.6364
Std Test Accuracy (Regular Model): 0.1050
Std Test Accuracy (Prototype Model): 0.1029
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.3650, 8.5082, 8.5038, 9.2471, 8.5936, 9.5822, 9.1853, 8.3389, 8.3389,
        9.1221], device='cuda:0')
Server loss: 2.7670867443084717
train global classifier
train glclassifier time: 4.070571072399616
global classifier accuracy: 100.0
end Update
server_global_time: 2128.690036661923
only_train_time: 21343.918681897223

-------------Global Round number: 132-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6350
Averaged Test Accuracy (Prototype Model): 0.6364
Std Test Accuracy (Regular Model): 0.1054
Std Test Accuracy (Prototype Model): 0.1029
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.3626, 8.5094, 8.5097, 9.2524, 8.5942, 9.5882, 9.1859, 8.3432, 8.3432,
        9.1227], device='cuda:0')
Server loss: 2.769502639770508
train global classifier
train glclassifier time: 3.99324831366539
global classifier accuracy: 100.0
end Update
server_global_time: 2144.2069852352142
only_train_time: 21504.471728660166

-------------Global Round number: 133-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6351
Averaged Test Accuracy (Prototype Model): 0.6362
Std Test Accuracy (Regular Model): 0.1049
Std Test Accuracy (Prototype Model): 0.1029
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.3540, 8.5128, 8.5101, 9.2614, 8.6017, 9.5875, 9.1890, 8.3424, 8.3424,
        9.1315], device='cuda:0')
Server loss: 2.7655842304229736
train global classifier
train glclassifier time: 4.082798287272453
global classifier accuracy: 100.0
end Update
server_global_time: 2159.647120811045
only_train_time: 21662.462260067463

-------------Global Round number: 134-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6346
Averaged Test Accuracy (Prototype Model): 0.6361
Std Test Accuracy (Regular Model): 0.1049
Std Test Accuracy (Prototype Model): 0.1017
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.3506, 8.5167, 8.5169, 9.2685, 8.6127, 9.5898, 9.1942, 8.3452, 8.3452,
        9.1342], device='cuda:0')
Server loss: 2.7632369995117188
train global classifier
train glclassifier time: 3.7212415635585785
global classifier accuracy: 100.0
end Update
server_global_time: 2175.849942408502
only_train_time: 21822.56860330701

-------------Global Round number: 135-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6349
Averaged Test Accuracy (Prototype Model): 0.6358
Std Test Accuracy (Regular Model): 0.1051
Std Test Accuracy (Prototype Model): 0.1025
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.3480, 8.5174, 8.5186, 9.2743, 8.6130, 9.5978, 9.1969, 8.3466, 8.3466,
        9.1388], device='cuda:0')
Server loss: 2.767637014389038
train global classifier
train glclassifier time: 4.13236390799284
global classifier accuracy: 100.0
end Update
server_global_time: 2191.0702705159783
only_train_time: 21980.01993957907

-------------Global Round number: 136-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6346
Averaged Test Accuracy (Prototype Model): 0.6356
Std Test Accuracy (Regular Model): 0.1050
Std Test Accuracy (Prototype Model): 0.1016
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.3427, 8.5180, 8.5204, 9.2808, 8.6162, 9.6006, 9.1989, 8.3498, 8.3498,
        9.1397], device='cuda:0')
Server loss: 2.766913890838623
train global classifier
train glclassifier time: 3.695891112089157
global classifier accuracy: 100.0
end Update
server_global_time: 2208.0730657577515
only_train_time: 22140.33950819075

-------------Global Round number: 137-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6348
Averaged Test Accuracy (Prototype Model): 0.6359
Std Test Accuracy (Regular Model): 0.1049
Std Test Accuracy (Prototype Model): 0.1017
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.3425, 8.5224, 8.5249, 9.2875, 8.6202, 9.6068, 9.2056, 8.3509, 8.3509,
        9.1445], device='cuda:0')
Server loss: 2.766878604888916
train global classifier
train glclassifier time: 4.0060217678546906
global classifier accuracy: 100.0
end Update
server_global_time: 2224.968493871391
only_train_time: 22300.222232304513

-------------Global Round number: 138-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6346
Averaged Test Accuracy (Prototype Model): 0.6357
Std Test Accuracy (Regular Model): 0.1050
Std Test Accuracy (Prototype Model): 0.1027
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.3375, 8.5269, 8.5308, 9.2908, 8.6204, 9.6159, 9.2129, 8.3535, 8.3535,
        9.1462], device='cuda:0')
Server loss: 2.7726998329162598
train global classifier
train glclassifier time: 3.8441314101219177
global classifier accuracy: 100.0
end Update
server_global_time: 2241.52071736753
only_train_time: 22461.858495414257

-------------Global Round number: 139-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6349
Averaged Test Accuracy (Prototype Model): 0.6362
Std Test Accuracy (Regular Model): 0.1050
Std Test Accuracy (Prototype Model): 0.1027
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.3363, 8.5259, 8.5317, 9.2964, 8.6240, 9.6180, 9.2161, 8.3536, 8.3536,
        9.1486], device='cuda:0')
Server loss: 2.770946741104126
train global classifier
train glclassifier time: 4.056110709905624
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 2257.147902570665
only_train_time: 22619.629143685102

-------------Global Round number: 140-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6348
Averaged Test Accuracy (Prototype Model): 0.6358
Std Test Accuracy (Regular Model): 0.1049
Std Test Accuracy (Prototype Model): 0.1024
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.3341, 8.5233, 8.5338, 9.3040, 8.6312, 9.6218, 9.2197, 8.3556, 8.3556,
        9.1549], device='cuda:0')
Server loss: 2.769625186920166
train global classifier
train glclassifier time: 4.086293637752533
global classifier accuracy: 100.0
end Update
server_global_time: 2272.6957613527775
only_train_time: 22777.73057913035

-------------Global Round number: 141-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6350
Averaged Test Accuracy (Prototype Model): 0.6357
Std Test Accuracy (Regular Model): 0.1045
Std Test Accuracy (Prototype Model): 0.1026
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.3355, 8.5291, 8.5419, 9.3118, 8.6387, 9.6243, 9.2261, 8.3628, 8.3628,
        9.1573], device='cuda:0')
Server loss: 2.7687644958496094
train global classifier
train glclassifier time: 3.6753914803266525
global classifier accuracy: 100.0
end Update
server_global_time: 2288.977380298078
only_train_time: 22937.585028015077

-------------Global Round number: 142-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6348
Averaged Test Accuracy (Prototype Model): 0.6354
Std Test Accuracy (Regular Model): 0.1046
Std Test Accuracy (Prototype Model): 0.1032
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.3318, 8.5316, 8.5467, 9.3163, 8.6443, 9.6277, 9.2288, 8.3712, 8.3712,
        9.1569], device='cuda:0')
Server loss: 2.7685976028442383
train global classifier
train glclassifier time: 4.018833488225937
global classifier accuracy: 100.0
end Update
server_global_time: 2304.653258368373
only_train_time: 23097.426547311246

-------------Global Round number: 143-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6353
Averaged Test Accuracy (Prototype Model): 0.6357
Std Test Accuracy (Regular Model): 0.1047
Std Test Accuracy (Prototype Model): 0.1036
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 9, 5, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 1, 9, 5, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.3259, 8.5394, 8.5515, 9.3237, 8.6469, 9.6321, 9.2279, 8.3742, 8.3742,
        9.1641], device='cuda:0')
Server loss: 2.7690083980560303
train global classifier
train glclassifier time: 3.9538674354553223
global classifier accuracy: 100.0
end Update
server_global_time: 2320.829040721059
only_train_time: 23258.999797567725

-------------Global Round number: 144-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6352
Averaged Test Accuracy (Prototype Model): 0.6359
Std Test Accuracy (Regular Model): 0.1051
Std Test Accuracy (Prototype Model): 0.1034
tobetrained:
[0, 8, 2, 1, 9, 5, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 9 begin training
Edge 5 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.3233, 8.5374, 8.5494, 9.3262, 8.6444, 9.6350, 9.2323, 8.3736, 8.3736,
        9.1645], device='cuda:0')
Server loss: 2.7698187828063965
train global classifier
train glclassifier time: 3.7029915302991867
global classifier accuracy: 100.0
end Update
server_global_time: 2336.5655556470156
only_train_time: 23420.47265177965

-------------Global Round number: 145-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6350
Averaged Test Accuracy (Prototype Model): 0.6362
Std Test Accuracy (Regular Model): 0.1052
Std Test Accuracy (Prototype Model): 0.1031
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.3175, 8.5399, 8.5540, 9.3349, 8.6530, 9.6434, 9.2333, 8.3751, 8.3751,
        9.1655], device='cuda:0')
Server loss: 2.7721376419067383
train global classifier
train glclassifier time: 3.9532440155744553
global classifier accuracy: 100.0
end Update
server_global_time: 2352.1039880514145
only_train_time: 23582.27338861674

-------------Global Round number: 146-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6352
Averaged Test Accuracy (Prototype Model): 0.6360
Std Test Accuracy (Regular Model): 0.1046
Std Test Accuracy (Prototype Model): 0.1029
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.3203, 8.5421, 8.5567, 9.3439, 8.6678, 9.6451, 9.2346, 8.3791, 8.3791,
        9.1694], device='cuda:0')
Server loss: 2.769118070602417
train global classifier
train glclassifier time: 3.8786449655890465
global classifier accuracy: 100.0
end Update
server_global_time: 2367.8312352374196
only_train_time: 23742.18082690239

-------------Global Round number: 147-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6357
Averaged Test Accuracy (Prototype Model): 0.6361
Std Test Accuracy (Regular Model): 0.1047
Std Test Accuracy (Prototype Model): 0.1033
tobetrained:
[0, 2, 8, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 9, 5, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 1, 9, 5, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.3141, 8.5436, 8.5604, 9.3535, 8.6696, 9.6436, 9.2357, 8.3808, 8.3808,
        9.1727], device='cuda:0')
Server loss: 2.7682297229766846
train global classifier
train glclassifier time: 3.730929307639599
global classifier accuracy: 100.0
end Update
server_global_time: 2383.2816237956285
only_train_time: 23901.041226632893

-------------Global Round number: 148-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6352
Averaged Test Accuracy (Prototype Model): 0.6360
Std Test Accuracy (Regular Model): 0.1046
Std Test Accuracy (Prototype Model): 0.1040
tobetrained:
[0, 8, 2, 1, 9, 5, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 9 begin training
Edge 5 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.3120, 8.5476, 8.5633, 9.3614, 8.6791, 9.6482, 9.2410, 8.3891, 8.3891,
        9.1770], device='cuda:0')
Server loss: 2.7667019367218018
train global classifier
train glclassifier time: 3.9726730808615685
global classifier accuracy: 100.0
end Update
server_global_time: 2399.331406876445
only_train_time: 24062.92018700391

-------------Global Round number: 149-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6353
Averaged Test Accuracy (Prototype Model): 0.6361
Std Test Accuracy (Regular Model): 0.1045
Std Test Accuracy (Prototype Model): 0.1033
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.3110, 8.5483, 8.5639, 9.3686, 8.6795, 9.6498, 9.2477, 8.3890, 8.3890,
        9.1774], device='cuda:0')
Server loss: 2.76176118850708
train global classifier
train glclassifier time: 3.7320870608091354
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 2414.9749803841114
only_train_time: 24220.526852838695

-------------Global Round number: 150-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6355
Averaged Test Accuracy (Prototype Model): 0.6360
Std Test Accuracy (Regular Model): 0.1049
Std Test Accuracy (Prototype Model): 0.1031

Best accuracy.
0.6371628371628372
File path: ../results/Cifar10_dir_0.3_imbalance_40_FedSAE_test_0.h5
Deleted.

Average time cost: 30469.4s.
Length:  151
std for best accurancy: 0.0
mean for best accurancy: 0.6371628371628372
All done!

Storage on cpu
-------------------------------------------------------------------------------
Total Tensors: 5130 	Used Memory: 20.50K
-------------------------------------------------------------------------------

Storage on cuda:0
-------------------------------------------------------------------------------
Total Tensors: 172064 	Used Memory: 6.44M
The allocated memory on cuda:0: 6.44M
-------------------------------------------------------------------------------
