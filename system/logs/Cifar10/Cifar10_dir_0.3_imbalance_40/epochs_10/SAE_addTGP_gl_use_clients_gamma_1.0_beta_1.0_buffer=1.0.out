==================================================
goal = test
device = cuda
device_id = 0
dataset = Cifar10_dir_0.3_imbalance_40
num_classes = 10
model_family = HtFE8
batch_size = 256
local_learning_rate = 0.06
use_decay_scheduler = False
learning_rate_decay = False
learning_rate_decay_gamma = 0.99
global_rounds = 200
edge_epochs = 1
local_epochs = 10
algorithm = FedSAE
join_ratio = 1.0
random_join_ratio = False
num_clients = 40
num_edges = 10
prev = 0
times = 1
eval_gap = 1
save_folder_name = temp
auto_break = False
feature_dim = 512
vocab_size = 98635
max_len = 200
client_drop_rate = 0.0
train_slow_rate = 0.0
send_slow_rate = 0.0
time_select = False
time_threthold = 10000
lamda = 2
trans_delay_simulate = False
agg_type = 0
buffersize = 10
mixclassifier = 0
gl_use_clients = 1
test_useglclassifier = 1
gamma = 1.0
use_beta = True
SAEbeta = 1.0
addTGP = True
drawtsne = True
drawround = 10
noise_dim = 512
generator_learning_rate = 0.005
hidden_dim = 512
server_epochs = 100
alpha = 1.0
beta = 1.0
mentee_learning_rate = 0.005
T_start = 0.95
T_end = 0.98
server_learning_rate = 0.01
margin_threthold = 100.0
generator_path = stylegan/stylegan-xl-models/imagenet64.pkl
stable_diffusion_prompt = a cat
server_batch_size = 100
gen_batch_size = 4
mu = 50.0
==================================================
Random seed set as 42

============= Running time: 0th =============
Creating server and clients ...
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600)
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes)
mobilenet_v2(pretrained=False, num_classes=args.num_classes)
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes)
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes)
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes)
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes)
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes)
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600) model chosen!
id 0
label_counts: defaultdict(<class 'int'>, {3: 400, 7: 347, 1: 47, 4: 179, 6: 87, 8: 41, 0: 2, 9: 2, 5: 2, 2: 1})
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes) model chosen!
id 1
label_counts: defaultdict(<class 'int'>, {2: 855, 4: 327, 0: 5, 3: 3})
mobilenet_v2(pretrained=False, num_classes=args.num_classes) model chosen!
id 2
label_counts: defaultdict(<class 'int'>, {6: 36, 5: 141, 8: 162, 9: 71, 4: 177, 2: 95, 0: 23, 1: 9, 7: 49, 3: 2})
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes) model chosen!
id 3
label_counts: defaultdict(<class 'int'>, {9: 347, 5: 394, 7: 415, 4: 88, 0: 3, 2: 15, 8: 32})
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes) model chosen!
id 4
label_counts: defaultdict(<class 'int'>, {3: 83, 2: 591, 5: 234, 8: 172, 4: 18, 7: 30, 0: 18, 1: 3})
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes) model chosen!
id 5
label_counts: defaultdict(<class 'int'>, {5: 565, 0: 841, 1: 70, 3: 35})
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes) model chosen!
id 6
label_counts: defaultdict(<class 'int'>, {3: 381, 6: 154, 8: 143, 1: 15, 9: 43, 0: 93, 4: 2, 7: 1, 2: 1})
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes) model chosen!
id 7
label_counts: defaultdict(<class 'int'>, {9: 1519, 4: 349, 7: 79, 3: 115, 0: 78, 2: 76, 5: 29, 1: 6, 6: 1})
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600) model chosen!
id 8
label_counts: defaultdict(<class 'int'>, {3: 83, 2: 115, 8: 161, 4: 425, 7: 92, 1: 15, 6: 5, 9: 10, 0: 4, 5: 2})
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes) model chosen!
id 9
label_counts: defaultdict(<class 'int'>, {5: 7, 1: 64, 7: 286, 4: 95, 3: 14, 2: 80, 9: 28, 0: 7})
mobilenet_v2(pretrained=False, num_classes=args.num_classes) model chosen!
id 10
label_counts: defaultdict(<class 'int'>, {8: 906, 0: 830, 4: 108, 5: 5, 2: 10, 6: 6, 1: 17, 3: 11})
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes) model chosen!
id 11
label_counts: defaultdict(<class 'int'>, {1: 227, 8: 208, 2: 238, 9: 48, 3: 16, 4: 1, 7: 8, 6: 2, 5: 2})
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes) model chosen!
id 12
label_counts: defaultdict(<class 'int'>, {6: 681, 1: 47, 0: 50, 4: 354, 3: 4, 2: 2, 5: 1})
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes) model chosen!
id 13
label_counts: defaultdict(<class 'int'>, {6: 426, 4: 10, 0: 464, 3: 90, 2: 271, 1: 67})
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes) model chosen!
id 14
label_counts: defaultdict(<class 'int'>, {5: 746, 1: 509, 4: 104, 3: 17, 0: 30, 2: 1})
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes) model chosen!
id 15
label_counts: defaultdict(<class 'int'>, {4: 973, 2: 843, 1: 155, 0: 75, 3: 45})
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600) model chosen!
id 16
label_counts: defaultdict(<class 'int'>, {3: 448, 9: 202, 4: 43, 5: 71, 6: 120, 8: 77, 0: 8, 1: 2})
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes) model chosen!
id 17
label_counts: defaultdict(<class 'int'>, {3: 84, 7: 978, 2: 130, 6: 42, 4: 48, 0: 8, 5: 9})
mobilenet_v2(pretrained=False, num_classes=args.num_classes) model chosen!
id 18
label_counts: defaultdict(<class 'int'>, {0: 260, 1: 196, 4: 82, 5: 179, 3: 53, 8: 51, 7: 8, 6: 3, 2: 2})
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes) model chosen!
id 19
label_counts: defaultdict(<class 'int'>, {1: 456, 8: 150, 3: 7, 9: 86, 2: 46, 6: 20, 5: 56, 7: 10})
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes) model chosen!
id 20
label_counts: defaultdict(<class 'int'>, {0: 218, 6: 242, 4: 48, 8: 358, 7: 24, 3: 362, 2: 17, 5: 6})
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes) model chosen!
id 21
label_counts: defaultdict(<class 'int'>, {3: 93, 0: 436, 1: 276, 4: 131, 8: 33, 2: 72, 5: 44, 9: 2, 6: 2})
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes) model chosen!
id 22
label_counts: defaultdict(<class 'int'>, {8: 459, 6: 159, 3: 97, 9: 131, 1: 82, 5: 64, 7: 22, 4: 2, 2: 1})
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes) model chosen!
id 23
label_counts: defaultdict(<class 'int'>, {2: 510, 1: 205, 0: 170, 3: 373})
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600) model chosen!
id 24
label_counts: defaultdict(<class 'int'>, {7: 407, 4: 111, 2: 21, 8: 68, 6: 231, 1: 151, 9: 44, 3: 19, 0: 4})
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes) model chosen!
id 25
label_counts: defaultdict(<class 'int'>, {7: 336, 1: 353, 6: 83, 5: 197, 4: 100, 2: 11, 0: 2, 3: 29, 8: 3, 9: 2})
mobilenet_v2(pretrained=False, num_classes=args.num_classes) model chosen!
id 26
label_counts: defaultdict(<class 'int'>, {3: 116, 9: 885, 0: 276, 5: 59, 8: 57, 1: 18, 4: 3, 6: 2})
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes) model chosen!
id 27
label_counts: defaultdict(<class 'int'>, {6: 360, 9: 54, 4: 28, 1: 24, 5: 140, 2: 15, 3: 12})
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes) model chosen!
id 28
label_counts: defaultdict(<class 'int'>, {8: 31, 5: 486, 0: 87, 4: 71, 1: 148, 2: 2, 7: 29, 6: 12, 3: 1})
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes) model chosen!
id 29
label_counts: defaultdict(<class 'int'>, {5: 380, 7: 932, 3: 54, 1: 46, 6: 48, 4: 10, 2: 10})
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes) model chosen!
id 30
label_counts: defaultdict(<class 'int'>, {3: 724, 6: 555, 0: 95, 5: 89, 4: 8, 2: 19, 1: 1})
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes) model chosen!
id 31
label_counts: defaultdict(<class 'int'>, {7: 52, 9: 201, 1: 130, 0: 185, 4: 61, 6: 65, 5: 41, 2: 12, 3: 7})
FedAvgCNN(in_features=3, num_classes=args.num_classes, dim=1600) model chosen!
id 32
label_counts: defaultdict(<class 'int'>, {5: 339, 6: 11, 8: 81, 9: 53, 2: 65, 3: 3, 0: 33, 1: 9, 7: 1})
torchvision.models.googlenet(pretrained=False, aux_logits=False, num_classes=args.num_classes) model chosen!
id 33
label_counts: defaultdict(<class 'int'>, {4: 82, 1: 688, 6: 249, 0: 10, 8: 63, 7: 39, 5: 32, 2: 2})
mobilenet_v2(pretrained=False, num_classes=args.num_classes) model chosen!
id 34
label_counts: defaultdict(<class 'int'>, {8: 782, 1: 196, 6: 180, 3: 124, 2: 5, 4: 26, 7: 25})
torchvision.models.resnet18(pretrained=False, num_classes=args.num_classes) model chosen!
id 35
label_counts: defaultdict(<class 'int'>, {2: 255, 9: 362, 8: 12, 7: 151, 3: 64, 0: 69, 6: 20, 1: 7, 4: 8})
torchvision.models.resnet34(pretrained=False, num_classes=args.num_classes) model chosen!
id 36
label_counts: defaultdict(<class 'int'>, {5: 152, 8: 159, 7: 10, 4: 109, 9: 83, 1: 70, 2: 15, 0: 1})
torchvision.models.resnet50(pretrained=False, num_classes=args.num_classes) model chosen!
id 37
label_counts: defaultdict(<class 'int'>, {1: 171, 3: 58, 6: 519, 0: 116, 4: 82, 5: 16, 7: 10, 9: 20, 2: 10})
torchvision.models.resnet101(pretrained=False, num_classes=args.num_classes) model chosen!
id 38
label_counts: defaultdict(<class 'int'>, {6: 156, 3: 111, 1: 29, 2: 125, 7: 141, 8: 27, 9: 20, 0: 6, 5: 29})
torchvision.models.resnet152(pretrained=False, num_classes=args.num_classes) model chosen!
id 39
label_counts: defaultdict(<class 'int'>, {9: 312, 3: 345, 8: 216, 4: 217, 0: 3, 7: 4, 5: 5, 1: 1, 2: 1})

Join ratio / total clients: 1.0 / 40
Finished creating server and clients.
Trainable_prototypes(
  (embedings): Embedding(10, 512)
  (middle): Sequential(
    (0): Sequential(
      (0): Linear(in_features=512, out_features=512, bias=True)
      (1): ReLU()
    )
  )
  (fc): Linear(in_features=512, out_features=512, bias=True)
)
tobetrained:
[9, 8, 7, 6, 5, 4, 3, 2, 1, 0]
Edge 9 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_5 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_31 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_13 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_0 protos Not Found
Client_5 prev_protos Not Found
Client_0 prev_protos Not Found
Client_13 prev_protos Not Found
Client_31 prev_protos Not Found
Edge 8 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_16 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_1 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_26 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_36 protos Not Found
Client_26 prev_protos Not Found
Client_36 prev_protos Not Found
Client_1 prev_protos Not Found
Client_16 prev_protos Not Found
Edge 7 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_24 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_7 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_27 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_2 protos Not Found
Client_2 prev_protos Not Found
Client_24 prev_protos Not Found
Client_27 prev_protos Not Found
Client_7 prev_protos Not Found
Edge 6 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_32 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_38 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_8 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_23 protos Not Found
Client_38 prev_protos Not Found
Client_23 prev_protos Not Found
Client_8 prev_protos Not Found
Client_32 prev_protos Not Found
Edge 5 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_9 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_33 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_29 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_6 protos Not Found
Client_29 prev_protos Not Found
Client_6 prev_protos Not Found
Client_9 prev_protos Not Found
Client_33 prev_protos Not Found
Edge 4 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_30 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_10 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_18 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_17 protos Not Found
Client_30 prev_protos Not Found
Client_17 prev_protos Not Found
Client_18 prev_protos Not Found
Client_10 prev_protos Not Found
Edge 3 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_14 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_15 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_39 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_35 protos Not Found
Client_14 prev_protos Not Found
Client_39 prev_protos Not Found
Client_15 prev_protos Not Found
Client_35 prev_protos Not Found
Edge 2 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_21 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_3 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_19 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_11 protos Not Found
Client_21 prev_protos Not Found
Client_11 prev_protos Not Found
Client_19 prev_protos Not Found
Client_3 prev_protos Not Found
Edge 1 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_12 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_20 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_22 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_25 protos Not Found
Client_25 prev_protos Not Found
Client_22 prev_protos Not Found
Client_20 prev_protos Not Found
Client_12 prev_protos Not Found
Edge 0 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_37 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_34 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_28 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_4 protos Not Found
Client_4 prev_protos Not Found
Client_28 prev_protos Not Found
Client_37 prev_protos Not Found
Client_34 prev_protos Not Found
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge_0 prev_protos Not Found
Edge_1 prev_protos Not Found
Edge_2 prev_protos Not Found
Edge_3 prev_protos Not Found
Edge_4 prev_protos Not Found
Edge_5 prev_protos Not Found
Edge_6 prev_protos Not Found
Edge_7 prev_protos Not Found
Edge_8 prev_protos Not Found
Edge_9 prev_protos Not Found
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([3.9864, 2.5491, 2.2446, 2.0699, 3.4147, 2.7722, 2.3389, 2.0699, 2.6666,
        3.1330], device='cuda:0')
Server loss: 5.9436750411987305
train global classifier
train glclassifier time: 3.698338158428669
global classifier accuracy: 90.2675
Number of samples: 326
end Update
server_global_time: 14.703456737101078
only_train_time: 138.08521031588316

-------------Global Round number: 0-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.4687
Averaged Test Accuracy (Prototype Model): 0.2396
Std Test Accuracy (Regular Model): 0.1452
Std Test Accuracy (Prototype Model): 0.1949
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([3.7412, 3.0364, 2.5998, 2.9706, 2.5998, 3.1300, 2.9901, 2.6270, 3.0364,
        3.1995], device='cuda:0')
Server loss: 4.573192119598389
train global classifier
train glclassifier time: 3.7109059244394302
global classifier accuracy: 98.485
end Update
server_global_time: 30.532539807260036
only_train_time: 296.97520683705807

-------------Global Round number: 1-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6187
Averaged Test Accuracy (Prototype Model): 0.5369
Std Test Accuracy (Regular Model): 0.1061
Std Test Accuracy (Prototype Model): 0.1762
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([5.4058, 4.6986, 3.9553, 4.3553, 3.9150, 4.6260, 4.6504, 3.9150, 4.6681,
        4.6986], device='cuda:0')
Server loss: 4.902320861816406
train global classifier
train glclassifier time: 3.5429814234375954
global classifier accuracy: 99.13
end Update
server_global_time: 46.24454229325056
only_train_time: 457.1318578198552

-------------Global Round number: 2-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6291
Averaged Test Accuracy (Prototype Model): 0.5917
Std Test Accuracy (Regular Model): 0.0987
Std Test Accuracy (Prototype Model): 0.1294
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([7.7195, 7.0306, 6.3409, 6.3814, 5.9879, 7.0039, 6.9053, 5.9879, 6.5768,
        7.0306], device='cuda:0')
Server loss: 5.462968349456787
train global classifier
train glclassifier time: 3.728603735566139
global classifier accuracy: 99.2175
end Update
server_global_time: 62.01416213810444
only_train_time: 615.903852827847

-------------Global Round number: 3-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6303
Averaged Test Accuracy (Prototype Model): 0.5961
Std Test Accuracy (Regular Model): 0.0949
Std Test Accuracy (Prototype Model): 0.1203
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([9.6267, 9.2486, 8.5011, 8.6125, 7.8954, 9.4954, 9.0424, 7.8954, 8.5424,
        9.3351], device='cuda:0')
Server loss: 6.0248565673828125
train global classifier
train glclassifier time: 3.6157665699720383
global classifier accuracy: 99.39
end Update
server_global_time: 77.5103055536747
only_train_time: 774.2186663523316

-------------Global Round number: 4-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6308
Averaged Test Accuracy (Prototype Model): 0.6112
Std Test Accuracy (Regular Model): 0.0966
Std Test Accuracy (Prototype Model): 0.1037
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.4322, 10.4350, 10.2213, 10.5368,  9.3866, 11.5406, 11.0157,  9.3866,
        10.1607, 10.2464], device='cuda:0')
Server loss: 7.28316068649292
train global classifier
train glclassifier time: 3.591923601925373
global classifier accuracy: 99.4875
end Update
server_global_time: 92.9951549693942
only_train_time: 932.0766445323825

-------------Global Round number: 5-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6280
Averaged Test Accuracy (Prototype Model): 0.6103
Std Test Accuracy (Regular Model): 0.1006
Std Test Accuracy (Prototype Model): 0.1023
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([12.9473, 12.5802, 12.5847, 12.4753, 11.5404, 13.6021, 12.7046, 11.5382,
        11.5382, 12.4566], device='cuda:0')
Server loss: 6.730382919311523
train global classifier
train glclassifier time: 3.5604919120669365
global classifier accuracy: 99.8125
end Update
server_global_time: 108.53722942620516
only_train_time: 1089.6064519435167

-------------Global Round number: 6-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6226
Averaged Test Accuracy (Prototype Model): 0.6067
Std Test Accuracy (Regular Model): 0.1024
Std Test Accuracy (Prototype Model): 0.1068
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([14.6271, 14.3332, 14.3738, 14.4262, 13.6341, 15.6583, 14.6112, 12.9580,
        12.9580, 14.2416], device='cuda:0')
Server loss: 8.720499992370605
train global classifier
train glclassifier time: 3.6078115180134773
global classifier accuracy: 99.87
end Update
server_global_time: 124.44167073071003
only_train_time: 1248.1783797591925

-------------Global Round number: 7-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6271
Averaged Test Accuracy (Prototype Model): 0.6111
Std Test Accuracy (Regular Model): 0.0974
Std Test Accuracy (Prototype Model): 0.1009
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([15.4249, 15.7006, 15.7728, 16.1199, 15.3657, 17.2071, 16.1373, 14.2922,
        14.2922, 15.8538], device='cuda:0')
Server loss: 9.070448875427246
train global classifier
train glclassifier time: 3.724229224026203
global classifier accuracy: 99.87
end Update
server_global_time: 140.0658758878708
only_train_time: 1406.3907066509128

-------------Global Round number: 8-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6289
Averaged Test Accuracy (Prototype Model): 0.6149
Std Test Accuracy (Regular Model): 0.1003
Std Test Accuracy (Prototype Model): 0.1035
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([16.6725, 16.1621, 16.6057, 17.0488, 16.2910, 17.9222, 16.7932, 14.8013,
        14.8013, 16.8335], device='cuda:0')
Server loss: 8.709043502807617
train global classifier
train glclassifier time: 3.657198987901211
global classifier accuracy: 99.9075
end Update
server_global_time: 155.7047387510538
only_train_time: 1563.6700424924493

-------------Global Round number: 9-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6288
Averaged Test Accuracy (Prototype Model): 0.6045
Std Test Accuracy (Regular Model): 0.0997
Std Test Accuracy (Prototype Model): 0.1088
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([18.1699, 18.3566, 18.1756, 19.1159, 18.0427, 20.6271, 18.6887, 16.5859,
        16.5859, 18.4879], device='cuda:0')
Server loss: 8.671257972717285
train global classifier
train glclassifier time: 3.6244056671857834
global classifier accuracy: 99.9625
Number of samples: 326
end Update
server_global_time: 171.4802971854806
only_train_time: 1722.2340437918901

-------------Global Round number: 10-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6256
Averaged Test Accuracy (Prototype Model): 0.6134
Std Test Accuracy (Regular Model): 0.0989
Std Test Accuracy (Prototype Model): 0.1059
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([19.7741, 19.8239, 19.3854, 20.4101, 19.2123, 22.0120, 20.5032, 17.8582,
        17.8582, 19.6304], device='cuda:0')
Server loss: 8.22652816772461
train global classifier
train glclassifier time: 3.6667637899518013
global classifier accuracy: 99.9525
end Update
server_global_time: 187.242570258677
only_train_time: 1880.2130159586668

-------------Global Round number: 11-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6234
Averaged Test Accuracy (Prototype Model): 0.6143
Std Test Accuracy (Regular Model): 0.1001
Std Test Accuracy (Prototype Model): 0.1070
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([20.8324, 20.8988, 20.3413, 21.6910, 20.4404, 23.2154, 21.8620, 18.8218,
        18.8218, 20.7375], device='cuda:0')
Server loss: 7.558316230773926
train global classifier
train glclassifier time: 3.6215800121426582
global classifier accuracy: 99.9525
end Update
server_global_time: 202.89110208302736
only_train_time: 2037.4382862448692

-------------Global Round number: 12-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6208
Averaged Test Accuracy (Prototype Model): 0.6109
Std Test Accuracy (Regular Model): 0.1002
Std Test Accuracy (Prototype Model): 0.1077
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([21.4799, 21.9020, 21.2520, 22.1971, 21.4878, 24.4899, 22.9894, 19.7237,
        19.7237, 21.4938], device='cuda:0')
Server loss: 8.650320053100586
train global classifier
train glclassifier time: 3.6243442371487617
global classifier accuracy: 99.9425
end Update
server_global_time: 218.2791639044881
only_train_time: 2195.0551262572408

-------------Global Round number: 13-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6208
Averaged Test Accuracy (Prototype Model): 0.6147
Std Test Accuracy (Regular Model): 0.1023
Std Test Accuracy (Prototype Model): 0.1065
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([22.4675, 22.4376, 22.2200, 23.3411, 22.2659, 24.5874, 23.9533, 20.7272,
        20.7272, 22.5888], device='cuda:0')
Server loss: 8.940407752990723
train global classifier
train glclassifier time: 3.702234797179699
global classifier accuracy: 99.9575
end Update
server_global_time: 233.88828323036432
only_train_time: 2352.2817747443914

-------------Global Round number: 14-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6223
Averaged Test Accuracy (Prototype Model): 0.6170
Std Test Accuracy (Regular Model): 0.1058
Std Test Accuracy (Prototype Model): 0.1078
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([23.2219, 23.5718, 21.9747, 24.1148, 22.2145, 25.5572, 24.8433, 21.6878,
        21.6878, 23.4259], device='cuda:0')
Server loss: 8.148805618286133
train global classifier
train glclassifier time: 3.648593485355377
global classifier accuracy: 99.93
end Update
server_global_time: 249.56239910423756
only_train_time: 2511.2236862555146

-------------Global Round number: 15-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6195
Averaged Test Accuracy (Prototype Model): 0.6157
Std Test Accuracy (Regular Model): 0.1068
Std Test Accuracy (Prototype Model): 0.1107
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([23.6512, 24.0329, 23.6124, 25.5069, 23.2443, 27.0367, 24.5670, 22.3944,
        22.3944, 23.5456], device='cuda:0')
Server loss: 11.046503067016602
train global classifier
train glclassifier time: 3.562771275639534
global classifier accuracy: 99.9625
end Update
server_global_time: 264.96757569909096
only_train_time: 2668.2564174234867

-------------Global Round number: 16-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6224
Averaged Test Accuracy (Prototype Model): 0.6185
Std Test Accuracy (Regular Model): 0.1101
Std Test Accuracy (Prototype Model): 0.1157
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([24.8116, 25.4131, 24.4387, 27.3399, 25.3294, 28.0503, 27.3093, 23.2733,
        23.2733, 24.8065], device='cuda:0')
Server loss: 11.506529808044434
train global classifier
train glclassifier time: 3.6007401049137115
global classifier accuracy: 99.985
end Update
server_global_time: 280.68973415344954
only_train_time: 2824.0434482470155

-------------Global Round number: 17-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6272
Averaged Test Accuracy (Prototype Model): 0.6224
Std Test Accuracy (Regular Model): 0.1075
Std Test Accuracy (Prototype Model): 0.1108
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([23.8050, 25.4160, 24.5035, 26.8712, 25.4686, 28.2968, 27.1746, 23.0161,
        23.0161, 24.9412], device='cuda:0')
Server loss: 8.258687019348145
train global classifier
train glclassifier time: 3.568553328514099
global classifier accuracy: 99.955
end Update
server_global_time: 296.0852218493819
only_train_time: 2981.464037977159

-------------Global Round number: 18-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6233
Averaged Test Accuracy (Prototype Model): 0.6190
Std Test Accuracy (Regular Model): 0.1080
Std Test Accuracy (Prototype Model): 0.1114
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([24.6757, 25.7989, 24.0298, 26.5366, 26.5074, 28.2981, 27.6568, 24.1042,
        24.0298, 25.9290], device='cuda:0')
Server loss: 9.29938793182373
train global classifier
train glclassifier time: 3.6020319908857346
global classifier accuracy: 99.8825
end Update
server_global_time: 311.6624538600445
only_train_time: 3137.982222057879

-------------Global Round number: 19-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6174
Averaged Test Accuracy (Prototype Model): 0.6184
Std Test Accuracy (Regular Model): 0.1116
Std Test Accuracy (Prototype Model): 0.1145
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([26.5243, 27.5533, 26.2178, 29.3920, 27.8264, 29.8770, 29.5616, 25.2356,
        25.2356, 26.9489], device='cuda:0')
Server loss: 7.988874435424805
train global classifier
train glclassifier time: 3.6988167241215706
global classifier accuracy: 99.9925
Number of samples: 326
end Update
server_global_time: 327.557323589921
only_train_time: 3295.3412490859628

-------------Global Round number: 20-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6248
Averaged Test Accuracy (Prototype Model): 0.6216
Std Test Accuracy (Regular Model): 0.1062
Std Test Accuracy (Prototype Model): 0.1112
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([27.3694, 28.2495, 27.2551, 30.5884, 28.4768, 30.9359, 30.3754, 26.0601,
        26.0601, 27.6713], device='cuda:0')
Server loss: 9.17000961303711
train global classifier
train glclassifier time: 3.7175758704543114
global classifier accuracy: 99.99
end Update
server_global_time: 342.95931677520275
only_train_time: 3452.4467739388347

-------------Global Round number: 21-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6246
Averaged Test Accuracy (Prototype Model): 0.6220
Std Test Accuracy (Regular Model): 0.1073
Std Test Accuracy (Prototype Model): 0.1103
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([28.0471, 28.9914, 28.1041, 31.4499, 29.1925, 31.7482, 31.3117, 26.7144,
        26.7144, 28.3434], device='cuda:0')
Server loss: 8.093998908996582
train global classifier
train glclassifier time: 3.629513792693615
global classifier accuracy: 99.9825
end Update
server_global_time: 358.4866690784693
only_train_time: 3609.8172166123986

-------------Global Round number: 22-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6259
Averaged Test Accuracy (Prototype Model): 0.6210
Std Test Accuracy (Regular Model): 0.1074
Std Test Accuracy (Prototype Model): 0.1106
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([28.4841, 29.7237, 28.7630, 32.0027, 29.9798, 32.2989, 32.1231, 27.1958,
        27.1958, 28.8213], device='cuda:0')
Server loss: 11.12643051147461
train global classifier
train glclassifier time: 3.553723633289337
global classifier accuracy: 99.985
end Update
server_global_time: 374.15866789221764
only_train_time: 3767.4132208302617

-------------Global Round number: 23-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6264
Averaged Test Accuracy (Prototype Model): 0.6218
Std Test Accuracy (Regular Model): 0.1064
Std Test Accuracy (Prototype Model): 0.1107
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([29.0616, 30.3213, 29.2248, 33.2466, 30.4456, 32.8817, 32.9115, 27.9669,
        27.9669, 29.4656], device='cuda:0')
Server loss: 9.244791030883789
train global classifier
train glclassifier time: 3.6195626258850098
global classifier accuracy: 99.985
end Update
server_global_time: 389.65414740890265
only_train_time: 3924.6582261398435

-------------Global Round number: 24-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6259
Averaged Test Accuracy (Prototype Model): 0.6204
Std Test Accuracy (Regular Model): 0.1072
Std Test Accuracy (Prototype Model): 0.1088
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([29.6326, 30.8281, 30.0651, 33.6734, 31.1396, 33.5983, 33.4927, 28.5123,
        28.5123, 30.1702], device='cuda:0')
Server loss: 7.823685646057129
train global classifier
train glclassifier time: 3.6634542495012283
global classifier accuracy: 99.9875
end Update
server_global_time: 405.4549108147621
only_train_time: 4082.529492624104

-------------Global Round number: 25-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6237
Averaged Test Accuracy (Prototype Model): 0.6204
Std Test Accuracy (Regular Model): 0.1065
Std Test Accuracy (Prototype Model): 0.1087
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([30.1403, 31.4738, 30.4656, 34.1733, 31.6878, 34.0100, 34.0718, 29.0111,
        29.0111, 30.7023], device='cuda:0')
Server loss: 8.60859489440918
train global classifier
train glclassifier time: 3.5834305360913277
global classifier accuracy: 99.99
end Update
server_global_time: 421.21813398599625
only_train_time: 4240.257217109203

-------------Global Round number: 26-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6256
Averaged Test Accuracy (Prototype Model): 0.6210
Std Test Accuracy (Regular Model): 0.1044
Std Test Accuracy (Prototype Model): 0.1077
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([29.2639, 31.0251, 30.2912, 34.1421, 30.9363, 34.1120, 34.1327, 29.2479,
        29.2479, 30.7960], device='cuda:0')
Server loss: 10.691112518310547
train global classifier
train glclassifier time: 3.712926506996155
global classifier accuracy: 99.97
end Update
server_global_time: 436.85035353153944
only_train_time: 4397.7516716867685

-------------Global Round number: 27-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6206
Averaged Test Accuracy (Prototype Model): 0.6187
Std Test Accuracy (Regular Model): 0.1067
Std Test Accuracy (Prototype Model): 0.1068
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([29.8023, 31.7208, 30.5317, 33.7705, 32.2739, 34.4743, 33.6406, 29.7290,
        29.7290, 31.1750], device='cuda:0')
Server loss: 6.763173580169678
train global classifier
train glclassifier time: 3.6387110576033592
global classifier accuracy: 99.9725
end Update
server_global_time: 452.66607885062695
only_train_time: 4558.4345518276095

-------------Global Round number: 28-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6228
Averaged Test Accuracy (Prototype Model): 0.6221
Std Test Accuracy (Regular Model): 0.1036
Std Test Accuracy (Prototype Model): 0.1070
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([31.1395, 32.6244, 31.6209, 35.3890, 33.1512, 35.2422, 35.2359, 30.2669,
        30.2669, 31.8289], device='cuda:0')
Server loss: 9.154407501220703
train global classifier
train glclassifier time: 3.6503217965364456
global classifier accuracy: 99.9875
end Update
server_global_time: 468.3012325167656
only_train_time: 4715.958589956164

-------------Global Round number: 29-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6267
Averaged Test Accuracy (Prototype Model): 0.6225
Std Test Accuracy (Regular Model): 0.1044
Std Test Accuracy (Prototype Model): 0.1068
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([32.0688, 33.2226, 32.1480, 35.9752, 33.7576, 35.8409, 36.0487, 30.9481,
        30.9481, 32.2976], device='cuda:0')
Server loss: 7.78194522857666
train global classifier
train glclassifier time: 3.6251445338129997
global classifier accuracy: 99.9925
Number of samples: 326
end Update
server_global_time: 483.91080740094185
only_train_time: 4874.439662434161

-------------Global Round number: 30-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6254
Averaged Test Accuracy (Prototype Model): 0.6226
Std Test Accuracy (Regular Model): 0.1035
Std Test Accuracy (Prototype Model): 0.1063
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([32.3698, 33.7697, 32.7373, 36.5346, 34.3808, 36.3724, 36.5244, 31.4585,
        31.4585, 32.6538], device='cuda:0')
Server loss: 7.684553623199463
train global classifier
train glclassifier time: 3.6853316500782967
global classifier accuracy: 99.9975
end Update
server_global_time: 499.48815490305424
only_train_time: 5031.507999025285

-------------Global Round number: 31-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6250
Averaged Test Accuracy (Prototype Model): 0.6218
Std Test Accuracy (Regular Model): 0.1044
Std Test Accuracy (Prototype Model): 0.1080
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([32.3728, 34.1226, 33.3651, 36.9080, 34.8992, 36.5336, 36.9258, 31.8152,
        31.8152, 33.1283], device='cuda:0')
Server loss: 8.410449028015137
train global classifier
train glclassifier time: 3.6539910659193993
global classifier accuracy: 99.9875
end Update
server_global_time: 515.0855753049254
only_train_time: 5190.359231844544

-------------Global Round number: 32-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6284
Averaged Test Accuracy (Prototype Model): 0.6244
Std Test Accuracy (Regular Model): 0.1083
Std Test Accuracy (Prototype Model): 0.1116
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([32.9230, 34.4065, 33.3041, 37.1427, 35.3444, 37.0337, 37.1667, 31.8862,
        31.8862, 33.1033], device='cuda:0')
Server loss: 6.898928165435791
train global classifier
train glclassifier time: 3.7235171645879745
global classifier accuracy: 99.99
end Update
server_global_time: 530.8038862869143
only_train_time: 5348.612427204847

-------------Global Round number: 33-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6277
Averaged Test Accuracy (Prototype Model): 0.6241
Std Test Accuracy (Regular Model): 0.1085
Std Test Accuracy (Prototype Model): 0.1120
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([33.5145, 35.2519, 34.0726, 37.9084, 35.8224, 37.6293, 37.9366, 32.7555,
        32.7555, 33.7369], device='cuda:0')
Server loss: 6.437317371368408
train global classifier
train glclassifier time: 3.649836115539074
global classifier accuracy: 99.99
end Update
server_global_time: 546.56652726233
only_train_time: 5506.391180999577

-------------Global Round number: 34-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6272
Averaged Test Accuracy (Prototype Model): 0.6240
Std Test Accuracy (Regular Model): 0.1084
Std Test Accuracy (Prototype Model): 0.1112
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([33.9351, 35.4669, 34.6303, 38.1303, 36.3431, 38.0819, 38.3921, 33.0844,
        33.0844, 34.3470], device='cuda:0')
Server loss: 9.149463653564453
train global classifier
train glclassifier time: 3.798246420919895
global classifier accuracy: 99.9975
end Update
server_global_time: 562.1338002607226
only_train_time: 5664.20609267056

-------------Global Round number: 35-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6273
Averaged Test Accuracy (Prototype Model): 0.6230
Std Test Accuracy (Regular Model): 0.1096
Std Test Accuracy (Prototype Model): 0.1118
tobetrained:
[0, 2, 8, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([34.2421, 35.9005, 34.9957, 38.6002, 37.1685, 38.4065, 39.0182, 33.4858,
        33.4858, 34.8022], device='cuda:0')
Server loss: 5.639322280883789
train global classifier
train glclassifier time: 3.663785308599472
global classifier accuracy: 99.995
end Update
server_global_time: 577.577291302383
only_train_time: 5820.296439319849

-------------Global Round number: 36-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6265
Averaged Test Accuracy (Prototype Model): 0.6237
Std Test Accuracy (Regular Model): 0.1112
Std Test Accuracy (Prototype Model): 0.1120
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([34.6047, 36.3686, 35.3506, 39.2372, 37.4287, 38.8947, 39.3634, 33.9771,
        33.9771, 35.1880], device='cuda:0')
Server loss: 11.034455299377441
train global classifier
train glclassifier time: 3.638213597238064
global classifier accuracy: 99.9825
end Update
server_global_time: 593.3376346677542
only_train_time: 5978.566291451454

-------------Global Round number: 37-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6275
Averaged Test Accuracy (Prototype Model): 0.6231
Std Test Accuracy (Regular Model): 0.1086
Std Test Accuracy (Prototype Model): 0.1112
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([35.0143, 36.7972, 35.7797, 39.4917, 37.8040, 39.6016, 39.7466, 34.3090,
        34.3090, 35.5425], device='cuda:0')
Server loss: 6.153359889984131
train global classifier
train glclassifier time: 3.8103191182017326
global classifier accuracy: 99.99
end Update
server_global_time: 608.6224614530802
only_train_time: 6135.893367938697

-------------Global Round number: 38-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6273
Averaged Test Accuracy (Prototype Model): 0.6226
Std Test Accuracy (Regular Model): 0.1101
Std Test Accuracy (Prototype Model): 0.1118
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([35.4574, 37.4590, 36.0326, 40.0896, 37.4331, 39.8234, 40.2205, 34.9993,
        34.9993, 35.9936], device='cuda:0')
Server loss: 8.309048652648926
train global classifier
train glclassifier time: 3.6877062544226646
global classifier accuracy: 99.965
end Update
server_global_time: 624.0954807177186
only_train_time: 6294.0424143746495

-------------Global Round number: 39-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6215
Averaged Test Accuracy (Prototype Model): 0.6218
Std Test Accuracy (Regular Model): 0.1088
Std Test Accuracy (Prototype Model): 0.1115
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([35.6919, 37.5473, 36.5445, 40.4008, 38.2767, 40.0085, 40.6050, 35.2291,
        35.2291, 36.5288], device='cuda:0')
Server loss: 8.621261596679688
train global classifier
train glclassifier time: 3.5802251994609833
global classifier accuracy: 99.965
Number of samples: 326
end Update
server_global_time: 639.4027910977602
only_train_time: 6450.391392290592

-------------Global Round number: 40-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6186
Averaged Test Accuracy (Prototype Model): 0.6176
Std Test Accuracy (Regular Model): 0.1079
Std Test Accuracy (Prototype Model): 0.1112
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([34.7819, 36.0271, 36.0390, 38.2838, 37.3899, 37.3798, 38.8381, 33.9181,
        33.9181, 35.7769], device='cuda:0')
Server loss: 9.078371047973633
train global classifier
train glclassifier time: 3.7708704620599747
global classifier accuracy: 99.98
end Update
server_global_time: 654.9237054511905
only_train_time: 6605.080559000373

-------------Global Round number: 41-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6316
Averaged Test Accuracy (Prototype Model): 0.6247
Std Test Accuracy (Regular Model): 0.1086
Std Test Accuracy (Prototype Model): 0.1126
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([36.3659, 37.6100, 37.0411, 40.5948, 38.9142, 40.3707, 40.9333, 35.5238,
        35.5238, 36.9165], device='cuda:0')
Server loss: 6.430445671081543
train global classifier
train glclassifier time: 3.6442205011844635
global classifier accuracy: 99.9975
end Update
server_global_time: 670.0805426239967
only_train_time: 6762.105357855558

-------------Global Round number: 42-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6321
Averaged Test Accuracy (Prototype Model): 0.6296
Std Test Accuracy (Regular Model): 0.1113
Std Test Accuracy (Prototype Model): 0.1122
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([36.6788, 38.5007, 37.7375, 41.0086, 39.4507, 41.1891, 41.6543, 36.2013,
        36.2013, 37.3284], device='cuda:0')
Server loss: 7.970530033111572
train global classifier
train glclassifier time: 3.5868641436100006
global classifier accuracy: 99.99
end Update
server_global_time: 685.7390559315681
only_train_time: 6918.366502694786

-------------Global Round number: 43-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6326
Averaged Test Accuracy (Prototype Model): 0.6292
Std Test Accuracy (Regular Model): 0.1123
Std Test Accuracy (Prototype Model): 0.1126
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([37.2001, 38.6636, 38.2588, 41.7829, 40.1989, 41.4451, 42.0461, 36.8438,
        36.8438, 38.0343], device='cuda:0')
Server loss: 8.472869873046875
train global classifier
train glclassifier time: 3.7560435608029366
global classifier accuracy: 99.9925
end Update
server_global_time: 702.0981491655111
only_train_time: 7077.450692541897

-------------Global Round number: 44-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6308
Averaged Test Accuracy (Prototype Model): 0.6284
Std Test Accuracy (Regular Model): 0.1110
Std Test Accuracy (Prototype Model): 0.1119
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([37.4156, 39.1973, 38.6068, 42.1065, 40.4410, 41.8784, 42.6502, 37.1502,
        37.1502, 38.3892], device='cuda:0')
Server loss: 8.888360977172852
train global classifier
train glclassifier time: 3.5866864696145058
global classifier accuracy: 99.9925
end Update
server_global_time: 717.8594518229365
only_train_time: 7235.431388147175

-------------Global Round number: 45-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6315
Averaged Test Accuracy (Prototype Model): 0.6276
Std Test Accuracy (Regular Model): 0.1112
Std Test Accuracy (Prototype Model): 0.1111
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([37.8111, 39.9342, 39.0666, 42.7138, 41.0305, 42.5105, 42.7608, 37.8720,
        37.8111, 38.7838], device='cuda:0')
Server loss: 8.410069465637207
train global classifier
train glclassifier time: 3.552598237991333
global classifier accuracy: 99.9975
end Update
server_global_time: 733.2870333641768
only_train_time: 7391.492913253605

-------------Global Round number: 46-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6319
Averaged Test Accuracy (Prototype Model): 0.6280
Std Test Accuracy (Regular Model): 0.1111
Std Test Accuracy (Prototype Model): 0.1103
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([38.1577, 40.1275, 39.4181, 42.9651, 41.6151, 42.7128, 43.1551, 38.0304,
        38.0304, 38.9564], device='cuda:0')
Server loss: 7.078851699829102
train global classifier
train glclassifier time: 3.5775265768170357
global classifier accuracy: 99.9925
end Update
server_global_time: 748.6760864779353
only_train_time: 7547.885176055133

-------------Global Round number: 47-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6322
Averaged Test Accuracy (Prototype Model): 0.6286
Std Test Accuracy (Regular Model): 0.1128
Std Test Accuracy (Prototype Model): 0.1112
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([37.7493, 39.7172, 38.9531, 41.6189, 41.0723, 42.8751, 42.7854, 37.5408,
        37.1626, 37.1626], device='cuda:0')
Server loss: 7.594531059265137
train global classifier
train glclassifier time: 3.5641122609376907
global classifier accuracy: 99.99
end Update
server_global_time: 764.139633834362
only_train_time: 7704.530751526356

-------------Global Round number: 48-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6326
Averaged Test Accuracy (Prototype Model): 0.6304
Std Test Accuracy (Regular Model): 0.1098
Std Test Accuracy (Prototype Model): 0.1115
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([38.4528, 40.5508, 39.8533, 43.2388, 41.7219, 43.2109, 43.6123, 38.3293,
        38.3293, 39.1851], device='cuda:0')
Server loss: 8.77254867553711
train global classifier
train glclassifier time: 3.8080755919218063
global classifier accuracy: 99.995
end Update
server_global_time: 780.462629429996
only_train_time: 7866.291562967002

-------------Global Round number: 49-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6344
Averaged Test Accuracy (Prototype Model): 0.6309
Std Test Accuracy (Regular Model): 0.1119
Std Test Accuracy (Prototype Model): 0.1123
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([38.8156, 41.0645, 40.4322, 43.7009, 42.4615, 43.4625, 44.1992, 38.8733,
        38.8156, 39.9538], device='cuda:0')
Server loss: 6.761205196380615
train global classifier
train glclassifier time: 3.78885105997324
global classifier accuracy: 99.995
Number of samples: 326
end Update
server_global_time: 796.7276295721531
only_train_time: 8029.753554210067

-------------Global Round number: 50-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6335
Averaged Test Accuracy (Prototype Model): 0.6307
Std Test Accuracy (Regular Model): 0.1101
Std Test Accuracy (Prototype Model): 0.1114
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([37.9403, 39.3952, 38.9057, 42.6534, 42.4830, 42.7659, 42.4025, 37.2800,
        37.2800, 38.0868], device='cuda:0')
Server loss: 10.68929672241211
train global classifier
train glclassifier time: 3.5531299263238907
global classifier accuracy: 99.985
end Update
server_global_time: 812.2135336771607
only_train_time: 8185.873429626226

-------------Global Round number: 51-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6358
Averaged Test Accuracy (Prototype Model): 0.6316
Std Test Accuracy (Regular Model): 0.1121
Std Test Accuracy (Prototype Model): 0.1130
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([39.0653, 40.9645, 40.3968, 43.5449, 42.8048, 43.8255, 44.4212, 38.8732,
        38.8732, 39.9110], device='cuda:0')
Server loss: 8.866060256958008
train global classifier
train glclassifier time: 3.6328523978590965
global classifier accuracy: 100.0
end Update
server_global_time: 827.4131887406111
only_train_time: 8342.203516572714

-------------Global Round number: 52-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6348
Averaged Test Accuracy (Prototype Model): 0.6328
Std Test Accuracy (Regular Model): 0.1089
Std Test Accuracy (Prototype Model): 0.1091
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([39.6418, 41.5529, 40.9689, 44.2655, 43.3535, 44.4914, 45.0090, 39.6980,
        39.6418, 40.8438], device='cuda:0')
Server loss: 6.453773021697998
train global classifier
train glclassifier time: 3.5950605273246765
global classifier accuracy: 99.9925
end Update
server_global_time: 842.8703620508313
only_train_time: 8498.81185978651

-------------Global Round number: 53-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6363
Averaged Test Accuracy (Prototype Model): 0.6326
Std Test Accuracy (Regular Model): 0.1089
Std Test Accuracy (Prototype Model): 0.1095
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([40.0220, 42.0829, 41.7832, 44.5474, 43.7193, 44.7484, 45.3814, 40.2230,
        40.0220, 41.4551], device='cuda:0')
Server loss: 9.179576873779297
train global classifier
train glclassifier time: 3.931060142815113
global classifier accuracy: 99.9975
end Update
server_global_time: 858.366530790925
only_train_time: 8656.271856069565

-------------Global Round number: 54-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6340
Averaged Test Accuracy (Prototype Model): 0.6318
Std Test Accuracy (Regular Model): 0.1080
Std Test Accuracy (Prototype Model): 0.1088
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([40.5407, 42.5007, 42.0978, 45.0373, 44.0137, 45.2676, 45.6450, 40.5959,
        40.5407, 41.9310], device='cuda:0')
Server loss: 6.395728588104248
train global classifier
train glclassifier time: 3.8239033296704292
global classifier accuracy: 99.9975
end Update
server_global_time: 874.132770396769
only_train_time: 8815.531712137163

-------------Global Round number: 55-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6341
Averaged Test Accuracy (Prototype Model): 0.6306
Std Test Accuracy (Regular Model): 0.1076
Std Test Accuracy (Prototype Model): 0.1098
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([40.8657, 42.8438, 42.5140, 45.9614, 44.5239, 45.5778, 46.1939, 41.1434,
        40.8657, 42.3071], device='cuda:0')
Server loss: 6.836365699768066
train global classifier
train glclassifier time: 3.6234662160277367
global classifier accuracy: 100.0
end Update
server_global_time: 889.599851384759
only_train_time: 8971.884070932865

-------------Global Round number: 56-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6338
Averaged Test Accuracy (Prototype Model): 0.6310
Std Test Accuracy (Regular Model): 0.1088
Std Test Accuracy (Prototype Model): 0.1099
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[8, 0, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[8, 0, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([41.2364, 43.1704, 42.8902, 46.4510, 45.0919, 46.0771, 46.4131, 41.5155,
        41.2364, 42.7888], device='cuda:0')
Server loss: 5.107452392578125
train global classifier
train glclassifier time: 3.6229919120669365
global classifier accuracy: 99.99
end Update
server_global_time: 904.9936064332724
only_train_time: 9126.83966806531

-------------Global Round number: 57-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6340
Averaged Test Accuracy (Prototype Model): 0.6311
Std Test Accuracy (Regular Model): 0.1077
Std Test Accuracy (Prototype Model): 0.1093
tobetrained:
[8, 0, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([41.4595, 43.7725, 43.4301, 46.6792, 45.2332, 46.4916, 46.7836, 41.9124,
        41.4595, 43.0920], device='cuda:0')
Server loss: 8.349952697753906
train global classifier
train glclassifier time: 3.611089274287224
global classifier accuracy: 99.9925
end Update
server_global_time: 920.4126027151942
only_train_time: 9284.023139066994

-------------Global Round number: 58-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6344
Averaged Test Accuracy (Prototype Model): 0.6313
Std Test Accuracy (Regular Model): 0.1091
Std Test Accuracy (Prototype Model): 0.1090
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([41.7533, 43.8574, 43.6806, 47.0052, 45.6963, 46.6959, 47.1421, 42.0350,
        41.7533, 43.2920], device='cuda:0')
Server loss: 8.954789161682129
train global classifier
train glclassifier time: 3.596327044069767
global classifier accuracy: 99.9975
end Update
server_global_time: 936.0011938363314
only_train_time: 9441.77284604311

-------------Global Round number: 59-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6350
Averaged Test Accuracy (Prototype Model): 0.6327
Std Test Accuracy (Regular Model): 0.1102
Std Test Accuracy (Prototype Model): 0.1094
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([42.0805, 44.4097, 44.2079, 47.1216, 45.8780, 47.0796, 47.3767, 42.5908,
        42.0805, 43.7643], device='cuda:0')
Server loss: 8.05355167388916
train global classifier
train glclassifier time: 3.580812022089958
global classifier accuracy: 99.9925
Number of samples: 326
end Update
server_global_time: 951.7582308650017
only_train_time: 9599.199202850461

-------------Global Round number: 60-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6350
Averaged Test Accuracy (Prototype Model): 0.6334
Std Test Accuracy (Regular Model): 0.1081
Std Test Accuracy (Prototype Model): 0.1087
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([42.2555, 44.1680, 44.4848, 47.6654, 45.8525, 46.3791, 47.4873, 42.8823,
        42.2555, 44.1747], device='cuda:0')
Server loss: 6.053404808044434
train global classifier
train glclassifier time: 3.6240684911608696
global classifier accuracy: 99.99
end Update
server_global_time: 967.3246265947819
only_train_time: 9755.57757885009

-------------Global Round number: 61-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6353
Averaged Test Accuracy (Prototype Model): 0.6348
Std Test Accuracy (Regular Model): 0.1085
Std Test Accuracy (Prototype Model): 0.1103
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[8, 0, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[8, 0, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([42.6540, 44.8309, 44.5626, 47.7782, 46.9128, 47.5720, 48.1020, 43.2275,
        42.6540, 44.3581], device='cuda:0')
Server loss: 7.869574069976807
train global classifier
train glclassifier time: 3.6558228507637978
global classifier accuracy: 99.99
end Update
server_global_time: 983.06610327214
only_train_time: 9912.18344309181

-------------Global Round number: 62-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6348
Averaged Test Accuracy (Prototype Model): 0.6330
Std Test Accuracy (Regular Model): 0.1088
Std Test Accuracy (Prototype Model): 0.1099
tobetrained:
[8, 0, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([42.2585, 44.2226, 44.0188, 47.8675, 46.5463, 46.7363, 48.1815, 42.4890,
        42.2585, 43.4131], device='cuda:0')
Server loss: 10.672428131103516
train global classifier
train glclassifier time: 3.6297881305217743
global classifier accuracy: 99.995
end Update
server_global_time: 998.7708700746298
only_train_time: 10069.47662705928

-------------Global Round number: 63-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6354
Averaged Test Accuracy (Prototype Model): 0.6346
Std Test Accuracy (Regular Model): 0.1144
Std Test Accuracy (Prototype Model): 0.1148
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([42.9808, 45.1146, 44.7034, 48.4076, 47.1012, 48.2072, 48.8231, 43.2434,
        42.9808, 44.3296], device='cuda:0')
Server loss: 8.245464324951172
train global classifier
train glclassifier time: 3.5455866530537605
global classifier accuracy: 99.9925
end Update
server_global_time: 1014.17128290236
only_train_time: 10226.012471280992

-------------Global Round number: 64-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6363
Averaged Test Accuracy (Prototype Model): 0.6348
Std Test Accuracy (Regular Model): 0.1093
Std Test Accuracy (Prototype Model): 0.1093
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([43.1233, 45.4895, 44.1777, 48.0560, 47.7003, 47.5984, 48.5667, 43.6294,
        43.1233, 45.0683], device='cuda:0')
Server loss: 5.582479953765869
train global classifier
train glclassifier time: 3.5838025361299515
global classifier accuracy: 99.99
end Update
server_global_time: 1029.4968380257487
only_train_time: 10383.769737124443

-------------Global Round number: 65-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6359
Averaged Test Accuracy (Prototype Model): 0.6361
Std Test Accuracy (Regular Model): 0.1088
Std Test Accuracy (Prototype Model): 0.1098
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([43.8115, 46.0131, 45.6388, 48.9706, 48.1134, 48.9314, 49.1691, 44.2022,
        43.8115, 45.6296], device='cuda:0')
Server loss: 7.781831741333008
train global classifier
train glclassifier time: 4.56203930079937
global classifier accuracy: 99.9975
end Update
server_global_time: 1045.0597224012017
only_train_time: 10540.884660169482

-------------Global Round number: 66-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6401
Averaged Test Accuracy (Prototype Model): 0.6387
Std Test Accuracy (Regular Model): 0.1098
Std Test Accuracy (Prototype Model): 0.1101
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([44.0182, 46.2576, 46.1217, 49.4447, 48.2473, 49.2700, 49.4578, 44.5074,
        44.0182, 46.0315], device='cuda:0')
Server loss: 7.553380966186523
train global classifier
train glclassifier time: 3.6278262063860893
global classifier accuracy: 99.995
end Update
server_global_time: 1060.447868026793
only_train_time: 10697.053088404238

-------------Global Round number: 67-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6392
Averaged Test Accuracy (Prototype Model): 0.6381
Std Test Accuracy (Regular Model): 0.1097
Std Test Accuracy (Prototype Model): 0.1100
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([44.4154, 46.5943, 46.4680, 49.7907, 48.9753, 49.6534, 49.7712, 44.9537,
        44.4154, 46.1843], device='cuda:0')
Server loss: 7.577476978302002
train global classifier
train glclassifier time: 3.609065182507038
global classifier accuracy: 99.995
end Update
server_global_time: 1076.045729637146
only_train_time: 10854.609093390405

-------------Global Round number: 68-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6369
Averaged Test Accuracy (Prototype Model): 0.6371
Std Test Accuracy (Regular Model): 0.1100
Std Test Accuracy (Prototype Model): 0.1111
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([44.1544, 45.8336, 46.3231, 49.2593, 47.9636, 49.3051, 48.3310, 44.5286,
        44.1544, 46.0043], device='cuda:0')
Server loss: 6.765259265899658
train global classifier
train glclassifier time: 3.5975478067994118
global classifier accuracy: 99.99
end Update
server_global_time: 1091.6516540199518
only_train_time: 11010.628607727587

-------------Global Round number: 69-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6348
Averaged Test Accuracy (Prototype Model): 0.6336
Std Test Accuracy (Regular Model): 0.1088
Std Test Accuracy (Prototype Model): 0.1080
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([44.8516, 46.8088, 46.8445, 49.8767, 48.8708, 49.5277, 50.0847, 45.3506,
        44.8516, 46.6000], device='cuda:0')
Server loss: 8.431770324707031
train global classifier
train glclassifier time: 3.599658191204071
global classifier accuracy: 99.9975
Number of samples: 326
end Update
server_global_time: 1107.4767009541392
only_train_time: 11168.410526022315

-------------Global Round number: 70-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6425
Averaged Test Accuracy (Prototype Model): 0.6428
Std Test Accuracy (Regular Model): 0.1105
Std Test Accuracy (Prototype Model): 0.1098
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([45.1616, 47.2467, 47.3589, 50.4424, 49.4157, 50.1804, 50.4791, 45.7642,
        45.1616, 47.0890], device='cuda:0')
Server loss: 8.654366493225098
train global classifier
train glclassifier time: 3.5827441662549973
global classifier accuracy: 99.9975
end Update
server_global_time: 1122.826593130827
only_train_time: 11325.175848171115

-------------Global Round number: 71-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6426
Averaged Test Accuracy (Prototype Model): 0.6413
Std Test Accuracy (Regular Model): 0.1103
Std Test Accuracy (Prototype Model): 0.1100
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([45.5612, 47.5501, 47.8322, 50.8447, 49.8311, 50.6589, 50.8470, 46.1643,
        45.5612, 47.4877], device='cuda:0')
Server loss: 8.02064323425293
train global classifier
train glclassifier time: 3.58002533018589
global classifier accuracy: 99.9925
end Update
server_global_time: 1138.5629699379206
only_train_time: 11481.56917335093

-------------Global Round number: 72-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6415
Averaged Test Accuracy (Prototype Model): 0.6406
Std Test Accuracy (Regular Model): 0.1096
Std Test Accuracy (Prototype Model): 0.1097
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([45.9876, 48.1733, 48.2461, 50.8207, 50.3633, 50.8579, 51.2339, 46.5305,
        45.9876, 47.8666], device='cuda:0')
Server loss: 7.551329135894775
train global classifier
train glclassifier time: 3.5783948972821236
global classifier accuracy: 99.9925
end Update
server_global_time: 1154.3240516930819
only_train_time: 11638.389056444168

-------------Global Round number: 73-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6418
Averaged Test Accuracy (Prototype Model): 0.6413
Std Test Accuracy (Regular Model): 0.1101
Std Test Accuracy (Prototype Model): 0.1095
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([46.0321, 46.9717, 47.7353, 51.1671, 50.4511, 50.9582, 51.4881, 46.3279,
        46.0321, 47.3361], device='cuda:0')
Server loss: 7.806103229522705
train global classifier
train glclassifier time: 3.8575864285230637
global classifier accuracy: 99.995
end Update
server_global_time: 1169.952573031187
only_train_time: 11794.985902577639

-------------Global Round number: 74-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6406
Averaged Test Accuracy (Prototype Model): 0.6407
Std Test Accuracy (Regular Model): 0.1101
Std Test Accuracy (Prototype Model): 0.1089
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([46.5569, 48.6407, 48.7451, 51.3790, 50.7180, 51.5709, 51.6385, 47.0472,
        46.5569, 48.4631], device='cuda:0')
Server loss: 4.814374923706055
train global classifier
train glclassifier time: 3.8008753582835197
global classifier accuracy: 99.9925
end Update
server_global_time: 1186.874048255384
only_train_time: 11953.558729961514

-------------Global Round number: 75-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6413
Averaged Test Accuracy (Prototype Model): 0.6403
Std Test Accuracy (Regular Model): 0.1102
Std Test Accuracy (Prototype Model): 0.1100
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([46.7437, 48.6922, 49.0224, 51.7623, 51.1108, 51.7074, 52.0444, 47.1063,
        46.7437, 48.7265], device='cuda:0')
Server loss: 7.204650402069092
train global classifier
train glclassifier time: 3.6125587224960327
global classifier accuracy: 99.9925
end Update
server_global_time: 1202.5713678002357
only_train_time: 12109.837763227522

-------------Global Round number: 76-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6408
Averaged Test Accuracy (Prototype Model): 0.6404
Std Test Accuracy (Regular Model): 0.1089
Std Test Accuracy (Prototype Model): 0.1090
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([47.2894, 49.1495, 49.2372, 51.8412, 51.5426, 51.8614, 52.2718, 47.6136,
        47.2894, 49.2732], device='cuda:0')
Server loss: 5.442684650421143
train global classifier
train glclassifier time: 3.6704791486263275
global classifier accuracy: 100.0
end Update
server_global_time: 1218.1493348553777
only_train_time: 12266.87837266177

-------------Global Round number: 77-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6412
Averaged Test Accuracy (Prototype Model): 0.6404
Std Test Accuracy (Regular Model): 0.1091
Std Test Accuracy (Prototype Model): 0.1076
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([47.3718, 49.4797, 49.5134, 52.2650, 51.7634, 52.3461, 52.7852, 47.8458,
        47.3718, 49.4773], device='cuda:0')
Server loss: 8.202902793884277
train global classifier
train glclassifier time: 3.7736081406474113
global classifier accuracy: 99.995
end Update
server_global_time: 1233.609927162528
only_train_time: 12423.928479216993

-------------Global Round number: 78-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6413
Averaged Test Accuracy (Prototype Model): 0.6410
Std Test Accuracy (Regular Model): 0.1093
Std Test Accuracy (Prototype Model): 0.1086
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([47.6414, 49.7902, 49.7232, 52.6164, 51.9496, 52.6585, 53.0087, 47.9719,
        47.6414, 49.6814], device='cuda:0')
Server loss: 5.7945475578308105
train global classifier
train glclassifier time: 3.572925202548504
global classifier accuracy: 99.9975
end Update
server_global_time: 1249.2636981084943
only_train_time: 12582.315637901425

-------------Global Round number: 79-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6411
Averaged Test Accuracy (Prototype Model): 0.6410
Std Test Accuracy (Regular Model): 0.1090
Std Test Accuracy (Prototype Model): 0.1081
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([48.0676, 50.1253, 50.2848, 52.6401, 51.9406, 52.8768, 53.3431, 48.4502,
        48.0676, 50.1376], device='cuda:0')
Server loss: 6.295007228851318
train global classifier
train glclassifier time: 5.0587840005755424
global classifier accuracy: 99.995
Number of samples: 326
end Update
server_global_time: 1264.6383675262332
only_train_time: 12738.919298104942

-------------Global Round number: 80-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6430
Averaged Test Accuracy (Prototype Model): 0.6423
Std Test Accuracy (Regular Model): 0.1095
Std Test Accuracy (Prototype Model): 0.1085
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([48.2634, 50.3648, 50.5005, 52.8909, 52.5403, 53.3012, 53.6590, 48.6890,
        48.2634, 50.3331], device='cuda:0')
Server loss: 6.878495216369629
train global classifier
train glclassifier time: 3.6901260763406754
global classifier accuracy: 99.9925
end Update
server_global_time: 1280.5211114957929
only_train_time: 12898.243340872228

-------------Global Round number: 81-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6421
Averaged Test Accuracy (Prototype Model): 0.6419
Std Test Accuracy (Regular Model): 0.1100
Std Test Accuracy (Prototype Model): 0.1081
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([48.5670, 50.5949, 50.8332, 53.4466, 52.7100, 53.3748, 53.7953, 48.8570,
        48.5670, 50.6259], device='cuda:0')
Server loss: 5.77307653427124
train global classifier
train glclassifier time: 3.8767485469579697
global classifier accuracy: 100.0
end Update
server_global_time: 1296.3159481659532
only_train_time: 13056.623647235334

-------------Global Round number: 82-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6432
Averaged Test Accuracy (Prototype Model): 0.6430
Std Test Accuracy (Regular Model): 0.1102
Std Test Accuracy (Prototype Model): 0.1085
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([48.8652, 50.7100, 51.1517, 53.7869, 52.9336, 53.3966, 53.9223, 49.1171,
        48.8652, 50.9816], device='cuda:0')
Server loss: 8.338704109191895
train global classifier
train glclassifier time: 3.6651649326086044
global classifier accuracy: 99.9975
end Update
server_global_time: 1311.8757777512074
only_train_time: 13214.60587477684

-------------Global Round number: 83-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6430
Averaged Test Accuracy (Prototype Model): 0.6436
Std Test Accuracy (Regular Model): 0.1098
Std Test Accuracy (Prototype Model): 0.1088
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([49.2266, 50.9645, 51.3026, 54.1314, 53.3726, 53.9081, 54.0658, 49.4825,
        49.2266, 51.3034], device='cuda:0')
Server loss: 5.568452835083008
train global classifier
train glclassifier time: 3.6322880759835243
global classifier accuracy: 100.0
end Update
server_global_time: 1327.7627951204777
only_train_time: 13372.393666312099

-------------Global Round number: 84-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6431
Averaged Test Accuracy (Prototype Model): 0.6414
Std Test Accuracy (Regular Model): 0.1095
Std Test Accuracy (Prototype Model): 0.1095
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([49.5142, 51.4236, 51.8470, 54.2984, 53.3889, 54.5373, 54.7495, 50.0752,
        49.5142, 51.7531], device='cuda:0')
Server loss: 7.376718044281006
train global classifier
train glclassifier time: 3.768067739903927
global classifier accuracy: 99.995
end Update
server_global_time: 1343.483645580709
only_train_time: 13532.200565956533

-------------Global Round number: 85-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6435
Averaged Test Accuracy (Prototype Model): 0.6420
Std Test Accuracy (Regular Model): 0.1092
Std Test Accuracy (Prototype Model): 0.1083
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([49.5116, 51.6855, 51.7598, 54.9595, 53.9385, 54.2537, 54.9327, 50.1232,
        49.5116, 51.7740], device='cuda:0')
Server loss: 6.847762584686279
train global classifier
train glclassifier time: 3.625736102461815
global classifier accuracy: 99.995
end Update
server_global_time: 1359.1503785550594
only_train_time: 13691.641824498773

-------------Global Round number: 86-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6432
Averaged Test Accuracy (Prototype Model): 0.6419
Std Test Accuracy (Regular Model): 0.1094
Std Test Accuracy (Prototype Model): 0.1081
tobetrained:
[0, 2, 8, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([49.8280, 52.0396, 51.8918, 55.0602, 54.1738, 54.7132, 55.1721, 50.2642,
        49.8280, 52.0858], device='cuda:0')
Server loss: 8.528105735778809
train global classifier
train glclassifier time: 3.6522902995347977
global classifier accuracy: 99.9925
end Update
server_global_time: 1374.9180165976286
only_train_time: 13848.478064343333

-------------Global Round number: 87-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6430
Averaged Test Accuracy (Prototype Model): 0.6416
Std Test Accuracy (Regular Model): 0.1095
Std Test Accuracy (Prototype Model): 0.1084
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([50.3102, 52.2987, 52.4222, 54.9827, 54.3558, 55.0858, 55.4727, 50.6397,
        50.3102, 52.4173], device='cuda:0')
Server loss: 6.023330211639404
train global classifier
train glclassifier time: 3.6712642833590508
global classifier accuracy: 99.995
end Update
server_global_time: 1390.4406081438065
only_train_time: 14003.22715011239

-------------Global Round number: 88-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6436
Averaged Test Accuracy (Prototype Model): 0.6427
Std Test Accuracy (Regular Model): 0.1079
Std Test Accuracy (Prototype Model): 0.1083
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([50.6044, 52.2814, 52.8830, 55.1403, 54.4988, 55.2972, 55.5985, 50.7619,
        50.6044, 52.7607], device='cuda:0')
Server loss: 6.22544527053833
train global classifier
train glclassifier time: 3.6157242208719254
global classifier accuracy: 99.995
end Update
server_global_time: 1406.0501441285014
only_train_time: 14160.957861818373

-------------Global Round number: 89-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6442
Averaged Test Accuracy (Prototype Model): 0.6426
Std Test Accuracy (Regular Model): 0.1077
Std Test Accuracy (Prototype Model): 0.1084
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([50.7657, 52.6850, 53.1392, 55.6537, 54.8059, 55.6295, 55.9898, 51.1862,
        50.7657, 53.0396], device='cuda:0')
Server loss: 6.452905178070068
train global classifier
train glclassifier time: 3.6544941514730453
global classifier accuracy: 99.995
Number of samples: 326
end Update
server_global_time: 1421.6350031122565
only_train_time: 14319.968534395099

-------------Global Round number: 90-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6430
Averaged Test Accuracy (Prototype Model): 0.6424
Std Test Accuracy (Regular Model): 0.1098
Std Test Accuracy (Prototype Model): 0.1088
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([51.0965, 52.9561, 53.3116, 55.9829, 55.0948, 56.0320, 56.1069, 51.4662,
        51.0965, 53.3613], device='cuda:0')
Server loss: 6.941717147827148
train global classifier
train glclassifier time: 3.623456969857216
global classifier accuracy: 99.995
end Update
server_global_time: 1437.4389843344688
only_train_time: 14480.952723436058

-------------Global Round number: 91-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6438
Averaged Test Accuracy (Prototype Model): 0.6430
Std Test Accuracy (Regular Model): 0.1079
Std Test Accuracy (Prototype Model): 0.1085
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([51.3755, 53.1988, 53.5118, 56.1979, 55.4006, 55.9465, 56.5149, 51.6475,
        51.3755, 53.5999], device='cuda:0')
Server loss: 7.512520790100098
train global classifier
train glclassifier time: 3.5921799764037132
global classifier accuracy: 99.9975
end Update
server_global_time: 1453.2586878463626
only_train_time: 14638.644228838384

-------------Global Round number: 92-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6437
Averaged Test Accuracy (Prototype Model): 0.6422
Std Test Accuracy (Regular Model): 0.1084
Std Test Accuracy (Prototype Model): 0.1092
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([51.6278, 53.7448, 53.8059, 56.2522, 55.8872, 56.2134, 56.7186, 52.0561,
        51.6278, 53.9468], device='cuda:0')
Server loss: 8.300235748291016
train global classifier
train glclassifier time: 3.6662146523594856
global classifier accuracy: 100.0
end Update
server_global_time: 1469.0955325365067
only_train_time: 14796.084203109145

-------------Global Round number: 93-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6434
Averaged Test Accuracy (Prototype Model): 0.6423
Std Test Accuracy (Regular Model): 0.1084
Std Test Accuracy (Prototype Model): 0.1084
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([51.6864, 53.6793, 53.8895, 56.6631, 56.1082, 56.2388, 56.9177, 52.0194,
        51.6864, 53.8249], device='cuda:0')
Server loss: 8.256328582763672
train global classifier
train glclassifier time: 3.642758622765541
global classifier accuracy: 99.9925
end Update
server_global_time: 1484.9538375139236
only_train_time: 14954.915083110332

-------------Global Round number: 94-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6424
Averaged Test Accuracy (Prototype Model): 0.6408
Std Test Accuracy (Regular Model): 0.1135
Std Test Accuracy (Prototype Model): 0.1119
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([51.9905, 53.8525, 54.4313, 56.9439, 56.1909, 56.2871, 56.3524, 52.4301,
        51.9905, 54.2933], device='cuda:0')
Server loss: 8.359837532043457
train global classifier
train glclassifier time: 4.096537984907627
global classifier accuracy: 100.0
end Update
server_global_time: 1500.62054284662
only_train_time: 15113.591017894447

-------------Global Round number: 95-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6451
Averaged Test Accuracy (Prototype Model): 0.6426
Std Test Accuracy (Regular Model): 0.1080
Std Test Accuracy (Prototype Model): 0.1078
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([52.3839, 54.1449, 54.5771, 56.8690, 56.2098, 57.0695, 57.1784, 52.5546,
        52.3839, 54.5531], device='cuda:0')
Server loss: 6.165078639984131
train global classifier
train glclassifier time: 3.668641984462738
global classifier accuracy: 99.9975
end Update
server_global_time: 1516.5028068944812
only_train_time: 15273.87590213865

-------------Global Round number: 96-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6443
Averaged Test Accuracy (Prototype Model): 0.6429
Std Test Accuracy (Regular Model): 0.1077
Std Test Accuracy (Prototype Model): 0.1081
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([52.6395, 54.4496, 54.9454, 57.5347, 56.6909, 57.0718, 57.5410, 53.0116,
        52.6395, 54.9649], device='cuda:0')
Server loss: 8.582806587219238
train global classifier
train glclassifier time: 3.613834962248802
global classifier accuracy: 100.0
end Update
server_global_time: 1532.228049196303
only_train_time: 15431.584876544774

-------------Global Round number: 97-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6432
Averaged Test Accuracy (Prototype Model): 0.6422
Std Test Accuracy (Regular Model): 0.1077
Std Test Accuracy (Prototype Model): 0.1085
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([52.9990, 54.6759, 55.1827, 57.4878, 56.8441, 57.4022, 57.8764, 53.2020,
        52.9990, 55.1381], device='cuda:0')
Server loss: 6.073996543884277
train global classifier
train glclassifier time: 3.704272173345089
global classifier accuracy: 100.0
end Update
server_global_time: 1547.9011699184775
only_train_time: 15589.096193529665

-------------Global Round number: 98-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6446
Averaged Test Accuracy (Prototype Model): 0.6427
Std Test Accuracy (Regular Model): 0.1086
Std Test Accuracy (Prototype Model): 0.1083
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([53.2982, 54.8167, 55.3680, 57.7144, 57.0657, 57.7801, 57.9149, 53.3389,
        53.2982, 55.4340], device='cuda:0')
Server loss: 7.272858142852783
train global classifier
train glclassifier time: 3.6479156464338303
global classifier accuracy: 100.0
end Update
server_global_time: 1563.4000241234899
only_train_time: 15746.816408753395

-------------Global Round number: 99-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6450
Averaged Test Accuracy (Prototype Model): 0.6442
Std Test Accuracy (Regular Model): 0.1081
Std Test Accuracy (Prototype Model): 0.1089
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([53.4008, 55.5671, 55.7847, 58.3144, 57.2663, 57.8339, 58.7390, 53.9671,
        53.4008, 55.7357], device='cuda:0')
Server loss: 6.3263750076293945
train global classifier
train glclassifier time: 3.6541672199964523
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 1578.9473578855395
only_train_time: 15904.578758090734

-------------Global Round number: 100-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6452
Averaged Test Accuracy (Prototype Model): 0.6436
Std Test Accuracy (Regular Model): 0.1093
Std Test Accuracy (Prototype Model): 0.1092
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([53.6563, 55.4666, 56.1429, 58.4242, 57.4826, 58.3256, 58.5827, 54.0502,
        53.6563, 56.0558], device='cuda:0')
Server loss: 7.276603698730469
train global classifier
train glclassifier time: 4.23040547221899
global classifier accuracy: 100.0
end Update
server_global_time: 1594.0635404363275
only_train_time: 16062.609286569059

-------------Global Round number: 101-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6448
Averaged Test Accuracy (Prototype Model): 0.6434
Std Test Accuracy (Regular Model): 0.1093
Std Test Accuracy (Prototype Model): 0.1103
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([53.9379, 55.5413, 56.3988, 58.8368, 58.2350, 58.3353, 58.8941, 54.3882,
        53.9379, 56.3405], device='cuda:0')
Server loss: 6.09852933883667
train global classifier
train glclassifier time: 3.7012590393424034
global classifier accuracy: 99.995
end Update
server_global_time: 1609.835926540196
only_train_time: 16221.861254900694

-------------Global Round number: 102-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6450
Averaged Test Accuracy (Prototype Model): 0.6444
Std Test Accuracy (Regular Model): 0.1095
Std Test Accuracy (Prototype Model): 0.1096
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([53.6368, 54.8822, 56.0262, 58.8143, 58.3539, 57.8443, 59.0211, 53.9992,
        53.6368, 55.5702], device='cuda:0')
Server loss: 9.363450050354004
train global classifier
train glclassifier time: 3.698297545313835
global classifier accuracy: 99.9975
end Update
server_global_time: 1625.3569678217173
only_train_time: 16379.75976075232

-------------Global Round number: 103-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6420
Averaged Test Accuracy (Prototype Model): 0.6418
Std Test Accuracy (Regular Model): 0.1103
Std Test Accuracy (Prototype Model): 0.1111
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([54.3395, 56.2993, 56.5851, 59.2459, 58.3370, 58.5558, 59.1846, 54.6645,
        54.3395, 56.6965], device='cuda:0')
Server loss: 6.5059309005737305
train global classifier
train glclassifier time: 3.6447478905320168
global classifier accuracy: 99.9975
end Update
server_global_time: 1641.0567096844316
only_train_time: 16538.149661302567

-------------Global Round number: 104-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6454
Averaged Test Accuracy (Prototype Model): 0.6442
Std Test Accuracy (Regular Model): 0.1091
Std Test Accuracy (Prototype Model): 0.1091
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([54.5327, 56.6880, 56.8312, 59.4948, 58.8367, 59.0213, 59.4939, 55.0075,
        54.5327, 57.0247], device='cuda:0')
Server loss: 7.554759502410889
train global classifier
train glclassifier time: 3.6793479323387146
global classifier accuracy: 100.0
end Update
server_global_time: 1656.7707705572248
only_train_time: 16696.64624775201

-------------Global Round number: 105-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6438
Averaged Test Accuracy (Prototype Model): 0.6438
Std Test Accuracy (Regular Model): 0.1094
Std Test Accuracy (Prototype Model): 0.1098
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([54.8300, 56.5765, 57.1660, 59.5911, 58.7602, 59.0457, 59.7626, 55.0952,
        54.8300, 57.1737], device='cuda:0')
Server loss: 5.8287224769592285
train global classifier
train glclassifier time: 3.7705036029219627
global classifier accuracy: 100.0
end Update
server_global_time: 1673.1415359526873
only_train_time: 16855.373681150377

-------------Global Round number: 106-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6452
Averaged Test Accuracy (Prototype Model): 0.6444
Std Test Accuracy (Regular Model): 0.1082
Std Test Accuracy (Prototype Model): 0.1092
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([55.0845, 56.8747, 57.4881, 59.6780, 59.0121, 59.5250, 60.0997, 55.4395,
        55.0845, 57.5459], device='cuda:0')
Server loss: 8.585488319396973
train global classifier
train glclassifier time: 3.6944370418787003
global classifier accuracy: 99.9975
end Update
server_global_time: 1688.736319474876
only_train_time: 17012.395383164287

-------------Global Round number: 107-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6445
Averaged Test Accuracy (Prototype Model): 0.6442
Std Test Accuracy (Regular Model): 0.1097
Std Test Accuracy (Prototype Model): 0.1090
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([55.3394, 57.1774, 57.7533, 59.8105, 59.4655, 59.4999, 60.4657, 55.5555,
        55.3394, 57.6479], device='cuda:0')
Server loss: 4.606478214263916
train global classifier
train glclassifier time: 3.661546178162098
global classifier accuracy: 100.0
end Update
server_global_time: 1704.377406179905
only_train_time: 17169.322160825133

-------------Global Round number: 108-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6447
Averaged Test Accuracy (Prototype Model): 0.6451
Std Test Accuracy (Regular Model): 0.1088
Std Test Accuracy (Prototype Model): 0.1091
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([55.5153, 57.4955, 58.0277, 60.3947, 59.7299, 59.8929, 60.8779, 55.9830,
        55.5153, 58.0108], device='cuda:0')
Server loss: 7.402972221374512
train global classifier
train glclassifier time: 3.806404523551464
global classifier accuracy: 99.995
end Update
server_global_time: 1719.9162615388632
only_train_time: 17326.948137693107

-------------Global Round number: 109-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6452
Averaged Test Accuracy (Prototype Model): 0.6437
Std Test Accuracy (Regular Model): 0.1090
Std Test Accuracy (Prototype Model): 0.1090
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([55.8092, 57.7103, 58.3357, 60.6625, 60.0326, 60.2477, 60.7560, 56.2138,
        55.8092, 58.3833], device='cuda:0')
Server loss: 7.087409019470215
train global classifier
train glclassifier time: 3.718506343662739
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 1735.5014788135886
only_train_time: 17485.34480755776

-------------Global Round number: 110-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6444
Averaged Test Accuracy (Prototype Model): 0.6434
Std Test Accuracy (Regular Model): 0.1092
Std Test Accuracy (Prototype Model): 0.1108
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([56.1239, 57.8252, 58.4779, 60.7601, 60.1992, 60.4133, 61.0598, 56.4680,
        56.1239, 58.7083], device='cuda:0')
Server loss: 9.298567771911621
train global classifier
train glclassifier time: 3.612772509455681
global classifier accuracy: 100.0
end Update
server_global_time: 1751.303684324026
only_train_time: 17643.67570861429

-------------Global Round number: 111-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6447
Averaged Test Accuracy (Prototype Model): 0.6435
Std Test Accuracy (Regular Model): 0.1082
Std Test Accuracy (Prototype Model): 0.1109
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([56.2507, 58.1627, 58.7704, 60.7570, 60.3783, 60.6459, 61.1763, 56.4761,
        56.2507, 58.7237], device='cuda:0')
Server loss: 6.381804943084717
train global classifier
train glclassifier time: 3.609592519700527
global classifier accuracy: 99.9975
end Update
server_global_time: 1766.925632596016
only_train_time: 17803.68582393229

-------------Global Round number: 112-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6453
Averaged Test Accuracy (Prototype Model): 0.6443
Std Test Accuracy (Regular Model): 0.1074
Std Test Accuracy (Prototype Model): 0.1090
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([56.5750, 58.5680, 58.9960, 61.2608, 60.7355, 61.0717, 61.5002, 57.0239,
        56.5750, 59.0444], device='cuda:0')
Server loss: 7.49040412902832
train global classifier
train glclassifier time: 3.6833309829235077
global classifier accuracy: 100.0
end Update
server_global_time: 1782.829025387764
only_train_time: 17962.760012298822

-------------Global Round number: 113-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6450
Averaged Test Accuracy (Prototype Model): 0.6443
Std Test Accuracy (Regular Model): 0.1088
Std Test Accuracy (Prototype Model): 0.1104
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([56.7379, 58.5863, 59.2354, 61.4587, 61.0812, 61.2722, 61.4248, 57.1733,
        56.7379, 59.4231], device='cuda:0')
Server loss: 6.65440559387207
train global classifier
train glclassifier time: 3.6858760118484497
global classifier accuracy: 100.0
end Update
server_global_time: 1798.4646713286638
only_train_time: 18121.410989925265

-------------Global Round number: 114-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6456
Averaged Test Accuracy (Prototype Model): 0.6448
Std Test Accuracy (Regular Model): 0.1088
Std Test Accuracy (Prototype Model): 0.1096
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([56.9665, 58.8098, 59.2527, 61.5201, 61.1021, 61.3825, 61.9284, 57.3114,
        56.9665, 59.6356], device='cuda:0')
Server loss: 6.613473415374756
train global classifier
train glclassifier time: 3.563998781144619
global classifier accuracy: 100.0
end Update
server_global_time: 1814.0656965747476
only_train_time: 18279.88190189004

-------------Global Round number: 115-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6454
Averaged Test Accuracy (Prototype Model): 0.6448
Std Test Accuracy (Regular Model): 0.1086
Std Test Accuracy (Prototype Model): 0.1088
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([57.1453, 59.1689, 59.7932, 61.9538, 61.4759, 61.6055, 62.0989, 57.7256,
        57.1453, 59.9281], device='cuda:0')
Server loss: 6.52521276473999
train global classifier
train glclassifier time: 3.605810172855854
global classifier accuracy: 100.0
end Update
server_global_time: 1829.6928938999772
only_train_time: 18437.532474696636

-------------Global Round number: 116-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6458
Averaged Test Accuracy (Prototype Model): 0.6447
Std Test Accuracy (Regular Model): 0.1081
Std Test Accuracy (Prototype Model): 0.1086
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([57.3527, 59.2780, 60.0813, 61.9880, 61.6607, 61.6327, 62.4297, 57.9058,
        57.3527, 60.1229], device='cuda:0')
Server loss: 8.292113304138184
train global classifier
train glclassifier time: 4.022624105215073
global classifier accuracy: 100.0
end Update
server_global_time: 1845.6999443471432
only_train_time: 18595.282866455615

-------------Global Round number: 117-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6454
Averaged Test Accuracy (Prototype Model): 0.6452
Std Test Accuracy (Regular Model): 0.1086
Std Test Accuracy (Prototype Model): 0.1095
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([57.4277, 59.5575, 60.0935, 62.2153, 61.8072, 61.9779, 62.1799, 57.9003,
        57.4277, 60.2729], device='cuda:0')
Server loss: 6.814515590667725
train global classifier
train glclassifier time: 3.7071823179721832
global classifier accuracy: 100.0
end Update
server_global_time: 1861.3116347715259
only_train_time: 18754.539305448532

-------------Global Round number: 118-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6457
Averaged Test Accuracy (Prototype Model): 0.6451
Std Test Accuracy (Regular Model): 0.1083
Std Test Accuracy (Prototype Model): 0.1086
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([57.6929, 59.5656, 60.1835, 62.4956, 61.9730, 62.1278, 62.6670, 58.0354,
        57.6929, 60.3735], device='cuda:0')
Server loss: 7.620522975921631
train global classifier
train glclassifier time: 3.6585317701101303
global classifier accuracy: 100.0
end Update
server_global_time: 1877.3472954630852
only_train_time: 18912.16131120175

-------------Global Round number: 119-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6461
Averaged Test Accuracy (Prototype Model): 0.6456
Std Test Accuracy (Regular Model): 0.1086
Std Test Accuracy (Prototype Model): 0.1093
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([58.0461, 60.1924, 60.7302, 62.4067, 62.2121, 62.3297, 62.8867, 58.4956,
        58.0461, 60.8211], device='cuda:0')
Server loss: 6.6140336990356445
train global classifier
train glclassifier time: 3.805861935019493
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 1892.900940619409
only_train_time: 19071.474096745253

-------------Global Round number: 120-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6465
Averaged Test Accuracy (Prototype Model): 0.6459
Std Test Accuracy (Regular Model): 0.1082
Std Test Accuracy (Prototype Model): 0.1089
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([56.2902, 56.9063, 52.7018, 61.0647, 52.7018, 60.4460, 60.5911, 56.2223,
        56.4562, 59.6387], device='cuda:0')
Server loss: 6.038956642150879
train global classifier
train glclassifier time: 3.694055996835232
global classifier accuracy: 99.845
end Update
server_global_time: 1908.885859951377
only_train_time: 19231.158933728933

-------------Global Round number: 121-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6372
Averaged Test Accuracy (Prototype Model): 0.6404
Std Test Accuracy (Regular Model): 0.1110
Std Test Accuracy (Prototype Model): 0.1093
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([57.9449, 59.6768, 59.3784, 62.8415, 61.0993, 62.4018, 63.2904, 58.5856,
        57.9449, 61.0556], device='cuda:0')
Server loss: 8.984081268310547
train global classifier
train glclassifier time: 3.777752809226513
global classifier accuracy: 100.0
end Update
server_global_time: 1924.849586121738
only_train_time: 19390.486630663276

-------------Global Round number: 122-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6442
Averaged Test Accuracy (Prototype Model): 0.6430
Std Test Accuracy (Regular Model): 0.1085
Std Test Accuracy (Prototype Model): 0.1108
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([58.4298, 60.2562, 60.3678, 63.3593, 62.1510, 62.4468, 63.3330, 58.8643,
        58.4298, 61.2973], device='cuda:0')
Server loss: 6.040311336517334
train global classifier
train glclassifier time: 3.6255198642611504
global classifier accuracy: 100.0
end Update
server_global_time: 1940.792703986168
only_train_time: 19549.42997881025

-------------Global Round number: 123-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6474
Averaged Test Accuracy (Prototype Model): 0.6464
Std Test Accuracy (Regular Model): 0.1077
Std Test Accuracy (Prototype Model): 0.1083
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([58.5717, 60.7549, 61.2799, 63.6978, 62.8967, 62.7046, 63.8599, 59.1854,
        58.5717, 61.4737], device='cuda:0')
Server loss: 5.862604141235352
train global classifier
train glclassifier time: 3.6463988572359085
global classifier accuracy: 100.0
end Update
server_global_time: 1956.6177106648684
only_train_time: 19708.564711026847

-------------Global Round number: 124-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6474
Averaged Test Accuracy (Prototype Model): 0.6461
Std Test Accuracy (Regular Model): 0.1083
Std Test Accuracy (Prototype Model): 0.1084
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([58.8798, 59.2770, 60.7963, 62.6364, 61.5720, 61.7332, 62.6661, 58.6478,
        58.6478, 61.1430], device='cuda:0')
Server loss: 8.1326265335083
train global classifier
train glclassifier time: 3.7357604056596756
global classifier accuracy: 99.995
end Update
server_global_time: 1972.5400450751185
only_train_time: 19865.230275526643

-------------Global Round number: 125-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6408
Averaged Test Accuracy (Prototype Model): 0.6420
Std Test Accuracy (Regular Model): 0.1127
Std Test Accuracy (Prototype Model): 0.1114
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([58.6741, 60.5124, 60.8032, 63.1037, 61.9917, 62.6812, 63.0806, 58.8851,
        58.6741, 61.3815], device='cuda:0')
Server loss: 10.066377639770508
train global classifier
train glclassifier time: 3.6848398447036743
global classifier accuracy: 99.9975
end Update
server_global_time: 1988.2413728013635
only_train_time: 20023.014376334846

-------------Global Round number: 126-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6466
Averaged Test Accuracy (Prototype Model): 0.6459
Std Test Accuracy (Regular Model): 0.1093
Std Test Accuracy (Prototype Model): 0.1095
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([59.0826, 61.1534, 61.2146, 63.4982, 62.5407, 63.1951, 63.7891, 59.2881,
        59.0826, 61.9039], device='cuda:0')
Server loss: 11.497689247131348
train global classifier
train glclassifier time: 3.607112295925617
global classifier accuracy: 100.0
end Update
server_global_time: 2003.9021297842264
only_train_time: 20181.41174429655

-------------Global Round number: 127-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6482
Averaged Test Accuracy (Prototype Model): 0.6477
Std Test Accuracy (Regular Model): 0.1094
Std Test Accuracy (Prototype Model): 0.1096
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([59.2455, 61.2988, 61.6622, 63.8661, 63.1383, 63.6847, 64.2521, 59.5214,
        59.2455, 62.0649], device='cuda:0')
Server loss: 9.100529670715332
train global classifier
train glclassifier time: 3.737610399723053
global classifier accuracy: 99.995
end Update
server_global_time: 2019.4979416951537
only_train_time: 20339.191928371787

-------------Global Round number: 128-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6479
Averaged Test Accuracy (Prototype Model): 0.6461
Std Test Accuracy (Regular Model): 0.1087
Std Test Accuracy (Prototype Model): 0.1096
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([59.4244, 61.7244, 62.1919, 64.5469, 63.8380, 63.6730, 64.4771, 59.9072,
        59.4244, 62.4468], device='cuda:0')
Server loss: 9.193078994750977
train global classifier
train glclassifier time: 3.631880633533001
global classifier accuracy: 100.0
end Update
server_global_time: 2035.3367078453302
only_train_time: 20498.160101681948

-------------Global Round number: 129-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6497
Averaged Test Accuracy (Prototype Model): 0.6481
Std Test Accuracy (Regular Model): 0.1085
Std Test Accuracy (Prototype Model): 0.1091
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 9, 5, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 9, 5, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([59.6580, 62.0775, 62.8348, 64.6148, 64.1979, 63.9321, 64.7118, 60.2405,
        59.6580, 62.7205], device='cuda:0')
Server loss: 6.212705135345459
train global classifier
train glclassifier time: 3.672587513923645
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 2051.0399835184216
only_train_time: 20656.585094213486

-------------Global Round number: 130-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6484
Averaged Test Accuracy (Prototype Model): 0.6480
Std Test Accuracy (Regular Model): 0.1085
Std Test Accuracy (Prototype Model): 0.1094
tobetrained:
[0, 8, 2, 9, 5, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 9 begin training
Edge 5 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([59.9013, 62.0223, 62.8105, 64.6016, 64.2953, 64.3414, 65.0024, 60.3178,
        59.9013, 62.9272], device='cuda:0')
Server loss: 9.230254173278809
train global classifier
train glclassifier time: 3.649686299264431
global classifier accuracy: 100.0
end Update
server_global_time: 2066.631961464882
only_train_time: 20813.63553196937

-------------Global Round number: 131-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6484
Averaged Test Accuracy (Prototype Model): 0.6476
Std Test Accuracy (Regular Model): 0.1086
Std Test Accuracy (Prototype Model): 0.1093
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([60.2836, 62.4245, 63.0711, 65.0601, 64.1097, 64.6578, 65.3889, 60.7584,
        60.2836, 63.2269], device='cuda:0')
Server loss: 7.267549514770508
train global classifier
train glclassifier time: 3.564098007977009
global classifier accuracy: 100.0
end Update
server_global_time: 2082.1269226297736
only_train_time: 20969.772853709757

-------------Global Round number: 132-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6486
Averaged Test Accuracy (Prototype Model): 0.6475
Std Test Accuracy (Regular Model): 0.1082
Std Test Accuracy (Prototype Model): 0.1089
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([60.4648, 62.6951, 63.4023, 65.3549, 64.4990, 64.8659, 65.4681, 60.9776,
        60.4648, 63.3212], device='cuda:0')
Server loss: 8.137835502624512
train global classifier
train glclassifier time: 3.684812903404236
global classifier accuracy: 100.0
end Update
server_global_time: 2097.6399622634053
only_train_time: 21127.19540131092

-------------Global Round number: 133-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6496
Averaged Test Accuracy (Prototype Model): 0.6487
Std Test Accuracy (Regular Model): 0.1080
Std Test Accuracy (Prototype Model): 0.1090
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([60.5840, 62.5223, 63.3210, 65.6290, 64.6211, 64.9785, 65.4297, 61.0307,
        60.5840, 63.5988], device='cuda:0')
Server loss: 7.750091075897217
train global classifier
train glclassifier time: 3.6940756663680077
global classifier accuracy: 100.0
end Update
server_global_time: 2113.4444854333997
only_train_time: 21285.547809891403

-------------Global Round number: 134-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6496
Averaged Test Accuracy (Prototype Model): 0.6485
Std Test Accuracy (Regular Model): 0.1089
Std Test Accuracy (Prototype Model): 0.1099
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([60.7732, 63.2347, 63.7855, 65.6831, 65.0564, 65.2070, 65.5552, 61.4686,
        60.7732, 63.8025], device='cuda:0')
Server loss: 7.270686149597168
train global classifier
train glclassifier time: 3.6895692721009254
global classifier accuracy: 100.0
end Update
server_global_time: 2129.066044829786
only_train_time: 21444.173929154873

-------------Global Round number: 135-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6485
Averaged Test Accuracy (Prototype Model): 0.6478
Std Test Accuracy (Regular Model): 0.1077
Std Test Accuracy (Prototype Model): 0.1094
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([60.8630, 62.7473, 62.9051, 64.8233, 64.2523, 65.2678, 64.9963, 60.8616,
        60.8616, 63.6809], device='cuda:0')
Server loss: 7.498094081878662
train global classifier
train glclassifier time: 3.696430876851082
global classifier accuracy: 99.9975
end Update
server_global_time: 2144.8601605519652
only_train_time: 21602.74180547893

-------------Global Round number: 136-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6464
Averaged Test Accuracy (Prototype Model): 0.6490
Std Test Accuracy (Regular Model): 0.1084
Std Test Accuracy (Prototype Model): 0.1090
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([61.1058, 63.1416, 62.5513, 65.0281, 64.8238, 65.2745, 65.3384, 61.4971,
        61.1058, 64.0056], device='cuda:0')
Server loss: 8.520310401916504
train global classifier
train glclassifier time: 3.6486115232110023
global classifier accuracy: 99.9975
end Update
server_global_time: 2160.3428789302707
only_train_time: 21760.345748394728

-------------Global Round number: 137-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6439
Averaged Test Accuracy (Prototype Model): 0.6452
Std Test Accuracy (Regular Model): 0.1075
Std Test Accuracy (Prototype Model): 0.1069
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([61.1899, 63.5069, 63.8834, 66.0551, 65.7780, 65.4335, 66.3363, 62.4165,
        61.1899, 64.3098], device='cuda:0')
Server loss: 7.579492568969727
train global classifier
train glclassifier time: 3.689141623675823
global classifier accuracy: 100.0
end Update
server_global_time: 2175.8933513835073
only_train_time: 21917.853074893355

-------------Global Round number: 138-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6388
Averaged Test Accuracy (Prototype Model): 0.6400
Std Test Accuracy (Regular Model): 0.1099
Std Test Accuracy (Prototype Model): 0.1117
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([61.4691, 63.7742, 64.3679, 66.7964, 65.9653, 65.7331, 66.5662, 62.6999,
        61.4691, 64.4613], device='cuda:0')
Server loss: 8.182724952697754
train global classifier
train glclassifier time: 3.6256487742066383
global classifier accuracy: 100.0
end Update
server_global_time: 2191.953866586089
only_train_time: 22076.517541363835

-------------Global Round number: 139-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6467
Averaged Test Accuracy (Prototype Model): 0.6468
Std Test Accuracy (Regular Model): 0.1067
Std Test Accuracy (Prototype Model): 0.1076
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([61.5116, 63.8668, 64.9191, 66.7593, 65.9858, 66.2634, 66.5757, 63.1182,
        61.5116, 64.8921], device='cuda:0')
Server loss: 7.513055801391602
train global classifier
train glclassifier time: 3.6010113283991814
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 2207.4625294953585
only_train_time: 22233.904283851385

-------------Global Round number: 140-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6450
Averaged Test Accuracy (Prototype Model): 0.6445
Std Test Accuracy (Regular Model): 0.1057
Std Test Accuracy (Prototype Model): 0.1062
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([61.8158, 64.2414, 65.1647, 67.4882, 66.3570, 66.0978, 67.1790, 63.3618,
        61.8158, 64.9326], device='cuda:0')
Server loss: 10.46562385559082
train global classifier
train glclassifier time: 3.6518355384469032
global classifier accuracy: 100.0
end Update
server_global_time: 2222.9008874967694
only_train_time: 22389.87933629006

-------------Global Round number: 141-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6498
Averaged Test Accuracy (Prototype Model): 0.6484
Std Test Accuracy (Regular Model): 0.1073
Std Test Accuracy (Prototype Model): 0.1088
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([61.8548, 64.1833, 64.7654, 67.1667, 66.5482, 66.2752, 66.9157, 63.0369,
        61.8548, 64.9709], device='cuda:0')
Server loss: 8.364169120788574
train global classifier
train glclassifier time: 3.651289612054825
global classifier accuracy: 100.0
end Update
server_global_time: 2238.4360083565116
only_train_time: 22546.780692219734

-------------Global Round number: 142-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6452
Averaged Test Accuracy (Prototype Model): 0.6456
Std Test Accuracy (Regular Model): 0.1216
Std Test Accuracy (Prototype Model): 0.1220
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([62.0922, 64.4951, 65.3883, 67.4602, 67.0118, 66.6125, 67.2850, 63.5844,
        62.0922, 65.3000], device='cuda:0')
Server loss: 7.8714985847473145
train global classifier
train glclassifier time: 3.620355762541294
global classifier accuracy: 100.0
end Update
server_global_time: 2254.0251740142703
only_train_time: 22703.86798737943

-------------Global Round number: 143-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6489
Averaged Test Accuracy (Prototype Model): 0.6478
Std Test Accuracy (Regular Model): 0.1010
Std Test Accuracy (Prototype Model): 0.1029
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([62.2823, 64.8563, 65.7794, 67.4107, 66.6515, 66.9674, 67.3254, 63.8866,
        62.2823, 65.6899], device='cuda:0')
Server loss: 6.64196252822876
train global classifier
train glclassifier time: 4.174663834273815
global classifier accuracy: 100.0
end Update
server_global_time: 2270.0978434979916
only_train_time: 22861.76621554047

-------------Global Round number: 144-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6473
Averaged Test Accuracy (Prototype Model): 0.6461
Std Test Accuracy (Regular Model): 0.1019
Std Test Accuracy (Prototype Model): 0.1031
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([62.4614, 64.9865, 65.9220, 67.8723, 67.2411, 67.0147, 67.8516, 64.3090,
        62.4614, 65.7614], device='cuda:0')
Server loss: 5.744524955749512
train global classifier
train glclassifier time: 3.94001691788435
global classifier accuracy: 100.0
end Update
server_global_time: 2285.7018638178706
only_train_time: 23018.555670246482

-------------Global Round number: 145-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6505
Averaged Test Accuracy (Prototype Model): 0.6490
Std Test Accuracy (Regular Model): 0.1020
Std Test Accuracy (Prototype Model): 0.1035
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([62.5699, 65.2596, 66.0772, 68.3030, 67.2808, 67.2275, 68.2066, 64.2672,
        62.5699, 65.8090], device='cuda:0')
Server loss: 7.73276948928833
train global classifier
train glclassifier time: 3.6299536302685738
global classifier accuracy: 100.0
end Update
server_global_time: 2301.1544795036316
only_train_time: 23175.29633899033

-------------Global Round number: 146-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6494
Averaged Test Accuracy (Prototype Model): 0.6484
Std Test Accuracy (Regular Model): 0.1014
Std Test Accuracy (Prototype Model): 0.1031
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([62.7467, 65.5026, 66.2412, 68.4185, 67.3001, 67.4173, 68.2533, 64.4221,
        62.7467, 66.0805], device='cuda:0')
Server loss: 7.864957809448242
train global classifier
train glclassifier time: 3.733319014310837
global classifier accuracy: 100.0
end Update
server_global_time: 2316.595529407263
only_train_time: 23332.988588176668

-------------Global Round number: 147-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6495
Averaged Test Accuracy (Prototype Model): 0.6490
Std Test Accuracy (Regular Model): 0.1015
Std Test Accuracy (Prototype Model): 0.1032
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([63.0562, 65.4338, 66.4442, 68.5812, 67.8373, 67.6416, 68.4828, 64.9222,
        63.0562, 66.3349], device='cuda:0')
Server loss: 7.040533542633057
train global classifier
train glclassifier time: 3.876507915556431
global classifier accuracy: 100.0
end Update
server_global_time: 2332.3666408360004
only_train_time: 23491.209465622902

-------------Global Round number: 148-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6500
Averaged Test Accuracy (Prototype Model): 0.6489
Std Test Accuracy (Regular Model): 0.1023
Std Test Accuracy (Prototype Model): 0.1027
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([63.1882, 65.7243, 66.7171, 68.5868, 68.2700, 67.7716, 68.8930, 64.9135,
        63.1882, 66.3872], device='cuda:0')
Server loss: 5.908253192901611
train global classifier
train glclassifier time: 3.5833158046007156
global classifier accuracy: 100.0
end Update
server_global_time: 2348.2421539723873
only_train_time: 23648.90512251109

-------------Global Round number: 149-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6500
Averaged Test Accuracy (Prototype Model): 0.6475
Std Test Accuracy (Regular Model): 0.1011
Std Test Accuracy (Prototype Model): 0.1035
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([63.3872, 65.9332, 67.0139, 69.1864, 68.0957, 68.0954, 69.0386, 65.2685,
        63.3872, 66.5546], device='cuda:0')
Server loss: 7.0162482261657715
train global classifier
train glclassifier time: 3.7031763195991516
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 2363.429719530046
only_train_time: 23806.251019127667

-------------Global Round number: 150-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6501
Averaged Test Accuracy (Prototype Model): 0.6494
Std Test Accuracy (Regular Model): 0.1032
Std Test Accuracy (Prototype Model): 0.1032
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([63.4958, 65.9954, 67.1601, 69.2125, 68.2052, 68.4347, 69.1693, 65.6633,
        63.4958, 66.8144], device='cuda:0')
Server loss: 6.437753677368164
train global classifier
train glclassifier time: 3.631193906068802
global classifier accuracy: 100.0
end Update
server_global_time: 2379.2334142401814
only_train_time: 23963.42463360727

-------------Global Round number: 151-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6507
Averaged Test Accuracy (Prototype Model): 0.6496
Std Test Accuracy (Regular Model): 0.1030
Std Test Accuracy (Prototype Model): 0.1034
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([63.0119, 65.4821, 66.6350, 68.0102, 65.6819, 68.3368, 65.6819, 65.2191,
        63.0119, 67.0657], device='cuda:0')
Server loss: 9.458322525024414
train global classifier
train glclassifier time: 3.548918567597866
global classifier accuracy: 99.9975
end Update
server_global_time: 2394.404874265194
only_train_time: 24119.484662786126

-------------Global Round number: 152-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6503
Averaged Test Accuracy (Prototype Model): 0.6484
Std Test Accuracy (Regular Model): 0.1026
Std Test Accuracy (Prototype Model): 0.1020
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([63.6139, 66.1452, 67.2108, 69.1744, 68.1627, 68.2548, 69.0020, 65.8010,
        63.6139, 67.0791], device='cuda:0')
Server loss: 6.512074947357178
train global classifier
train glclassifier time: 3.6802244931459427
global classifier accuracy: 100.0
end Update
server_global_time: 2409.911365531385
only_train_time: 24276.94205158204

-------------Global Round number: 153-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6496
Averaged Test Accuracy (Prototype Model): 0.6478
Std Test Accuracy (Regular Model): 0.1031
Std Test Accuracy (Prototype Model): 0.1036
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([63.9126, 66.4501, 67.7183, 69.4542, 68.5780, 68.8764, 69.3144, 66.1616,
        63.9126, 67.4209], device='cuda:0')
Server loss: 7.0266571044921875
train global classifier
train glclassifier time: 3.644696146249771
global classifier accuracy: 100.0
end Update
server_global_time: 2425.813984654844
only_train_time: 24435.482965409756

-------------Global Round number: 154-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6506
Averaged Test Accuracy (Prototype Model): 0.6488
Std Test Accuracy (Regular Model): 0.1025
Std Test Accuracy (Prototype Model): 0.1026
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([64.1787, 66.6525, 67.7330, 69.7724, 68.9832, 69.0146, 69.8392, 66.3152,
        64.1787, 67.6506], device='cuda:0')
Server loss: 8.191055297851562
train global classifier
train glclassifier time: 3.8057700395584106
global classifier accuracy: 100.0
end Update
server_global_time: 2441.2922326400876
only_train_time: 24593.740074455738

-------------Global Round number: 155-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6513
Averaged Test Accuracy (Prototype Model): 0.6499
Std Test Accuracy (Regular Model): 0.1025
Std Test Accuracy (Prototype Model): 0.1038
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([64.4397, 66.9261, 68.0683, 70.2160, 69.2210, 69.0516, 69.9112, 66.5669,
        64.4397, 67.9287], device='cuda:0')
Server loss: 8.182040214538574
train global classifier
train glclassifier time: 3.6617543399333954
global classifier accuracy: 100.0
end Update
server_global_time: 2456.726234704256
only_train_time: 24752.41887650639

-------------Global Round number: 156-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6515
Averaged Test Accuracy (Prototype Model): 0.6497
Std Test Accuracy (Regular Model): 0.1022
Std Test Accuracy (Prototype Model): 0.1031
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([64.5964, 67.3060, 68.2559, 70.3016, 69.3348, 69.4010, 70.1696, 66.9305,
        64.5964, 68.0211], device='cuda:0')
Server loss: 8.00282096862793
train global classifier
train glclassifier time: 3.6663817390799522
global classifier accuracy: 100.0
end Update
server_global_time: 2472.5100834816694
only_train_time: 24909.87980491668

-------------Global Round number: 157-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6508
Averaged Test Accuracy (Prototype Model): 0.6499
Std Test Accuracy (Regular Model): 0.1012
Std Test Accuracy (Prototype Model): 0.1028
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([64.7515, 67.3549, 68.4760, 70.3253, 69.5544, 69.7575, 70.3013, 66.9728,
        64.7515, 68.0508], device='cuda:0')
Server loss: 7.891676425933838
train global classifier
train glclassifier time: 3.655509650707245
global classifier accuracy: 100.0
end Update
server_global_time: 2487.821664325893
only_train_time: 25066.72422169149

-------------Global Round number: 158-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6505
Averaged Test Accuracy (Prototype Model): 0.6495
Std Test Accuracy (Regular Model): 0.1020
Std Test Accuracy (Prototype Model): 0.1034
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([64.4819, 65.9104, 68.2453, 70.1294, 68.8650, 69.3091, 69.6773, 66.7056,
        64.4819, 67.9468], device='cuda:0')
Server loss: 8.792717933654785
train global classifier
train glclassifier time: 3.596833571791649
global classifier accuracy: 100.0
end Update
server_global_time: 2503.3742879107594
only_train_time: 25223.880792565644

-------------Global Round number: 159-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6501
Averaged Test Accuracy (Prototype Model): 0.6490
Std Test Accuracy (Regular Model): 0.1020
Std Test Accuracy (Prototype Model): 0.1016
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([64.5940, 66.7854, 68.1899, 70.4346, 69.6700, 69.4297, 70.0127, 66.7794,
        64.5940, 67.9068], device='cuda:0')
Server loss: 7.053048610687256
train global classifier
train glclassifier time: 3.7201196923851967
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 2519.0584624633193
only_train_time: 25383.300770796835

-------------Global Round number: 160-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6523
Averaged Test Accuracy (Prototype Model): 0.6504
Std Test Accuracy (Regular Model): 0.1021
Std Test Accuracy (Prototype Model): 0.1022
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([64.8275, 67.5444, 68.6152, 70.8516, 69.7411, 69.6245, 70.5205, 66.9607,
        64.8275, 68.2944], device='cuda:0')
Server loss: 7.300190448760986
train global classifier
train glclassifier time: 4.181373380124569
global classifier accuracy: 100.0
end Update
server_global_time: 2535.502690382302
only_train_time: 25548.14143587649

-------------Global Round number: 161-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6511
Averaged Test Accuracy (Prototype Model): 0.6499
Std Test Accuracy (Regular Model): 0.1031
Std Test Accuracy (Prototype Model): 0.1023
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([65.1696, 67.8320, 68.9563, 70.5507, 70.2185, 69.9637, 71.1556, 67.4361,
        65.1696, 68.6527], device='cuda:0')
Server loss: 8.06334400177002
train global classifier
train glclassifier time: 3.8554422557353973
global classifier accuracy: 100.0
end Update
server_global_time: 2551.747755974531
only_train_time: 25713.099147617817

-------------Global Round number: 162-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6513
Averaged Test Accuracy (Prototype Model): 0.6503
Std Test Accuracy (Regular Model): 0.1027
Std Test Accuracy (Prototype Model): 0.1033
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([65.3166, 67.9029, 69.2509, 70.9070, 70.3449, 70.2278, 71.0714, 67.6745,
        65.3166, 68.8655], device='cuda:0')
Server loss: 7.265015602111816
train global classifier
train glclassifier time: 3.8817313089966774
global classifier accuracy: 100.0
end Update
server_global_time: 2567.92677026242
only_train_time: 25877.161147855222

-------------Global Round number: 163-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6504
Averaged Test Accuracy (Prototype Model): 0.6500
Std Test Accuracy (Regular Model): 0.1035
Std Test Accuracy (Prototype Model): 0.1035
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([65.6971, 68.3057, 69.4679, 70.8992, 70.7365, 70.6244, 71.3489, 68.1362,
        65.6971, 69.2602], device='cuda:0')
Server loss: 9.592555046081543
train global classifier
train glclassifier time: 3.886078178882599
global classifier accuracy: 100.0
end Update
server_global_time: 2583.998793669045
only_train_time: 26040.513300575316

-------------Global Round number: 164-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6525
Averaged Test Accuracy (Prototype Model): 0.6513
Std Test Accuracy (Regular Model): 0.1043
Std Test Accuracy (Prototype Model): 0.1036
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([65.6711, 68.4186, 69.6159, 71.4610, 70.6304, 70.8333, 71.4792, 68.2867,
        65.6711, 69.3518], device='cuda:0')
Server loss: 7.267973899841309
train global classifier
train glclassifier time: 3.8565563037991524
global classifier accuracy: 100.0
end Update
server_global_time: 2600.3488617762923
only_train_time: 26205.10297577828

-------------Global Round number: 165-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6526
Averaged Test Accuracy (Prototype Model): 0.6505
Std Test Accuracy (Regular Model): 0.1041
Std Test Accuracy (Prototype Model): 0.1043
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([65.8923, 68.6054, 69.9119, 71.3100, 71.0065, 71.2891, 71.4417, 68.3975,
        65.8923, 69.4958], device='cuda:0')
Server loss: 8.055675506591797
train global classifier
train glclassifier time: 4.566548585891724
global classifier accuracy: 100.0
end Update
server_global_time: 2616.6990296170115
only_train_time: 26368.004572682083

-------------Global Round number: 166-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6523
Averaged Test Accuracy (Prototype Model): 0.6502
Std Test Accuracy (Regular Model): 0.1030
Std Test Accuracy (Prototype Model): 0.1033
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([65.9369, 68.6961, 69.9365, 71.7159, 71.1280, 71.0433, 71.8100, 68.7685,
        65.9369, 69.4639], device='cuda:0')
Server loss: 6.367464065551758
train global classifier
train glclassifier time: 4.894810512661934
global classifier accuracy: 100.0
end Update
server_global_time: 2633.0255682468414
only_train_time: 26531.799014285207

-------------Global Round number: 167-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6523
Averaged Test Accuracy (Prototype Model): 0.6503
Std Test Accuracy (Regular Model): 0.1022
Std Test Accuracy (Prototype Model): 0.1037
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([66.2398, 69.0485, 70.2032, 71.8175, 71.0372, 71.3846, 72.0291, 68.8610,
        66.2398, 69.8621], device='cuda:0')
Server loss: 9.154648780822754
train global classifier
train glclassifier time: 4.202783323824406
global classifier accuracy: 100.0
end Update
server_global_time: 2649.624915935099
only_train_time: 26697.227082893252

-------------Global Round number: 168-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6525
Averaged Test Accuracy (Prototype Model): 0.6509
Std Test Accuracy (Regular Model): 0.1024
Std Test Accuracy (Prototype Model): 0.1028
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([66.3806, 69.1316, 70.5687, 71.6098, 71.3204, 71.7544, 71.9239, 68.8917,
        66.3806, 69.9768], device='cuda:0')
Server loss: 8.926722526550293
train global classifier
train glclassifier time: 3.8121152594685555
global classifier accuracy: 100.0
end Update
server_global_time: 2665.704300954938
only_train_time: 26859.93715978414

-------------Global Round number: 169-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6514
Averaged Test Accuracy (Prototype Model): 0.6499
Std Test Accuracy (Regular Model): 0.1024
Std Test Accuracy (Prototype Model): 0.1045
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([66.6820, 69.4235, 70.6319, 72.2485, 71.7644, 71.6912, 72.2693, 69.2257,
        66.6820, 70.1599], device='cuda:0')
Server loss: 5.874636173248291
train global classifier
train glclassifier time: 3.8347775489091873
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 2681.9735199809074
only_train_time: 27024.43855755031

-------------Global Round number: 170-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6523
Averaged Test Accuracy (Prototype Model): 0.6496
Std Test Accuracy (Regular Model): 0.1024
Std Test Accuracy (Prototype Model): 0.1039
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([66.6593, 69.5802, 70.6488, 72.1924, 71.8919, 71.7904, 72.5328, 69.4510,
        66.6593, 70.2089], device='cuda:0')
Server loss: 5.390410900115967
train global classifier
train glclassifier time: 3.81709261238575
global classifier accuracy: 100.0
end Update
server_global_time: 2698.1375260278583
only_train_time: 27187.63068600744

-------------Global Round number: 171-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6519
Averaged Test Accuracy (Prototype Model): 0.6500
Std Test Accuracy (Regular Model): 0.1026
Std Test Accuracy (Prototype Model): 0.1037
tobetrained:
[0, 8, 2, 5, 9, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([66.8806, 69.6639, 70.8846, 72.6901, 71.7912, 72.0119, 72.5049, 69.6060,
        66.8806, 70.3633], device='cuda:0')
Server loss: 7.63802433013916
train global classifier
train glclassifier time: 3.8183570504188538
global classifier accuracy: 100.0
end Update
server_global_time: 2714.400467723608
only_train_time: 27351.29322167486

-------------Global Round number: 172-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6509
Averaged Test Accuracy (Prototype Model): 0.6496
Std Test Accuracy (Regular Model): 0.1026
Std Test Accuracy (Prototype Model): 0.1040
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([67.0412, 69.9683, 70.9131, 72.9021, 72.1930, 71.6750, 72.9052, 69.4077,
        67.0412, 70.4471], device='cuda:0')
Server loss: 6.187543869018555
train global classifier
train glclassifier time: 4.241326384246349
global classifier accuracy: 100.0
end Update
server_global_time: 2730.9590118974447
only_train_time: 27517.530147999525

-------------Global Round number: 173-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6497
Averaged Test Accuracy (Prototype Model): 0.6477
Std Test Accuracy (Regular Model): 0.1012
Std Test Accuracy (Prototype Model): 0.1021
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([66.6520, 69.1695, 71.1406, 72.5132, 71.8318, 71.2065, 72.3901, 69.5212,
        66.6520, 70.6450], device='cuda:0')
Server loss: 9.360016822814941
train global classifier
train glclassifier time: 4.21058090031147
global classifier accuracy: 100.0
end Update
server_global_time: 2747.9959193095565
only_train_time: 27686.08050829172

-------------Global Round number: 174-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6515
Averaged Test Accuracy (Prototype Model): 0.6500
Std Test Accuracy (Regular Model): 0.1026
Std Test Accuracy (Prototype Model): 0.1030
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([67.0705, 69.7560, 71.4324, 72.5244, 72.0369, 72.5318, 72.9682, 69.6945,
        67.0705, 70.8457], device='cuda:0')
Server loss: 10.006754875183105
train global classifier
train glclassifier time: 4.185386285185814
global classifier accuracy: 100.0
end Update
server_global_time: 2764.1950055658817
only_train_time: 27850.972135975957

-------------Global Round number: 175-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6526
Averaged Test Accuracy (Prototype Model): 0.6513
Std Test Accuracy (Regular Model): 0.1029
Std Test Accuracy (Prototype Model): 0.1034
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([67.1797, 69.8756, 71.2387, 72.9368, 72.4117, 72.4604, 72.7574, 70.0638,
        67.1797, 70.4457], device='cuda:0')
Server loss: 10.37297248840332
train global classifier
train glclassifier time: 4.5346900671720505
global classifier accuracy: 100.0
end Update
server_global_time: 2780.4487334117293
only_train_time: 28014.460523955524

-------------Global Round number: 176-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6535
Averaged Test Accuracy (Prototype Model): 0.6523
Std Test Accuracy (Regular Model): 0.1021
Std Test Accuracy (Prototype Model): 0.1031
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([67.3521, 70.2382, 71.1868, 72.7787, 72.6204, 72.6104, 73.3490, 70.3973,
        67.3521, 70.8503], device='cuda:0')
Server loss: 9.61866569519043
train global classifier
train glclassifier time: 3.7523215413093567
global classifier accuracy: 100.0
end Update
server_global_time: 2796.7486217990518
only_train_time: 28179.4150775671

-------------Global Round number: 177-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6545
Averaged Test Accuracy (Prototype Model): 0.6526
Std Test Accuracy (Regular Model): 0.1023
Std Test Accuracy (Prototype Model): 0.1038
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([67.7349, 70.4150, 71.7007, 73.0349, 72.7589, 72.7127, 73.5548, 70.7567,
        67.7349, 71.2671], device='cuda:0')
Server loss: 5.795435905456543
train global classifier
train glclassifier time: 3.918748661875725
global classifier accuracy: 100.0
end Update
server_global_time: 2813.0121698156
only_train_time: 28343.159661203623

-------------Global Round number: 178-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6544
Averaged Test Accuracy (Prototype Model): 0.6521
Std Test Accuracy (Regular Model): 0.1020
Std Test Accuracy (Prototype Model): 0.1028
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([67.9747, 70.8671, 71.9051, 73.5223, 72.8149, 73.1203, 73.6715, 70.8038,
        67.9747, 71.5161], device='cuda:0')
Server loss: 7.488760471343994
train global classifier
train glclassifier time: 3.872475244104862
global classifier accuracy: 100.0
end Update
server_global_time: 2829.4196116551757
only_train_time: 28508.950124010444

-------------Global Round number: 179-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6545
Averaged Test Accuracy (Prototype Model): 0.6527
Std Test Accuracy (Regular Model): 0.1023
Std Test Accuracy (Prototype Model): 0.1029
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([68.0733, 70.8831, 72.0403, 73.5439, 73.1636, 73.1846, 74.0106, 70.7074,
        68.0733, 71.6615], device='cuda:0')
Server loss: 6.8589768409729
train global classifier
train glclassifier time: 3.8265984058380127
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 2845.7766948640347
only_train_time: 28673.10073006898

-------------Global Round number: 180-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6539
Averaged Test Accuracy (Prototype Model): 0.6525
Std Test Accuracy (Regular Model): 0.1024
Std Test Accuracy (Prototype Model): 0.1030
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([68.1442, 70.8413, 72.3020, 73.7318, 73.1259, 73.1725, 73.9225, 70.9508,
        68.1442, 71.7959], device='cuda:0')
Server loss: 7.748922824859619
train global classifier
train glclassifier time: 3.8622675463557243
global classifier accuracy: 100.0
end Update
server_global_time: 2861.979266218841
only_train_time: 28836.354536391795

-------------Global Round number: 181-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6535
Averaged Test Accuracy (Prototype Model): 0.6523
Std Test Accuracy (Regular Model): 0.1023
Std Test Accuracy (Prototype Model): 0.1031
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([68.3569, 71.2813, 72.4699, 73.8122, 73.4785, 73.4269, 74.2099, 71.3861,
        68.3569, 71.8351], device='cuda:0')
Server loss: 7.494835376739502
train global classifier
train glclassifier time: 3.9240361526608467
global classifier accuracy: 100.0
end Update
server_global_time: 2878.293368473649
only_train_time: 29000.90876672417

-------------Global Round number: 182-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6542
Averaged Test Accuracy (Prototype Model): 0.6525
Std Test Accuracy (Regular Model): 0.1011
Std Test Accuracy (Prototype Model): 0.1025
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([68.4460, 71.3648, 72.4695, 74.2370, 73.6706, 73.3490, 74.3132, 71.5262,
        68.4460, 72.0585], device='cuda:0')
Server loss: 8.473501205444336
train global classifier
train glclassifier time: 3.8380344584584236
global classifier accuracy: 100.0
end Update
server_global_time: 2894.454075835645
only_train_time: 29164.52868385613

-------------Global Round number: 183-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6537
Averaged Test Accuracy (Prototype Model): 0.6523
Std Test Accuracy (Regular Model): 0.1018
Std Test Accuracy (Prototype Model): 0.1032
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([68.5382, 71.5851, 72.4314, 74.4129, 73.8725, 73.6206, 74.6480, 71.5492,
        68.5382, 72.0455], device='cuda:0')
Server loss: 5.419901371002197
train global classifier
train glclassifier time: 3.8226350992918015
global classifier accuracy: 100.0
end Update
server_global_time: 2910.666850231588
only_train_time: 29328.41655830294

-------------Global Round number: 184-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6538
Averaged Test Accuracy (Prototype Model): 0.6520
Std Test Accuracy (Regular Model): 0.1026
Std Test Accuracy (Prototype Model): 0.1039
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([68.7856, 71.8332, 72.8723, 74.6059, 73.7331, 73.9070, 74.7652, 71.8596,
        68.7856, 72.1305], device='cuda:0')
Server loss: 9.711671829223633
train global classifier
train glclassifier time: 4.5046267583966255
global classifier accuracy: 100.0
end Update
server_global_time: 2927.023821949959
only_train_time: 29493.744549416006

-------------Global Round number: 185-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6533
Averaged Test Accuracy (Prototype Model): 0.6517
Std Test Accuracy (Regular Model): 0.1015
Std Test Accuracy (Prototype Model): 0.1018
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([68.9731, 72.0004, 72.6823, 74.9424, 73.9329, 73.9870, 75.0150, 71.9906,
        68.9731, 72.2745], device='cuda:0')
Server loss: 6.4699554443359375
train global classifier
train glclassifier time: 3.815110944211483
global classifier accuracy: 100.0
end Update
server_global_time: 2943.252687625587
only_train_time: 29657.146665237844

-------------Global Round number: 186-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6555
Averaged Test Accuracy (Prototype Model): 0.6532
Std Test Accuracy (Regular Model): 0.1018
Std Test Accuracy (Prototype Model): 0.1025
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([68.8050, 71.9392, 73.1065, 74.5850, 74.0743, 74.1202, 74.9915, 72.0002,
        68.8050, 72.4825], device='cuda:0')
Server loss: 6.578427314758301
train global classifier
train glclassifier time: 3.795180432498455
global classifier accuracy: 100.0
end Update
server_global_time: 2959.5023427158594
only_train_time: 29820.746500514448

-------------Global Round number: 187-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6543
Averaged Test Accuracy (Prototype Model): 0.6521
Std Test Accuracy (Regular Model): 0.1028
Std Test Accuracy (Prototype Model): 0.1030
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([69.1670, 72.0929, 73.3446, 74.9244, 74.2513, 74.3305, 75.1818, 72.2356,
        69.1670, 72.7812], device='cuda:0')
Server loss: 7.3155975341796875
train global classifier
train glclassifier time: 3.8396606519818306
global classifier accuracy: 100.0
end Update
server_global_time: 2975.613049119711
only_train_time: 29983.881635002792

-------------Global Round number: 188-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6554
Averaged Test Accuracy (Prototype Model): 0.6519
Std Test Accuracy (Regular Model): 0.1019
Std Test Accuracy (Prototype Model): 0.1031
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([69.2929, 72.1347, 73.5716, 75.0619, 74.5861, 74.4809, 75.4196, 72.5070,
        69.2929, 72.7698], device='cuda:0')
Server loss: 10.173828125
train global classifier
train glclassifier time: 3.7751268669962883
global classifier accuracy: 100.0
end Update
server_global_time: 2991.9040213003755
only_train_time: 30147.206135749817

-------------Global Round number: 189-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6543
Averaged Test Accuracy (Prototype Model): 0.6522
Std Test Accuracy (Regular Model): 0.1026
Std Test Accuracy (Prototype Model): 0.1025
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([69.4833, 72.5340, 73.6679, 75.3214, 74.5242, 74.6701, 75.6585, 72.5277,
        69.4833, 72.8241], device='cuda:0')
Server loss: 8.498761177062988
train global classifier
train glclassifier time: 3.864893637597561
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 3008.2564714699984
only_train_time: 30310.35740401596

-------------Global Round number: 190-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6547
Averaged Test Accuracy (Prototype Model): 0.6526
Std Test Accuracy (Regular Model): 0.1022
Std Test Accuracy (Prototype Model): 0.1027
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([69.6271, 72.6605, 73.9582, 75.3431, 74.6089, 74.6739, 75.7834, 72.5505,
        69.6271, 73.1439], device='cuda:0')
Server loss: 8.302688598632812
train global classifier
train glclassifier time: 3.7976287826895714
global classifier accuracy: 100.0
end Update
server_global_time: 3024.586928255856
only_train_time: 30475.072800792754

-------------Global Round number: 191-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6534
Averaged Test Accuracy (Prototype Model): 0.6527
Std Test Accuracy (Regular Model): 0.1020
Std Test Accuracy (Prototype Model): 0.1020
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([69.8368, 72.9360, 74.0736, 75.4593, 74.7725, 75.0483, 75.7041, 73.2027,
        69.8368, 73.3777], device='cuda:0')
Server loss: 10.679903030395508
train global classifier
train glclassifier time: 3.886455737054348
global classifier accuracy: 100.0
end Update
server_global_time: 3040.9907938316464
only_train_time: 30638.702312357724

-------------Global Round number: 192-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6543
Averaged Test Accuracy (Prototype Model): 0.6523
Std Test Accuracy (Regular Model): 0.1029
Std Test Accuracy (Prototype Model): 0.1025
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 9, 5, 1, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 9, 5, 1, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([69.8370, 72.9592, 74.2030, 75.7051, 74.9988, 75.2112, 75.8670, 73.2215,
        69.8370, 73.3163], device='cuda:0')
Server loss: 9.048328399658203
train global classifier
train glclassifier time: 4.413946658372879
global classifier accuracy: 100.0
end Update
server_global_time: 3057.3587992191315
only_train_time: 30803.01384357363

-------------Global Round number: 193-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6542
Averaged Test Accuracy (Prototype Model): 0.6527
Std Test Accuracy (Regular Model): 0.1031
Std Test Accuracy (Prototype Model): 0.1031
tobetrained:
[0, 8, 2, 9, 5, 1, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 9 begin training
Edge 5 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([69.8648, 73.2493, 74.3361, 75.9079, 74.7558, 75.1932, 76.0083, 73.3814,
        69.8648, 73.5092], device='cuda:0')
Server loss: 7.273075580596924
train global classifier
train glclassifier time: 4.867864638566971
global classifier accuracy: 100.0
end Update
server_global_time: 3073.7358347103
only_train_time: 30967.974448792636

-------------Global Round number: 194-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6543
Averaged Test Accuracy (Prototype Model): 0.6525
Std Test Accuracy (Regular Model): 0.1026
Std Test Accuracy (Prototype Model): 0.1025
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 7, 3]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([70.1443, 73.3548, 74.7137, 75.9275, 75.0840, 75.4037, 76.4382, 73.3692,
        70.1443, 73.5766], device='cuda:0')
Server loss: 10.598540306091309
train global classifier
train glclassifier time: 3.82964326441288
global classifier accuracy: 100.0
end Update
server_global_time: 3090.0042854472995
only_train_time: 31132.248560145497

-------------Global Round number: 195-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6533
Averaged Test Accuracy (Prototype Model): 0.6511
Std Test Accuracy (Regular Model): 0.1027
Std Test Accuracy (Prototype Model): 0.1033
tobetrained:
[0, 8, 2, 1, 5, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([70.3593, 73.4471, 74.8118, 76.0838, 75.3737, 75.5952, 76.3734, 73.8393,
        70.3593, 73.8789], device='cuda:0')
Server loss: 6.255923748016357
train global classifier
train glclassifier time: 3.9070062190294266
global classifier accuracy: 100.0
end Update
server_global_time: 3106.152603395283
only_train_time: 31296.966121777892

-------------Global Round number: 196-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6536
Averaged Test Accuracy (Prototype Model): 0.6522
Std Test Accuracy (Regular Model): 0.1019
Std Test Accuracy (Prototype Model): 0.1029
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([70.4247, 73.7515, 74.7871, 76.3776, 75.7121, 75.2775, 76.7510, 73.7648,
        70.4247, 73.7904], device='cuda:0')
Server loss: 8.429285049438477
train global classifier
train glclassifier time: 3.8366369903087616
global classifier accuracy: 100.0
end Update
server_global_time: 3122.4389366284013
only_train_time: 31461.428562372923

-------------Global Round number: 197-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6541
Averaged Test Accuracy (Prototype Model): 0.6519
Std Test Accuracy (Regular Model): 0.1024
Std Test Accuracy (Prototype Model): 0.1023
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([70.5715, 73.6907, 74.7813, 76.5319, 75.8819, 75.9742, 76.6598, 74.3202,
        70.5715, 74.0434], device='cuda:0')
Server loss: 7.5141921043396
train global classifier
train glclassifier time: 3.695135273039341
global classifier accuracy: 100.0
end Update
server_global_time: 3138.676158748567
only_train_time: 31625.613251924515

-------------Global Round number: 198-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6532
Averaged Test Accuracy (Prototype Model): 0.6513
Std Test Accuracy (Regular Model): 0.1036
Std Test Accuracy (Prototype Model): 0.1034
tobetrained:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([70.7373, 73.9092, 75.2178, 76.7131, 75.6792, 76.2116, 76.6521, 74.1166,
        70.7373, 74.2833], device='cuda:0')
Server loss: 9.419403076171875
train global classifier
train glclassifier time: 4.275972090661526
global classifier accuracy: 100.0
end Update
server_global_time: 3155.070212587714
only_train_time: 31790.280841760337

-------------Global Round number: 199-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6531
Averaged Test Accuracy (Prototype Model): 0.6517
Std Test Accuracy (Regular Model): 0.1026
Std Test Accuracy (Prototype Model): 0.1028
tobetrained:
[0, 2, 8, 5, 1, 9, 4, 6, 3, 7]
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
aggregation_buffer:
[0, 8, 2, 5, 1, 9, 4, 6, 3, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([70.6871, 73.8717, 75.2297, 76.5995, 75.9065, 76.0922, 77.1665, 74.3902,
        70.6871, 74.3141], device='cuda:0')
Server loss: 7.898496150970459
train global classifier
train glclassifier time: 3.832829497754574
global classifier accuracy: 100.0
Number of samples: 326
end Update
server_global_time: 3171.5242538303137
only_train_time: 31957.632944218814

-------------Global Round number: 200-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6539
Averaged Test Accuracy (Prototype Model): 0.6511
Std Test Accuracy (Regular Model): 0.1021
Std Test Accuracy (Prototype Model): 0.1020

Best accuracy.
0.6555444555444555
File path: ../results/Cifar10_dir_0.3_imbalance_40_FedSAE_test_0.h5
Deleted.

Average time cost: 40294.67s.
Length:  201
std for best accurancy: 0.0
mean for best accurancy: 0.6555444555444555
All done!

Storage on cpu
-------------------------------------------------------------------------------
Total Tensors: 5130 	Used Memory: 20.50K
-------------------------------------------------------------------------------

Storage on cuda:0
-------------------------------------------------------------------------------
Total Tensors: 172064 	Used Memory: 6.44M
The allocated memory on cuda:0: 6.44M
-------------------------------------------------------------------------------
