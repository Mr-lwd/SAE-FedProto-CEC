
cuda is not avaiable.

==================================================
goal = test
device = cpu
device_id = 0
dataset = FashionMNIST_dir_0.3_imbalance_20
num_classes = 10
model_family = HCNNs8
batch_size = 256
local_learning_rate = 0.05
learning_rate_decay = False
learning_rate_decay_gamma = 0.99
global_rounds = 80
local_epochs = 3
algorithm = FedProto
join_ratio = 1.0
random_join_ratio = False
num_clients = 20
prev = 0
times = 1
eval_gap = 1
save_folder_name = temp
auto_break = False
feature_dim = 512
vocab_size = 98635
max_len = 200
client_drop_rate = 0.0
train_slow_rate = 0.0
send_slow_rate = 0.0
time_select = False
time_threthold = 10000
lamda = 1
agg_by_dataset_dis = False
trans_delay_simulate = False
semi_local_train_lamma = 3
async_buffer_length = 1
FedASync_alpha = 0.9
use_tau_zero = False
tau_zero = 9
agg_type = 0
cs_strategy = 0
balanceproto = 0
use_focalLoss = 0
each_epoch_update_proto = 0
glclassifier = 0
test_useglclassifier = 0
gamma = 0
rep_reloss = 0
drawtsne = True
use_smooth = 0
contrastive_loss_fn = 0
entropy_alpha = 0.1
noise_dim = 512
generator_learning_rate = 0.005
hidden_dim = 512
server_epochs = 100
alpha = 1.0
beta = 1.0
mentee_learning_rate = 0.005
T_start = 0.95
T_end = 0.98
server_learning_rate = 0.01
margin_threthold = 100.0
generator_path = stylegan/stylegan-xl-models/imagenet64.pkl
stable_diffusion_prompt = a cat
server_batch_size = 100
gen_batch_size = 4
mu = 50.0
==================================================
Random seed set as 42

============= Running time: 0th =============
Creating server and clients ...
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 0
self.label_counts defaultdict(<class 'int'>, {9: 1677, 7: 481, 0: 359, 6: 42, 2: 44, 1: 26, 5: 7, 8: 62, 4: 110})
entropy 1.270432932536052
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 1
self.label_counts defaultdict(<class 'int'>, {8: 1498, 6: 899, 9: 318, 5: 32, 7: 15, 3: 5, 1: 5, 0: 13, 2: 1})
entropy 1.076348412710483
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 2
self.label_counts defaultdict(<class 'int'>, {7: 417, 5: 538, 4: 3, 6: 556, 9: 42, 8: 148, 0: 340, 1: 6, 2: 7})
entropy 1.6401410570532078
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 3
self.label_counts defaultdict(<class 'int'>, {0: 820, 2: 92, 7: 61, 6: 59, 3: 52, 5: 30, 8: 23, 9: 5, 1: 4, 4: 1})
entropy 1.114494086794196
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 4
self.label_counts defaultdict(<class 'int'>, {9: 1352, 8: 1038, 0: 325, 2: 577, 6: 146, 3: 69, 7: 9, 4: 4, 1: 9, 5: 5})
entropy 1.4986770144834285
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 5
self.label_counts defaultdict(<class 'int'>, {9: 594, 0: 111, 6: 140, 5: 32, 8: 51, 3: 35, 1: 2, 2: 7})
entropy 1.262827398156374
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 6
self.label_counts defaultdict(<class 'int'>, {6: 707, 2: 152, 7: 17, 0: 87, 9: 48, 1: 5, 4: 8, 5: 1, 8: 1})
entropy 1.0372461021940647
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 7
self.label_counts defaultdict(<class 'int'>, {2: 1135, 5: 1568, 1: 185, 0: 96, 3: 355, 4: 18})
entropy 1.2492021079696578
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 8
self.label_counts defaultdict(<class 'int'>, {0: 695, 1: 842, 2: 783, 4: 514, 3: 3})
entropy 1.3771584091020033
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 9
self.label_counts defaultdict(<class 'int'>, {1: 439, 8: 2154, 7: 5, 2: 8, 4: 13, 0: 153, 6: 8, 3: 15})
entropy 0.7484095985671576
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 10
self.label_counts defaultdict(<class 'int'>, {5: 798, 1: 390, 3: 64, 6: 763, 7: 334, 0: 436, 4: 83, 2: 40})
entropy 1.7528658377612782
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 11
self.label_counts defaultdict(<class 'int'>, {4: 3521, 1: 2081, 3: 2, 2: 25, 0: 15})
entropy 0.7048218903168841
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 12
self.label_counts defaultdict(<class 'int'>, {0: 745, 7: 839, 5: 234, 2: 157, 3: 218, 9: 337, 6: 24, 8: 3, 4: 1})
entropy 1.6466569954838752
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 13
self.label_counts defaultdict(<class 'int'>, {5: 209, 0: 111, 4: 231, 6: 43, 2: 811, 1: 451, 7: 71, 8: 35, 3: 23})
entropy 1.6759904200717124
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 14
self.label_counts defaultdict(<class 'int'>, {2: 472, 5: 1631, 0: 398, 4: 58, 1: 361, 3: 2})
entropy 1.2326238379966665
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 15
self.label_counts defaultdict(<class 'int'>, {3: 2449, 2: 318, 0: 50, 1: 9})
entropy 0.4595966978278456
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 16
self.label_counts defaultdict(<class 'int'>, {7: 1457, 4: 215, 3: 986, 1: 5, 6: 792, 0: 1})
entropy 1.2441875679473098
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 17
self.label_counts defaultdict(<class 'int'>, {7: 1355, 6: 368, 2: 612, 1: 272, 3: 555, 4: 100, 0: 329, 5: 43})
entropy 1.749594163507263
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 18
self.label_counts defaultdict(<class 'int'>, {9: 856, 4: 341, 5: 150, 8: 135, 0: 46, 6: 146, 1: 47, 7: 105, 3: 80, 2: 9})
entropy 1.747495484925764
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 19
self.label_counts defaultdict(<class 'int'>, {8: 104, 3: 296, 6: 586, 7: 123, 1: 93, 2: 17, 0: 74, 4: 27, 9: 6})
entropy 1.6228313161452321

Join ratio / total clients: 1.0 / 20
Finished creating server and clients.
client.id trained 0
Server global_protos Not Found
Client_0 protos Not Found
local_model_loss tensor(0.3973, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
Server global_protos Not Found
Client_17 protos Not Found
local_model_loss tensor(0.9011, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
Server global_protos Not Found
Client_15 protos Not Found
local_model_loss tensor(0.4215, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
Server global_protos Not Found
Client_1 protos Not Found
local_model_loss tensor(0.6056, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
Server global_protos Not Found
Client_8 protos Not Found
local_model_loss tensor(0.5379, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
Server global_protos Not Found
Client_5 protos Not Found
local_model_loss tensor(1.2303, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
Server global_protos Not Found
Client_11 protos Not Found
local_model_loss tensor(0.1612, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
Server global_protos Not Found
Client_3 protos Not Found
local_model_loss tensor(1.1795, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
Server global_protos Not Found
Client_18 protos Not Found
local_model_loss tensor(1.0140, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
Server global_protos Not Found
Client_16 protos Not Found
local_model_loss tensor(0.3069, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
Server global_protos Not Found
Client_13 protos Not Found
local_model_loss tensor(1.5702, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
Server global_protos Not Found
Client_2 protos Not Found
local_model_loss tensor(1.1593, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
Server global_protos Not Found
Client_9 protos Not Found
local_model_loss tensor(0.2888, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
Server global_protos Not Found
Client_19 protos Not Found
local_model_loss tensor(1.7320, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
Server global_protos Not Found
Client_4 protos Not Found
local_model_loss tensor(0.4384, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
Server global_protos Not Found
Client_12 protos Not Found
local_model_loss tensor(0.8239, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
Server global_protos Not Found
Client_7 protos Not Found
local_model_loss tensor(1.0794, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
Server global_protos Not Found
Client_10 protos Not Found
local_model_loss tensor(0.8835, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
Server global_protos Not Found
Client_14 protos Not Found
local_model_loss tensor(0.7495, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
Server global_protos Not Found
Client_6 protos Not Found
local_model_loss tensor(1.0677, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 6.6935305499937385
only_train_time: 60.96851082867943
all_clients_time_cost: 60.96851082867943
agg_protos_label dict_keys([9, 7, 0, 6, 2, 1, 5, 8, 4, 3])
Number of samples: 167
-------------------------------------------------- 63.70828914642334

-------------Round number: 0-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 131, 1: 0, 2: 0, 3: 0, 4: 32, 5: 0, 6: 0, 7: 91, 8: 2, 9: 576}
Prototype-Based Model Correct Classifications (per class):
{0: 96, 1: 8, 2: 0, 3: 0, 4: 38, 5: 0, 6: 0, 7: 116, 8: 0, 9: 516}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 265, 7: 0, 8: 445, 9: 105}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 1, 6: 46, 7: 12, 8: 223, 9: 12}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 131, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 4, 7: 82, 8: 43, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 181, 6: 145, 7: 18, 8: 13, 9: 0}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 265, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 45, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 1, 9: 0}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 78, 1: 0, 2: 181, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 329, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 2, 1: 0, 2: 0, 3: 21, 4: 0, 5: 0, 6: 0, 7: 0, 8: 9, 9: 480}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 182}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 1, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 13, 9: 0}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 236, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 51, 3: 0, 4: 2, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 501, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 274, 3: 2, 4: 0, 5: 501, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 220, 1: 273, 2: 181, 3: 0, 4: 139, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 159, 1: 287, 2: 0, 3: 0, 4: 159, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 3, 1: 138, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 127, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 5, 8: 149, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 112, 1: 137, 2: 0, 3: 0, 4: 0, 5: 124, 6: 170, 7: 108, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 9, 1: 135, 2: 0, 3: 0, 4: 0, 5: 134, 6: 159, 7: 104, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 711, 2: 0, 3: 0, 4: 1059, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 676, 2: 2, 3: 0, 4: 906, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 244, 1: 0, 2: 7, 3: 4, 4: 0, 5: 53, 6: 0, 7: 211, 8: 0, 9: 95}
Prototype-Based Model Correct Classifications (per class):
{0: 1, 1: 0, 2: 1, 3: 72, 4: 0, 5: 29, 6: 4, 7: 111, 8: 0, 9: 104}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 0, 1: 142, 2: 245, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 173, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 4, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 126, 1: 83, 2: 78, 3: 0, 4: 0, 5: 529, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 83, 3: 0, 4: 5, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 78, 3: 759, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 350, 4: 23, 5: 0, 6: 193, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 34, 4: 57, 5: 0, 6: 1, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 157, 3: 195, 4: 0, 5: 0, 6: 0, 7: 442, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 68, 2: 38, 3: 72, 4: 0, 5: 2, 6: 0, 7: 441, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 117, 5: 33, 6: 0, 7: 0, 8: 2, 9: 273}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 18, 5: 55, 6: 38, 7: 0, 8: 1, 9: 227}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 200, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 6, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.8879
Client 1: Regular Model Acc: 0.8773
Client 2: Regular Model Acc: 0.3790
Client 3: Regular Model Acc: 0.6919
Client 4: Regular Model Acc: 0.9042
Client 5: Regular Model Acc: 0.5617
Client 6: Regular Model Acc: 0.6880
Client 7: Regular Model Acc: 0.4477
Client 8: Regular Model Acc: 0.8594
Client 9: Regular Model Acc: 0.9099
Client 10: Regular Model Acc: 0.6711
Client 11: Regular Model Acc: 0.9405
Client 12: Regular Model Acc: 0.7198
Client 13: Regular Model Acc: 0.5846
Client 14: Regular Model Acc: 0.8378
Client 15: Regular Model Acc: 0.8769
Client 16: Regular Model Acc: 0.8916
Client 17: Regular Model Acc: 0.6568
Client 18: Regular Model Acc: 0.6651
Client 19: Regular Model Acc: 0.4525
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.8260
Client 1: Prototype Model Acc: 0.3175
Client 2: Prototype Model Acc: 0.5204
Client 3: Prototype Model Acc: 0.1201
Client 4: Prototype Model Acc: 0.4343
Client 5: Prototype Model Acc: 0.0432
Client 6: Prototype Model Acc: 0.1545
Client 7: Prototype Model Acc: 0.6944
Client 8: Prototype Model Acc: 0.6395
Client 9: Prototype Model Acc: 0.3015
Client 10: Prototype Model Acc: 0.5577
Client 11: Prototype Model Acc: 0.8417
Client 12: Prototype Model Acc: 0.3775
Client 13: Prototype Model Acc: 0.2674
Client 14: Prototype Model Acc: 0.6345
Client 15: Prototype Model Acc: 0.8885
Client 16: Prototype Model Acc: 0.4822
Client 17: Prototype Model Acc: 0.5124
Client 18: Prototype Model Acc: 0.5305
Client 19: Prototype Model Acc: 0.0136
Averaged Test Accuracy (Regular Model): 0.7615
Averaged Test Accuracy (Prototype Model): 0.5321
Std Test Accuracy (Regular Model): 0.1695
Std Test Accuracy (Prototype Model): 0.2524
client.id trained 19
local_model_loss tensor(1.4804, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.2713, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.3651, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.9519, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.3375, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.5138, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.3056, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.5922, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(1.0562, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.9322, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.6565, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.2232, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(1.0615, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.6011, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.7416, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.3564, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.6355, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.1223, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.3326, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.2937, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 14.117793017998338
only_train_time: 124.75726216263138
all_clients_time_cost: 124.75726216263138
agg_protos_label dict_keys([8, 3, 6, 7, 1, 2, 0, 4, 9, 5])
-------------------------------------------------- 65.2636399269104

-------------Round number: 1-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 131, 1: 0, 2: 0, 3: 0, 4: 36, 5: 0, 6: 0, 7: 90, 8: 7, 9: 578}
Prototype-Based Model Correct Classifications (per class):
{0: 125, 1: 8, 2: 0, 3: 0, 4: 40, 5: 0, 6: 0, 7: 108, 8: 11, 9: 556}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 264, 7: 0, 8: 468, 9: 109}
Prototype-Based Model Correct Classifications (per class):
{0: 1, 1: 1, 2: 0, 3: 1, 4: 0, 5: 5, 6: 196, 7: 8, 8: 462, 9: 95}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 127, 1: 0, 2: 0, 3: 0, 4: 0, 5: 166, 6: 65, 7: 115, 8: 44, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 119, 1: 0, 2: 0, 3: 0, 4: 0, 5: 144, 6: 106, 7: 133, 8: 37, 9: 0}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 265, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 3, 3: 8, 4: 0, 5: 0, 6: 0, 7: 0, 8: 4, 9: 0}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 80, 1: 0, 2: 181, 3: 2, 4: 0, 5: 0, 6: 0, 7: 0, 8: 330, 9: 479}
Prototype-Based Model Correct Classifications (per class):
{0: 64, 1: 0, 2: 4, 3: 19, 4: 1, 5: 0, 6: 6, 7: 0, 8: 319, 9: 479}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 1, 7: 0, 8: 0, 9: 182}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 21, 9: 162}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 236, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 39, 3: 0, 4: 1, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 359, 3: 107, 4: 0, 5: 491, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 358, 3: 94, 4: 0, 5: 302, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 221, 1: 280, 2: 189, 3: 0, 4: 148, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 225, 1: 281, 2: 13, 3: 0, 4: 168, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 36, 1: 136, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 137, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 704, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 118, 1: 131, 2: 0, 3: 0, 4: 0, 5: 200, 6: 213, 7: 96, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 106, 1: 134, 2: 0, 3: 0, 4: 5, 5: 172, 6: 204, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1101, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 559, 2: 7, 3: 0, 4: 31, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 243, 1: 0, 2: 37, 3: 40, 4: 0, 5: 54, 6: 0, 7: 238, 8: 0, 9: 88}
Prototype-Based Model Correct Classifications (per class):
{0: 182, 1: 0, 2: 4, 3: 69, 4: 0, 5: 37, 6: 2, 7: 204, 8: 0, 9: 101}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 0, 1: 141, 2: 241, 3: 0, 4: 2, 5: 79, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 111, 2: 239, 3: 4, 4: 0, 5: 48, 6: 0, 7: 0, 8: 3, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 137, 1: 116, 2: 124, 3: 0, 4: 0, 5: 529, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 118, 2: 62, 3: 0, 4: 12, 5: 529, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 87, 3: 770, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 348, 4: 27, 5: 0, 6: 214, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 34, 4: 59, 5: 0, 6: 76, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 73, 1: 62, 2: 196, 3: 183, 4: 0, 5: 0, 6: 2, 7: 442, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 18, 1: 71, 2: 162, 3: 49, 4: 0, 5: 6, 6: 4, 7: 441, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 7, 4: 118, 5: 36, 6: 5, 7: 24, 8: 36, 9: 272}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 12, 2: 0, 3: 0, 4: 24, 5: 34, 6: 38, 7: 37, 8: 23, 9: 261}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 200, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 2, 3: 98, 4: 0, 5: 0, 6: 0, 7: 0, 8: 8, 9: 0}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.8986
Client 1: Regular Model Acc: 0.9053
Client 2: Regular Model Acc: 0.7536
Client 3: Regular Model Acc: 0.6919
Client 4: Regular Model Acc: 0.9092
Client 5: Regular Model Acc: 0.5648
Client 6: Regular Model Acc: 0.6880
Client 7: Regular Model Acc: 0.8552
Client 8: Regular Model Acc: 0.8858
Client 9: Regular Model Acc: 0.9431
Client 10: Regular Model Acc: 0.7814
Client 11: Regular Model Acc: 0.9644
Client 12: Regular Model Acc: 0.8206
Client 13: Regular Model Acc: 0.6994
Client 14: Regular Model Acc: 0.9302
Client 15: Regular Model Acc: 0.8769
Client 16: Regular Model Acc: 0.9115
Client 17: Regular Model Acc: 0.7904
Client 18: Regular Model Acc: 0.7793
Client 19: Regular Model Acc: 0.4525
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9050
Client 1: Prototype Model Acc: 0.8278
Client 2: Prototype Model Acc: 0.7857
Client 3: Prototype Model Acc: 0.0392
Client 4: Prototype Model Acc: 0.7566
Client 5: Prototype Model Acc: 0.5648
Client 6: Prototype Model Acc: 0.1166
Client 7: Prototype Model Acc: 0.6738
Client 8: Prototype Model Acc: 0.7262
Client 9: Prototype Model Acc: 0.9024
Client 10: Prototype Model Acc: 0.7464
Client 11: Prototype Model Acc: 0.3172
Client 12: Prototype Model Acc: 0.7022
Client 13: Prototype Model Acc: 0.6118
Client 14: Prototype Model Acc: 0.7485
Client 15: Prototype Model Acc: 0.9098
Client 16: Prototype Model Acc: 0.5490
Client 17: Prototype Model Acc: 0.6196
Client 18: Prototype Model Acc: 0.6714
Client 19: Prototype Model Acc: 0.2443
Averaged Test Accuracy (Regular Model): 0.8457
Averaged Test Accuracy (Prototype Model): 0.6512
Std Test Accuracy (Regular Model): 0.1302
Std Test Accuracy (Prototype Model): 0.2472
client.id trained 10
local_model_loss tensor(0.5244, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.7691, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.2853, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.5382, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.7349, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.6042, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.2407, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.4193, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.2952, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.2077, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.2632, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.1904, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.2529, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.8692, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.1040, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(1.2305, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.9314, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.5533, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.8562, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.2986, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 22.186455918010324
only_train_time: 188.65629878768232
all_clients_time_cost: 188.65629878768232
agg_protos_label dict_keys([5, 1, 3, 6, 7, 0, 4, 2, 9, 8])
-------------------------------------------------- 65.5196304321289

-------------Round number: 2-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 132, 1: 6, 2: 0, 3: 0, 4: 39, 5: 0, 6: 0, 7: 102, 8: 14, 9: 573}
Prototype-Based Model Correct Classifications (per class):
{0: 125, 1: 8, 2: 1, 3: 0, 4: 40, 5: 0, 6: 0, 7: 112, 8: 13, 9: 553}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 266, 7: 0, 8: 469, 9: 111}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 6, 6: 257, 7: 8, 8: 464, 9: 102}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 126, 1: 0, 2: 0, 3: 0, 4: 0, 5: 164, 6: 92, 7: 125, 8: 45, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 121, 1: 0, 2: 0, 3: 0, 4: 0, 5: 145, 6: 107, 7: 133, 8: 43, 9: 2}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 265, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 26, 3: 16, 4: 0, 5: 0, 6: 0, 7: 0, 8: 4, 9: 0}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 82, 1: 0, 2: 181, 3: 11, 4: 0, 5: 0, 6: 0, 7: 0, 8: 330, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 68, 1: 0, 2: 4, 3: 21, 4: 1, 5: 0, 6: 4, 7: 0, 8: 319, 9: 479}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 17, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 55, 7: 0, 8: 0, 9: 182}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 4, 6: 0, 7: 0, 8: 18, 9: 178}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 236, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 45, 3: 0, 4: 1, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 330, 3: 100, 4: 0, 5: 499, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 362, 3: 107, 4: 0, 5: 480, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 221, 1: 283, 2: 112, 3: 0, 4: 170, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 223, 1: 281, 2: 6, 3: 0, 4: 170, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 43, 1: 136, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 139, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 706, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 117, 1: 130, 2: 0, 3: 0, 4: 0, 5: 223, 6: 218, 7: 94, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 119, 1: 132, 2: 0, 3: 0, 4: 12, 5: 198, 6: 183, 7: 102, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 715, 2: 0, 3: 0, 4: 1088, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 518, 2: 7, 3: 0, 4: 44, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 240, 1: 0, 2: 47, 3: 50, 4: 0, 5: 57, 6: 0, 7: 228, 8: 0, 9: 91}
Prototype-Based Model Correct Classifications (per class):
{0: 217, 1: 0, 2: 4, 3: 65, 4: 0, 5: 45, 6: 1, 7: 198, 8: 0, 9: 102}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 0, 1: 141, 2: 242, 3: 0, 4: 12, 5: 83, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 129, 2: 239, 3: 2, 4: 0, 5: 75, 6: 0, 7: 0, 8: 10, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 141, 1: 117, 2: 134, 3: 0, 4: 0, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 123, 1: 118, 2: 102, 3: 0, 4: 5, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 80, 3: 816, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 95, 3: 788, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 350, 4: 31, 5: 0, 6: 219, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 60, 4: 55, 5: 0, 6: 86, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 77, 1: 64, 2: 196, 3: 184, 4: 0, 5: 0, 6: 3, 7: 442, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 68, 1: 72, 2: 175, 3: 115, 4: 0, 5: 7, 6: 6, 7: 439, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 8, 4: 120, 5: 38, 6: 12, 7: 26, 8: 41, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 6, 1: 13, 2: 0, 3: 0, 4: 1, 5: 35, 6: 38, 7: 35, 8: 32, 9: 263}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 76, 4: 0, 5: 0, 6: 185, 7: 43, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 25, 2: 2, 3: 49, 4: 0, 5: 0, 6: 0, 7: 0, 8: 13, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9242
Client 1: Regular Model Acc: 0.9107
Client 2: Regular Model Acc: 0.8047
Client 3: Regular Model Acc: 0.6919
Client 4: Regular Model Acc: 0.9177
Client 5: Regular Model Acc: 0.7840
Client 6: Regular Model Acc: 0.6880
Client 7: Regular Model Acc: 0.8302
Client 8: Regular Model Acc: 0.8309
Client 9: Regular Model Acc: 0.9506
Client 10: Regular Model Acc: 0.8062
Client 11: Regular Model Acc: 0.9580
Client 12: Regular Model Acc: 0.8359
Client 13: Regular Model Acc: 0.7221
Client 14: Regular Model Acc: 0.9466
Client 15: Regular Model Acc: 0.9512
Client 16: Regular Model Acc: 0.9211
Client 17: Regular Model Acc: 0.7970
Client 18: Regular Model Acc: 0.8075
Client 19: Regular Model Acc: 0.6878
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9093
Client 1: Prototype Model Acc: 0.9010
Client 2: Prototype Model Acc: 0.8032
Client 3: Prototype Model Acc: 0.1201
Client 4: Prototype Model Acc: 0.7600
Client 5: Prototype Model Acc: 0.6173
Client 6: Prototype Model Acc: 0.1341
Client 7: Prototype Model Acc: 0.8481
Client 8: Prototype Model Acc: 0.7188
Client 9: Prototype Model Acc: 0.9067
Client 10: Prototype Model Acc: 0.7691
Client 11: Prototype Model Acc: 0.3023
Client 12: Prototype Model Acc: 0.7409
Client 13: Prototype Model Acc: 0.6873
Client 14: Prototype Model Acc: 0.9014
Client 15: Prototype Model Acc: 0.9374
Client 16: Prototype Model Acc: 0.5768
Client 17: Prototype Model Acc: 0.7277
Client 18: Prototype Model Acc: 0.6620
Client 19: Prototype Model Acc: 0.2059
Averaged Test Accuracy (Regular Model): 0.8650
Averaged Test Accuracy (Prototype Model): 0.6926
Std Test Accuracy (Regular Model): 0.0909
Std Test Accuracy (Prototype Model): 0.2569
client.id trained 0
local_model_loss tensor(0.2561, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.5229, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.7905, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.2926, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.5099, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0913, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.2717, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.1703, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.3710, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.4821, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.6283, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.8952, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.2083, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.2825, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.2289, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.8233, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.2187, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.7690, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.4532, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.1742, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 29.720688114059158
only_train_time: 255.23814698681235
all_clients_time_cost: 255.23814698681235
agg_protos_label dict_keys([9, 7, 0, 6, 2, 1, 5, 8, 4, 3])
-------------------------------------------------- 68.22427487373352

-------------Round number: 3-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 129, 1: 8, 2: 2, 3: 0, 4: 40, 5: 0, 6: 0, 7: 95, 8: 16, 9: 578}
Prototype-Based Model Correct Classifications (per class):
{0: 124, 1: 8, 2: 0, 3: 0, 4: 40, 5: 0, 6: 0, 7: 109, 8: 15, 9: 562}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 267, 7: 0, 8: 471, 9: 111}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 6, 6: 262, 7: 5, 8: 464, 9: 104}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 127, 1: 0, 2: 0, 3: 0, 4: 0, 5: 179, 6: 96, 7: 106, 8: 44, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 118, 1: 0, 2: 0, 3: 0, 4: 0, 5: 165, 6: 106, 7: 127, 8: 44, 9: 4}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 265, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 7, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 16, 3: 16, 4: 0, 5: 0, 6: 0, 7: 0, 8: 5, 9: 0}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 82, 1: 0, 2: 182, 3: 13, 4: 0, 5: 0, 6: 1, 7: 0, 8: 330, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 69, 1: 0, 2: 5, 3: 21, 4: 1, 5: 0, 6: 4, 7: 0, 8: 318, 9: 479}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 25, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 51, 7: 0, 8: 0, 9: 182}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 4, 6: 0, 7: 0, 8: 18, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 236, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 52, 3: 0, 4: 1, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 0, 1: 56, 2: 356, 3: 104, 4: 0, 5: 501, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 361, 3: 119, 4: 0, 5: 497, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 222, 1: 284, 2: 136, 3: 0, 4: 167, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 223, 1: 281, 2: 33, 3: 0, 4: 169, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 50, 1: 135, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 139, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 706, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 114, 1: 130, 2: 0, 3: 0, 4: 0, 5: 227, 6: 220, 7: 98, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 120, 1: 131, 2: 0, 3: 1, 4: 12, 5: 213, 6: 186, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 715, 2: 0, 3: 0, 4: 1086, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 598, 2: 6, 3: 0, 4: 117, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 239, 1: 0, 2: 49, 3: 55, 4: 0, 5: 60, 6: 0, 7: 228, 8: 0, 9: 92}
Prototype-Based Model Correct Classifications (per class):
{0: 218, 1: 0, 2: 5, 3: 64, 4: 0, 5: 55, 6: 0, 7: 199, 8: 0, 9: 102}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 8, 1: 140, 2: 239, 3: 0, 4: 22, 5: 83, 6: 0, 7: 2, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 131, 2: 241, 3: 3, 4: 0, 5: 82, 6: 0, 7: 0, 8: 13, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 144, 1: 117, 2: 134, 3: 0, 4: 0, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 133, 1: 118, 2: 135, 3: 0, 4: 2, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 85, 3: 814, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 96, 3: 784, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 348, 4: 33, 5: 0, 6: 224, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 214, 4: 54, 5: 0, 6: 102, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 84, 1: 64, 2: 196, 3: 184, 4: 0, 5: 0, 6: 4, 7: 442, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 84, 1: 72, 2: 183, 3: 164, 4: 0, 5: 8, 6: 4, 7: 438, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 0, 1: 3, 2: 0, 3: 8, 4: 120, 5: 40, 6: 15, 7: 28, 8: 41, 9: 269}
Prototype-Based Model Correct Classifications (per class):
{0: 9, 1: 13, 2: 0, 3: 0, 4: 1, 5: 39, 6: 38, 7: 36, 8: 35, 9: 262}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 91, 4: 0, 5: 0, 6: 171, 7: 43, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 1, 1: 25, 2: 3, 3: 31, 4: 2, 5: 0, 6: 0, 7: 0, 8: 10, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9264
Client 1: Regular Model Acc: 0.9139
Client 2: Regular Model Acc: 0.8061
Client 3: Regular Model Acc: 0.7102
Client 4: Regular Model Acc: 0.9211
Client 5: Regular Model Acc: 0.7963
Client 6: Regular Model Acc: 0.6880
Client 7: Regular Model Acc: 0.9088
Client 8: Regular Model Acc: 0.8552
Client 9: Regular Model Acc: 0.9571
Client 10: Regular Model Acc: 0.8134
Client 11: Regular Model Acc: 0.9570
Client 12: Regular Model Acc: 0.8476
Client 13: Regular Model Acc: 0.7462
Client 14: Regular Model Acc: 0.9497
Client 15: Regular Model Acc: 0.9544
Client 16: Regular Model Acc: 0.9254
Client 17: Regular Model Acc: 0.8036
Client 18: Regular Model Acc: 0.8200
Client 19: Regular Model Acc: 0.6900
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9157
Client 1: Prototype Model Acc: 0.9053
Client 2: Prototype Model Acc: 0.8222
Client 3: Prototype Model Acc: 0.0966
Client 4: Prototype Model Acc: 0.7608
Client 5: Prototype Model Acc: 0.6204
Client 6: Prototype Model Acc: 0.1545
Client 7: Prototype Model Acc: 0.8731
Client 8: Prototype Model Acc: 0.7463
Client 9: Prototype Model Acc: 0.9152
Client 10: Prototype Model Acc: 0.7897
Client 11: Prototype Model Acc: 0.3831
Client 12: Prototype Model Acc: 0.7538
Client 13: Prototype Model Acc: 0.7100
Client 14: Prototype Model Acc: 0.9425
Client 15: Prototype Model Acc: 0.9342
Client 16: Prototype Model Acc: 0.7233
Client 17: Prototype Model Acc: 0.7863
Client 18: Prototype Model Acc: 0.6776
Client 19: Prototype Model Acc: 0.1674
Averaged Test Accuracy (Regular Model): 0.8763
Averaged Test Accuracy (Prototype Model): 0.7242
Std Test Accuracy (Regular Model): 0.0892
Std Test Accuracy (Prototype Model): 0.2613
client.id trained 5
local_model_loss tensor(0.5659, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.4462, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.4460, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.7810, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.2334, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.3340, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.1561, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.2017, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.2121, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.2553, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.4798, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.2653, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0788, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.7349, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.4716, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.2345, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.1555, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.1867, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.6936, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.7438, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 37.583010366070084
only_train_time: 321.76557744911406
all_clients_time_cost: 321.76557744911406
agg_protos_label dict_keys([9, 0, 6, 5, 8, 3, 1, 2, 7, 4])
Number of samples: 167
-------------------------------------------------- 69.27556872367859

-------------Round number: 4-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 130, 1: 8, 2: 4, 3: 0, 4: 40, 5: 0, 6: 0, 7: 99, 8: 16, 9: 577}
Prototype-Based Model Correct Classifications (per class):
{0: 125, 1: 8, 2: 0, 3: 0, 4: 40, 5: 0, 6: 0, 7: 112, 8: 15, 9: 563}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 267, 7: 0, 8: 473, 9: 111}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 6, 6: 263, 7: 5, 8: 463, 9: 103}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 125, 1: 0, 2: 0, 3: 0, 4: 0, 5: 161, 6: 102, 7: 130, 8: 46, 9: 6}
Prototype-Based Model Correct Classifications (per class):
{0: 122, 1: 0, 2: 0, 3: 0, 4: 0, 5: 153, 6: 110, 7: 133, 8: 46, 9: 6}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 265, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 13, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 1, 1: 0, 2: 21, 3: 16, 4: 0, 5: 0, 6: 1, 7: 7, 8: 4, 9: 0}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 82, 1: 0, 2: 183, 3: 14, 4: 0, 5: 0, 6: 1, 7: 0, 8: 331, 9: 477}
Prototype-Based Model Correct Classifications (per class):
{0: 70, 1: 0, 2: 6, 3: 21, 4: 1, 5: 0, 6: 4, 7: 0, 8: 318, 9: 479}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 27, 1: 0, 2: 0, 3: 0, 4: 0, 5: 1, 6: 49, 7: 0, 8: 6, 9: 182}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 9, 4: 0, 5: 4, 6: 8, 7: 0, 8: 18, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 236, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 48, 3: 0, 4: 1, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 0, 1: 63, 2: 359, 3: 105, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 360, 3: 119, 4: 0, 5: 499, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 223, 1: 284, 2: 174, 3: 0, 4: 166, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 225, 1: 282, 2: 60, 3: 0, 4: 169, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 54, 1: 138, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 31, 1: 138, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 706, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 114, 1: 129, 2: 0, 3: 4, 4: 0, 5: 233, 6: 221, 7: 102, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 125, 1: 131, 2: 0, 3: 1, 4: 11, 5: 221, 6: 190, 7: 104, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 715, 2: 0, 3: 0, 4: 1125, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 641, 2: 5, 3: 0, 4: 547, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 239, 1: 0, 2: 49, 3: 58, 4: 0, 5: 61, 6: 0, 7: 232, 8: 0, 9: 93}
Prototype-Based Model Correct Classifications (per class):
{0: 218, 1: 0, 2: 5, 3: 64, 4: 0, 5: 56, 6: 0, 7: 197, 8: 0, 9: 102}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 18, 1: 139, 2: 233, 3: 0, 4: 31, 5: 82, 6: 0, 7: 11, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 131, 2: 245, 3: 3, 4: 0, 5: 82, 6: 0, 7: 0, 8: 13, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 144, 1: 117, 2: 135, 3: 0, 4: 0, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 136, 1: 118, 2: 136, 3: 0, 4: 0, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 85, 3: 815, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 95, 3: 792, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 347, 4: 36, 5: 0, 6: 226, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 330, 4: 56, 5: 0, 6: 119, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 86, 1: 65, 2: 195, 3: 185, 4: 0, 5: 1, 6: 5, 7: 442, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 88, 1: 71, 2: 189, 3: 176, 4: 0, 5: 9, 6: 2, 7: 437, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 0, 1: 10, 2: 0, 3: 8, 4: 119, 5: 41, 6: 14, 7: 28, 8: 43, 9: 270}
Prototype-Based Model Correct Classifications (per class):
{0: 9, 1: 13, 2: 0, 3: 0, 4: 2, 5: 40, 6: 37, 7: 36, 8: 39, 9: 260}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 0, 1: 16, 2: 0, 3: 90, 4: 0, 5: 0, 6: 177, 7: 43, 8: 12, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 7, 1: 25, 2: 2, 3: 30, 4: 6, 5: 0, 6: 1, 7: 1, 8: 10, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9328
Client 1: Regular Model Acc: 0.9160
Client 2: Regular Model Acc: 0.8309
Client 3: Regular Model Acc: 0.7258
Client 4: Regular Model Acc: 0.9228
Client 5: Regular Model Acc: 0.8179
Client 6: Regular Model Acc: 0.6880
Client 7: Regular Model Acc: 0.9178
Client 8: Regular Model Acc: 0.8953
Client 9: Regular Model Acc: 0.9646
Client 10: Regular Model Acc: 0.8278
Client 11: Regular Model Acc: 0.9777
Client 12: Regular Model Acc: 0.8581
Client 13: Regular Model Acc: 0.7764
Client 14: Regular Model Acc: 0.9507
Client 15: Regular Model Acc: 0.9554
Client 16: Regular Model Acc: 0.9289
Client 17: Regular Model Acc: 0.8078
Client 18: Regular Model Acc: 0.8341
Client 19: Regular Model Acc: 0.7647
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9210
Client 1: Prototype Model Acc: 0.9042
Client 2: Prototype Model Acc: 0.8309
Client 3: Prototype Model Acc: 0.1305
Client 4: Prototype Model Acc: 0.7625
Client 5: Prototype Model Acc: 0.6728
Client 6: Prototype Model Acc: 0.1429
Client 7: Prototype Model Acc: 0.8740
Client 8: Prototype Model Acc: 0.7780
Client 9: Prototype Model Acc: 0.9388
Client 10: Prototype Model Acc: 0.8072
Client 11: Prototype Model Acc: 0.6339
Client 12: Prototype Model Acc: 0.7526
Client 13: Prototype Model Acc: 0.7160
Client 14: Prototype Model Acc: 0.9446
Client 15: Prototype Model Acc: 0.9416
Client 16: Prototype Model Acc: 0.8404
Client 17: Prototype Model Acc: 0.8020
Client 18: Prototype Model Acc: 0.6823
Client 19: Prototype Model Acc: 0.1900
Averaged Test Accuracy (Regular Model): 0.8894
Averaged Test Accuracy (Prototype Model): 0.7676
Std Test Accuracy (Regular Model): 0.0819
Std Test Accuracy (Prototype Model): 0.2514
client.id trained 3
local_model_loss tensor(0.6792, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.1992, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.2419, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.5182, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.1739, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.1944, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.1452, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.4186, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.6349, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.3720, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.4321, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.6988, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0706, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.4562, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.2021, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.2463, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.6856, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.2205, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.3038, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.1425, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 43.975463717011735
only_train_time: 385.47613522806205
all_clients_time_cost: 385.47613522806205
agg_protos_label dict_keys([0, 2, 7, 6, 3, 5, 8, 9, 1, 4])
-------------------------------------------------- 65.32731676101685

-------------Round number: 5-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 130, 1: 8, 2: 6, 3: 0, 4: 39, 5: 0, 6: 0, 7: 106, 8: 16, 9: 572}
Prototype-Based Model Correct Classifications (per class):
{0: 123, 1: 8, 2: 0, 3: 0, 4: 40, 5: 0, 6: 0, 7: 113, 8: 15, 9: 562}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 1, 6: 268, 7: 0, 8: 476, 9: 111}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 6, 6: 265, 7: 5, 8: 463, 9: 103}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 123, 1: 0, 2: 0, 3: 0, 4: 0, 5: 179, 6: 103, 7: 110, 8: 44, 9: 7}
Prototype-Based Model Correct Classifications (per class):
{0: 115, 1: 0, 2: 0, 3: 0, 4: 0, 5: 178, 6: 111, 7: 120, 8: 44, 9: 7}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 265, 1: 0, 2: 3, 3: 0, 4: 0, 5: 0, 6: 0, 7: 14, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 14, 1: 0, 2: 23, 3: 16, 4: 0, 5: 0, 6: 1, 7: 14, 8: 4, 9: 0}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 83, 1: 0, 2: 184, 3: 14, 4: 0, 5: 0, 6: 1, 7: 0, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 72, 1: 0, 2: 9, 3: 21, 4: 1, 5: 0, 6: 4, 7: 0, 8: 318, 9: 479}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 28, 1: 0, 2: 0, 3: 0, 4: 0, 5: 1, 6: 49, 7: 0, 8: 11, 9: 182}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 10, 4: 0, 5: 4, 6: 17, 7: 0, 8: 18, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 236, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 3, 1: 0, 2: 42, 3: 0, 4: 2, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 0, 1: 64, 2: 357, 3: 101, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 54, 2: 358, 3: 119, 4: 0, 5: 499, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 223, 1: 284, 2: 176, 3: 0, 4: 166, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 225, 1: 283, 2: 71, 3: 0, 4: 169, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 54, 1: 139, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 37, 1: 138, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 706, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 116, 1: 129, 2: 0, 3: 8, 4: 0, 5: 235, 6: 224, 7: 103, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 126, 1: 130, 2: 0, 3: 1, 4: 11, 5: 229, 6: 192, 7: 104, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1143, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 673, 2: 2, 3: 0, 4: 909, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 239, 1: 0, 2: 47, 3: 60, 4: 0, 5: 60, 6: 0, 7: 254, 8: 0, 9: 93}
Prototype-Based Model Correct Classifications (per class):
{0: 218, 1: 0, 2: 6, 3: 64, 4: 0, 5: 56, 6: 0, 7: 222, 8: 0, 9: 101}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 19, 1: 139, 2: 228, 3: 0, 4: 35, 5: 77, 6: 0, 7: 20, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 132, 2: 247, 3: 4, 4: 0, 5: 82, 6: 0, 7: 0, 8: 13, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 144, 1: 117, 2: 135, 3: 0, 4: 0, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 138, 1: 118, 2: 135, 3: 0, 4: 0, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 87, 3: 816, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 95, 3: 798, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 331, 4: 22, 5: 0, 6: 249, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 349, 4: 56, 5: 0, 6: 164, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 88, 1: 67, 2: 194, 3: 187, 4: 4, 5: 1, 6: 6, 7: 442, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 91, 1: 71, 2: 190, 3: 180, 4: 0, 5: 9, 6: 2, 7: 436, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 1, 1: 12, 2: 0, 3: 8, 4: 118, 5: 42, 6: 14, 7: 30, 8: 44, 9: 270}
Prototype-Based Model Correct Classifications (per class):
{0: 13, 1: 14, 2: 0, 3: 2, 4: 18, 5: 40, 6: 36, 7: 36, 8: 39, 9: 261}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 0, 1: 19, 2: 0, 3: 92, 4: 0, 5: 0, 6: 180, 7: 43, 8: 14, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 7, 1: 25, 2: 2, 3: 47, 4: 6, 5: 0, 6: 1, 7: 1, 8: 12, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9360
Client 1: Regular Model Acc: 0.9214
Client 2: Regular Model Acc: 0.8251
Client 3: Regular Model Acc: 0.7363
Client 4: Regular Model Acc: 0.9254
Client 5: Regular Model Acc: 0.8364
Client 6: Regular Model Acc: 0.6880
Client 7: Regular Model Acc: 0.9133
Client 8: Regular Model Acc: 0.8975
Client 9: Regular Model Acc: 0.9657
Client 10: Regular Model Acc: 0.8402
Client 11: Regular Model Acc: 0.9867
Client 12: Regular Model Acc: 0.8828
Client 13: Regular Model Acc: 0.7825
Client 14: Regular Model Acc: 0.9507
Client 15: Regular Model Acc: 0.9586
Client 16: Regular Model Acc: 0.9228
Client 17: Regular Model Acc: 0.8160
Client 18: Regular Model Acc: 0.8435
Client 19: Regular Model Acc: 0.7873
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9189
Client 1: Prototype Model Acc: 0.9064
Client 2: Prototype Model Acc: 0.8382
Client 3: Prototype Model Acc: 0.1880
Client 4: Prototype Model Acc: 0.7668
Client 5: Prototype Model Acc: 0.7037
Client 6: Prototype Model Acc: 0.1370
Client 7: Prototype Model Acc: 0.9205
Client 8: Prototype Model Acc: 0.7907
Client 9: Prototype Model Acc: 0.9453
Client 10: Prototype Model Acc: 0.8175
Client 11: Prototype Model Acc: 0.8417
Client 12: Prototype Model Acc: 0.7819
Client 13: Prototype Model Acc: 0.7221
Client 14: Prototype Model Acc: 0.9456
Client 15: Prototype Model Acc: 0.9480
Client 16: Prototype Model Acc: 0.8959
Client 17: Prototype Model Acc: 0.8078
Client 18: Prototype Model Acc: 0.7183
Client 19: Prototype Model Acc: 0.2330
Averaged Test Accuracy (Regular Model): 0.8946
Averaged Test Accuracy (Prototype Model): 0.8053
Std Test Accuracy (Regular Model): 0.0793
Std Test Accuracy (Prototype Model): 0.2457
client.id trained 13
local_model_loss tensor(0.5894, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.3961, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.2852, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.1775, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.1365, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.4790, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.6272, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.3660, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.2298, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.1644, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.1324, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.4362, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.2033, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.1883, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0658, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.1834, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.3999, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.6463, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.2315, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.6464, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 50.64923913101666
only_train_time: 447.81330111727584
all_clients_time_cost: 447.81330111727584
agg_protos_label dict_keys([5, 0, 4, 6, 2, 1, 7, 8, 3, 9])
-------------------------------------------------- 63.94279384613037

-------------Round number: 6-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 130, 1: 8, 2: 6, 3: 0, 4: 39, 5: 0, 6: 0, 7: 103, 8: 16, 9: 577}
Prototype-Based Model Correct Classifications (per class):
{0: 123, 1: 8, 2: 0, 3: 0, 4: 40, 5: 0, 6: 0, 7: 112, 8: 15, 9: 566}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 2, 6: 268, 7: 0, 8: 478, 9: 111}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 6, 6: 265, 7: 5, 8: 461, 9: 102}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 122, 1: 0, 2: 0, 3: 0, 4: 0, 5: 179, 6: 104, 7: 115, 8: 46, 9: 7}
Prototype-Based Model Correct Classifications (per class):
{0: 117, 1: 0, 2: 0, 3: 0, 4: 0, 5: 177, 6: 113, 7: 125, 8: 45, 9: 7}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 265, 1: 0, 2: 16, 3: 0, 4: 0, 5: 0, 6: 0, 7: 14, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 161, 1: 0, 2: 25, 3: 15, 4: 0, 5: 0, 6: 1, 7: 14, 8: 4, 9: 0}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 83, 1: 0, 2: 184, 3: 15, 4: 0, 5: 0, 6: 1, 7: 0, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 72, 1: 0, 2: 9, 3: 22, 4: 1, 5: 0, 6: 4, 7: 0, 8: 318, 9: 479}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 30, 1: 0, 2: 0, 3: 2, 4: 0, 5: 1, 6: 46, 7: 0, 8: 12, 9: 182}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 24, 7: 0, 8: 18, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 236, 7: 0, 8: 0, 9: 8}
Prototype-Based Model Correct Classifications (per class):
{0: 22, 1: 0, 2: 32, 3: 0, 4: 2, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 0, 1: 65, 2: 357, 3: 98, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 62, 2: 358, 3: 116, 4: 0, 5: 499, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 223, 1: 285, 2: 186, 3: 0, 4: 165, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 226, 1: 284, 2: 88, 3: 0, 4: 169, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 57, 1: 139, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 42, 1: 138, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 706, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 115, 1: 129, 2: 0, 3: 10, 4: 0, 5: 238, 6: 228, 7: 103, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 127, 1: 129, 2: 0, 3: 6, 4: 11, 5: 234, 6: 186, 7: 104, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1147, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 683, 2: 0, 3: 0, 4: 1072, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 239, 1: 0, 2: 49, 3: 60, 4: 0, 5: 57, 6: 0, 7: 274, 8: 0, 9: 89}
Prototype-Based Model Correct Classifications (per class):
{0: 218, 1: 0, 2: 13, 3: 66, 4: 0, 5: 57, 6: 0, 7: 239, 8: 0, 9: 101}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 21, 1: 139, 2: 224, 3: 0, 4: 39, 5: 74, 6: 0, 7: 21, 8: 1, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 132, 2: 248, 3: 4, 4: 5, 5: 82, 6: 0, 7: 0, 8: 14, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 143, 1: 118, 2: 135, 3: 0, 4: 0, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 138, 1: 118, 2: 134, 3: 0, 4: 0, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 89, 3: 816, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 95, 3: 799, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 349, 4: 39, 5: 0, 6: 229, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 356, 4: 57, 5: 0, 6: 145, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 90, 1: 68, 2: 194, 3: 188, 4: 5, 5: 2, 6: 7, 7: 442, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 94, 1: 71, 2: 190, 3: 183, 4: 0, 5: 10, 6: 2, 7: 436, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 1, 1: 13, 2: 0, 3: 8, 4: 118, 5: 45, 6: 15, 7: 30, 8: 44, 9: 270}
Prototype-Based Model Correct Classifications (per class):
{0: 14, 1: 14, 2: 0, 3: 2, 4: 23, 5: 42, 6: 35, 7: 36, 8: 40, 9: 261}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 0, 1: 19, 2: 0, 3: 82, 4: 0, 5: 0, 6: 188, 7: 43, 8: 14, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 16, 1: 25, 2: 0, 3: 80, 4: 6, 5: 0, 6: 9, 7: 5, 8: 15, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9381
Client 1: Regular Model Acc: 0.9247
Client 2: Regular Model Acc: 0.8353
Client 3: Regular Model Acc: 0.7702
Client 4: Regular Model Acc: 0.9262
Client 5: Regular Model Acc: 0.8426
Client 6: Regular Model Acc: 0.7114
Client 7: Regular Model Acc: 0.9115
Client 8: Regular Model Acc: 0.9080
Client 9: Regular Model Acc: 0.9689
Client 10: Regular Model Acc: 0.8485
Client 11: Regular Model Acc: 0.9888
Client 12: Regular Model Acc: 0.9004
Client 13: Regular Model Acc: 0.7840
Client 14: Regular Model Acc: 0.9507
Client 15: Regular Model Acc: 0.9607
Client 16: Regular Model Acc: 0.9358
Client 17: Regular Model Acc: 0.8218
Client 18: Regular Model Acc: 0.8513
Client 19: Regular Model Acc: 0.7828
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9221
Client 1: Prototype Model Acc: 0.9031
Client 2: Prototype Model Acc: 0.8513
Client 3: Prototype Model Acc: 0.5744
Client 4: Prototype Model Acc: 0.7676
Client 5: Prototype Model Acc: 0.7284
Client 6: Prototype Model Acc: 0.1633
Client 7: Prototype Model Acc: 0.9249
Client 8: Prototype Model Acc: 0.8108
Client 9: Prototype Model Acc: 0.9506
Client 10: Prototype Model Acc: 0.8216
Client 11: Prototype Model Acc: 0.9325
Client 12: Prototype Model Acc: 0.8136
Client 13: Prototype Model Acc: 0.7326
Client 14: Prototype Model Acc: 0.9446
Client 15: Prototype Model Acc: 0.9490
Client 16: Prototype Model Acc: 0.8855
Client 17: Prototype Model Acc: 0.8135
Client 18: Prototype Model Acc: 0.7308
Client 19: Prototype Model Acc: 0.3575
Averaged Test Accuracy (Regular Model): 0.9004
Averaged Test Accuracy (Prototype Model): 0.8322
Std Test Accuracy (Regular Model): 0.0748
Std Test Accuracy (Prototype Model): 0.1993
client.id trained 17
local_model_loss tensor(0.4184, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.3712, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.1791, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.4458, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.5874, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.1561, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.1709, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0622, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.1863, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.2176, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.3764, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.2707, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.6148, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.1290, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.6041, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.1909, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.3299, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.5531, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.1239, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.2184, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 58.11910343100317
only_train_time: 511.43754725530744
all_clients_time_cost: 511.43754725530744
agg_protos_label dict_keys([7, 6, 2, 1, 3, 4, 0, 5, 9, 8])
-------------------------------------------------- 65.0988929271698

-------------Round number: 7-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 130, 1: 8, 2: 6, 3: 0, 4: 39, 5: 0, 6: 0, 7: 107, 8: 16, 9: 574}
Prototype-Based Model Correct Classifications (per class):
{0: 120, 1: 8, 2: 0, 3: 0, 4: 40, 5: 0, 6: 0, 7: 112, 8: 15, 9: 561}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 2, 6: 268, 7: 0, 8: 479, 9: 111}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 6, 6: 266, 7: 5, 8: 462, 9: 101}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 121, 1: 0, 2: 0, 3: 0, 4: 0, 5: 180, 6: 111, 7: 106, 8: 46, 9: 7}
Prototype-Based Model Correct Classifications (per class):
{0: 115, 1: 0, 2: 0, 3: 0, 4: 0, 5: 179, 6: 114, 7: 115, 8: 44, 9: 8}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 265, 1: 0, 2: 17, 3: 0, 4: 0, 5: 0, 6: 0, 7: 14, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 211, 1: 0, 2: 13, 3: 11, 4: 0, 5: 0, 6: 2, 7: 14, 8: 2, 9: 0}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 83, 1: 0, 2: 184, 3: 16, 4: 0, 5: 0, 6: 1, 7: 0, 8: 332, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 72, 1: 0, 2: 16, 3: 22, 4: 1, 5: 0, 6: 4, 7: 0, 8: 318, 9: 479}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 28, 1: 0, 2: 0, 3: 5, 4: 0, 5: 1, 6: 44, 7: 0, 8: 13, 9: 182}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 26, 7: 0, 8: 19, 9: 178}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 236, 7: 0, 8: 0, 9: 9}
Prototype-Based Model Correct Classifications (per class):
{0: 24, 1: 0, 2: 30, 3: 0, 4: 2, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 2, 1: 66, 2: 355, 3: 96, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 65, 2: 358, 3: 106, 4: 0, 5: 499, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 223, 1: 285, 2: 189, 3: 0, 4: 165, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 284, 2: 97, 3: 0, 4: 169, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 57, 1: 139, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 45, 1: 138, 2: 0, 3: 1, 4: 0, 5: 0, 6: 0, 7: 0, 8: 706, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 115, 1: 128, 2: 0, 3: 10, 4: 0, 5: 239, 6: 228, 7: 102, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 128, 1: 129, 2: 0, 3: 8, 4: 10, 5: 237, 6: 187, 7: 105, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1150, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 690, 2: 0, 3: 0, 4: 1121, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 239, 1: 0, 2: 50, 3: 61, 4: 0, 5: 57, 6: 0, 7: 280, 8: 0, 9: 89}
Prototype-Based Model Correct Classifications (per class):
{0: 213, 1: 0, 2: 14, 3: 67, 4: 0, 5: 55, 6: 0, 7: 252, 8: 0, 9: 101}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 22, 1: 139, 2: 223, 3: 0, 4: 43, 5: 75, 6: 0, 7: 21, 8: 6, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 132, 2: 244, 3: 4, 4: 19, 5: 82, 6: 0, 7: 0, 8: 14, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 144, 1: 119, 2: 135, 3: 0, 4: 0, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 139, 1: 118, 2: 134, 3: 0, 4: 0, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 91, 3: 815, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 95, 3: 805, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 351, 4: 41, 5: 0, 6: 225, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 357, 4: 59, 5: 0, 6: 144, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 93, 1: 68, 2: 193, 3: 188, 4: 7, 5: 4, 6: 6, 7: 442, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 97, 1: 71, 2: 192, 3: 183, 4: 0, 5: 10, 6: 1, 7: 437, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 1, 1: 13, 2: 0, 3: 9, 4: 117, 5: 46, 6: 15, 7: 30, 8: 44, 9: 270}
Prototype-Based Model Correct Classifications (per class):
{0: 14, 1: 14, 2: 0, 3: 4, 4: 40, 5: 44, 6: 34, 7: 36, 8: 40, 9: 261}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 0, 1: 22, 2: 0, 3: 90, 4: 0, 5: 0, 6: 181, 7: 43, 8: 15, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 16, 1: 25, 2: 0, 3: 87, 4: 6, 5: 0, 6: 24, 7: 5, 8: 15, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9392
Client 1: Regular Model Acc: 0.9257
Client 2: Regular Model Acc: 0.8324
Client 3: Regular Model Acc: 0.7728
Client 4: Regular Model Acc: 0.9279
Client 5: Regular Model Acc: 0.8426
Client 6: Regular Model Acc: 0.7143
Client 7: Regular Model Acc: 0.9106
Client 8: Regular Model Acc: 0.9112
Client 9: Regular Model Acc: 0.9689
Client 10: Regular Model Acc: 0.8474
Client 11: Regular Model Acc: 0.9904
Client 12: Regular Model Acc: 0.9097
Client 13: Regular Model Acc: 0.7991
Client 14: Regular Model Acc: 0.9528
Client 15: Regular Model Acc: 0.9618
Client 16: Regular Model Acc: 0.9358
Client 17: Regular Model Acc: 0.8259
Client 18: Regular Model Acc: 0.8529
Client 19: Regular Model Acc: 0.7941
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9136
Client 1: Prototype Model Acc: 0.9042
Client 2: Prototype Model Acc: 0.8382
Client 3: Prototype Model Acc: 0.6606
Client 4: Prototype Model Acc: 0.7735
Client 5: Prototype Model Acc: 0.7346
Client 6: Prototype Model Acc: 0.1633
Client 7: Prototype Model Acc: 0.9187
Client 8: Prototype Model Acc: 0.8214
Client 9: Prototype Model Acc: 0.9549
Client 10: Prototype Model Acc: 0.8289
Client 11: Prototype Model Acc: 0.9623
Client 12: Prototype Model Acc: 0.8230
Client 13: Prototype Model Acc: 0.7477
Client 14: Prototype Model Acc: 0.9456
Client 15: Prototype Model Acc: 0.9554
Client 16: Prototype Model Acc: 0.8873
Client 17: Prototype Model Acc: 0.8177
Client 18: Prototype Model Acc: 0.7621
Client 19: Prototype Model Acc: 0.4072
Averaged Test Accuracy (Regular Model): 0.9027
Averaged Test Accuracy (Prototype Model): 0.8419
Std Test Accuracy (Regular Model): 0.0732
Std Test Accuracy (Prototype Model): 0.1912
client.id trained 17
local_model_loss tensor(0.4019, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0592, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.1605, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.5251, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.2013, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.1225, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.2075, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.2098, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.1711, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.4184, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.3031, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.1689, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.5865, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.1486, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.5545, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.3493, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.3591, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.1167, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.2549, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.5790, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 65.67264369793702
only_train_time: 574.6807649510447
all_clients_time_cost: 574.6807649510447
agg_protos_label dict_keys([7, 6, 2, 1, 3, 4, 0, 5, 8, 9])
Number of samples: 167
-------------------------------------------------- 66.07091736793518

-------------Round number: 8-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 130, 1: 8, 2: 6, 3: 0, 4: 39, 5: 0, 6: 0, 7: 93, 8: 16, 9: 579}
Prototype-Based Model Correct Classifications (per class):
{0: 121, 1: 8, 2: 0, 3: 0, 4: 40, 5: 0, 6: 0, 7: 106, 8: 15, 9: 572}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 5, 6: 268, 7: 0, 8: 479, 9: 111}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 6, 6: 267, 7: 5, 8: 463, 9: 101}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 119, 1: 0, 2: 0, 3: 0, 4: 0, 5: 180, 6: 113, 7: 115, 8: 46, 9: 7}
Prototype-Based Model Correct Classifications (per class):
{0: 115, 1: 0, 2: 0, 3: 0, 4: 0, 5: 178, 6: 114, 7: 117, 8: 44, 9: 9}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 265, 1: 0, 2: 18, 3: 0, 4: 0, 5: 0, 6: 0, 7: 14, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 233, 1: 0, 2: 7, 3: 10, 4: 0, 5: 0, 6: 1, 7: 14, 8: 2, 9: 0}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 83, 1: 0, 2: 183, 3: 16, 4: 0, 5: 0, 6: 3, 7: 0, 8: 332, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 0, 2: 23, 3: 22, 4: 1, 5: 0, 6: 3, 7: 0, 8: 318, 9: 479}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 30, 1: 0, 2: 0, 3: 5, 4: 0, 5: 2, 6: 44, 7: 0, 8: 16, 9: 182}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 28, 7: 0, 8: 19, 9: 178}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 236, 7: 0, 8: 0, 9: 11}
Prototype-Based Model Correct Classifications (per class):
{0: 24, 1: 0, 2: 35, 3: 0, 4: 2, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 7, 1: 66, 2: 352, 3: 99, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 66, 2: 358, 3: 105, 4: 0, 5: 499, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 224, 1: 285, 2: 190, 3: 0, 4: 165, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 285, 2: 100, 3: 0, 4: 169, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 58, 1: 139, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 47, 1: 138, 2: 0, 3: 1, 4: 0, 5: 0, 6: 0, 7: 0, 8: 706, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 115, 1: 129, 2: 0, 3: 11, 4: 0, 5: 240, 6: 229, 7: 102, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 129, 1: 129, 2: 0, 3: 9, 4: 9, 5: 238, 6: 192, 7: 105, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1151, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 697, 2: 0, 3: 0, 4: 1137, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 238, 1: 0, 2: 50, 3: 61, 4: 0, 5: 57, 6: 0, 7: 286, 8: 0, 9: 89}
Prototype-Based Model Correct Classifications (per class):
{0: 212, 1: 0, 2: 16, 3: 67, 4: 0, 5: 55, 6: 0, 7: 261, 8: 0, 9: 100}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 23, 1: 140, 2: 224, 3: 0, 4: 47, 5: 75, 6: 0, 7: 22, 8: 10, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 9, 1: 132, 2: 239, 3: 4, 4: 25, 5: 83, 6: 0, 7: 0, 8: 14, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 145, 1: 120, 2: 136, 3: 0, 4: 0, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 139, 1: 119, 2: 134, 3: 0, 4: 0, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 92, 3: 815, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 96, 3: 809, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 340, 4: 39, 5: 0, 6: 243, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 355, 4: 58, 5: 0, 6: 170, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 92, 1: 68, 2: 193, 3: 189, 4: 8, 5: 4, 6: 8, 7: 442, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 98, 1: 70, 2: 192, 3: 181, 4: 0, 5: 10, 6: 1, 7: 435, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 2, 1: 13, 2: 0, 3: 9, 4: 117, 5: 46, 6: 15, 7: 29, 8: 44, 9: 270}
Prototype-Based Model Correct Classifications (per class):
{0: 14, 1: 14, 2: 0, 3: 4, 4: 58, 5: 47, 6: 33, 7: 36, 8: 42, 9: 262}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 0, 1: 24, 2: 0, 3: 91, 4: 0, 5: 0, 6: 180, 7: 43, 8: 15, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 14, 1: 25, 2: 0, 3: 93, 4: 6, 5: 0, 6: 41, 7: 5, 8: 15, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9296
Client 1: Regular Model Acc: 0.9290
Client 2: Regular Model Acc: 0.8455
Client 3: Regular Model Acc: 0.7755
Client 4: Regular Model Acc: 0.9288
Client 5: Regular Model Acc: 0.8611
Client 6: Regular Model Acc: 0.7201
Client 7: Regular Model Acc: 0.9151
Client 8: Regular Model Acc: 0.9133
Client 9: Regular Model Acc: 0.9700
Client 10: Regular Model Acc: 0.8515
Client 11: Regular Model Acc: 0.9910
Client 12: Regular Model Acc: 0.9156
Client 13: Regular Model Acc: 0.8172
Client 14: Regular Model Acc: 0.9559
Client 15: Regular Model Acc: 0.9628
Client 16: Regular Model Acc: 0.9402
Client 17: Regular Model Acc: 0.8284
Client 18: Regular Model Acc: 0.8529
Client 19: Regular Model Acc: 0.7986
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9200
Client 1: Prototype Model Acc: 0.9064
Client 2: Prototype Model Acc: 0.8411
Client 3: Prototype Model Acc: 0.6971
Client 4: Prototype Model Acc: 0.7803
Client 5: Prototype Model Acc: 0.7407
Client 6: Prototype Model Acc: 0.1778
Client 7: Prototype Model Acc: 0.9187
Client 8: Prototype Model Acc: 0.8256
Client 9: Prototype Model Acc: 0.9571
Client 10: Prototype Model Acc: 0.8361
Client 11: Prototype Model Acc: 0.9745
Client 12: Prototype Model Acc: 0.8335
Client 13: Prototype Model Acc: 0.7644
Client 14: Prototype Model Acc: 0.9466
Client 15: Prototype Model Acc: 0.9607
Client 16: Prototype Model Acc: 0.9072
Client 17: Prototype Model Acc: 0.8144
Client 18: Prototype Model Acc: 0.7981
Client 19: Prototype Model Acc: 0.4548
Averaged Test Accuracy (Regular Model): 0.9060
Averaged Test Accuracy (Prototype Model): 0.8513
Std Test Accuracy (Regular Model): 0.0706
Std Test Accuracy (Prototype Model): 0.1845
client.id trained 4
local_model_loss tensor(0.1969, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.1168, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.1637, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.1415, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.1511, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.3959, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.1559, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.2836, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.3235, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.5637, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.2370, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.3861, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.1930, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.1106, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.1775, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.5021, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.5476, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.3450, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.5501, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0566, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 73.80674103402998
only_train_time: 645.2191225661663
all_clients_time_cost: 645.2191225661663
agg_protos_label dict_keys([9, 8, 0, 2, 6, 3, 7, 4, 1, 5])
-------------------------------------------------- 71.91357064247131

-------------Round number: 9-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 130, 1: 8, 2: 6, 3: 0, 4: 39, 5: 0, 6: 1, 7: 111, 8: 16, 9: 566}
Prototype-Based Model Correct Classifications (per class):
{0: 121, 1: 8, 2: 0, 3: 0, 4: 41, 5: 0, 6: 0, 7: 113, 8: 15, 9: 555}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 6, 6: 270, 7: 0, 8: 482, 9: 111}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 6, 6: 267, 7: 6, 8: 460, 9: 101}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 119, 1: 0, 2: 0, 3: 0, 4: 0, 5: 179, 6: 114, 7: 117, 8: 46, 9: 7}
Prototype-Based Model Correct Classifications (per class):
{0: 115, 1: 0, 2: 0, 3: 0, 4: 0, 5: 178, 6: 115, 7: 122, 8: 46, 9: 10}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 264, 1: 0, 2: 27, 3: 2, 4: 0, 5: 3, 6: 0, 7: 14, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 228, 1: 0, 2: 15, 3: 10, 4: 0, 5: 0, 6: 1, 7: 14, 8: 2, 9: 0}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 84, 1: 0, 2: 183, 3: 17, 4: 0, 5: 0, 6: 5, 7: 0, 8: 332, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 75, 1: 0, 2: 36, 3: 23, 4: 1, 5: 0, 6: 4, 7: 0, 8: 318, 9: 479}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 32, 1: 0, 2: 0, 3: 6, 4: 0, 5: 2, 6: 44, 7: 0, 8: 16, 9: 182}
Prototype-Based Model Correct Classifications (per class):
{0: 2, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 31, 7: 0, 8: 18, 9: 178}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 236, 7: 0, 8: 0, 9: 11}
Prototype-Based Model Correct Classifications (per class):
{0: 24, 1: 0, 2: 45, 3: 0, 4: 2, 5: 0, 6: 6, 7: 0, 8: 0, 9: 0}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 14, 1: 66, 2: 353, 3: 101, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 66, 2: 357, 3: 104, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 223, 1: 285, 2: 176, 3: 0, 4: 166, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 226, 1: 285, 2: 94, 3: 0, 4: 170, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 58, 1: 139, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 47, 1: 138, 2: 0, 3: 1, 4: 0, 5: 0, 6: 0, 7: 0, 8: 706, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 114, 1: 129, 2: 0, 3: 11, 4: 0, 5: 242, 6: 229, 7: 102, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 127, 1: 128, 2: 0, 3: 11, 4: 9, 5: 239, 6: 197, 7: 105, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1152, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 697, 2: 0, 3: 0, 4: 1139, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 238, 1: 0, 2: 50, 3: 63, 4: 0, 5: 57, 6: 0, 7: 287, 8: 0, 9: 87}
Prototype-Based Model Correct Classifications (per class):
{0: 213, 1: 0, 2: 16, 3: 67, 4: 0, 5: 55, 6: 0, 7: 264, 8: 0, 9: 98}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 23, 1: 140, 2: 224, 3: 0, 4: 47, 5: 75, 6: 0, 7: 23, 8: 11, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 16, 1: 132, 2: 235, 3: 4, 4: 32, 5: 83, 6: 0, 7: 0, 8: 14, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 145, 1: 120, 2: 136, 3: 0, 4: 1, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 140, 1: 119, 2: 134, 3: 0, 4: 0, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 95, 3: 815, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 97, 3: 810, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 337, 4: 36, 5: 0, 6: 244, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 354, 4: 57, 5: 0, 6: 176, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 91, 1: 69, 2: 192, 3: 189, 4: 8, 5: 5, 6: 7, 7: 441, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 98, 1: 70, 2: 192, 3: 181, 4: 0, 5: 10, 6: 2, 7: 435, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 4, 1: 14, 2: 0, 3: 10, 4: 116, 5: 47, 6: 16, 7: 29, 8: 45, 9: 270}
Prototype-Based Model Correct Classifications (per class):
{0: 14, 1: 14, 2: 0, 3: 6, 4: 60, 5: 48, 6: 31, 7: 36, 8: 42, 9: 262}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 0, 1: 24, 2: 0, 3: 91, 4: 0, 5: 0, 6: 183, 7: 43, 8: 15, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 17, 1: 25, 2: 1, 3: 95, 4: 6, 5: 0, 6: 53, 7: 13, 8: 17, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9360
Client 1: Regular Model Acc: 0.9354
Client 2: Regular Model Acc: 0.8484
Client 3: Regular Model Acc: 0.8094
Client 4: Regular Model Acc: 0.9321
Client 5: Regular Model Acc: 0.8704
Client 6: Regular Model Acc: 0.7201
Client 7: Regular Model Acc: 0.9240
Client 8: Regular Model Acc: 0.8985
Client 9: Regular Model Acc: 0.9700
Client 10: Regular Model Acc: 0.8526
Client 11: Regular Model Acc: 0.9915
Client 12: Regular Model Acc: 0.9168
Client 13: Regular Model Acc: 0.8202
Client 14: Regular Model Acc: 0.9569
Client 15: Regular Model Acc: 0.9660
Client 16: Regular Model Acc: 0.9358
Client 17: Regular Model Acc: 0.8267
Client 18: Regular Model Acc: 0.8623
Client 19: Regular Model Acc: 0.8054
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9104
Client 1: Prototype Model Acc: 0.9042
Client 2: Prototype Model Acc: 0.8542
Client 3: Prototype Model Acc: 0.7050
Client 4: Prototype Model Acc: 0.7939
Client 5: Prototype Model Acc: 0.7531
Client 6: Prototype Model Acc: 0.2245
Client 7: Prototype Model Acc: 0.9178
Client 8: Prototype Model Acc: 0.8192
Client 9: Prototype Model Acc: 0.9571
Client 10: Prototype Model Acc: 0.8412
Client 11: Prototype Model Acc: 0.9756
Client 12: Prototype Model Acc: 0.8359
Client 13: Prototype Model Acc: 0.7795
Client 14: Prototype Model Acc: 0.9476
Client 15: Prototype Model Acc: 0.9628
Client 16: Prototype Model Acc: 0.9107
Client 17: Prototype Model Acc: 0.8152
Client 18: Prototype Model Acc: 0.8028
Client 19: Prototype Model Acc: 0.5181
Averaged Test Accuracy (Regular Model): 0.9083
Averaged Test Accuracy (Prototype Model): 0.8563
Std Test Accuracy (Regular Model): 0.0680
Std Test Accuracy (Prototype Model): 0.1702
client.id trained 2
local_model_loss tensor(0.2658, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.5240, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.1472, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.1865, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.3709, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.1571, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.4823, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.2163, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.5309, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.5196, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.1786, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.1342, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.3770, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.3287, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.1052, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.1422, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0543, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.1116, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.3239, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.1653, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 81.79879025998525
only_train_time: 711.8060245749075
all_clients_time_cost: 711.8060245749075
agg_protos_label dict_keys([7, 5, 4, 6, 9, 8, 0, 1, 2, 3])
-------------------------------------------------- 68.2790060043335

-------------Round number: 10-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 130, 1: 8, 2: 6, 3: 0, 4: 39, 5: 0, 6: 1, 7: 108, 8: 16, 9: 577}
Prototype-Based Model Correct Classifications (per class):
{0: 121, 1: 8, 2: 0, 3: 0, 4: 41, 5: 0, 6: 0, 7: 111, 8: 15, 9: 565}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 6, 6: 270, 7: 0, 8: 482, 9: 111}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 6, 6: 267, 7: 6, 8: 460, 9: 102}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 119, 1: 0, 2: 0, 3: 0, 4: 0, 5: 178, 6: 116, 7: 121, 8: 46, 9: 7}
Prototype-Based Model Correct Classifications (per class):
{0: 117, 1: 0, 2: 0, 3: 0, 4: 0, 5: 178, 6: 114, 7: 124, 8: 46, 9: 10}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 265, 1: 0, 2: 23, 3: 1, 4: 0, 5: 2, 6: 0, 7: 14, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 241, 1: 0, 2: 13, 3: 9, 4: 0, 5: 0, 6: 1, 7: 14, 8: 2, 9: 0}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 84, 1: 0, 2: 182, 3: 17, 4: 0, 5: 0, 6: 10, 7: 0, 8: 332, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 75, 1: 0, 2: 53, 3: 23, 4: 1, 5: 0, 6: 6, 7: 0, 8: 318, 9: 479}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 30, 1: 0, 2: 0, 3: 6, 4: 0, 5: 2, 6: 45, 7: 0, 8: 16, 9: 182}
Prototype-Based Model Correct Classifications (per class):
{0: 16, 1: 0, 2: 0, 3: 11, 4: 0, 5: 5, 6: 31, 7: 0, 8: 18, 9: 178}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 236, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 24, 1: 0, 2: 50, 3: 0, 4: 0, 5: 0, 6: 8, 7: 0, 8: 0, 9: 0}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 21, 1: 66, 2: 353, 3: 105, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 66, 2: 356, 3: 106, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 224, 1: 285, 2: 206, 3: 0, 4: 160, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 285, 2: 125, 3: 0, 4: 169, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 58, 1: 139, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 48, 1: 137, 2: 1, 3: 1, 4: 0, 5: 0, 6: 0, 7: 0, 8: 706, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 114, 1: 129, 2: 0, 3: 11, 4: 1, 5: 242, 6: 229, 7: 102, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 128, 1: 128, 2: 0, 3: 11, 4: 9, 5: 242, 6: 198, 7: 105, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 702, 2: 0, 3: 0, 4: 1141, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 238, 1: 0, 2: 53, 3: 64, 4: 0, 5: 58, 6: 0, 7: 281, 8: 0, 9: 95}
Prototype-Based Model Correct Classifications (per class):
{0: 213, 1: 0, 2: 18, 3: 67, 4: 0, 5: 56, 6: 0, 7: 252, 8: 0, 9: 102}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 24, 1: 140, 2: 226, 3: 0, 4: 46, 5: 76, 6: 0, 7: 23, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 18, 1: 133, 2: 231, 3: 4, 4: 35, 5: 84, 6: 0, 7: 0, 8: 14, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 144, 1: 120, 2: 136, 3: 0, 4: 1, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 142, 1: 119, 2: 135, 3: 0, 4: 0, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 95, 3: 816, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 98, 3: 812, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 345, 4: 41, 5: 0, 6: 241, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 356, 4: 58, 5: 0, 6: 174, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 90, 1: 69, 2: 193, 3: 189, 4: 10, 5: 5, 6: 9, 7: 441, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 98, 1: 70, 2: 191, 3: 180, 4: 5, 5: 10, 6: 2, 7: 435, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 7, 1: 13, 2: 0, 3: 12, 4: 110, 5: 47, 6: 25, 7: 30, 8: 45, 9: 268}
Prototype-Based Model Correct Classifications (per class):
{0: 14, 1: 15, 2: 0, 3: 9, 4: 52, 5: 48, 6: 30, 7: 36, 8: 43, 9: 260}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 0, 1: 24, 2: 0, 3: 92, 4: 0, 5: 0, 6: 184, 7: 43, 8: 15, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 18, 1: 26, 2: 0, 3: 95, 4: 6, 5: 0, 6: 56, 7: 27, 8: 18, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9445
Client 1: Regular Model Acc: 0.9354
Client 2: Regular Model Acc: 0.8557
Client 3: Regular Model Acc: 0.7963
Client 4: Regular Model Acc: 0.9355
Client 5: Regular Model Acc: 0.8673
Client 6: Regular Model Acc: 0.7230
Client 7: Regular Model Acc: 0.9339
Client 8: Regular Model Acc: 0.9249
Client 9: Regular Model Acc: 0.9700
Client 10: Regular Model Acc: 0.8536
Client 11: Regular Model Acc: 0.9920
Client 12: Regular Model Acc: 0.9250
Client 13: Regular Model Acc: 0.8278
Client 14: Regular Model Acc: 0.9559
Client 15: Regular Model Acc: 0.9671
Client 16: Regular Model Acc: 0.9445
Client 17: Regular Model Acc: 0.8300
Client 18: Regular Model Acc: 0.8717
Client 19: Regular Model Acc: 0.8100
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9189
Client 1: Prototype Model Acc: 0.9053
Client 2: Prototype Model Acc: 0.8586
Client 3: Prototype Model Acc: 0.7311
Client 4: Prototype Model Acc: 0.8100
Client 5: Prototype Model Acc: 0.7994
Client 6: Prototype Model Acc: 0.2391
Client 7: Prototype Model Acc: 0.9187
Client 8: Prototype Model Acc: 0.8520
Client 9: Prototype Model Acc: 0.9582
Client 10: Prototype Model Acc: 0.8464
Client 11: Prototype Model Acc: 0.9793
Client 12: Prototype Model Acc: 0.8300
Client 13: Prototype Model Acc: 0.7840
Client 14: Prototype Model Acc: 0.9507
Client 15: Prototype Model Acc: 0.9660
Client 16: Prototype Model Acc: 0.9124
Client 17: Prototype Model Acc: 0.8177
Client 18: Prototype Model Acc: 0.7934
Client 19: Prototype Model Acc: 0.5611
Averaged Test Accuracy (Regular Model): 0.9131
Averaged Test Accuracy (Prototype Model): 0.8636
Std Test Accuracy (Regular Model): 0.0690
Std Test Accuracy (Prototype Model): 0.1638
client.id trained 14
local_model_loss tensor(0.1004, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.5032, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.1067, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.2976, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.1949, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0523, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.3562, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.5048, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.3618, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.2379, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.5057, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.4658, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.3246, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.1260, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.1338, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.1596, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.1794, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.1433, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.2534, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.1509, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 88.51850594498683
only_train_time: 776.7224490222288
all_clients_time_cost: 776.7224490222288
agg_protos_label dict_keys([2, 5, 0, 4, 1, 3, 7, 6, 8, 9])
-------------------------------------------------- 66.42845487594604

-------------Round number: 11-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 130, 1: 8, 2: 6, 3: 0, 4: 39, 5: 0, 6: 1, 7: 111, 8: 16, 9: 566}
Prototype-Based Model Correct Classifications (per class):
{0: 121, 1: 8, 2: 0, 3: 0, 4: 42, 5: 0, 6: 0, 7: 114, 8: 15, 9: 554}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 6, 6: 270, 7: 0, 8: 483, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 6, 6: 267, 7: 6, 8: 461, 9: 102}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 116, 1: 0, 2: 0, 3: 0, 4: 0, 5: 178, 6: 119, 7: 124, 8: 46, 9: 8}
Prototype-Based Model Correct Classifications (per class):
{0: 119, 1: 0, 2: 0, 3: 0, 4: 0, 5: 178, 6: 116, 7: 125, 8: 48, 9: 10}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 265, 1: 0, 2: 26, 3: 1, 4: 0, 5: 4, 6: 0, 7: 14, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 241, 1: 0, 2: 9, 3: 9, 4: 0, 5: 0, 6: 0, 7: 14, 8: 2, 9: 0}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 84, 1: 0, 2: 179, 3: 17, 4: 0, 5: 0, 6: 17, 7: 0, 8: 332, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 77, 1: 0, 2: 94, 3: 23, 4: 1, 5: 0, 6: 8, 7: 0, 8: 320, 9: 479}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 29, 1: 0, 2: 0, 3: 6, 4: 0, 5: 2, 6: 46, 7: 0, 8: 16, 9: 182}
Prototype-Based Model Correct Classifications (per class):
{0: 22, 1: 0, 2: 0, 3: 11, 4: 0, 5: 5, 6: 31, 7: 0, 8: 18, 9: 178}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 236, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 24, 1: 0, 2: 51, 3: 0, 4: 0, 5: 0, 6: 12, 7: 0, 8: 0, 9: 3}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 24, 1: 66, 2: 354, 3: 105, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 1, 1: 66, 2: 354, 3: 108, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 224, 1: 286, 2: 201, 3: 0, 4: 163, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 285, 2: 133, 3: 0, 4: 170, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 58, 1: 139, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 50, 1: 137, 2: 1, 3: 1, 4: 0, 5: 0, 6: 0, 7: 0, 8: 706, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 115, 1: 129, 2: 0, 3: 12, 4: 1, 5: 245, 6: 227, 7: 102, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 129, 1: 128, 2: 0, 3: 13, 4: 9, 5: 242, 6: 197, 7: 105, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 705, 2: 0, 3: 0, 4: 1144, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 238, 1: 0, 2: 53, 3: 64, 4: 0, 5: 57, 6: 0, 7: 288, 8: 0, 9: 89}
Prototype-Based Model Correct Classifications (per class):
{0: 214, 1: 0, 2: 27, 3: 67, 4: 0, 5: 56, 6: 0, 7: 265, 8: 0, 9: 99}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 25, 1: 139, 2: 225, 3: 1, 4: 46, 5: 76, 6: 0, 7: 23, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 20, 1: 135, 2: 230, 3: 4, 4: 40, 5: 84, 6: 1, 7: 0, 8: 14, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 143, 1: 120, 2: 136, 3: 0, 4: 2, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 142, 1: 119, 2: 136, 3: 0, 4: 0, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 95, 3: 821, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 98, 3: 813, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 340, 4: 35, 5: 0, 6: 245, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 352, 4: 56, 5: 0, 6: 185, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 91, 1: 70, 2: 192, 3: 188, 4: 10, 5: 5, 6: 12, 7: 441, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 99, 1: 69, 2: 189, 3: 181, 4: 8, 5: 10, 6: 2, 7: 434, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 7, 1: 14, 2: 0, 3: 8, 4: 120, 5: 49, 6: 12, 7: 27, 8: 45, 9: 268}
Prototype-Based Model Correct Classifications (per class):
{0: 14, 1: 15, 2: 0, 3: 6, 4: 92, 5: 49, 6: 26, 7: 33, 8: 42, 9: 263}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 0, 1: 24, 2: 0, 3: 91, 4: 0, 5: 0, 6: 186, 7: 43, 8: 16, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 18, 1: 26, 2: 0, 3: 94, 4: 6, 5: 0, 6: 61, 7: 32, 8: 18, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9360
Client 1: Regular Model Acc: 0.9354
Client 2: Regular Model Acc: 0.8615
Client 3: Regular Model Acc: 0.8094
Client 4: Regular Model Acc: 0.9389
Client 5: Regular Model Acc: 0.8673
Client 6: Regular Model Acc: 0.7230
Client 7: Regular Model Acc: 0.9374
Client 8: Regular Model Acc: 0.9239
Client 9: Regular Model Acc: 0.9700
Client 10: Regular Model Acc: 0.8567
Client 11: Regular Model Acc: 0.9920
Client 12: Regular Model Acc: 0.9250
Client 13: Regular Model Acc: 0.8278
Client 14: Regular Model Acc: 0.9559
Client 15: Regular Model Acc: 0.9724
Client 16: Regular Model Acc: 0.9384
Client 17: Regular Model Acc: 0.8325
Client 18: Regular Model Acc: 0.8607
Client 19: Regular Model Acc: 0.8145
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9114
Client 1: Prototype Model Acc: 0.9074
Client 2: Prototype Model Acc: 0.8688
Client 3: Prototype Model Acc: 0.7180
Client 4: Prototype Model Acc: 0.8499
Client 5: Prototype Model Acc: 0.8179
Client 6: Prototype Model Acc: 0.2624
Client 7: Prototype Model Acc: 0.9196
Client 8: Prototype Model Acc: 0.8615
Client 9: Prototype Model Acc: 0.9603
Client 10: Prototype Model Acc: 0.8485
Client 11: Prototype Model Acc: 0.9825
Client 12: Prototype Model Acc: 0.8535
Client 13: Prototype Model Acc: 0.7976
Client 14: Prototype Model Acc: 0.9517
Client 15: Prototype Model Acc: 0.9671
Client 16: Prototype Model Acc: 0.9167
Client 17: Prototype Model Acc: 0.8185
Client 18: Prototype Model Acc: 0.8451
Client 19: Prototype Model Acc: 0.5814
Averaged Test Accuracy (Regular Model): 0.9135
Averaged Test Accuracy (Prototype Model): 0.8726
Std Test Accuracy (Regular Model): 0.0677
Std Test Accuracy (Prototype Model): 0.1587
client.id trained 9
local_model_loss tensor(0.1021, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.1789, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.4874, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0959, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.4499, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.2522, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.4899, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.2057, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.1453, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.3420, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.1802, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.1168, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.2744, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.1544, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.1322, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.1257, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.2999, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.4860, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.3492, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0504, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 96.25602011405863
only_train_time: 841.966332383221
all_clients_time_cost: 841.966332383221
agg_protos_label dict_keys([1, 8, 7, 2, 4, 0, 6, 3, 9, 5])
Number of samples: 167
-------------------------------------------------- 67.99632430076599

-------------Round number: 12-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 130, 1: 8, 2: 6, 3: 0, 4: 39, 5: 0, 6: 1, 7: 109, 8: 16, 9: 574}
Prototype-Based Model Correct Classifications (per class):
{0: 121, 1: 8, 2: 0, 3: 0, 4: 41, 5: 0, 6: 0, 7: 111, 8: 15, 9: 564}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 6, 6: 270, 7: 0, 8: 483, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 6, 6: 269, 7: 6, 8: 461, 9: 102}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 116, 1: 0, 2: 0, 3: 0, 4: 0, 5: 178, 6: 118, 7: 124, 8: 47, 9: 8}
Prototype-Based Model Correct Classifications (per class):
{0: 119, 1: 1, 2: 0, 3: 0, 4: 0, 5: 178, 6: 116, 7: 123, 8: 49, 9: 10}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 263, 1: 0, 2: 28, 3: 2, 4: 0, 5: 6, 6: 0, 7: 14, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 237, 1: 0, 2: 8, 3: 10, 4: 0, 5: 0, 6: 0, 7: 14, 8: 2, 9: 0}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 80, 1: 0, 2: 184, 3: 18, 4: 0, 5: 0, 6: 5, 7: 0, 8: 330, 9: 479}
Prototype-Based Model Correct Classifications (per class):
{0: 72, 1: 0, 2: 104, 3: 23, 4: 1, 5: 0, 6: 3, 7: 0, 8: 319, 9: 479}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 29, 1: 0, 2: 0, 3: 7, 4: 0, 5: 2, 6: 46, 7: 0, 8: 16, 9: 182}
Prototype-Based Model Correct Classifications (per class):
{0: 26, 1: 0, 2: 0, 3: 11, 4: 0, 5: 5, 6: 32, 7: 0, 8: 18, 9: 178}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 236, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 24, 1: 0, 2: 52, 3: 0, 4: 0, 5: 0, 6: 18, 7: 0, 8: 0, 9: 9}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 29, 1: 66, 2: 354, 3: 106, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 66, 2: 354, 3: 109, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 224, 1: 288, 2: 195, 3: 0, 4: 163, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 286, 2: 121, 3: 0, 4: 170, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 58, 1: 139, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 52, 1: 137, 2: 1, 3: 1, 4: 0, 5: 0, 6: 0, 7: 0, 8: 704, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 122, 1: 129, 2: 0, 3: 13, 4: 5, 5: 251, 6: 218, 7: 99, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 130, 1: 128, 2: 0, 3: 17, 4: 9, 5: 249, 6: 189, 7: 101, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 707, 2: 0, 3: 0, 4: 1146, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 238, 1: 0, 2: 55, 3: 65, 4: 0, 5: 61, 6: 0, 7: 263, 8: 0, 9: 99}
Prototype-Based Model Correct Classifications (per class):
{0: 216, 1: 0, 2: 26, 3: 67, 4: 0, 5: 59, 6: 0, 7: 235, 8: 0, 9: 102}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 25, 1: 140, 2: 227, 3: 1, 4: 47, 5: 75, 6: 0, 7: 23, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 20, 1: 135, 2: 229, 3: 4, 4: 43, 5: 84, 6: 1, 7: 0, 8: 14, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 143, 1: 120, 2: 136, 3: 0, 4: 2, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 142, 1: 120, 2: 136, 3: 0, 4: 0, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 93, 3: 822, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 98, 3: 814, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 346, 4: 42, 5: 0, 6: 241, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 356, 4: 59, 5: 0, 6: 174, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 95, 1: 70, 2: 193, 3: 189, 4: 12, 5: 5, 6: 14, 7: 441, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 99, 1: 69, 2: 188, 3: 184, 4: 11, 5: 10, 6: 5, 7: 434, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 8, 1: 14, 2: 0, 3: 10, 4: 115, 5: 50, 6: 17, 7: 28, 8: 45, 9: 268}
Prototype-Based Model Correct Classifications (per class):
{0: 14, 1: 15, 2: 0, 3: 9, 4: 81, 5: 49, 6: 28, 7: 33, 8: 42, 9: 262}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 0, 1: 24, 2: 0, 3: 92, 4: 0, 5: 0, 6: 183, 7: 43, 8: 17, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 17, 1: 25, 2: 1, 3: 94, 4: 6, 5: 0, 6: 62, 7: 35, 8: 18, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9424
Client 1: Regular Model Acc: 0.9354
Client 2: Regular Model Acc: 0.8615
Client 3: Regular Model Acc: 0.8172
Client 4: Regular Model Acc: 0.9296
Client 5: Regular Model Acc: 0.8704
Client 6: Regular Model Acc: 0.7230
Client 7: Regular Model Acc: 0.9428
Client 8: Regular Model Acc: 0.9197
Client 9: Regular Model Acc: 0.9700
Client 10: Regular Model Acc: 0.8629
Client 11: Regular Model Acc: 0.9920
Client 12: Regular Model Acc: 0.9156
Client 13: Regular Model Acc: 0.8323
Client 14: Regular Model Acc: 0.9559
Client 15: Regular Model Acc: 0.9713
Client 16: Regular Model Acc: 0.9462
Client 17: Regular Model Acc: 0.8408
Client 18: Regular Model Acc: 0.8685
Client 19: Regular Model Acc: 0.8122
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9178
Client 1: Prototype Model Acc: 0.9085
Client 2: Prototype Model Acc: 0.8688
Client 3: Prototype Model Acc: 0.7076
Client 4: Prototype Model Acc: 0.8490
Client 5: Prototype Model Acc: 0.8333
Client 6: Prototype Model Acc: 0.3003
Client 7: Prototype Model Acc: 0.9267
Client 8: Prototype Model Acc: 0.8499
Client 9: Prototype Model Acc: 0.9603
Client 10: Prototype Model Acc: 0.8485
Client 11: Prototype Model Acc: 0.9846
Client 12: Prototype Model Acc: 0.8265
Client 13: Prototype Model Acc: 0.8006
Client 14: Prototype Model Acc: 0.9528
Client 15: Prototype Model Acc: 0.9682
Client 16: Prototype Model Acc: 0.9133
Client 17: Prototype Model Acc: 0.8251
Client 18: Prototype Model Acc: 0.8341
Client 19: Prototype Model Acc: 0.5882
Averaged Test Accuracy (Regular Model): 0.9149
Averaged Test Accuracy (Prototype Model): 0.8727
Std Test Accuracy (Regular Model): 0.0665
Std Test Accuracy (Prototype Model): 0.1521
client.id trained 5
local_model_loss tensor(0.3387, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0487, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.1641, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.4731, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0979, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.1399, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.1831, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.3044, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.1184, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.1459, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.1711, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.4357, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.4745, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.3284, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.1299, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0917, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.2656, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.4705, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.2446, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.1080, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 103.74153580202255
only_train_time: 904.6991724965628
all_clients_time_cost: 904.6991724965628
agg_protos_label dict_keys([9, 0, 6, 5, 8, 3, 1, 2, 4, 7])
-------------------------------------------------- 64.45644569396973

-------------Round number: 13-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 130, 1: 8, 2: 6, 3: 0, 4: 39, 5: 0, 6: 1, 7: 109, 8: 16, 9: 576}
Prototype-Based Model Correct Classifications (per class):
{0: 121, 1: 8, 2: 0, 3: 0, 4: 41, 5: 0, 6: 0, 7: 111, 8: 15, 9: 565}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 6, 6: 270, 7: 1, 8: 484, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 6, 6: 269, 7: 6, 8: 462, 9: 102}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 115, 1: 0, 2: 0, 3: 0, 4: 0, 5: 178, 6: 119, 7: 130, 8: 47, 9: 8}
Prototype-Based Model Correct Classifications (per class):
{0: 118, 1: 1, 2: 0, 3: 0, 4: 0, 5: 178, 6: 116, 7: 128, 8: 49, 9: 10}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 263, 1: 0, 2: 31, 3: 2, 4: 0, 5: 6, 6: 0, 7: 14, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 237, 1: 0, 2: 7, 3: 10, 4: 0, 5: 0, 6: 0, 7: 14, 8: 2, 9: 0}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 83, 1: 0, 2: 181, 3: 18, 4: 0, 5: 0, 6: 16, 7: 0, 8: 330, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 76, 1: 0, 2: 133, 3: 23, 4: 1, 5: 0, 6: 6, 7: 0, 8: 319, 9: 479}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 29, 1: 0, 2: 0, 3: 7, 4: 0, 5: 2, 6: 46, 7: 0, 8: 16, 9: 182}
Prototype-Based Model Correct Classifications (per class):
{0: 26, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 33, 7: 0, 8: 19, 9: 177}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 1, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 236, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 24, 1: 0, 2: 54, 3: 0, 4: 0, 5: 0, 6: 33, 7: 0, 8: 0, 9: 10}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 29, 1: 66, 2: 354, 3: 108, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 14, 1: 65, 2: 354, 3: 110, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 224, 1: 288, 2: 191, 3: 0, 4: 164, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 286, 2: 117, 3: 0, 4: 170, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 59, 1: 139, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 52, 1: 137, 2: 1, 3: 1, 4: 0, 5: 0, 6: 0, 7: 0, 8: 704, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 115, 1: 129, 2: 0, 3: 12, 4: 1, 5: 248, 6: 224, 7: 103, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 128, 1: 128, 2: 0, 3: 15, 4: 9, 5: 245, 6: 200, 7: 104, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 707, 2: 0, 3: 0, 4: 1148, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 238, 1: 0, 2: 55, 3: 65, 4: 0, 5: 59, 6: 0, 7: 275, 8: 0, 9: 98}
Prototype-Based Model Correct Classifications (per class):
{0: 216, 1: 0, 2: 33, 3: 68, 4: 0, 5: 58, 6: 0, 7: 242, 8: 0, 9: 102}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 25, 1: 140, 2: 226, 3: 1, 4: 49, 5: 75, 6: 0, 7: 23, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 22, 1: 135, 2: 229, 3: 4, 4: 43, 5: 84, 6: 1, 7: 0, 8: 14, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 143, 1: 120, 2: 135, 3: 0, 4: 2, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 143, 1: 120, 2: 135, 3: 0, 4: 0, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 90, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 96, 3: 820, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 339, 4: 34, 5: 0, 6: 248, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 353, 4: 55, 5: 0, 6: 192, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 96, 1: 70, 2: 193, 3: 188, 4: 13, 5: 5, 6: 27, 7: 441, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 100, 1: 69, 2: 185, 3: 182, 4: 13, 5: 10, 6: 5, 7: 433, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 8, 1: 14, 2: 0, 3: 10, 4: 115, 5: 50, 6: 17, 7: 28, 8: 45, 9: 268}
Prototype-Based Model Correct Classifications (per class):
{0: 14, 1: 15, 2: 0, 3: 10, 4: 86, 5: 50, 6: 28, 7: 32, 8: 44, 9: 262}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 0, 1: 24, 2: 0, 3: 91, 4: 0, 5: 0, 6: 186, 7: 43, 8: 17, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 17, 1: 25, 2: 0, 3: 94, 4: 6, 5: 0, 6: 68, 7: 37, 8: 18, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9445
Client 1: Regular Model Acc: 0.9376
Client 2: Regular Model Acc: 0.8703
Client 3: Regular Model Acc: 0.8251
Client 4: Regular Model Acc: 0.9381
Client 5: Regular Model Acc: 0.8704
Client 6: Regular Model Acc: 0.7259
Client 7: Regular Model Acc: 0.9446
Client 8: Regular Model Acc: 0.9165
Client 9: Regular Model Acc: 0.9710
Client 10: Regular Model Acc: 0.8577
Client 11: Regular Model Acc: 0.9920
Client 12: Regular Model Acc: 0.9261
Client 13: Regular Model Acc: 0.8338
Client 14: Regular Model Acc: 0.9548
Client 15: Regular Model Acc: 0.9713
Client 16: Regular Model Acc: 0.9393
Client 17: Regular Model Acc: 0.8523
Client 18: Regular Model Acc: 0.8685
Client 19: Regular Model Acc: 0.8167
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9189
Client 1: Prototype Model Acc: 0.9107
Client 2: Prototype Model Acc: 0.8746
Client 3: Prototype Model Acc: 0.7050
Client 4: Prototype Model Acc: 0.8796
Client 5: Prototype Model Acc: 0.8333
Client 6: Prototype Model Acc: 0.3528
Client 7: Prototype Model Acc: 0.9321
Client 8: Prototype Model Acc: 0.8457
Client 9: Prototype Model Acc: 0.9603
Client 10: Prototype Model Acc: 0.8546
Client 11: Prototype Model Acc: 0.9857
Client 12: Prototype Model Acc: 0.8429
Client 13: Prototype Model Acc: 0.8036
Client 14: Prototype Model Acc: 0.9528
Client 15: Prototype Model Acc: 0.9724
Client 16: Prototype Model Acc: 0.9228
Client 17: Prototype Model Acc: 0.8226
Client 18: Prototype Model Acc: 0.8466
Client 19: Prototype Model Acc: 0.6041
Averaged Test Accuracy (Regular Model): 0.9169
Averaged Test Accuracy (Prototype Model): 0.8791
Std Test Accuracy (Regular Model): 0.0651
Std Test Accuracy (Prototype Model): 0.1429
client.id trained 14
local_model_loss tensor(0.0877, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.1206, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.4795, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.4217, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.1542, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.1826, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.3293, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.1119, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.2902, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.1350, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.1395, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.1035, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.4569, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.1652, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.2423, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0471, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.4613, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.2188, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0940, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.3146, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 110.23886926309206
only_train_time: 966.4722567425342
all_clients_time_cost: 966.4722567425342
agg_protos_label dict_keys([2, 5, 0, 4, 1, 3, 7, 6, 8, 9])
-------------------------------------------------- 63.42316818237305

-------------Round number: 14-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 130, 1: 8, 2: 6, 3: 0, 4: 39, 5: 0, 6: 1, 7: 108, 8: 16, 9: 576}
Prototype-Based Model Correct Classifications (per class):
{0: 119, 1: 8, 2: 0, 3: 0, 4: 41, 5: 0, 6: 0, 7: 110, 8: 15, 9: 566}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 6, 6: 270, 7: 3, 8: 484, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 6, 6: 269, 7: 6, 8: 463, 9: 102}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 116, 1: 0, 2: 0, 3: 0, 4: 0, 5: 178, 6: 120, 7: 129, 8: 48, 9: 8}
Prototype-Based Model Correct Classifications (per class):
{0: 118, 1: 1, 2: 0, 3: 0, 4: 0, 5: 178, 6: 116, 7: 129, 8: 50, 9: 10}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 263, 1: 0, 2: 34, 3: 2, 4: 0, 5: 8, 6: 0, 7: 14, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 236, 1: 0, 2: 6, 3: 10, 4: 0, 5: 0, 6: 0, 7: 14, 8: 2, 9: 0}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 82, 1: 0, 2: 179, 3: 18, 4: 0, 5: 0, 6: 17, 7: 0, 8: 330, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 77, 1: 0, 2: 152, 3: 23, 4: 1, 5: 0, 6: 7, 7: 0, 8: 319, 9: 479}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 29, 1: 0, 2: 0, 3: 7, 4: 0, 5: 2, 6: 45, 7: 0, 8: 16, 9: 182}
Prototype-Based Model Correct Classifications (per class):
{0: 26, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 34, 7: 0, 8: 19, 9: 177}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 1, 1: 0, 2: 2, 3: 0, 4: 0, 5: 0, 6: 236, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 24, 1: 0, 2: 55, 3: 0, 4: 0, 5: 0, 6: 42, 7: 0, 8: 0, 9: 11}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 30, 1: 66, 2: 355, 3: 110, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 17, 1: 65, 2: 355, 3: 111, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 222, 1: 288, 2: 181, 3: 0, 4: 168, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 286, 2: 106, 3: 0, 4: 170, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 59, 1: 139, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 53, 1: 137, 2: 1, 3: 1, 4: 0, 5: 0, 6: 0, 7: 0, 8: 703, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 114, 1: 129, 2: 0, 3: 12, 4: 2, 5: 250, 6: 226, 7: 102, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 127, 1: 128, 2: 0, 3: 15, 4: 8, 5: 248, 6: 198, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 707, 2: 0, 3: 0, 4: 1149, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 239, 1: 0, 2: 55, 3: 65, 4: 0, 5: 59, 6: 0, 7: 281, 8: 0, 9: 95}
Prototype-Based Model Correct Classifications (per class):
{0: 218, 1: 0, 2: 36, 3: 68, 4: 0, 5: 57, 6: 0, 7: 260, 8: 0, 9: 102}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 26, 1: 140, 2: 228, 3: 1, 4: 51, 5: 74, 6: 0, 7: 23, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 23, 1: 135, 2: 230, 3: 4, 4: 45, 5: 84, 6: 1, 7: 2, 8: 14, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 145, 1: 120, 2: 134, 3: 0, 4: 5, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 143, 1: 120, 2: 135, 3: 0, 4: 0, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 92, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 97, 3: 820, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 348, 4: 43, 5: 0, 6: 236, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 356, 4: 60, 5: 0, 6: 178, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 94, 1: 70, 2: 193, 3: 188, 4: 15, 5: 5, 6: 33, 7: 441, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 103, 1: 69, 2: 180, 3: 182, 4: 15, 5: 10, 6: 6, 7: 433, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 10, 1: 14, 2: 0, 3: 10, 4: 112, 5: 48, 6: 22, 7: 29, 8: 45, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 14, 1: 15, 2: 0, 3: 12, 4: 80, 5: 49, 6: 26, 7: 36, 8: 45, 9: 265}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 0, 1: 24, 2: 0, 3: 82, 4: 0, 5: 0, 6: 195, 7: 43, 8: 16, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 9, 1: 24, 2: 0, 3: 91, 4: 6, 5: 0, 6: 75, 7: 43, 8: 19, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9434
Client 1: Regular Model Acc: 0.9397
Client 2: Regular Model Acc: 0.8732
Client 3: Regular Model Acc: 0.8381
Client 4: Regular Model Acc: 0.9364
Client 5: Regular Model Acc: 0.8673
Client 6: Regular Model Acc: 0.7318
Client 7: Regular Model Acc: 0.9482
Client 8: Regular Model Acc: 0.9080
Client 9: Regular Model Acc: 0.9710
Client 10: Regular Model Acc: 0.8608
Client 11: Regular Model Acc: 0.9920
Client 12: Regular Model Acc: 0.9308
Client 13: Regular Model Acc: 0.8399
Client 14: Regular Model Acc: 0.9589
Client 15: Regular Model Acc: 0.9735
Client 16: Regular Model Acc: 0.9445
Client 17: Regular Model Acc: 0.8573
Client 18: Regular Model Acc: 0.8779
Client 19: Regular Model Acc: 0.8145
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9168
Client 1: Prototype Model Acc: 0.9117
Client 2: Prototype Model Acc: 0.8776
Client 3: Prototype Model Acc: 0.6997
Client 4: Prototype Model Acc: 0.8974
Client 5: Prototype Model Acc: 0.8364
Client 6: Prototype Model Acc: 0.3848
Client 7: Prototype Model Acc: 0.9366
Client 8: Prototype Model Acc: 0.8340
Client 9: Prototype Model Acc: 0.9603
Client 10: Prototype Model Acc: 0.8526
Client 11: Prototype Model Acc: 0.9862
Client 12: Prototype Model Acc: 0.8687
Client 13: Prototype Model Acc: 0.8127
Client 14: Prototype Model Acc: 0.9528
Client 15: Prototype Model Acc: 0.9735
Client 16: Prototype Model Acc: 0.9176
Client 17: Prototype Model Acc: 0.8234
Client 18: Prototype Model Acc: 0.8482
Client 19: Prototype Model Acc: 0.6086
Averaged Test Accuracy (Regular Model): 0.9191
Averaged Test Accuracy (Prototype Model): 0.8821
Std Test Accuracy (Regular Model): 0.0637
Std Test Accuracy (Prototype Model): 0.1377
client.id trained 6
local_model_loss tensor(0.4445, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0457, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.1462, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.1304, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.2506, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0902, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0839, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.4082, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.2801, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.1654, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.1742, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.3208, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.1063, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.4442, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.3022, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.1161, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0983, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.2113, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.4406, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.1527, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 116.09639541816432
only_train_time: 1028.0631880015135
all_clients_time_cost: 1028.0631880015135
agg_protos_label dict_keys([6, 2, 7, 0, 9, 1, 4, 5, 8, 3])
-------------------------------------------------- 63.288625717163086

-------------Round number: 15-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 130, 1: 8, 2: 6, 3: 0, 4: 39, 5: 0, 6: 2, 7: 116, 8: 16, 9: 551}
Prototype-Based Model Correct Classifications (per class):
{0: 120, 1: 8, 2: 0, 3: 0, 4: 40, 5: 0, 6: 0, 7: 117, 8: 15, 9: 537}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 6, 6: 270, 7: 3, 8: 487, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 269, 7: 7, 8: 463, 9: 101}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 116, 1: 0, 2: 0, 3: 0, 4: 0, 5: 178, 6: 117, 7: 131, 8: 48, 9: 9}
Prototype-Based Model Correct Classifications (per class):
{0: 119, 1: 1, 2: 0, 3: 0, 4: 0, 5: 178, 6: 116, 7: 130, 8: 50, 9: 10}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 263, 1: 0, 2: 36, 3: 4, 4: 0, 5: 8, 6: 0, 7: 14, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 235, 1: 0, 2: 6, 3: 10, 4: 0, 5: 1, 6: 0, 7: 14, 8: 2, 9: 0}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 82, 1: 0, 2: 178, 3: 18, 4: 0, 5: 0, 6: 19, 7: 0, 8: 330, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 77, 1: 0, 2: 164, 3: 23, 4: 1, 5: 0, 6: 9, 7: 0, 8: 319, 9: 479}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 29, 1: 0, 2: 0, 3: 8, 4: 0, 5: 2, 6: 45, 7: 0, 8: 16, 9: 182}
Prototype-Based Model Correct Classifications (per class):
{0: 25, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 34, 7: 0, 8: 19, 9: 177}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 5, 1: 0, 2: 3, 3: 0, 4: 0, 5: 0, 6: 236, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 23, 1: 0, 2: 55, 3: 0, 4: 0, 5: 0, 6: 49, 7: 0, 8: 0, 9: 11}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 30, 1: 66, 2: 356, 3: 110, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 20, 1: 65, 2: 356, 3: 112, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 224, 1: 288, 2: 200, 3: 0, 4: 163, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 286, 2: 130, 3: 0, 4: 170, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 59, 1: 139, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 53, 1: 137, 2: 1, 3: 1, 4: 0, 5: 0, 6: 0, 7: 0, 8: 703, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 114, 1: 129, 2: 0, 3: 13, 4: 3, 5: 250, 6: 228, 7: 102, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 127, 1: 128, 2: 0, 3: 15, 4: 8, 5: 248, 6: 198, 7: 102, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 709, 2: 0, 3: 0, 4: 1149, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 239, 1: 0, 2: 55, 3: 65, 4: 0, 5: 58, 6: 0, 7: 290, 8: 0, 9: 90}
Prototype-Based Model Correct Classifications (per class):
{0: 220, 1: 0, 2: 50, 3: 68, 4: 0, 5: 57, 6: 0, 7: 276, 8: 0, 9: 96}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 26, 1: 140, 2: 230, 3: 1, 4: 51, 5: 75, 6: 0, 7: 23, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 23, 1: 135, 2: 231, 3: 3, 4: 45, 5: 84, 6: 1, 7: 3, 8: 14, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 145, 1: 120, 2: 134, 3: 0, 4: 6, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 143, 1: 120, 2: 135, 3: 0, 4: 0, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 96, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 98, 3: 820, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 350, 4: 47, 5: 0, 6: 224, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 355, 4: 60, 5: 0, 6: 170, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 93, 1: 70, 2: 192, 3: 189, 4: 15, 5: 5, 6: 41, 7: 441, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 104, 1: 69, 2: 178, 3: 182, 4: 15, 5: 10, 6: 7, 7: 433, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 10, 1: 14, 2: 0, 3: 10, 4: 114, 5: 49, 6: 21, 7: 29, 8: 45, 9: 268}
Prototype-Based Model Correct Classifications (per class):
{0: 14, 1: 15, 2: 0, 3: 12, 4: 82, 5: 49, 6: 28, 7: 33, 8: 45, 9: 261}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 3, 1: 25, 2: 0, 3: 92, 4: 0, 5: 0, 6: 184, 7: 43, 8: 17, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 17, 1: 26, 2: 0, 3: 94, 4: 6, 5: 0, 6: 69, 7: 43, 8: 18, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9264
Client 1: Regular Model Acc: 0.9429
Client 2: Regular Model Acc: 0.8732
Client 3: Regular Model Acc: 0.8486
Client 4: Regular Model Acc: 0.9372
Client 5: Regular Model Acc: 0.8704
Client 6: Regular Model Acc: 0.7464
Client 7: Regular Model Acc: 0.9491
Client 8: Regular Model Acc: 0.9249
Client 9: Regular Model Acc: 0.9710
Client 10: Regular Model Acc: 0.8649
Client 11: Regular Model Acc: 0.9920
Client 12: Regular Model Acc: 0.9343
Client 13: Regular Model Acc: 0.8444
Client 14: Regular Model Acc: 0.9600
Client 15: Regular Model Acc: 0.9777
Client 16: Regular Model Acc: 0.9393
Client 17: Regular Model Acc: 0.8630
Client 18: Regular Model Acc: 0.8764
Client 19: Regular Model Acc: 0.8235
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.8933
Client 1: Prototype Model Acc: 0.9107
Client 2: Prototype Model Acc: 0.8805
Client 3: Prototype Model Acc: 0.6997
Client 4: Prototype Model Acc: 0.9092
Client 5: Prototype Model Acc: 0.8333
Client 6: Prototype Model Acc: 0.4023
Client 7: Prototype Model Acc: 0.9410
Client 8: Prototype Model Acc: 0.8594
Client 9: Prototype Model Acc: 0.9603
Client 10: Prototype Model Acc: 0.8515
Client 11: Prototype Model Acc: 0.9872
Client 12: Prototype Model Acc: 0.8992
Client 13: Prototype Model Acc: 0.8142
Client 14: Prototype Model Acc: 0.9528
Client 15: Prototype Model Acc: 0.9745
Client 16: Prototype Model Acc: 0.9098
Client 17: Prototype Model Acc: 0.8234
Client 18: Prototype Model Acc: 0.8435
Client 19: Prototype Model Acc: 0.6222
Averaged Test Accuracy (Regular Model): 0.9210
Averaged Test Accuracy (Prototype Model): 0.8850
Std Test Accuracy (Regular Model): 0.0602
Std Test Accuracy (Prototype Model): 0.1339
client.id trained 14
local_model_loss tensor(0.0802, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.1016, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.1598, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.4350, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0443, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.1411, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.1251, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0867, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.2692, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.1298, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.4327, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.1634, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.2323, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.3132, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.4299, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.1259, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.3990, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.2890, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.1990, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0953, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 122.78494887414854
only_train_time: 1093.0622198492056
all_clients_time_cost: 1093.0622198492056
agg_protos_label dict_keys([2, 5, 0, 4, 1, 3, 7, 9, 6, 8])
Number of samples: 167
-------------------------------------------------- 67.95758605003357

-------------Round number: 16-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 130, 1: 8, 2: 6, 3: 0, 4: 39, 5: 0, 6: 2, 7: 108, 8: 16, 9: 577}
Prototype-Based Model Correct Classifications (per class):
{0: 116, 1: 8, 2: 0, 3: 0, 4: 42, 5: 0, 6: 0, 7: 110, 8: 16, 9: 568}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 6, 6: 270, 7: 3, 8: 488, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 271, 7: 6, 8: 464, 9: 101}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 116, 1: 0, 2: 0, 3: 0, 4: 0, 5: 178, 6: 123, 7: 129, 8: 48, 9: 10}
Prototype-Based Model Correct Classifications (per class):
{0: 119, 1: 1, 2: 0, 3: 0, 4: 0, 5: 178, 6: 118, 7: 128, 8: 50, 9: 10}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 263, 1: 0, 2: 37, 3: 6, 4: 0, 5: 8, 6: 0, 7: 14, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 235, 1: 0, 2: 5, 3: 10, 4: 0, 5: 1, 6: 0, 7: 14, 8: 2, 9: 0}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 81, 1: 1, 2: 176, 3: 18, 4: 0, 5: 0, 6: 21, 7: 0, 8: 330, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 76, 1: 0, 2: 171, 3: 23, 4: 0, 5: 0, 6: 12, 7: 0, 8: 319, 9: 479}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 29, 1: 0, 2: 0, 3: 8, 4: 0, 5: 3, 6: 46, 7: 0, 8: 16, 9: 182}
Prototype-Based Model Correct Classifications (per class):
{0: 25, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 35, 7: 0, 8: 19, 9: 177}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 5, 1: 0, 2: 5, 3: 0, 4: 0, 5: 0, 6: 236, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 23, 1: 0, 2: 55, 3: 0, 4: 0, 5: 0, 6: 55, 7: 0, 8: 0, 9: 11}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 30, 1: 66, 2: 357, 3: 109, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 23, 1: 63, 2: 356, 3: 115, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 224, 1: 288, 2: 204, 3: 0, 4: 162, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 287, 2: 127, 3: 0, 4: 170, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 60, 1: 139, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 53, 1: 138, 2: 1, 3: 1, 4: 0, 5: 0, 6: 0, 7: 0, 8: 702, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 113, 1: 129, 2: 0, 3: 14, 4: 3, 5: 250, 6: 228, 7: 102, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 127, 1: 129, 2: 0, 3: 16, 4: 8, 5: 249, 6: 200, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 710, 2: 0, 3: 0, 4: 1150, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 239, 1: 0, 2: 56, 3: 65, 4: 0, 5: 59, 6: 0, 7: 273, 8: 0, 9: 98}
Prototype-Based Model Correct Classifications (per class):
{0: 221, 1: 0, 2: 57, 3: 68, 4: 0, 5: 58, 6: 0, 7: 252, 8: 0, 9: 102}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 26, 1: 140, 2: 230, 3: 1, 4: 53, 5: 76, 6: 0, 7: 23, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 23, 1: 135, 2: 231, 3: 3, 4: 46, 5: 84, 6: 1, 7: 4, 8: 14, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 145, 1: 121, 2: 134, 3: 0, 4: 7, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 143, 1: 120, 2: 135, 3: 0, 4: 1, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 1, 1: 0, 2: 97, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 98, 3: 820, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 343, 4: 40, 5: 0, 6: 246, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 353, 4: 56, 5: 0, 6: 198, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 93, 1: 69, 2: 192, 3: 189, 4: 16, 5: 5, 6: 46, 7: 441, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 104, 1: 69, 2: 179, 3: 183, 4: 15, 5: 10, 6: 6, 7: 432, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 10, 1: 14, 2: 0, 3: 10, 4: 115, 5: 53, 6: 18, 7: 29, 8: 45, 9: 268}
Prototype-Based Model Correct Classifications (per class):
{0: 14, 1: 15, 2: 0, 3: 12, 4: 86, 5: 51, 6: 27, 7: 33, 8: 45, 9: 260}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 3, 1: 25, 2: 0, 3: 90, 4: 0, 5: 0, 6: 187, 7: 43, 8: 17, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 17, 1: 26, 2: 0, 3: 94, 4: 6, 5: 0, 6: 70, 7: 43, 8: 19, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9456
Client 1: Regular Model Acc: 0.9440
Client 2: Regular Model Acc: 0.8805
Client 3: Regular Model Acc: 0.8564
Client 4: Regular Model Acc: 0.9372
Client 5: Regular Model Acc: 0.8765
Client 6: Regular Model Acc: 0.7522
Client 7: Regular Model Acc: 0.9491
Client 8: Regular Model Acc: 0.9281
Client 9: Regular Model Acc: 0.9721
Client 10: Regular Model Acc: 0.8649
Client 11: Regular Model Acc: 0.9920
Client 12: Regular Model Acc: 0.9261
Client 13: Regular Model Acc: 0.8489
Client 14: Regular Model Acc: 0.9620
Client 15: Regular Model Acc: 0.9798
Client 16: Regular Model Acc: 0.9462
Client 17: Regular Model Acc: 0.8672
Client 18: Regular Model Acc: 0.8795
Client 19: Regular Model Acc: 0.8258
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9178
Client 1: Prototype Model Acc: 0.9128
Client 2: Prototype Model Acc: 0.8805
Client 3: Prototype Model Acc: 0.6971
Client 4: Prototype Model Acc: 0.9160
Client 5: Prototype Model Acc: 0.8364
Client 6: Prototype Model Acc: 0.4198
Client 7: Prototype Model Acc: 0.9446
Client 8: Prototype Model Acc: 0.8573
Client 9: Prototype Model Acc: 0.9603
Client 10: Prototype Model Acc: 0.8577
Client 11: Prototype Model Acc: 0.9883
Client 12: Prototype Model Acc: 0.8886
Client 13: Prototype Model Acc: 0.8172
Client 14: Prototype Model Acc: 0.9538
Client 15: Prototype Model Acc: 0.9745
Client 16: Prototype Model Acc: 0.9289
Client 17: Prototype Model Acc: 0.8234
Client 18: Prototype Model Acc: 0.8498
Client 19: Prototype Model Acc: 0.6267
Averaged Test Accuracy (Regular Model): 0.9239
Averaged Test Accuracy (Prototype Model): 0.8890
Std Test Accuracy (Regular Model): 0.0591
Std Test Accuracy (Prototype Model): 0.1320
client.id trained 7
local_model_loss tensor(0.0977, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.4224, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.1405, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.2153, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.1216, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.1530, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.1355, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0834, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0765, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.2834, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.4377, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.3916, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.4248, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.3057, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.1964, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.2578, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0431, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0874, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.1333, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.1063, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 130.66852972120978
only_train_time: 1155.7078451394336
all_clients_time_cost: 1155.7078451394336
agg_protos_label dict_keys([2, 5, 1, 0, 3, 4, 7, 6, 8, 9])
-------------------------------------------------- 64.13100910186768

-------------Round number: 17-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 130, 1: 8, 2: 6, 3: 0, 4: 39, 5: 0, 6: 2, 7: 112, 8: 16, 9: 560}
Prototype-Based Model Correct Classifications (per class):
{0: 116, 1: 8, 2: 1, 3: 0, 4: 41, 5: 0, 6: 0, 7: 115, 8: 15, 9: 551}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 6, 6: 270, 7: 4, 8: 489, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 271, 7: 6, 8: 464, 9: 100}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 122, 1: 0, 2: 0, 3: 0, 4: 0, 5: 179, 6: 110, 7: 125, 8: 47, 9: 10}
Prototype-Based Model Correct Classifications (per class):
{0: 123, 1: 1, 2: 0, 3: 0, 4: 0, 5: 179, 6: 106, 7: 124, 8: 48, 9: 10}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 264, 1: 0, 2: 37, 3: 6, 4: 0, 5: 8, 6: 0, 7: 14, 8: 1, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 233, 1: 0, 2: 5, 3: 10, 4: 0, 5: 1, 6: 0, 7: 14, 8: 2, 9: 0}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 80, 1: 1, 2: 183, 3: 18, 4: 0, 5: 0, 6: 14, 7: 0, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 75, 1: 0, 2: 180, 3: 23, 4: 0, 5: 0, 6: 6, 7: 0, 8: 322, 9: 479}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 29, 1: 0, 2: 0, 3: 8, 4: 0, 5: 3, 6: 46, 7: 0, 8: 16, 9: 182}
Prototype-Based Model Correct Classifications (per class):
{0: 25, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 37, 7: 0, 8: 18, 9: 177}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 5, 1: 0, 2: 5, 3: 0, 4: 0, 5: 0, 6: 236, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 23, 1: 0, 2: 53, 3: 0, 4: 0, 5: 0, 6: 66, 7: 0, 8: 0, 9: 11}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 29, 1: 66, 2: 357, 3: 112, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 25, 1: 63, 2: 357, 3: 116, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 224, 1: 288, 2: 198, 3: 0, 4: 163, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 288, 2: 128, 3: 0, 4: 170, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 60, 1: 139, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 53, 1: 138, 2: 1, 3: 1, 4: 0, 5: 0, 6: 0, 7: 0, 8: 702, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 112, 1: 129, 2: 0, 3: 14, 4: 4, 5: 250, 6: 229, 7: 102, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 127, 1: 129, 2: 0, 3: 16, 4: 8, 5: 249, 6: 201, 7: 102, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 711, 2: 0, 3: 0, 4: 1150, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 239, 1: 0, 2: 56, 3: 66, 4: 0, 5: 59, 6: 0, 7: 282, 8: 0, 9: 95}
Prototype-Based Model Correct Classifications (per class):
{0: 221, 1: 0, 2: 58, 3: 68, 4: 0, 5: 57, 6: 0, 7: 265, 8: 0, 9: 99}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 25, 1: 140, 2: 227, 3: 1, 4: 53, 5: 76, 6: 0, 7: 23, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 23, 1: 135, 2: 229, 3: 3, 4: 47, 5: 84, 6: 1, 7: 7, 8: 14, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 145, 1: 122, 2: 133, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 143, 1: 120, 2: 134, 3: 0, 4: 4, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 3, 1: 0, 2: 97, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 98, 3: 821, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 346, 4: 44, 5: 0, 6: 239, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 355, 4: 58, 5: 0, 6: 188, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 94, 1: 69, 2: 192, 3: 188, 4: 18, 5: 5, 6: 54, 7: 441, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 104, 1: 69, 2: 178, 3: 183, 4: 15, 5: 10, 6: 8, 7: 432, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 11, 1: 14, 2: 0, 3: 10, 4: 113, 5: 51, 6: 23, 7: 29, 8: 46, 9: 269}
Prototype-Based Model Correct Classifications (per class):
{0: 14, 1: 15, 2: 0, 3: 13, 4: 85, 5: 51, 6: 28, 7: 35, 8: 45, 9: 262}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 0, 1: 24, 2: 0, 3: 82, 4: 0, 5: 0, 6: 195, 7: 43, 8: 18, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 13, 1: 24, 2: 0, 3: 92, 4: 6, 5: 0, 6: 79, 7: 43, 8: 19, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9317
Client 1: Regular Model Acc: 0.9462
Client 2: Regular Model Acc: 0.8644
Client 3: Regular Model Acc: 0.8616
Client 4: Regular Model Acc: 0.9372
Client 5: Regular Model Acc: 0.8765
Client 6: Regular Model Acc: 0.7522
Client 7: Regular Model Acc: 0.9508
Client 8: Regular Model Acc: 0.9228
Client 9: Regular Model Acc: 0.9721
Client 10: Regular Model Acc: 0.8660
Client 11: Regular Model Acc: 0.9920
Client 12: Regular Model Acc: 0.9343
Client 13: Regular Model Acc: 0.8429
Client 14: Regular Model Acc: 0.9641
Client 15: Regular Model Acc: 0.9820
Client 16: Regular Model Acc: 0.9462
Client 17: Regular Model Acc: 0.8754
Client 18: Regular Model Acc: 0.8858
Client 19: Regular Model Acc: 0.8190
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9039
Client 1: Prototype Model Acc: 0.9117
Client 2: Prototype Model Acc: 0.8615
Client 3: Prototype Model Acc: 0.6919
Client 4: Prototype Model Acc: 0.9203
Client 5: Prototype Model Acc: 0.8395
Client 6: Prototype Model Acc: 0.4461
Client 7: Prototype Model Acc: 0.9482
Client 8: Prototype Model Acc: 0.8594
Client 9: Prototype Model Acc: 0.9603
Client 10: Prototype Model Acc: 0.8577
Client 11: Prototype Model Acc: 0.9888
Client 12: Prototype Model Acc: 0.9004
Client 13: Prototype Model Acc: 0.8202
Client 14: Prototype Model Acc: 0.9559
Client 15: Prototype Model Acc: 0.9756
Client 16: Prototype Model Acc: 0.9237
Client 17: Prototype Model Acc: 0.8243
Client 18: Prototype Model Acc: 0.8576
Client 19: Prototype Model Acc: 0.6290
Averaged Test Accuracy (Regular Model): 0.9237
Averaged Test Accuracy (Prototype Model): 0.8895
Std Test Accuracy (Regular Model): 0.0598
Std Test Accuracy (Prototype Model): 0.1278
client.id trained 8
local_model_loss tensor(0.1306, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.1052, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.1176, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.4043, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0802, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.2468, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0418, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.4017, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.3721, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.2988, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.2657, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.1453, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.2006, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.1037, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.4125, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.2677, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0847, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.1302, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.1214, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0730, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 137.23679213726427
only_train_time: 1218.4698193094227
all_clients_time_cost: 1218.4698193094227
agg_protos_label dict_keys([0, 1, 2, 4, 3, 5, 8, 6, 9, 7])
-------------------------------------------------- 64.40397262573242

-------------Round number: 18-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 130, 1: 8, 2: 6, 3: 0, 4: 39, 5: 0, 6: 2, 7: 108, 8: 16, 9: 576}
Prototype-Based Model Correct Classifications (per class):
{0: 116, 1: 8, 2: 1, 3: 0, 4: 42, 5: 0, 6: 0, 7: 110, 8: 16, 9: 569}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 6, 6: 271, 7: 4, 8: 489, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 5, 6: 271, 7: 6, 8: 463, 9: 100}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 110, 1: 0, 2: 0, 3: 0, 4: 0, 5: 173, 6: 140, 7: 132, 8: 47, 9: 9}
Prototype-Based Model Correct Classifications (per class):
{0: 113, 1: 1, 2: 0, 3: 0, 4: 0, 5: 173, 6: 127, 7: 133, 8: 50, 9: 10}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 264, 1: 0, 2: 38, 3: 6, 4: 0, 5: 8, 6: 0, 7: 14, 8: 1, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 235, 1: 0, 2: 5, 3: 10, 4: 0, 5: 1, 6: 0, 7: 14, 8: 2, 9: 0}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 81, 1: 1, 2: 180, 3: 18, 4: 0, 5: 0, 6: 19, 7: 0, 8: 329, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 76, 1: 0, 2: 181, 3: 23, 4: 0, 5: 0, 6: 9, 7: 0, 8: 320, 9: 479}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 28, 1: 0, 2: 0, 3: 8, 4: 0, 5: 4, 6: 47, 7: 0, 8: 16, 9: 182}
Prototype-Based Model Correct Classifications (per class):
{0: 26, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 37, 7: 0, 8: 18, 9: 178}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 5, 1: 0, 2: 11, 3: 0, 4: 0, 5: 0, 6: 235, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 23, 1: 0, 2: 54, 3: 0, 4: 0, 5: 0, 6: 71, 7: 0, 8: 0, 9: 11}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 31, 1: 66, 2: 356, 3: 114, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 25, 1: 64, 2: 358, 3: 116, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 223, 1: 288, 2: 195, 3: 0, 4: 165, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 288, 2: 122, 3: 0, 4: 170, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 60, 1: 139, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 55, 1: 138, 2: 1, 3: 1, 4: 0, 5: 0, 6: 0, 7: 0, 8: 702, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 110, 1: 129, 2: 0, 3: 15, 4: 5, 5: 250, 6: 229, 7: 102, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 127, 1: 129, 2: 0, 3: 16, 4: 8, 5: 249, 6: 204, 7: 102, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 712, 2: 0, 3: 0, 4: 1152, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 238, 1: 0, 2: 56, 3: 66, 4: 0, 5: 58, 6: 0, 7: 284, 8: 0, 9: 95}
Prototype-Based Model Correct Classifications (per class):
{0: 222, 1: 0, 2: 58, 3: 68, 4: 0, 5: 57, 6: 0, 7: 267, 8: 0, 9: 99}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 25, 1: 140, 2: 226, 3: 1, 4: 56, 5: 75, 6: 0, 7: 23, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 24, 1: 136, 2: 227, 3: 3, 4: 48, 5: 84, 6: 1, 7: 10, 8: 14, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 145, 1: 122, 2: 133, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 144, 1: 120, 2: 134, 3: 0, 4: 4, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 4, 1: 0, 2: 97, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 98, 3: 821, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 345, 4: 44, 5: 0, 6: 243, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 354, 4: 58, 5: 0, 6: 190, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 95, 1: 69, 2: 195, 3: 187, 4: 14, 5: 5, 6: 49, 7: 441, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 104, 1: 69, 2: 178, 3: 183, 4: 16, 5: 10, 6: 7, 7: 432, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 11, 1: 15, 2: 0, 3: 10, 4: 112, 5: 51, 6: 25, 7: 29, 8: 46, 9: 269}
Prototype-Based Model Correct Classifications (per class):
{0: 14, 1: 15, 2: 0, 3: 13, 4: 86, 5: 52, 6: 28, 7: 35, 8: 45, 9: 262}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 10, 1: 25, 2: 0, 3: 91, 4: 0, 5: 0, 6: 184, 7: 43, 8: 17, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 18, 1: 26, 2: 0, 3: 93, 4: 6, 5: 0, 6: 77, 7: 43, 8: 19, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9445
Client 1: Regular Model Acc: 0.9473
Client 2: Regular Model Acc: 0.8907
Client 3: Regular Model Acc: 0.8642
Client 4: Regular Model Acc: 0.9381
Client 5: Regular Model Acc: 0.8796
Client 6: Regular Model Acc: 0.7668
Client 7: Regular Model Acc: 0.9535
Client 8: Regular Model Acc: 0.9207
Client 9: Regular Model Acc: 0.9721
Client 10: Regular Model Acc: 0.8660
Client 11: Regular Model Acc: 0.9920
Client 12: Regular Model Acc: 0.9343
Client 13: Regular Model Acc: 0.8444
Client 14: Regular Model Acc: 0.9641
Client 15: Regular Model Acc: 0.9841
Client 16: Regular Model Acc: 0.9488
Client 17: Regular Model Acc: 0.8705
Client 18: Regular Model Acc: 0.8889
Client 19: Regular Model Acc: 0.8371
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9200
Client 1: Prototype Model Acc: 0.9096
Client 2: Prototype Model Acc: 0.8848
Client 3: Prototype Model Acc: 0.6971
Client 4: Prototype Model Acc: 0.9228
Client 5: Prototype Model Acc: 0.8457
Client 6: Prototype Model Acc: 0.4636
Client 7: Prototype Model Acc: 0.9500
Client 8: Prototype Model Acc: 0.8531
Client 9: Prototype Model Acc: 0.9624
Client 10: Prototype Model Acc: 0.8608
Client 11: Prototype Model Acc: 0.9904
Client 12: Prototype Model Acc: 0.9039
Client 13: Prototype Model Acc: 0.8263
Client 14: Prototype Model Acc: 0.9569
Client 15: Prototype Model Acc: 0.9756
Client 16: Prototype Model Acc: 0.9245
Client 17: Prototype Model Acc: 0.8243
Client 18: Prototype Model Acc: 0.8607
Client 19: Prototype Model Acc: 0.6425
Averaged Test Accuracy (Regular Model): 0.9265
Averaged Test Accuracy (Prototype Model): 0.8931
Std Test Accuracy (Regular Model): 0.0565
Std Test Accuracy (Prototype Model): 0.1242
client.id trained 17
local_model_loss tensor(0.2651, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.1248, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.4030, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.2375, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.4018, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.3512, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0697, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0407, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0914, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0957, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.1484, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.2928, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0773, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.1470, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.1138, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0828, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.3991, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.2139, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.1160, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.1899, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 146.58240706729703
only_train_time: 1284.9602119736373
all_clients_time_cost: 1284.9602119736373
agg_protos_label dict_keys([7, 6, 2, 1, 3, 4, 0, 5, 9, 8])
-------------------------------------------------- 68.07374382019043

-------------Round number: 19-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 131, 1: 8, 2: 6, 3: 0, 4: 38, 5: 0, 6: 2, 7: 108, 8: 16, 9: 576}
Prototype-Based Model Correct Classifications (per class):
{0: 116, 1: 8, 2: 1, 3: 0, 4: 42, 5: 0, 6: 0, 7: 110, 8: 16, 9: 571}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 6, 6: 271, 7: 4, 8: 490, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 5, 6: 272, 7: 6, 8: 464, 9: 100}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 112, 1: 0, 2: 0, 3: 0, 4: 0, 5: 177, 6: 136, 7: 132, 8: 48, 9: 10}
Prototype-Based Model Correct Classifications (per class):
{0: 113, 1: 1, 2: 0, 3: 0, 4: 0, 5: 178, 6: 127, 7: 131, 8: 50, 9: 10}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 264, 1: 0, 2: 38, 3: 7, 4: 0, 5: 8, 6: 0, 7: 14, 8: 1, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 235, 1: 0, 2: 4, 3: 10, 4: 0, 5: 1, 6: 0, 7: 14, 8: 2, 9: 0}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 81, 1: 2, 2: 179, 3: 18, 4: 0, 5: 0, 6: 19, 7: 0, 8: 329, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 75, 1: 1, 2: 182, 3: 23, 4: 0, 5: 0, 6: 9, 7: 0, 8: 323, 9: 479}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 28, 1: 0, 2: 0, 3: 8, 4: 0, 5: 4, 6: 47, 7: 0, 8: 16, 9: 182}
Prototype-Based Model Correct Classifications (per class):
{0: 26, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 37, 7: 0, 8: 18, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 5, 1: 0, 2: 13, 3: 0, 4: 0, 5: 0, 6: 234, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 23, 1: 0, 2: 55, 3: 0, 4: 0, 5: 0, 6: 68, 7: 0, 8: 0, 9: 11}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 29, 1: 66, 2: 357, 3: 114, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 25, 1: 63, 2: 357, 3: 115, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 224, 1: 288, 2: 206, 3: 0, 4: 162, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 288, 2: 144, 3: 0, 4: 170, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 60, 1: 139, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 55, 1: 138, 2: 1, 3: 1, 4: 0, 5: 0, 6: 0, 7: 0, 8: 702, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 110, 1: 129, 2: 0, 3: 15, 4: 5, 5: 250, 6: 229, 7: 102, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 127, 1: 129, 2: 0, 3: 16, 4: 7, 5: 249, 6: 206, 7: 102, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 712, 2: 0, 3: 0, 4: 1152, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 237, 1: 0, 2: 56, 3: 66, 4: 0, 5: 58, 6: 0, 7: 288, 8: 0, 9: 88}
Prototype-Based Model Correct Classifications (per class):
{0: 222, 1: 0, 2: 59, 3: 68, 4: 0, 5: 57, 6: 0, 7: 278, 8: 0, 9: 96}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 26, 1: 139, 2: 235, 3: 2, 4: 49, 5: 78, 6: 0, 7: 22, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 24, 1: 135, 2: 233, 3: 3, 4: 46, 5: 84, 6: 1, 7: 6, 8: 14, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 145, 1: 122, 2: 131, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 144, 1: 120, 2: 133, 3: 0, 4: 6, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 4, 1: 0, 2: 96, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 98, 3: 823, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 349, 4: 50, 5: 0, 6: 229, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 355, 4: 59, 5: 0, 6: 177, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 96, 1: 69, 2: 193, 3: 188, 4: 18, 5: 5, 6: 58, 7: 441, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 104, 1: 69, 2: 177, 3: 183, 4: 16, 5: 10, 6: 10, 7: 432, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 10, 1: 14, 2: 0, 3: 10, 4: 116, 5: 52, 6: 19, 7: 29, 8: 46, 9: 269}
Prototype-Based Model Correct Classifications (per class):
{0: 14, 1: 15, 2: 0, 3: 13, 4: 89, 5: 52, 6: 27, 7: 34, 8: 46, 9: 261}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 11, 1: 25, 2: 0, 3: 90, 4: 0, 5: 0, 6: 184, 7: 43, 8: 17, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 18, 1: 26, 2: 0, 3: 93, 4: 6, 5: 0, 6: 79, 7: 43, 8: 19, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9445
Client 1: Regular Model Acc: 0.9483
Client 2: Regular Model Acc: 0.8965
Client 3: Regular Model Acc: 0.8668
Client 4: Regular Model Acc: 0.9381
Client 5: Regular Model Acc: 0.8796
Client 6: Regular Model Acc: 0.7697
Client 7: Regular Model Acc: 0.9526
Client 8: Regular Model Acc: 0.9302
Client 9: Regular Model Acc: 0.9721
Client 10: Regular Model Acc: 0.8660
Client 11: Regular Model Acc: 0.9920
Client 12: Regular Model Acc: 0.9297
Client 13: Regular Model Acc: 0.8520
Client 14: Regular Model Acc: 0.9620
Client 15: Regular Model Acc: 0.9830
Client 16: Regular Model Acc: 0.9454
Client 17: Regular Model Acc: 0.8812
Client 18: Regular Model Acc: 0.8842
Client 19: Regular Model Acc: 0.8371
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9221
Client 1: Prototype Model Acc: 0.9117
Client 2: Prototype Model Acc: 0.8892
Client 3: Prototype Model Acc: 0.6945
Client 4: Prototype Model Acc: 0.9262
Client 5: Prototype Model Acc: 0.8488
Client 6: Prototype Model Acc: 0.4577
Client 7: Prototype Model Acc: 0.9473
Client 8: Prototype Model Acc: 0.8763
Client 9: Prototype Model Acc: 0.9624
Client 10: Prototype Model Acc: 0.8619
Client 11: Prototype Model Acc: 0.9904
Client 12: Prototype Model Acc: 0.9144
Client 13: Prototype Model Acc: 0.8248
Client 14: Prototype Model Acc: 0.9579
Client 15: Prototype Model Acc: 0.9777
Client 16: Prototype Model Acc: 0.9150
Client 17: Prototype Model Acc: 0.8259
Client 18: Prototype Model Acc: 0.8623
Client 19: Prototype Model Acc: 0.6471
Averaged Test Accuracy (Regular Model): 0.9276
Averaged Test Accuracy (Prototype Model): 0.8951
Std Test Accuracy (Regular Model): 0.0551
Std Test Accuracy (Prototype Model): 0.1252
client.id trained 13
local_model_loss tensor(0.3766, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0665, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0756, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.2452, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.3941, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.1179, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.1819, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.4110, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.1718, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0396, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.1545, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0744, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.3757, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.2868, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.2269, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.1211, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.1192, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0880, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0996, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.1098, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 154.23499850125518
only_train_time: 1348.9984951127553
all_clients_time_cost: 1348.9984951127553
agg_protos_label dict_keys([5, 0, 4, 6, 2, 1, 7, 8, 3, 9])
Number of samples: 167
-------------------------------------------------- 66.90088844299316

-------------Round number: 20-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 131, 1: 8, 2: 6, 3: 0, 4: 38, 5: 0, 6: 3, 7: 113, 8: 16, 9: 562}
Prototype-Based Model Correct Classifications (per class):
{0: 116, 1: 8, 2: 1, 3: 0, 4: 40, 5: 0, 6: 0, 7: 114, 8: 16, 9: 555}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 6, 6: 271, 7: 4, 8: 490, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 5, 6: 272, 7: 6, 8: 465, 9: 100}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 102, 1: 0, 2: 0, 3: 0, 4: 0, 5: 176, 6: 143, 7: 132, 8: 49, 9: 10}
Prototype-Based Model Correct Classifications (per class):
{0: 107, 1: 1, 2: 0, 3: 0, 4: 0, 5: 176, 6: 138, 7: 130, 8: 50, 9: 10}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 264, 1: 0, 2: 38, 3: 7, 4: 0, 5: 8, 6: 0, 7: 14, 8: 1, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 235, 1: 0, 2: 5, 3: 10, 4: 0, 5: 1, 6: 0, 7: 14, 8: 2, 9: 0}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 80, 1: 2, 2: 178, 3: 18, 4: 0, 5: 0, 6: 19, 7: 0, 8: 329, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 76, 1: 1, 2: 182, 3: 23, 4: 0, 5: 0, 6: 10, 7: 0, 8: 323, 9: 479}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 28, 1: 0, 2: 0, 3: 8, 4: 0, 5: 4, 6: 47, 7: 0, 8: 16, 9: 182}
Prototype-Based Model Correct Classifications (per class):
{0: 26, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 38, 7: 0, 8: 18, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 5, 1: 0, 2: 15, 3: 0, 4: 0, 5: 0, 6: 234, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 23, 1: 0, 2: 52, 3: 0, 4: 0, 5: 0, 6: 97, 7: 0, 8: 0, 9: 11}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 30, 1: 67, 2: 358, 3: 114, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 26, 1: 63, 2: 357, 3: 117, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 224, 1: 288, 2: 204, 3: 0, 4: 162, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 288, 2: 132, 3: 0, 4: 170, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 60, 1: 139, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 56, 1: 138, 2: 1, 3: 1, 4: 1, 5: 0, 6: 0, 7: 0, 8: 702, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 110, 1: 130, 2: 0, 3: 15, 4: 5, 5: 251, 6: 230, 7: 102, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 127, 1: 129, 2: 0, 3: 16, 4: 7, 5: 249, 6: 207, 7: 102, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 712, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 238, 1: 0, 2: 57, 3: 66, 4: 0, 5: 61, 6: 0, 7: 259, 8: 0, 9: 99}
Prototype-Based Model Correct Classifications (per class):
{0: 222, 1: 0, 2: 59, 3: 68, 4: 0, 5: 59, 6: 0, 7: 242, 8: 0, 9: 102}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 26, 1: 138, 2: 236, 3: 2, 4: 49, 5: 81, 6: 0, 7: 22, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 24, 1: 135, 2: 234, 3: 3, 4: 45, 5: 84, 6: 1, 7: 6, 8: 14, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 145, 1: 122, 2: 131, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 143, 1: 120, 2: 133, 3: 0, 4: 6, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 4, 1: 0, 2: 98, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 98, 3: 823, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 343, 4: 41, 5: 0, 6: 247, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 351, 4: 57, 5: 0, 6: 202, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 97, 1: 69, 2: 196, 3: 182, 4: 11, 5: 4, 6: 42, 7: 441, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 103, 1: 69, 2: 182, 3: 184, 4: 16, 5: 10, 6: 8, 7: 432, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 110, 5: 50, 6: 33, 7: 31, 8: 46, 9: 269}
Prototype-Based Model Correct Classifications (per class):
{0: 14, 1: 15, 2: 0, 3: 13, 4: 76, 5: 52, 6: 28, 7: 35, 8: 46, 9: 262}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 3, 1: 25, 2: 0, 3: 85, 4: 0, 5: 0, 6: 192, 7: 43, 8: 18, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 17, 1: 24, 2: 0, 3: 92, 4: 6, 5: 0, 6: 82, 7: 43, 8: 20, 9: 1}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9360
Client 1: Regular Model Acc: 0.9483
Client 2: Regular Model Acc: 0.8921
Client 3: Regular Model Acc: 0.8668
Client 4: Regular Model Acc: 0.9364
Client 5: Regular Model Acc: 0.8796
Client 6: Regular Model Acc: 0.7755
Client 7: Regular Model Acc: 0.9553
Client 8: Regular Model Acc: 0.9281
Client 9: Regular Model Acc: 0.9721
Client 10: Regular Model Acc: 0.8691
Client 11: Regular Model Acc: 0.9920
Client 12: Regular Model Acc: 0.9144
Client 13: Regular Model Acc: 0.8565
Client 14: Regular Model Acc: 0.9620
Client 15: Regular Model Acc: 0.9851
Client 16: Regular Model Acc: 0.9480
Client 17: Regular Model Acc: 0.8597
Client 18: Regular Model Acc: 0.9045
Client 19: Regular Model Acc: 0.8281
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9072
Client 1: Prototype Model Acc: 0.9128
Client 2: Prototype Model Acc: 0.8921
Client 3: Prototype Model Acc: 0.6971
Client 4: Prototype Model Acc: 0.9279
Client 5: Prototype Model Acc: 0.8519
Client 6: Prototype Model Acc: 0.5335
Client 7: Prototype Model Acc: 0.9500
Client 8: Prototype Model Acc: 0.8636
Client 9: Prototype Model Acc: 0.9646
Client 10: Prototype Model Acc: 0.8629
Client 11: Prototype Model Acc: 0.9910
Client 12: Prototype Model Acc: 0.8816
Client 13: Prototype Model Acc: 0.8248
Client 14: Prototype Model Acc: 0.9569
Client 15: Prototype Model Acc: 0.9777
Client 16: Prototype Model Acc: 0.9315
Client 17: Prototype Model Acc: 0.8284
Client 18: Prototype Model Acc: 0.8466
Client 19: Prototype Model Acc: 0.6448
Averaged Test Accuracy (Regular Model): 0.9260
Averaged Test Accuracy (Prototype Model): 0.8948
Std Test Accuracy (Regular Model): 0.0551
Std Test Accuracy (Prototype Model): 0.1135
client.id trained 4
local_model_loss tensor(0.1108, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.3683, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.1260, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.2451, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.1741, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.2809, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.2153, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0873, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0716, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.1061, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.3602, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.1725, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0386, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0634, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.3411, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0723, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0855, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.1087, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.1278, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.3856, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 160.76354629115667
only_train_time: 1411.82824882376
all_clients_time_cost: 1411.82824882376
agg_protos_label dict_keys([9, 8, 0, 2, 6, 3, 7, 4, 1, 5])
-------------------------------------------------- 64.44871783256531

-------------Round number: 21-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 131, 1: 8, 2: 6, 3: 0, 4: 38, 5: 0, 6: 2, 7: 108, 8: 16, 9: 577}
Prototype-Based Model Correct Classifications (per class):
{0: 115, 1: 8, 2: 1, 3: 0, 4: 41, 5: 0, 6: 1, 7: 110, 8: 16, 9: 571}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 5, 6: 271, 7: 4, 8: 490, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 6, 8: 467, 9: 100}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 104, 1: 0, 2: 0, 3: 0, 4: 0, 5: 176, 6: 143, 7: 132, 8: 49, 9: 10}
Prototype-Based Model Correct Classifications (per class):
{0: 107, 1: 1, 2: 0, 3: 0, 4: 0, 5: 176, 6: 137, 7: 130, 8: 50, 9: 10}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 264, 1: 0, 2: 38, 3: 7, 4: 0, 5: 8, 6: 0, 7: 14, 8: 1, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 235, 1: 0, 2: 4, 3: 10, 4: 0, 5: 1, 6: 0, 7: 14, 8: 2, 9: 0}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 80, 1: 2, 2: 176, 3: 19, 4: 0, 5: 0, 6: 20, 7: 0, 8: 330, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 1, 2: 180, 3: 23, 4: 0, 5: 0, 6: 13, 7: 0, 8: 323, 9: 479}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 28, 1: 0, 2: 0, 3: 8, 4: 0, 5: 4, 6: 47, 7: 0, 8: 16, 9: 182}
Prototype-Based Model Correct Classifications (per class):
{0: 26, 1: 0, 2: 0, 3: 9, 4: 0, 5: 5, 6: 37, 7: 0, 8: 19, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 5, 1: 0, 2: 31, 3: 0, 4: 0, 5: 0, 6: 230, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 21, 1: 0, 2: 58, 3: 0, 4: 0, 5: 0, 6: 40, 7: 0, 8: 0, 9: 12}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 30, 1: 67, 2: 358, 3: 114, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 28, 1: 64, 2: 357, 3: 117, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 224, 1: 288, 2: 207, 3: 0, 4: 161, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 288, 2: 143, 3: 0, 4: 170, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 60, 1: 139, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 57, 1: 138, 2: 2, 3: 1, 4: 1, 5: 0, 6: 0, 7: 0, 8: 702, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 110, 1: 130, 2: 0, 3: 15, 4: 5, 5: 251, 6: 231, 7: 102, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 127, 1: 129, 2: 0, 3: 18, 4: 7, 5: 249, 6: 207, 7: 102, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 712, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 238, 1: 0, 2: 57, 3: 66, 4: 0, 5: 59, 6: 0, 7: 283, 8: 0, 9: 95}
Prototype-Based Model Correct Classifications (per class):
{0: 223, 1: 0, 2: 59, 3: 68, 4: 0, 5: 58, 6: 0, 7: 266, 8: 0, 9: 99}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 27, 1: 138, 2: 251, 3: 3, 4: 38, 5: 83, 6: 0, 7: 21, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 24, 1: 135, 2: 245, 3: 4, 4: 39, 5: 84, 6: 0, 7: 5, 8: 13, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 145, 1: 122, 2: 131, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 143, 1: 120, 2: 133, 3: 0, 4: 7, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 6, 1: 0, 2: 98, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 1, 1: 0, 2: 98, 3: 819, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 350, 4: 52, 5: 0, 6: 228, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 355, 4: 59, 5: 0, 6: 180, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 96, 1: 69, 2: 190, 3: 187, 4: 20, 5: 4, 6: 64, 7: 441, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 104, 1: 69, 2: 177, 3: 186, 4: 17, 5: 10, 6: 19, 7: 432, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 112, 5: 51, 6: 30, 7: 32, 8: 46, 9: 269}
Prototype-Based Model Correct Classifications (per class):
{0: 14, 1: 15, 2: 0, 3: 13, 4: 86, 5: 52, 6: 28, 7: 34, 8: 46, 9: 263}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 10, 1: 25, 2: 0, 3: 89, 4: 0, 5: 0, 6: 184, 7: 43, 8: 19, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 18, 1: 26, 2: 0, 3: 92, 4: 6, 5: 0, 6: 84, 7: 43, 8: 19, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9456
Client 1: Regular Model Acc: 0.9473
Client 2: Regular Model Acc: 0.8950
Client 3: Regular Model Acc: 0.8668
Client 4: Regular Model Acc: 0.9372
Client 5: Regular Model Acc: 0.8796
Client 6: Regular Model Acc: 0.8105
Client 7: Regular Model Acc: 0.9553
Client 8: Regular Model Acc: 0.9302
Client 9: Regular Model Acc: 0.9721
Client 10: Regular Model Acc: 0.8701
Client 11: Regular Model Acc: 0.9920
Client 12: Regular Model Acc: 0.9355
Client 13: Regular Model Acc: 0.8671
Client 14: Regular Model Acc: 0.9620
Client 15: Regular Model Acc: 0.9862
Client 16: Regular Model Acc: 0.9471
Client 17: Regular Model Acc: 0.8837
Client 18: Regular Model Acc: 0.9061
Client 19: Regular Model Acc: 0.8371
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9210
Client 1: Prototype Model Acc: 0.9160
Client 2: Prototype Model Acc: 0.8907
Client 3: Prototype Model Acc: 0.6945
Client 4: Prototype Model Acc: 0.9271
Client 5: Prototype Model Acc: 0.8488
Client 6: Prototype Model Acc: 0.3819
Client 7: Prototype Model Acc: 0.9526
Client 8: Prototype Model Acc: 0.8753
Client 9: Prototype Model Acc: 0.9667
Client 10: Prototype Model Acc: 0.8649
Client 11: Prototype Model Acc: 0.9910
Client 12: Prototype Model Acc: 0.9062
Client 13: Prototype Model Acc: 0.8293
Client 14: Prototype Model Acc: 0.9579
Client 15: Prototype Model Acc: 0.9745
Client 16: Prototype Model Acc: 0.9176
Client 17: Prototype Model Acc: 0.8366
Client 18: Prototype Model Acc: 0.8623
Client 19: Prototype Model Acc: 0.6561
Averaged Test Accuracy (Regular Model): 0.9308
Averaged Test Accuracy (Prototype Model): 0.8954
Std Test Accuracy (Regular Model): 0.0493
Std Test Accuracy (Prototype Model): 0.1373
client.id trained 2
local_model_loss tensor(0.1523, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.3472, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.1025, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.3783, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.1125, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0815, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.3773, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.4691, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.1738, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.1222, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0841, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.1040, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.1053, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0376, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.2067, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.2309, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0608, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.2753, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0690, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0844, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 168.44441828713752
only_train_time: 1476.790170588647
all_clients_time_cost: 1476.790170588647
agg_protos_label dict_keys([7, 5, 4, 6, 9, 8, 0, 1, 2, 3])
-------------------------------------------------- 66.48053193092346

-------------Round number: 22-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 130, 1: 8, 2: 6, 3: 0, 4: 38, 5: 0, 6: 4, 7: 108, 8: 16, 9: 577}
Prototype-Based Model Correct Classifications (per class):
{0: 115, 1: 8, 2: 2, 3: 0, 4: 40, 5: 0, 6: 1, 7: 110, 8: 16, 9: 571}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 271, 7: 4, 8: 491, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 273, 7: 6, 8: 465, 9: 101}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 102, 1: 0, 2: 0, 3: 0, 4: 0, 5: 176, 6: 146, 7: 132, 8: 49, 9: 10}
Prototype-Based Model Correct Classifications (per class):
{0: 107, 1: 1, 2: 0, 3: 0, 4: 0, 5: 175, 6: 139, 7: 131, 8: 49, 9: 11}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 264, 1: 0, 2: 38, 3: 7, 4: 0, 5: 9, 6: 0, 7: 14, 8: 1, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 235, 1: 0, 2: 3, 3: 10, 4: 0, 5: 1, 6: 0, 7: 14, 8: 2, 9: 0}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 80, 1: 2, 2: 182, 3: 19, 4: 0, 5: 0, 6: 18, 7: 0, 8: 330, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 1, 2: 187, 3: 23, 4: 0, 5: 0, 6: 9, 7: 0, 8: 323, 9: 479}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 28, 1: 0, 2: 0, 3: 8, 4: 0, 5: 4, 6: 46, 7: 0, 8: 16, 9: 182}
Prototype-Based Model Correct Classifications (per class):
{0: 26, 1: 0, 2: 0, 3: 9, 4: 0, 5: 5, 6: 36, 7: 0, 8: 19, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 18, 1: 0, 2: 37, 3: 0, 4: 0, 5: 0, 6: 196, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 23, 1: 1, 2: 57, 3: 0, 4: 0, 5: 0, 6: 20, 7: 0, 8: 0, 9: 12}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 31, 1: 67, 2: 358, 3: 114, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 28, 1: 63, 2: 357, 3: 116, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 223, 1: 288, 2: 203, 3: 0, 4: 163, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 289, 2: 144, 3: 0, 4: 170, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 60, 1: 139, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 58, 1: 138, 2: 2, 3: 1, 4: 0, 5: 0, 6: 0, 7: 0, 8: 699, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 112, 1: 130, 2: 0, 3: 17, 4: 9, 5: 251, 6: 230, 7: 102, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 126, 1: 129, 2: 0, 3: 18, 4: 8, 5: 249, 6: 205, 7: 102, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 712, 2: 0, 3: 0, 4: 1152, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 238, 1: 0, 2: 57, 3: 66, 4: 0, 5: 58, 6: 0, 7: 285, 8: 0, 9: 94}
Prototype-Based Model Correct Classifications (per class):
{0: 223, 1: 0, 2: 59, 3: 68, 4: 0, 5: 58, 6: 0, 7: 271, 8: 0, 9: 99}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 27, 1: 138, 2: 252, 3: 3, 4: 32, 5: 83, 6: 0, 7: 21, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 25, 1: 135, 2: 250, 3: 4, 4: 37, 5: 84, 6: 0, 7: 6, 8: 13, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 144, 1: 122, 2: 131, 3: 0, 4: 8, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 143, 1: 120, 2: 133, 3: 0, 4: 7, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 5, 1: 0, 2: 98, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 98, 3: 817, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 348, 4: 52, 5: 0, 6: 235, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 354, 4: 60, 5: 0, 6: 191, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 97, 1: 69, 2: 195, 3: 183, 4: 12, 5: 4, 6: 52, 7: 441, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 103, 1: 69, 2: 183, 3: 183, 4: 16, 5: 10, 6: 18, 7: 433, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 10, 4: 114, 5: 51, 6: 25, 7: 32, 8: 46, 9: 270}
Prototype-Based Model Correct Classifications (per class):
{0: 14, 1: 15, 2: 0, 3: 13, 4: 89, 5: 52, 6: 27, 7: 35, 8: 46, 9: 263}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 3, 1: 24, 2: 0, 3: 81, 4: 0, 5: 0, 6: 194, 7: 43, 8: 18, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 13, 1: 24, 2: 0, 3: 90, 4: 6, 5: 0, 6: 93, 7: 43, 8: 20, 9: 1}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9466
Client 1: Regular Model Acc: 0.9494
Client 2: Regular Model Acc: 0.8965
Client 3: Regular Model Acc: 0.8695
Client 4: Regular Model Acc: 0.9406
Client 5: Regular Model Acc: 0.8765
Client 6: Regular Model Acc: 0.7668
Client 7: Regular Model Acc: 0.9562
Client 8: Regular Model Acc: 0.9271
Client 9: Regular Model Acc: 0.9721
Client 10: Regular Model Acc: 0.8773
Client 11: Regular Model Acc: 0.9920
Client 12: Regular Model Acc: 0.9355
Client 13: Regular Model Acc: 0.8595
Client 14: Regular Model Acc: 0.9600
Client 15: Regular Model Acc: 0.9851
Client 16: Regular Model Acc: 0.9514
Client 17: Regular Model Acc: 0.8688
Client 18: Regular Model Acc: 0.8998
Client 19: Regular Model Acc: 0.8213
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9210
Client 1: Prototype Model Acc: 0.9160
Client 2: Prototype Model Acc: 0.8936
Client 3: Prototype Model Acc: 0.6919
Client 4: Prototype Model Acc: 0.9296
Client 5: Prototype Model Acc: 0.8457
Client 6: Prototype Model Acc: 0.3294
Client 7: Prototype Model Acc: 0.9508
Client 8: Prototype Model Acc: 0.8774
Client 9: Prototype Model Acc: 0.9635
Client 10: Prototype Model Acc: 0.8629
Client 11: Prototype Model Acc: 0.9904
Client 12: Prototype Model Acc: 0.9121
Client 13: Prototype Model Acc: 0.8369
Client 14: Prototype Model Acc: 0.9579
Client 15: Prototype Model Acc: 0.9713
Client 16: Prototype Model Acc: 0.9271
Client 17: Prototype Model Acc: 0.8375
Client 18: Prototype Model Acc: 0.8670
Client 19: Prototype Model Acc: 0.6561
Averaged Test Accuracy (Regular Model): 0.9289
Averaged Test Accuracy (Prototype Model): 0.8954
Std Test Accuracy (Regular Model): 0.0566
Std Test Accuracy (Prototype Model): 0.1468
client.id trained 3
local_model_loss tensor(0.3697, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0582, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.3649, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.2697, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.1049, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.2103, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.1052, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.2250, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.3900, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0817, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.1632, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.1033, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.3527, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0665, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0366, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0990, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.1233, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0680, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0815, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.1585, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 178.88310781808104
only_train_time: 1553.2020209766924
all_clients_time_cost: 1553.2020209766924
agg_protos_label dict_keys([0, 2, 7, 6, 3, 5, 8, 9, 1, 4])
-------------------------------------------------- 78.16643953323364

-------------Round number: 23-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 130, 1: 8, 2: 6, 3: 0, 4: 38, 5: 0, 6: 4, 7: 110, 8: 16, 9: 570}
Prototype-Based Model Correct Classifications (per class):
{0: 115, 1: 8, 2: 3, 3: 0, 4: 40, 5: 0, 6: 0, 7: 112, 8: 16, 9: 567}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 271, 7: 4, 8: 491, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 6, 8: 465, 9: 101}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 105, 1: 0, 2: 0, 3: 0, 4: 0, 5: 176, 6: 143, 7: 131, 8: 49, 9: 10}
Prototype-Based Model Correct Classifications (per class):
{0: 108, 1: 1, 2: 0, 3: 0, 4: 0, 5: 175, 6: 137, 7: 131, 8: 50, 9: 11}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 264, 1: 0, 2: 38, 3: 7, 4: 0, 5: 9, 6: 0, 7: 14, 8: 1, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 235, 1: 0, 2: 4, 3: 10, 4: 0, 5: 2, 6: 0, 7: 14, 8: 2, 9: 0}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 80, 1: 2, 2: 181, 3: 19, 4: 0, 5: 0, 6: 19, 7: 0, 8: 330, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 73, 1: 1, 2: 187, 3: 23, 4: 0, 5: 0, 6: 9, 7: 0, 8: 323, 9: 479}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 28, 1: 0, 2: 0, 3: 8, 4: 0, 5: 4, 6: 47, 7: 0, 8: 16, 9: 182}
Prototype-Based Model Correct Classifications (per class):
{0: 26, 1: 0, 2: 0, 3: 9, 4: 0, 5: 5, 6: 38, 7: 0, 8: 19, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 13, 1: 0, 2: 42, 3: 0, 4: 0, 5: 0, 6: 203, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 23, 1: 1, 2: 58, 3: 0, 4: 1, 5: 0, 6: 17, 7: 0, 8: 0, 9: 12}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 30, 1: 67, 2: 358, 3: 114, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 28, 1: 64, 2: 357, 3: 117, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 222, 1: 288, 2: 203, 3: 0, 4: 164, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 289, 2: 135, 3: 0, 4: 170, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 60, 1: 139, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 58, 1: 138, 2: 2, 3: 1, 4: 2, 5: 0, 6: 0, 7: 0, 8: 700, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 111, 1: 130, 2: 0, 3: 17, 4: 9, 5: 252, 6: 230, 7: 103, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 125, 1: 129, 2: 0, 3: 18, 4: 7, 5: 249, 6: 205, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 713, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 239, 1: 0, 2: 57, 3: 66, 4: 0, 5: 58, 6: 0, 7: 287, 8: 0, 9: 89}
Prototype-Based Model Correct Classifications (per class):
{0: 225, 1: 0, 2: 59, 3: 68, 4: 0, 5: 57, 6: 0, 7: 279, 8: 0, 9: 95}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 25, 1: 138, 2: 231, 3: 2, 4: 57, 5: 79, 6: 0, 7: 22, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 25, 1: 137, 2: 230, 3: 3, 4: 50, 5: 84, 6: 1, 7: 14, 8: 14, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 144, 1: 122, 2: 132, 3: 0, 4: 8, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 143, 1: 120, 2: 133, 3: 0, 4: 6, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 6, 1: 0, 2: 98, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 3, 1: 0, 2: 98, 3: 821, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 348, 4: 52, 5: 0, 6: 234, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 354, 4: 60, 5: 0, 6: 190, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 96, 1: 69, 2: 186, 3: 187, 4: 24, 5: 4, 6: 69, 7: 441, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 104, 1: 69, 2: 174, 3: 186, 4: 17, 5: 10, 6: 30, 7: 433, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 10, 4: 116, 5: 50, 6: 22, 7: 32, 8: 46, 9: 270}
Prototype-Based Model Correct Classifications (per class):
{0: 14, 1: 15, 2: 0, 3: 14, 4: 89, 5: 52, 6: 27, 7: 34, 8: 46, 9: 263}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 13, 1: 26, 2: 0, 3: 90, 4: 0, 5: 0, 6: 182, 7: 43, 8: 18, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 20, 1: 26, 2: 0, 3: 92, 4: 6, 5: 0, 6: 72, 7: 43, 8: 19, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9413
Client 1: Regular Model Acc: 0.9494
Client 2: Regular Model Acc: 0.8950
Client 3: Regular Model Acc: 0.8695
Client 4: Regular Model Acc: 0.9406
Client 5: Regular Model Acc: 0.8796
Client 6: Regular Model Acc: 0.7872
Client 7: Regular Model Acc: 0.9553
Client 8: Regular Model Acc: 0.9271
Client 9: Regular Model Acc: 0.9721
Client 10: Regular Model Acc: 0.8784
Client 11: Regular Model Acc: 0.9920
Client 12: Regular Model Acc: 0.9332
Client 13: Regular Model Acc: 0.8565
Client 14: Regular Model Acc: 0.9610
Client 15: Regular Model Acc: 0.9862
Client 16: Regular Model Acc: 0.9506
Client 17: Regular Model Acc: 0.8878
Client 18: Regular Model Acc: 0.8967
Client 19: Regular Model Acc: 0.8416
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9189
Client 1: Prototype Model Acc: 0.9150
Client 2: Prototype Model Acc: 0.8936
Client 3: Prototype Model Acc: 0.6971
Client 4: Prototype Model Acc: 0.9288
Client 5: Prototype Model Acc: 0.8519
Client 6: Prototype Model Acc: 0.3265
Client 7: Prototype Model Acc: 0.9526
Client 8: Prototype Model Acc: 0.8679
Client 9: Prototype Model Acc: 0.9667
Client 10: Prototype Model Acc: 0.8619
Client 11: Prototype Model Acc: 0.9915
Client 12: Prototype Model Acc: 0.9179
Client 13: Prototype Model Acc: 0.8429
Client 14: Prototype Model Acc: 0.9569
Client 15: Prototype Model Acc: 0.9788
Client 16: Prototype Model Acc: 0.9263
Client 17: Prototype Model Acc: 0.8441
Client 18: Prototype Model Acc: 0.8670
Client 19: Prototype Model Acc: 0.6335
Averaged Test Accuracy (Regular Model): 0.9305
Averaged Test Accuracy (Prototype Model): 0.8959
Std Test Accuracy (Regular Model): 0.0518
Std Test Accuracy (Prototype Model): 0.1490
client.id trained 18
local_model_loss tensor(0.1548, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0635, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.3619, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.1477, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.1369, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.3694, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0643, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.2023, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0771, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.1000, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0793, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.3474, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.2645, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.3282, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0956, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0562, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.2141, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0971, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0357, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.1330, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 186.58688489615452
only_train_time: 1614.362486251397
all_clients_time_cost: 1614.362486251397
agg_protos_label dict_keys([9, 4, 5, 8, 0, 6, 1, 7, 3, 2])
Number of samples: 167
-------------------------------------------------- 64.02133226394653

-------------Round number: 24-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 129, 1: 8, 2: 6, 3: 0, 4: 38, 5: 0, 6: 4, 7: 108, 8: 16, 9: 578}
Prototype-Based Model Correct Classifications (per class):
{0: 114, 1: 8, 2: 3, 3: 0, 4: 41, 5: 0, 6: 0, 7: 110, 8: 16, 9: 573}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 271, 7: 4, 8: 492, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 6, 8: 465, 9: 101}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 98, 1: 0, 2: 0, 3: 0, 4: 0, 5: 176, 6: 148, 7: 132, 8: 50, 9: 10}
Prototype-Based Model Correct Classifications (per class):
{0: 104, 1: 1, 2: 0, 3: 0, 4: 0, 5: 175, 6: 143, 7: 131, 8: 50, 9: 11}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 263, 1: 0, 2: 38, 3: 7, 4: 0, 5: 9, 6: 0, 7: 14, 8: 1, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 238, 1: 0, 2: 4, 3: 10, 4: 0, 5: 2, 6: 0, 7: 14, 8: 2, 9: 0}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 80, 1: 2, 2: 181, 3: 19, 4: 0, 5: 0, 6: 19, 7: 0, 8: 330, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 73, 1: 1, 2: 187, 3: 23, 4: 0, 5: 0, 6: 9, 7: 0, 8: 323, 9: 479}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 28, 1: 0, 2: 0, 3: 8, 4: 0, 5: 4, 6: 46, 7: 0, 8: 16, 9: 182}
Prototype-Based Model Correct Classifications (per class):
{0: 26, 1: 0, 2: 0, 3: 9, 4: 0, 5: 5, 6: 38, 7: 0, 8: 19, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 15, 1: 0, 2: 46, 3: 0, 4: 0, 5: 0, 6: 199, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 23, 1: 1, 2: 57, 3: 0, 4: 1, 5: 0, 6: 19, 7: 0, 8: 0, 9: 12}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 30, 1: 67, 2: 358, 3: 115, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 64, 2: 358, 3: 117, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 223, 1: 289, 2: 194, 3: 0, 4: 166, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 289, 2: 124, 3: 0, 4: 170, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 61, 1: 139, 2: 0, 3: 0, 4: 1, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 58, 1: 138, 2: 2, 3: 1, 4: 2, 5: 0, 6: 0, 7: 0, 8: 700, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 109, 1: 129, 2: 0, 3: 17, 4: 6, 5: 252, 6: 231, 7: 103, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 122, 1: 129, 2: 0, 3: 17, 4: 7, 5: 250, 6: 209, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1152, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 713, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 238, 1: 0, 2: 57, 3: 66, 4: 0, 5: 61, 6: 0, 7: 236, 8: 0, 9: 103}
Prototype-Based Model Correct Classifications (per class):
{0: 223, 1: 0, 2: 59, 3: 68, 4: 0, 5: 59, 6: 0, 7: 216, 8: 0, 9: 103}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 25, 1: 138, 2: 227, 3: 2, 4: 61, 5: 80, 6: 0, 7: 22, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 25, 1: 137, 2: 223, 3: 3, 4: 54, 5: 84, 6: 1, 7: 14, 8: 14, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 144, 1: 122, 2: 131, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 144, 1: 120, 2: 133, 3: 0, 4: 6, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 7, 1: 0, 2: 98, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 5, 1: 0, 2: 98, 3: 822, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 350, 4: 54, 5: 0, 6: 227, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 355, 4: 60, 5: 0, 6: 181, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 98, 1: 69, 2: 194, 3: 185, 4: 15, 5: 4, 6: 61, 7: 441, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 105, 1: 69, 2: 185, 3: 183, 4: 16, 5: 10, 6: 25, 7: 434, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 10, 4: 114, 5: 50, 6: 28, 7: 32, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 15, 1: 15, 2: 0, 3: 13, 4: 88, 5: 52, 6: 28, 7: 34, 8: 46, 9: 263}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 12, 1: 25, 2: 0, 3: 89, 4: 0, 5: 0, 6: 183, 7: 43, 8: 19, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 21, 1: 26, 2: 0, 3: 92, 4: 6, 5: 0, 6: 75, 7: 43, 8: 20, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9466
Client 1: Regular Model Acc: 0.9505
Client 2: Regular Model Acc: 0.8950
Client 3: Regular Model Acc: 0.8668
Client 4: Regular Model Acc: 0.9406
Client 5: Regular Model Acc: 0.8765
Client 6: Regular Model Acc: 0.7930
Client 7: Regular Model Acc: 0.9562
Client 8: Regular Model Acc: 0.9218
Client 9: Regular Model Acc: 0.9742
Client 10: Regular Model Acc: 0.8732
Client 11: Regular Model Acc: 0.9915
Client 12: Regular Model Acc: 0.8921
Client 13: Regular Model Acc: 0.8580
Client 14: Regular Model Acc: 0.9610
Client 15: Regular Model Acc: 0.9873
Client 16: Regular Model Acc: 0.9480
Client 17: Regular Model Acc: 0.8804
Client 18: Regular Model Acc: 0.9045
Client 19: Regular Model Acc: 0.8394
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9232
Client 1: Prototype Model Acc: 0.9150
Client 2: Prototype Model Acc: 0.8965
Client 3: Prototype Model Acc: 0.7050
Client 4: Prototype Model Acc: 0.9288
Client 5: Prototype Model Acc: 0.8519
Client 6: Prototype Model Acc: 0.3294
Client 7: Prototype Model Acc: 0.9544
Client 8: Prototype Model Acc: 0.8562
Client 9: Prototype Model Acc: 0.9667
Client 10: Prototype Model Acc: 0.8629
Client 11: Prototype Model Acc: 0.9915
Client 12: Prototype Model Acc: 0.8535
Client 13: Prototype Model Acc: 0.8384
Client 14: Prototype Model Acc: 0.9579
Client 15: Prototype Model Acc: 0.9820
Client 16: Prototype Model Acc: 0.9193
Client 17: Prototype Model Acc: 0.8474
Client 18: Prototype Model Acc: 0.8670
Client 19: Prototype Model Acc: 0.6448
Averaged Test Accuracy (Regular Model): 0.9281
Averaged Test Accuracy (Prototype Model): 0.8930
Std Test Accuracy (Regular Model): 0.0520
Std Test Accuracy (Prototype Model): 0.1467
client.id trained 5
local_model_loss tensor(0.2593, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0770, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0923, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.1388, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.1059, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0793, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.1071, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.3550, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.3530, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.1924, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0621, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0544, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.3546, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0980, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.2097, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0347, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.3038, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0952, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.1433, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0603, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 193.45228870818391
only_train_time: 1685.2979222603608
all_clients_time_cost: 1685.2979222603608
agg_protos_label dict_keys([9, 0, 6, 5, 8, 3, 1, 2, 4, 7])
-------------------------------------------------- 72.43288803100586

-------------Round number: 25-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 129, 1: 8, 2: 6, 3: 0, 4: 38, 5: 0, 6: 4, 7: 110, 8: 16, 9: 568}
Prototype-Based Model Correct Classifications (per class):
{0: 114, 1: 8, 2: 3, 3: 0, 4: 41, 5: 0, 6: 0, 7: 112, 8: 16, 9: 566}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 272, 7: 4, 8: 492, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 6, 8: 465, 9: 101}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 98, 1: 0, 2: 0, 3: 0, 4: 0, 5: 176, 6: 149, 7: 131, 8: 50, 9: 10}
Prototype-Based Model Correct Classifications (per class):
{0: 104, 1: 1, 2: 0, 3: 0, 4: 0, 5: 175, 6: 143, 7: 132, 8: 51, 9: 11}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 263, 1: 0, 2: 38, 3: 7, 4: 0, 5: 10, 6: 0, 7: 14, 8: 1, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 239, 1: 0, 2: 4, 3: 10, 4: 0, 5: 2, 6: 0, 7: 14, 8: 2, 9: 0}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 80, 1: 2, 2: 183, 3: 19, 4: 0, 5: 0, 6: 19, 7: 0, 8: 330, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 1, 2: 187, 3: 23, 4: 0, 5: 0, 6: 9, 7: 1, 8: 323, 9: 479}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 28, 1: 0, 2: 0, 3: 9, 4: 0, 5: 4, 6: 46, 7: 0, 8: 16, 9: 182}
Prototype-Based Model Correct Classifications (per class):
{0: 26, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 37, 7: 0, 8: 19, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 15, 1: 0, 2: 46, 3: 0, 4: 0, 5: 0, 6: 196, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 23, 1: 1, 2: 57, 3: 0, 4: 1, 5: 0, 6: 22, 7: 0, 8: 0, 9: 12}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 30, 1: 67, 2: 358, 3: 115, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 28, 1: 64, 2: 358, 3: 117, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 222, 1: 289, 2: 201, 3: 0, 4: 165, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 289, 2: 137, 3: 0, 4: 170, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 61, 1: 139, 2: 0, 3: 0, 4: 1, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 58, 1: 138, 2: 2, 3: 1, 4: 3, 5: 0, 6: 0, 7: 0, 8: 700, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 110, 1: 129, 2: 0, 3: 16, 4: 6, 5: 252, 6: 230, 7: 102, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 123, 1: 129, 2: 0, 3: 17, 4: 7, 5: 251, 6: 206, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1152, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 238, 1: 0, 2: 57, 3: 66, 4: 0, 5: 58, 6: 0, 7: 284, 8: 0, 9: 94}
Prototype-Based Model Correct Classifications (per class):
{0: 219, 1: 0, 2: 59, 3: 68, 4: 0, 5: 58, 6: 0, 7: 274, 8: 0, 9: 99}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 25, 1: 139, 2: 217, 3: 2, 4: 64, 5: 79, 6: 0, 7: 23, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 24, 1: 137, 2: 215, 3: 4, 4: 57, 5: 84, 6: 1, 7: 17, 8: 14, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 144, 1: 122, 2: 133, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 143, 1: 120, 2: 133, 3: 0, 4: 6, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 7, 1: 0, 2: 98, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 5, 1: 0, 2: 98, 3: 822, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 344, 4: 51, 5: 0, 6: 238, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 352, 4: 60, 5: 0, 6: 194, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 97, 1: 69, 2: 185, 3: 188, 4: 25, 5: 4, 6: 70, 7: 441, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 103, 1: 69, 2: 173, 3: 186, 4: 19, 5: 10, 6: 31, 7: 435, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 109, 5: 50, 6: 29, 7: 33, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 15, 1: 15, 2: 0, 3: 13, 4: 85, 5: 52, 6: 28, 7: 37, 8: 46, 9: 263}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 10, 1: 25, 2: 0, 3: 87, 4: 0, 5: 0, 6: 185, 7: 43, 8: 18, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 19, 1: 25, 2: 0, 3: 92, 4: 6, 5: 0, 6: 84, 7: 43, 8: 20, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9381
Client 1: Regular Model Acc: 0.9516
Client 2: Regular Model Acc: 0.8950
Client 3: Regular Model Acc: 0.8695
Client 4: Regular Model Acc: 0.9423
Client 5: Regular Model Acc: 0.8796
Client 6: Regular Model Acc: 0.7843
Client 7: Regular Model Acc: 0.9562
Client 8: Regular Model Acc: 0.9271
Client 9: Regular Model Acc: 0.9742
Client 10: Regular Model Acc: 0.8711
Client 11: Regular Model Acc: 0.9915
Client 12: Regular Model Acc: 0.9343
Client 13: Regular Model Acc: 0.8489
Client 14: Regular Model Acc: 0.9630
Client 15: Regular Model Acc: 0.9873
Client 16: Regular Model Acc: 0.9497
Client 17: Regular Model Acc: 0.8903
Client 18: Regular Model Acc: 0.9030
Client 19: Regular Model Acc: 0.8326
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9178
Client 1: Prototype Model Acc: 0.9150
Client 2: Prototype Model Acc: 0.8994
Client 3: Prototype Model Acc: 0.7076
Client 4: Prototype Model Acc: 0.9304
Client 5: Prototype Model Acc: 0.8519
Client 6: Prototype Model Acc: 0.3382
Client 7: Prototype Model Acc: 0.9535
Client 8: Prototype Model Acc: 0.8700
Client 9: Prototype Model Acc: 0.9678
Client 10: Prototype Model Acc: 0.8619
Client 11: Prototype Model Acc: 0.9920
Client 12: Prototype Model Acc: 0.9109
Client 13: Prototype Model Acc: 0.8353
Client 14: Prototype Model Acc: 0.9569
Client 15: Prototype Model Acc: 0.9820
Client 16: Prototype Model Acc: 0.9280
Client 17: Prototype Model Acc: 0.8465
Client 18: Prototype Model Acc: 0.8670
Client 19: Prototype Model Acc: 0.6584
Averaged Test Accuracy (Regular Model): 0.9303
Averaged Test Accuracy (Prototype Model): 0.8974
Std Test Accuracy (Regular Model): 0.0537
Std Test Accuracy (Prototype Model): 0.1448
client.id trained 10
local_model_loss tensor(0.1918, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.2539, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0520, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.2996, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.1037, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.1946, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.3416, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.1050, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0339, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.1390, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.3293, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0764, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0904, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0575, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.1292, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0709, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0601, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0892, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.3466, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0906, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 200.92726944119204
only_train_time: 1751.0506671646144
all_clients_time_cost: 1751.0506671646144
agg_protos_label dict_keys([5, 1, 3, 6, 7, 0, 4, 2, 9, 8])
-------------------------------------------------- 67.57381296157837

-------------Round number: 26-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 129, 1: 8, 2: 6, 3: 0, 4: 38, 5: 0, 6: 4, 7: 108, 8: 16, 9: 578}
Prototype-Based Model Correct Classifications (per class):
{0: 114, 1: 8, 2: 3, 3: 0, 4: 41, 5: 0, 6: 0, 7: 110, 8: 16, 9: 572}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 272, 7: 4, 8: 492, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 6, 8: 467, 9: 101}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 102, 1: 0, 2: 0, 3: 0, 4: 0, 5: 176, 6: 147, 7: 131, 8: 50, 9: 11}
Prototype-Based Model Correct Classifications (per class):
{0: 106, 1: 1, 2: 0, 3: 0, 4: 0, 5: 175, 6: 143, 7: 132, 8: 51, 9: 11}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 263, 1: 0, 2: 38, 3: 7, 4: 0, 5: 10, 6: 0, 7: 14, 8: 2, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 238, 1: 0, 2: 4, 3: 10, 4: 0, 5: 2, 6: 0, 7: 14, 8: 2, 9: 0}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 80, 1: 2, 2: 181, 3: 19, 4: 0, 5: 0, 6: 19, 7: 1, 8: 330, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 186, 3: 23, 4: 0, 5: 0, 6: 12, 7: 1, 8: 323, 9: 479}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 28, 1: 0, 2: 0, 3: 9, 4: 0, 5: 4, 6: 47, 7: 0, 8: 16, 9: 182}
Prototype-Based Model Correct Classifications (per class):
{0: 26, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 37, 7: 0, 8: 19, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 6, 1: 0, 2: 44, 3: 0, 4: 0, 5: 0, 6: 217, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 17, 1: 0, 2: 58, 3: 0, 4: 0, 5: 0, 6: 31, 7: 0, 8: 0, 9: 12}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 30, 1: 67, 2: 359, 3: 115, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 64, 2: 358, 3: 117, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 221, 1: 289, 2: 204, 3: 0, 4: 163, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 289, 2: 143, 3: 0, 4: 170, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 62, 1: 140, 2: 0, 3: 0, 4: 1, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 58, 1: 138, 2: 2, 3: 1, 4: 3, 5: 0, 6: 0, 7: 0, 8: 699, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 112, 1: 129, 2: 0, 3: 17, 4: 9, 5: 252, 6: 229, 7: 104, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 122, 1: 129, 2: 0, 3: 18, 4: 8, 5: 251, 6: 207, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1152, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 240, 1: 0, 2: 56, 3: 65, 4: 0, 5: 59, 6: 0, 7: 284, 8: 0, 9: 94}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 0, 2: 59, 3: 68, 4: 0, 5: 58, 6: 0, 7: 273, 8: 0, 9: 99}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 27, 1: 137, 2: 254, 3: 3, 4: 21, 5: 83, 6: 0, 7: 18, 8: 12, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 27, 1: 134, 2: 251, 3: 4, 4: 23, 5: 84, 6: 0, 7: 7, 8: 13, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 145, 1: 122, 2: 132, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 144, 1: 120, 2: 133, 3: 0, 4: 6, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 7, 1: 0, 2: 98, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 6, 1: 0, 2: 98, 3: 820, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 353, 4: 57, 5: 0, 6: 222, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 353, 4: 60, 5: 0, 6: 187, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 97, 1: 69, 2: 193, 3: 187, 4: 18, 5: 4, 6: 67, 7: 441, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 105, 1: 69, 2: 182, 3: 185, 4: 17, 5: 10, 6: 28, 7: 435, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 10, 4: 116, 5: 50, 6: 25, 7: 34, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 15, 1: 15, 2: 0, 3: 14, 4: 91, 5: 52, 6: 28, 7: 37, 8: 47, 9: 263}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 9, 1: 25, 2: 0, 3: 85, 4: 0, 5: 0, 6: 188, 7: 43, 8: 18, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 19, 1: 24, 2: 0, 3: 91, 4: 6, 5: 0, 6: 93, 7: 43, 8: 20, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9466
Client 1: Regular Model Acc: 0.9516
Client 2: Regular Model Acc: 0.8994
Client 3: Regular Model Acc: 0.8721
Client 4: Regular Model Acc: 0.9415
Client 5: Regular Model Acc: 0.8827
Client 6: Regular Model Acc: 0.8134
Client 7: Regular Model Acc: 0.9571
Client 8: Regular Model Acc: 0.9271
Client 9: Regular Model Acc: 0.9764
Client 10: Regular Model Acc: 0.8784
Client 11: Regular Model Acc: 0.9915
Client 12: Regular Model Acc: 0.9355
Client 13: Regular Model Acc: 0.8384
Client 14: Regular Model Acc: 0.9630
Client 15: Regular Model Acc: 0.9873
Client 16: Regular Model Acc: 0.9488
Client 17: Regular Model Acc: 0.8878
Client 18: Regular Model Acc: 0.9061
Client 19: Regular Model Acc: 0.8326
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9221
Client 1: Prototype Model Acc: 0.9171
Client 2: Prototype Model Acc: 0.9023
Client 3: Prototype Model Acc: 0.7050
Client 4: Prototype Model Acc: 0.9330
Client 5: Prototype Model Acc: 0.8519
Client 6: Prototype Model Acc: 0.3440
Client 7: Prototype Model Acc: 0.9544
Client 8: Prototype Model Acc: 0.8763
Client 9: Prototype Model Acc: 0.9667
Client 10: Prototype Model Acc: 0.8639
Client 11: Prototype Model Acc: 0.9920
Client 12: Prototype Model Acc: 0.9191
Client 13: Prototype Model Acc: 0.8202
Client 14: Prototype Model Acc: 0.9579
Client 15: Prototype Model Acc: 0.9809
Client 16: Prototype Model Acc: 0.9228
Client 17: Prototype Model Acc: 0.8507
Client 18: Prototype Model Acc: 0.8795
Client 19: Prototype Model Acc: 0.6742
Averaged Test Accuracy (Regular Model): 0.9317
Averaged Test Accuracy (Prototype Model): 0.8991
Std Test Accuracy (Regular Model): 0.0509
Std Test Accuracy (Prototype Model): 0.1433
client.id trained 5
local_model_loss tensor(0.2489, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.3435, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.3188, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.1015, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.3420, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0520, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0862, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0719, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0581, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0551, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.2732, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0844, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.2116, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.1366, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0997, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0764, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0867, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.1166, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.2018, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0330, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 208.14558323123492
only_train_time: 1817.1097619686043
all_clients_time_cost: 1817.1097619686043
agg_protos_label dict_keys([9, 0, 6, 5, 8, 3, 1, 2, 7, 4])
-------------------------------------------------- 67.72792720794678

-------------Round number: 27-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 129, 1: 8, 2: 7, 3: 0, 4: 38, 5: 0, 6: 4, 7: 108, 8: 16, 9: 576}
Prototype-Based Model Correct Classifications (per class):
{0: 112, 1: 8, 2: 3, 3: 0, 4: 41, 5: 0, 6: 0, 7: 111, 8: 16, 9: 572}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 272, 7: 4, 8: 493, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 6, 8: 467, 9: 101}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 111, 1: 0, 2: 0, 3: 0, 4: 0, 5: 177, 6: 137, 7: 131, 8: 48, 9: 10}
Prototype-Based Model Correct Classifications (per class):
{0: 114, 1: 1, 2: 0, 3: 0, 4: 0, 5: 175, 6: 130, 7: 132, 8: 50, 9: 11}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 264, 1: 0, 2: 37, 3: 7, 4: 0, 5: 10, 6: 0, 7: 14, 8: 2, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 243, 1: 0, 2: 5, 3: 10, 4: 0, 5: 2, 6: 0, 7: 14, 8: 2, 9: 1}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 80, 1: 2, 2: 182, 3: 19, 4: 0, 5: 0, 6: 20, 7: 1, 8: 330, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 186, 3: 23, 4: 0, 5: 0, 6: 12, 7: 2, 8: 323, 9: 479}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 29, 1: 0, 2: 0, 3: 9, 4: 0, 5: 4, 6: 45, 7: 0, 8: 16, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 26, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 38, 7: 0, 8: 19, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 5, 1: 0, 2: 11, 3: 0, 4: 0, 5: 0, 6: 234, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 17, 1: 0, 2: 49, 3: 0, 4: 0, 5: 0, 6: 158, 7: 0, 8: 0, 9: 11}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 30, 1: 67, 2: 359, 3: 115, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 30, 1: 64, 2: 358, 3: 117, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 222, 1: 289, 2: 193, 3: 0, 4: 167, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 226, 1: 289, 2: 123, 3: 0, 4: 170, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 63, 1: 139, 2: 0, 3: 0, 4: 1, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 58, 1: 138, 2: 2, 3: 1, 4: 3, 5: 0, 6: 0, 7: 0, 8: 700, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 112, 1: 129, 2: 0, 3: 15, 4: 7, 5: 252, 6: 225, 7: 104, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 124, 1: 129, 2: 0, 3: 17, 4: 7, 5: 251, 6: 206, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1152, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 238, 1: 0, 2: 57, 3: 66, 4: 0, 5: 59, 6: 0, 7: 284, 8: 0, 9: 94}
Prototype-Based Model Correct Classifications (per class):
{0: 221, 1: 0, 2: 59, 3: 68, 4: 0, 5: 58, 6: 0, 7: 274, 8: 0, 9: 98}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 26, 1: 137, 2: 251, 3: 3, 4: 37, 5: 83, 6: 0, 7: 20, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 26, 1: 134, 2: 250, 3: 4, 4: 39, 5: 84, 6: 1, 7: 13, 8: 13, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 145, 1: 122, 2: 133, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 143, 1: 120, 2: 134, 3: 0, 4: 6, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 8, 1: 0, 2: 98, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 6, 1: 0, 2: 98, 3: 820, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 344, 4: 44, 5: 0, 6: 244, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 350, 4: 58, 5: 0, 6: 210, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 97, 1: 69, 2: 189, 3: 187, 4: 23, 5: 4, 6: 70, 7: 441, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 104, 1: 69, 2: 178, 3: 185, 4: 19, 5: 10, 6: 32, 7: 434, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 115, 5: 50, 6: 28, 7: 34, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 15, 1: 15, 2: 0, 3: 14, 4: 89, 5: 52, 6: 28, 7: 37, 8: 46, 9: 263}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 13, 1: 25, 2: 0, 3: 87, 4: 0, 5: 0, 6: 183, 7: 43, 8: 20, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 20, 1: 26, 2: 0, 3: 92, 4: 6, 5: 0, 6: 81, 7: 43, 8: 20, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9456
Client 1: Regular Model Acc: 0.9526
Client 2: Regular Model Acc: 0.8950
Client 3: Regular Model Acc: 0.8721
Client 4: Regular Model Acc: 0.9432
Client 5: Regular Model Acc: 0.8765
Client 6: Regular Model Acc: 0.7638
Client 7: Regular Model Acc: 0.9571
Client 8: Regular Model Acc: 0.9207
Client 9: Regular Model Acc: 0.9764
Client 10: Regular Model Acc: 0.8701
Client 11: Regular Model Acc: 0.9915
Client 12: Regular Model Acc: 0.9355
Client 13: Regular Model Acc: 0.8610
Client 14: Regular Model Acc: 0.9641
Client 15: Regular Model Acc: 0.9883
Client 16: Regular Model Acc: 0.9488
Client 17: Regular Model Acc: 0.8911
Client 18: Regular Model Acc: 0.9124
Client 19: Regular Model Acc: 0.8394
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9210
Client 1: Prototype Model Acc: 0.9171
Client 2: Prototype Model Acc: 0.8936
Client 3: Prototype Model Acc: 0.7232
Client 4: Prototype Model Acc: 0.9338
Client 5: Prototype Model Acc: 0.8549
Client 6: Prototype Model Acc: 0.6851
Client 7: Prototype Model Acc: 0.9553
Client 8: Prototype Model Acc: 0.8541
Client 9: Prototype Model Acc: 0.9678
Client 10: Prototype Model Acc: 0.8629
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9121
Client 13: Prototype Model Acc: 0.8520
Client 14: Prototype Model Acc: 0.9579
Client 15: Prototype Model Acc: 0.9809
Client 16: Prototype Model Acc: 0.9384
Client 17: Prototype Model Acc: 0.8507
Client 18: Prototype Model Acc: 0.8748
Client 19: Prototype Model Acc: 0.6561
Averaged Test Accuracy (Regular Model): 0.9313
Averaged Test Accuracy (Prototype Model): 0.9061
Std Test Accuracy (Regular Model): 0.0555
Std Test Accuracy (Prototype Model): 0.0919
client.id trained 12
local_model_loss tensor(0.0935, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.2445, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0879, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0530, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0912, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.3380, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0482, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0635, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.1281, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.1909, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0322, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.3423, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0699, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0566, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0862, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.2992, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.1162, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.1880, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0835, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.2660, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 214.57708946918137
only_train_time: 1879.5200269665802
all_clients_time_cost: 1879.5200269665802
agg_protos_label dict_keys([0, 7, 5, 2, 3, 9, 6, 8, 4, 1])
Number of samples: 167
-------------------------------------------------- 65.24589824676514

-------------Round number: 28-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 129, 1: 8, 2: 7, 3: 0, 4: 38, 5: 0, 6: 4, 7: 105, 8: 16, 9: 578}
Prototype-Based Model Correct Classifications (per class):
{0: 113, 1: 8, 2: 3, 3: 0, 4: 41, 5: 0, 6: 0, 7: 110, 8: 16, 9: 574}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 4, 8: 493, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 6, 8: 472, 9: 99}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 109, 1: 0, 2: 0, 3: 0, 4: 0, 5: 177, 6: 141, 7: 131, 8: 49, 9: 11}
Prototype-Based Model Correct Classifications (per class):
{0: 113, 1: 1, 2: 0, 3: 0, 4: 0, 5: 176, 6: 133, 7: 132, 8: 51, 9: 11}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 259, 1: 0, 2: 41, 3: 7, 4: 0, 5: 10, 6: 0, 7: 14, 8: 3, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 231, 1: 0, 2: 5, 3: 10, 4: 0, 5: 2, 6: 0, 7: 14, 8: 2, 9: 1}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 80, 1: 2, 2: 184, 3: 19, 4: 0, 5: 0, 6: 19, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 187, 3: 23, 4: 0, 5: 0, 6: 12, 7: 1, 8: 323, 9: 479}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 29, 1: 0, 2: 0, 3: 9, 4: 0, 5: 4, 6: 45, 7: 0, 8: 16, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 27, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 37, 7: 0, 8: 19, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 5, 1: 0, 2: 31, 3: 0, 4: 0, 5: 0, 6: 232, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 19, 1: 0, 2: 56, 3: 0, 4: 0, 5: 0, 6: 98, 7: 0, 8: 0, 9: 12}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 30, 1: 67, 2: 359, 3: 115, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 30, 1: 64, 2: 359, 3: 116, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 222, 1: 289, 2: 207, 3: 0, 4: 164, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 289, 2: 152, 3: 0, 4: 170, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 62, 1: 140, 2: 0, 3: 0, 4: 1, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 58, 1: 138, 2: 2, 3: 1, 4: 3, 5: 0, 6: 0, 7: 0, 8: 698, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 108, 1: 130, 2: 1, 3: 17, 4: 7, 5: 252, 6: 231, 7: 104, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 120, 1: 129, 2: 0, 3: 18, 4: 8, 5: 251, 6: 210, 7: 104, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1152, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 238, 1: 0, 2: 57, 3: 66, 4: 0, 5: 59, 6: 0, 7: 284, 8: 0, 9: 94}
Prototype-Based Model Correct Classifications (per class):
{0: 222, 1: 0, 2: 59, 3: 68, 4: 0, 5: 58, 6: 0, 7: 274, 8: 0, 9: 98}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 26, 1: 138, 2: 248, 3: 3, 4: 46, 5: 82, 6: 0, 7: 20, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 25, 1: 134, 2: 245, 3: 4, 4: 43, 5: 84, 6: 1, 7: 14, 8: 13, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 145, 1: 122, 2: 133, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 144, 1: 120, 2: 134, 3: 0, 4: 6, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 9, 1: 0, 2: 98, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 6, 1: 0, 2: 98, 3: 820, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 350, 4: 56, 5: 0, 6: 228, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 352, 4: 60, 5: 0, 6: 192, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 99, 1: 69, 2: 194, 3: 180, 4: 15, 5: 4, 6: 62, 7: 441, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 105, 1: 69, 2: 187, 3: 184, 4: 14, 5: 11, 6: 28, 7: 434, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 115, 5: 50, 6: 27, 7: 34, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 15, 1: 15, 2: 0, 3: 14, 4: 90, 5: 51, 6: 29, 7: 37, 8: 47, 9: 263}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 15, 1: 26, 2: 0, 3: 92, 4: 0, 5: 0, 6: 171, 7: 43, 8: 19, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 22, 1: 26, 2: 0, 3: 93, 4: 6, 5: 0, 6: 64, 7: 43, 8: 19, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9445
Client 1: Regular Model Acc: 0.9537
Client 2: Regular Model Acc: 0.9009
Client 3: Regular Model Acc: 0.8721
Client 4: Regular Model Acc: 0.9449
Client 5: Regular Model Acc: 0.8765
Client 6: Regular Model Acc: 0.8163
Client 7: Regular Model Acc: 0.9571
Client 8: Regular Model Acc: 0.9323
Client 9: Regular Model Acc: 0.9764
Client 10: Regular Model Acc: 0.8763
Client 11: Regular Model Acc: 0.9915
Client 12: Regular Model Acc: 0.9355
Client 13: Regular Model Acc: 0.8701
Client 14: Regular Model Acc: 0.9641
Client 15: Regular Model Acc: 0.9894
Client 16: Regular Model Acc: 0.9506
Client 17: Regular Model Acc: 0.8779
Client 18: Regular Model Acc: 0.9108
Client 19: Regular Model Acc: 0.8281
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9232
Client 1: Prototype Model Acc: 0.9203
Client 2: Prototype Model Acc: 0.8994
Client 3: Prototype Model Acc: 0.6919
Client 4: Prototype Model Acc: 0.9338
Client 5: Prototype Model Acc: 0.8549
Client 6: Prototype Model Acc: 0.5394
Client 7: Prototype Model Acc: 0.9553
Client 8: Prototype Model Acc: 0.8858
Client 9: Prototype Model Acc: 0.9657
Client 10: Prototype Model Acc: 0.8660
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9132
Client 13: Prototype Model Acc: 0.8505
Client 14: Prototype Model Acc: 0.9589
Client 15: Prototype Model Acc: 0.9809
Client 16: Prototype Model Acc: 0.9263
Client 17: Prototype Model Acc: 0.8515
Client 18: Prototype Model Acc: 0.8779
Client 19: Prototype Model Acc: 0.6222
Averaged Test Accuracy (Regular Model): 0.9329
Averaged Test Accuracy (Prototype Model): 0.9034
Std Test Accuracy (Regular Model): 0.0500
Std Test Accuracy (Prototype Model): 0.1163
client.id trained 14
local_model_loss tensor(0.0470, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.3436, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.2883, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0622, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0511, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.2399, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.3409, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0314, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0808, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.1749, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0891, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0933, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.1254, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0759, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.1004, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0771, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0546, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.1315, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.3359, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.1764, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 222.16428573115263
only_train_time: 1942.7734043525998
all_clients_time_cost: 1942.7734043525998
agg_protos_label dict_keys([2, 5, 0, 4, 1, 3, 8, 6, 7, 9])
-------------------------------------------------- 64.95725727081299

-------------Round number: 29-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 7, 3: 0, 4: 39, 5: 0, 6: 4, 7: 108, 8: 16, 9: 574}
Prototype-Based Model Correct Classifications (per class):
{0: 116, 1: 8, 2: 3, 3: 0, 4: 40, 5: 0, 6: 0, 7: 109, 8: 16, 9: 574}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 4, 8: 494, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 7, 8: 475, 9: 100}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 119, 1: 0, 2: 0, 3: 0, 4: 0, 5: 178, 6: 119, 7: 131, 8: 48, 9: 11}
Prototype-Based Model Correct Classifications (per class):
{0: 122, 1: 1, 2: 0, 3: 0, 4: 0, 5: 176, 6: 117, 7: 132, 8: 50, 9: 11}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 264, 1: 0, 2: 36, 3: 7, 4: 0, 5: 9, 6: 0, 7: 14, 8: 2, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 243, 1: 0, 2: 3, 3: 10, 4: 0, 5: 2, 6: 0, 7: 14, 8: 2, 9: 1}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 80, 1: 2, 2: 183, 3: 19, 4: 0, 5: 0, 6: 20, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 186, 3: 23, 4: 0, 5: 0, 6: 13, 7: 2, 8: 323, 9: 479}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 30, 1: 0, 2: 0, 3: 9, 4: 0, 5: 4, 6: 45, 7: 0, 8: 16, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 26, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 37, 7: 0, 8: 19, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 8, 1: 0, 2: 5, 3: 0, 4: 0, 5: 0, 6: 235, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 24, 1: 0, 2: 46, 3: 0, 4: 0, 5: 0, 6: 151, 7: 0, 8: 0, 9: 11}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 29, 1: 67, 2: 354, 3: 119, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 27, 1: 64, 2: 356, 3: 120, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 222, 1: 289, 2: 192, 3: 0, 4: 168, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 225, 1: 289, 2: 122, 3: 0, 4: 170, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 62, 1: 140, 2: 0, 3: 0, 4: 1, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 58, 1: 137, 2: 2, 3: 1, 4: 3, 5: 0, 6: 0, 7: 0, 8: 701, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 107, 1: 130, 2: 1, 3: 17, 4: 7, 5: 252, 6: 233, 7: 104, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 119, 1: 129, 2: 0, 3: 18, 4: 8, 5: 252, 6: 210, 7: 104, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1152, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 238, 1: 0, 2: 57, 3: 66, 4: 0, 5: 59, 6: 0, 7: 284, 8: 0, 9: 92}
Prototype-Based Model Correct Classifications (per class):
{0: 225, 1: 0, 2: 59, 3: 68, 4: 0, 5: 58, 6: 0, 7: 275, 8: 0, 9: 98}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 25, 1: 138, 2: 236, 3: 2, 4: 55, 5: 81, 6: 0, 7: 20, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 25, 1: 135, 2: 234, 3: 4, 4: 50, 5: 84, 6: 1, 7: 14, 8: 14, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 149, 1: 122, 2: 131, 3: 0, 4: 10, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 146, 1: 120, 2: 132, 3: 0, 4: 8, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 9, 1: 0, 2: 98, 3: 824, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 7, 1: 1, 2: 98, 3: 820, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 344, 4: 53, 5: 0, 6: 239, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 350, 4: 60, 5: 0, 6: 201, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 97, 1: 69, 2: 185, 3: 188, 4: 25, 5: 4, 6: 69, 7: 441, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 104, 1: 69, 2: 175, 3: 185, 4: 21, 5: 10, 6: 36, 7: 435, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 11, 4: 115, 5: 50, 6: 26, 7: 36, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 15, 1: 15, 2: 0, 3: 14, 4: 91, 5: 51, 6: 29, 7: 37, 8: 46, 9: 263}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 5, 1: 25, 2: 0, 3: 86, 4: 0, 5: 0, 6: 189, 7: 43, 8: 18, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 18, 1: 24, 2: 0, 3: 92, 4: 6, 5: 0, 6: 101, 7: 43, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9434
Client 1: Regular Model Acc: 0.9548
Client 2: Regular Model Acc: 0.8834
Client 3: Regular Model Acc: 0.8668
Client 4: Regular Model Acc: 0.9449
Client 5: Regular Model Acc: 0.8796
Client 6: Regular Model Acc: 0.7580
Client 7: Regular Model Acc: 0.9553
Client 8: Regular Model Acc: 0.9207
Client 9: Regular Model Acc: 0.9764
Client 10: Regular Model Acc: 0.8773
Client 11: Regular Model Acc: 0.9915
Client 12: Regular Model Acc: 0.9332
Client 13: Regular Model Acc: 0.8610
Client 14: Regular Model Acc: 0.9671
Client 15: Regular Model Acc: 0.9883
Client 16: Regular Model Acc: 0.9523
Client 17: Regular Model Acc: 0.8894
Client 18: Regular Model Acc: 0.9108
Client 19: Regular Model Acc: 0.8281
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9242
Client 1: Prototype Model Acc: 0.9257
Client 2: Prototype Model Acc: 0.8878
Client 3: Prototype Model Acc: 0.7180
Client 4: Prototype Model Acc: 0.9347
Client 5: Prototype Model Acc: 0.8519
Client 6: Prototype Model Acc: 0.6764
Client 7: Prototype Model Acc: 0.9535
Client 8: Prototype Model Acc: 0.8520
Client 9: Prototype Model Acc: 0.9678
Client 10: Prototype Model Acc: 0.8660
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9179
Client 13: Prototype Model Acc: 0.8474
Client 14: Prototype Model Acc: 0.9610
Client 15: Prototype Model Acc: 0.9830
Client 16: Prototype Model Acc: 0.9324
Client 17: Prototype Model Acc: 0.8540
Client 18: Prototype Model Acc: 0.8779
Client 19: Prototype Model Acc: 0.6946
Averaged Test Accuracy (Regular Model): 0.9309
Averaged Test Accuracy (Prototype Model): 0.9075
Std Test Accuracy (Regular Model): 0.0575
Std Test Accuracy (Prototype Model): 0.0894
client.id trained 1
local_model_loss tensor(0.0783, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.2865, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0306, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0535, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.3004, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0853, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0664, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0453, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0489, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.1146, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.1660, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.2357, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.1666, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.3211, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.2938, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0815, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0584, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0905, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.1099, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0857, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 230.42478687816765
only_train_time: 2006.811804036959
all_clients_time_cost: 2006.811804036959
agg_protos_label dict_keys([8, 6, 9, 5, 7, 3, 1, 0, 2, 4])
-------------------------------------------------- 65.8080804347992

-------------Round number: 30-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 7, 3: 0, 4: 38, 5: 0, 6: 4, 7: 108, 8: 16, 9: 575}
Prototype-Based Model Correct Classifications (per class):
{0: 114, 1: 8, 2: 3, 3: 0, 4: 41, 5: 0, 6: 0, 7: 110, 8: 16, 9: 572}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 4, 8: 494, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 7, 8: 474, 9: 100}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 101, 1: 0, 2: 0, 3: 0, 4: 0, 5: 177, 6: 147, 7: 131, 8: 50, 9: 11}
Prototype-Based Model Correct Classifications (per class):
{0: 105, 1: 1, 2: 0, 3: 0, 4: 0, 5: 176, 6: 144, 7: 132, 8: 51, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 259, 1: 0, 2: 40, 3: 8, 4: 0, 5: 10, 6: 0, 7: 14, 8: 3, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 234, 1: 0, 2: 5, 3: 11, 4: 0, 5: 2, 6: 0, 7: 14, 8: 2, 9: 1}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 81, 1: 2, 2: 185, 3: 19, 4: 0, 5: 0, 6: 18, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 188, 3: 23, 4: 0, 5: 0, 6: 11, 7: 2, 8: 323, 9: 479}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 31, 1: 0, 2: 0, 3: 9, 4: 0, 5: 5, 6: 44, 7: 0, 8: 16, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 28, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 37, 7: 0, 8: 19, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 5, 1: 0, 2: 41, 3: 0, 4: 0, 5: 0, 6: 223, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 17, 1: 0, 2: 58, 3: 0, 4: 1, 5: 0, 6: 72, 7: 0, 8: 0, 9: 12}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 30, 1: 67, 2: 359, 3: 115, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 30, 1: 65, 2: 359, 3: 118, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 221, 1: 289, 2: 205, 3: 0, 4: 163, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 289, 2: 149, 3: 0, 4: 169, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 62, 1: 140, 2: 0, 3: 0, 4: 1, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 58, 1: 137, 2: 2, 3: 1, 4: 4, 5: 0, 6: 0, 7: 0, 8: 698, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 106, 1: 130, 2: 1, 3: 17, 4: 7, 5: 252, 6: 234, 7: 104, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 117, 1: 129, 2: 0, 3: 18, 4: 8, 5: 252, 6: 214, 7: 104, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1152, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 238, 1: 0, 2: 57, 3: 65, 4: 0, 5: 60, 6: 0, 7: 284, 8: 0, 9: 95}
Prototype-Based Model Correct Classifications (per class):
{0: 226, 1: 0, 2: 59, 3: 68, 4: 0, 5: 58, 6: 1, 7: 275, 8: 0, 9: 98}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 25, 1: 138, 2: 223, 3: 2, 4: 63, 5: 80, 6: 0, 7: 20, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 25, 1: 137, 2: 223, 3: 4, 4: 57, 5: 84, 6: 1, 7: 17, 8: 14, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 146, 1: 120, 2: 134, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 145, 1: 120, 2: 134, 3: 0, 4: 5, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 9, 1: 0, 2: 98, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 7, 1: 1, 2: 98, 3: 822, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 351, 4: 56, 5: 0, 6: 227, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 352, 4: 61, 5: 0, 6: 191, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 97, 1: 69, 2: 192, 3: 186, 4: 23, 5: 4, 6: 69, 7: 441, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 105, 1: 69, 2: 178, 3: 185, 4: 20, 5: 11, 6: 37, 7: 434, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 111, 5: 50, 6: 27, 7: 34, 8: 46, 9: 272}
Prototype-Based Model Correct Classifications (per class):
{0: 15, 1: 15, 2: 0, 3: 14, 4: 86, 5: 51, 6: 29, 7: 37, 8: 47, 9: 265}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 10, 1: 25, 2: 0, 3: 86, 4: 0, 5: 0, 6: 186, 7: 43, 8: 19, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 19, 1: 24, 2: 0, 3: 91, 4: 6, 5: 0, 6: 96, 7: 43, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9434
Client 1: Regular Model Acc: 0.9548
Client 2: Regular Model Acc: 0.8994
Client 3: Regular Model Acc: 0.8721
Client 4: Regular Model Acc: 0.9457
Client 5: Regular Model Acc: 0.8827
Client 6: Regular Model Acc: 0.8192
Client 7: Regular Model Acc: 0.9571
Client 8: Regular Model Acc: 0.9281
Client 9: Regular Model Acc: 0.9764
Client 10: Regular Model Acc: 0.8773
Client 11: Regular Model Acc: 0.9915
Client 12: Regular Model Acc: 0.9367
Client 13: Regular Model Acc: 0.8520
Client 14: Regular Model Acc: 0.9641
Client 15: Regular Model Acc: 0.9894
Client 16: Regular Model Acc: 0.9506
Client 17: Regular Model Acc: 0.8919
Client 18: Regular Model Acc: 0.9061
Client 19: Regular Model Acc: 0.8348
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9221
Client 1: Prototype Model Acc: 0.9247
Client 2: Prototype Model Acc: 0.9052
Client 3: Prototype Model Acc: 0.7023
Client 4: Prototype Model Acc: 0.9347
Client 5: Prototype Model Acc: 0.8580
Client 6: Prototype Model Acc: 0.4665
Client 7: Prototype Model Acc: 0.9580
Client 8: Prototype Model Acc: 0.8816
Client 9: Prototype Model Acc: 0.9657
Client 10: Prototype Model Acc: 0.8680
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9203
Client 13: Prototype Model Acc: 0.8489
Client 14: Prototype Model Acc: 0.9589
Client 15: Prototype Model Acc: 0.9851
Client 16: Prototype Model Acc: 0.9263
Client 17: Prototype Model Acc: 0.8573
Client 18: Prototype Model Acc: 0.8748
Client 19: Prototype Model Acc: 0.6833
Averaged Test Accuracy (Regular Model): 0.9333
Averaged Test Accuracy (Prototype Model): 0.9051
Std Test Accuracy (Regular Model): 0.0495
Std Test Accuracy (Prototype Model): 0.1218
client.id trained 12
local_model_loss tensor(0.0848, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.2922, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0758, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.2317, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0654, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0771, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.3317, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0513, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.1617, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.1802, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.3260, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0941, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0298, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.1018, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0553, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0698, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0482, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0431, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.1197, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.2780, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 235.96476276312023
only_train_time: 2056.9261890021153
all_clients_time_cost: 2056.9261890021153
agg_protos_label dict_keys([0, 7, 5, 2, 3, 9, 6, 8, 4, 1])
-------------------------------------------------- 51.774736404418945

-------------Round number: 31-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 7, 3: 0, 4: 38, 5: 0, 6: 4, 7: 108, 8: 16, 9: 574}
Prototype-Based Model Correct Classifications (per class):
{0: 114, 1: 8, 2: 3, 3: 0, 4: 41, 5: 0, 6: 0, 7: 111, 8: 16, 9: 573}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 4, 8: 494, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 6, 8: 475, 9: 100}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 111, 1: 0, 2: 0, 3: 0, 4: 0, 5: 178, 6: 135, 7: 131, 8: 49, 9: 11}
Prototype-Based Model Correct Classifications (per class):
{0: 114, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 131, 7: 132, 8: 50, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 264, 1: 0, 2: 35, 3: 7, 4: 0, 5: 9, 6: 0, 7: 14, 8: 2, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 246, 1: 0, 2: 5, 3: 10, 4: 0, 5: 2, 6: 0, 7: 14, 8: 2, 9: 1}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 80, 1: 2, 2: 183, 3: 19, 4: 0, 5: 0, 6: 20, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 186, 3: 23, 4: 0, 5: 0, 6: 13, 7: 2, 8: 323, 9: 479}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 33, 1: 0, 2: 0, 3: 9, 4: 0, 5: 5, 6: 44, 7: 0, 8: 16, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 37, 7: 0, 8: 19, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 19, 1: 0, 2: 48, 3: 0, 4: 0, 5: 0, 6: 188, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 23, 1: 1, 2: 56, 3: 0, 4: 1, 5: 0, 6: 30, 7: 0, 8: 0, 9: 12}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 30, 1: 67, 2: 359, 3: 113, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 30, 1: 65, 2: 359, 3: 114, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 222, 1: 289, 2: 191, 3: 0, 4: 168, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 223, 1: 289, 2: 123, 3: 0, 4: 170, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 61, 1: 140, 2: 0, 3: 0, 4: 1, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 57, 1: 137, 2: 2, 3: 1, 4: 4, 5: 0, 6: 0, 7: 0, 8: 699, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 105, 1: 130, 2: 1, 3: 17, 4: 7, 5: 252, 6: 238, 7: 104, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 117, 1: 129, 2: 0, 3: 18, 4: 9, 5: 252, 6: 215, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1152, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 239, 1: 0, 2: 56, 3: 65, 4: 0, 5: 59, 6: 0, 7: 284, 8: 0, 9: 91}
Prototype-Based Model Correct Classifications (per class):
{0: 229, 1: 0, 2: 59, 3: 68, 4: 0, 5: 58, 6: 1, 7: 279, 8: 0, 9: 96}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 27, 1: 138, 2: 253, 3: 3, 4: 25, 5: 83, 6: 0, 7: 19, 8: 12, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 27, 1: 134, 2: 250, 3: 4, 4: 30, 5: 84, 6: 0, 7: 13, 8: 13, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 149, 1: 122, 2: 130, 3: 0, 4: 10, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 147, 1: 120, 2: 133, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 9, 1: 0, 2: 98, 3: 824, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 7, 1: 1, 2: 98, 3: 820, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 344, 4: 53, 5: 0, 6: 240, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 350, 4: 59, 5: 0, 6: 210, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 97, 1: 69, 2: 191, 3: 186, 4: 23, 5: 4, 6: 69, 7: 441, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 105, 1: 69, 2: 177, 3: 184, 4: 20, 5: 11, 6: 36, 7: 435, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 10, 4: 116, 5: 50, 6: 21, 7: 36, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 15, 1: 15, 2: 0, 3: 14, 4: 95, 5: 51, 6: 27, 7: 37, 8: 47, 9: 264}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 13, 1: 25, 2: 0, 3: 86, 4: 0, 5: 0, 6: 185, 7: 43, 8: 19, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 19, 1: 26, 2: 0, 3: 91, 4: 6, 5: 0, 6: 93, 7: 43, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9424
Client 1: Regular Model Acc: 0.9548
Client 2: Regular Model Acc: 0.8965
Client 3: Regular Model Acc: 0.8642
Client 4: Regular Model Acc: 0.9449
Client 5: Regular Model Acc: 0.8889
Client 6: Regular Model Acc: 0.7784
Client 7: Regular Model Acc: 0.9553
Client 8: Regular Model Acc: 0.9197
Client 9: Regular Model Acc: 0.9753
Client 10: Regular Model Acc: 0.8804
Client 11: Regular Model Acc: 0.9915
Client 12: Regular Model Acc: 0.9308
Client 13: Regular Model Acc: 0.8459
Client 14: Regular Model Acc: 0.9661
Client 15: Regular Model Acc: 0.9883
Client 16: Regular Model Acc: 0.9532
Client 17: Regular Model Acc: 0.8911
Client 18: Regular Model Acc: 0.9030
Client 19: Regular Model Acc: 0.8394
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9242
Client 1: Prototype Model Acc: 0.9247
Client 2: Prototype Model Acc: 0.8994
Client 3: Prototype Model Acc: 0.7311
Client 4: Prototype Model Acc: 0.9347
Client 5: Prototype Model Acc: 0.8611
Client 6: Prototype Model Acc: 0.3586
Client 7: Prototype Model Acc: 0.9544
Client 8: Prototype Model Acc: 0.8510
Client 9: Prototype Model Acc: 0.9657
Client 10: Prototype Model Acc: 0.8691
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9261
Client 13: Prototype Model Acc: 0.8384
Client 14: Prototype Model Acc: 0.9641
Client 15: Prototype Model Acc: 0.9830
Client 16: Prototype Model Acc: 0.9393
Client 17: Prototype Model Acc: 0.8556
Client 18: Prototype Model Acc: 0.8842
Client 19: Prototype Model Acc: 0.6810
Averaged Test Accuracy (Regular Model): 0.9314
Averaged Test Accuracy (Prototype Model): 0.9028
Std Test Accuracy (Regular Model): 0.0542
Std Test Accuracy (Prototype Model): 0.1397
client.id trained 16
local_model_loss tensor(0.0534, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0427, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0290, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.3098, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0650, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0449, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.2269, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.1549, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0738, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0504, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0723, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0734, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.1066, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.1531, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0798, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.2988, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.0972, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0709, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.2349, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.2877, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 242.83203048910946
only_train_time: 2121.2416755908635
all_clients_time_cost: 2121.2416755908635
agg_protos_label dict_keys([7, 4, 3, 1, 6, 0, 2, 5, 8, 9])
Number of samples: 167
-------------------------------------------------- 67.15284633636475

-------------Round number: 32-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 7, 3: 0, 4: 38, 5: 0, 6: 4, 7: 108, 8: 16, 9: 575}
Prototype-Based Model Correct Classifications (per class):
{0: 114, 1: 8, 2: 3, 3: 0, 4: 41, 5: 0, 6: 0, 7: 111, 8: 16, 9: 573}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 4, 8: 494, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 5, 6: 272, 7: 6, 8: 473, 9: 100}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 101, 1: 0, 2: 0, 3: 0, 4: 0, 5: 177, 6: 147, 7: 131, 8: 50, 9: 11}
Prototype-Based Model Correct Classifications (per class):
{0: 105, 1: 1, 2: 0, 3: 0, 4: 0, 5: 176, 6: 144, 7: 132, 8: 51, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 259, 1: 0, 2: 43, 3: 9, 4: 0, 5: 10, 6: 0, 7: 14, 8: 3, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 234, 1: 0, 2: 6, 3: 11, 4: 0, 5: 3, 6: 0, 7: 14, 8: 2, 9: 1}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 79, 1: 2, 2: 185, 3: 19, 4: 0, 5: 0, 6: 16, 7: 1, 8: 331, 9: 477}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 187, 3: 23, 4: 0, 5: 0, 6: 11, 7: 2, 8: 323, 9: 479}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 33, 1: 0, 2: 0, 3: 9, 4: 0, 5: 5, 6: 44, 7: 0, 8: 16, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 28, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 37, 7: 0, 8: 19, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 14, 1: 0, 2: 49, 3: 0, 4: 0, 5: 0, 6: 203, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 23, 1: 1, 2: 57, 3: 0, 4: 1, 5: 0, 6: 44, 7: 0, 8: 0, 9: 12}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 30, 1: 67, 2: 359, 3: 115, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 65, 2: 359, 3: 118, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 222, 1: 289, 2: 215, 3: 0, 4: 160, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 289, 2: 168, 3: 0, 4: 168, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 62, 1: 140, 2: 0, 3: 0, 4: 1, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 58, 1: 137, 2: 2, 3: 1, 4: 5, 5: 0, 6: 0, 7: 0, 8: 698, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 108, 1: 130, 2: 1, 3: 17, 4: 7, 5: 252, 6: 236, 7: 104, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 118, 1: 129, 2: 0, 3: 18, 4: 8, 5: 252, 6: 216, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1152, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 238, 1: 0, 2: 57, 3: 67, 4: 0, 5: 60, 6: 0, 7: 284, 8: 0, 9: 95}
Prototype-Based Model Correct Classifications (per class):
{0: 224, 1: 0, 2: 59, 3: 69, 4: 0, 5: 58, 6: 1, 7: 276, 8: 0, 9: 99}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 26, 1: 138, 2: 252, 3: 3, 4: 36, 5: 82, 6: 0, 7: 20, 8: 12, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 27, 1: 134, 2: 248, 3: 4, 4: 34, 5: 84, 6: 1, 7: 14, 8: 13, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 150, 1: 122, 2: 134, 3: 0, 4: 10, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 145, 1: 120, 2: 134, 3: 0, 4: 7, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 9, 1: 0, 2: 98, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 7, 1: 1, 2: 98, 3: 824, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 348, 4: 55, 5: 0, 6: 231, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 352, 4: 62, 5: 0, 6: 201, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 99, 1: 69, 2: 193, 3: 185, 4: 16, 5: 4, 6: 69, 7: 441, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 105, 1: 69, 2: 181, 3: 184, 4: 19, 5: 11, 6: 38, 7: 435, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 113, 5: 50, 6: 27, 7: 34, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 15, 1: 15, 2: 0, 3: 14, 4: 88, 5: 51, 6: 29, 7: 37, 8: 47, 9: 265}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 10, 1: 25, 2: 0, 3: 86, 4: 0, 5: 0, 6: 186, 7: 43, 8: 19, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 19, 1: 24, 2: 0, 3: 90, 4: 6, 5: 0, 6: 104, 7: 43, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9434
Client 1: Regular Model Acc: 0.9548
Client 2: Regular Model Acc: 0.8994
Client 3: Regular Model Acc: 0.8825
Client 4: Regular Model Acc: 0.9415
Client 5: Regular Model Acc: 0.8889
Client 6: Regular Model Acc: 0.8105
Client 7: Regular Model Acc: 0.9571
Client 8: Regular Model Acc: 0.9366
Client 9: Regular Model Acc: 0.9764
Client 10: Regular Model Acc: 0.8814
Client 11: Regular Model Acc: 0.9915
Client 12: Regular Model Acc: 0.9390
Client 13: Regular Model Acc: 0.8595
Client 14: Regular Model Acc: 0.9713
Client 15: Regular Model Acc: 0.9894
Client 16: Regular Model Acc: 0.9506
Client 17: Regular Model Acc: 0.8878
Client 18: Regular Model Acc: 0.9077
Client 19: Regular Model Acc: 0.8348
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9242
Client 1: Prototype Model Acc: 0.9214
Client 2: Prototype Model Acc: 0.9052
Client 3: Prototype Model Acc: 0.7076
Client 4: Prototype Model Acc: 0.9338
Client 5: Prototype Model Acc: 0.8580
Client 6: Prototype Model Acc: 0.4023
Client 7: Prototype Model Acc: 0.9571
Client 8: Prototype Model Acc: 0.9006
Client 9: Prototype Model Acc: 0.9667
Client 10: Prototype Model Acc: 0.8701
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9215
Client 13: Prototype Model Acc: 0.8444
Client 14: Prototype Model Acc: 0.9610
Client 15: Prototype Model Acc: 0.9873
Client 16: Prototype Model Acc: 0.9358
Client 17: Prototype Model Acc: 0.8597
Client 18: Prototype Model Acc: 0.8779
Client 19: Prototype Model Acc: 0.6991
Averaged Test Accuracy (Regular Model): 0.9344
Averaged Test Accuracy (Prototype Model): 0.9064
Std Test Accuracy (Regular Model): 0.0496
Std Test Accuracy (Prototype Model): 0.1319
client.id trained 10
local_model_loss tensor(0.1411, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0395, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.1050, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0484, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0502, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0719, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.2210, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.2739, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0283, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.3121, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0461, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0710, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0752, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0617, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.0972, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.2213, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.2724, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0637, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0712, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.1542, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 249.47315341013018
only_train_time: 2184.502728116233
all_clients_time_cost: 2184.502728116233
agg_protos_label dict_keys([5, 1, 3, 6, 7, 0, 4, 2, 9, 8])
-------------------------------------------------- 64.93723702430725

-------------Round number: 33-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 7, 3: 0, 4: 39, 5: 0, 6: 4, 7: 108, 8: 16, 9: 575}
Prototype-Based Model Correct Classifications (per class):
{0: 114, 1: 8, 2: 3, 3: 0, 4: 41, 5: 0, 6: 0, 7: 111, 8: 16, 9: 573}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 4, 8: 495, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 270, 7: 7, 8: 474, 9: 100}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 118, 1: 0, 2: 0, 3: 0, 4: 0, 5: 178, 6: 130, 7: 131, 8: 48, 9: 11}
Prototype-Based Model Correct Classifications (per class):
{0: 116, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 129, 7: 132, 8: 50, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 264, 1: 0, 2: 37, 3: 7, 4: 0, 5: 9, 6: 0, 7: 14, 8: 2, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 246, 1: 0, 2: 7, 3: 10, 4: 0, 5: 2, 6: 0, 7: 14, 8: 2, 9: 2}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 80, 1: 2, 2: 182, 3: 19, 4: 0, 5: 0, 6: 21, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 185, 3: 23, 4: 0, 5: 0, 6: 13, 7: 2, 8: 323, 9: 479}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 28, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 46, 7: 0, 8: 17, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 27, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 39, 7: 0, 8: 20, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 10, 1: 0, 2: 45, 3: 0, 4: 0, 5: 0, 6: 216, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 22, 1: 1, 2: 57, 3: 0, 4: 1, 5: 0, 6: 67, 7: 0, 8: 0, 9: 12}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 30, 1: 67, 2: 358, 3: 115, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 65, 2: 359, 3: 118, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 222, 1: 289, 2: 212, 3: 0, 4: 163, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 289, 2: 164, 3: 0, 4: 168, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 61, 1: 140, 2: 0, 3: 0, 4: 1, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 58, 1: 137, 2: 2, 3: 1, 4: 5, 5: 0, 6: 0, 7: 0, 8: 699, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 107, 1: 130, 2: 1, 3: 16, 4: 7, 5: 252, 6: 236, 7: 104, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 118, 1: 129, 2: 0, 3: 18, 4: 9, 5: 252, 6: 216, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1152, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 238, 1: 0, 2: 56, 3: 65, 4: 0, 5: 59, 6: 0, 7: 284, 8: 0, 9: 92}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 0, 2: 59, 3: 69, 4: 0, 5: 58, 6: 1, 7: 280, 8: 0, 9: 96}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 25, 1: 138, 2: 232, 3: 2, 4: 61, 5: 81, 6: 0, 7: 20, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 25, 1: 135, 2: 226, 3: 4, 4: 55, 5: 84, 6: 1, 7: 17, 8: 14, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 149, 1: 122, 2: 129, 3: 0, 4: 12, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 148, 1: 120, 2: 133, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 9, 1: 0, 2: 98, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 7, 1: 1, 2: 98, 3: 819, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 344, 4: 54, 5: 0, 6: 240, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 349, 4: 59, 5: 0, 6: 210, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 100, 1: 69, 2: 186, 3: 189, 4: 27, 5: 4, 6: 68, 7: 441, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 105, 1: 69, 2: 175, 3: 184, 4: 23, 5: 11, 6: 35, 7: 436, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 114, 5: 50, 6: 27, 7: 36, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 14, 1: 15, 2: 0, 3: 14, 4: 92, 5: 51, 6: 29, 7: 38, 8: 47, 9: 264}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 13, 1: 25, 2: 0, 3: 86, 4: 0, 5: 0, 6: 185, 7: 43, 8: 19, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 20, 1: 26, 2: 0, 3: 91, 4: 6, 5: 0, 6: 102, 7: 43, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9445
Client 1: Regular Model Acc: 0.9559
Client 2: Regular Model Acc: 0.8980
Client 3: Regular Model Acc: 0.8695
Client 4: Regular Model Acc: 0.9449
Client 5: Regular Model Acc: 0.8858
Client 6: Regular Model Acc: 0.8251
Client 7: Regular Model Acc: 0.9562
Client 8: Regular Model Acc: 0.9366
Client 9: Regular Model Acc: 0.9753
Client 10: Regular Model Acc: 0.8794
Client 11: Regular Model Acc: 0.9915
Client 12: Regular Model Acc: 0.9308
Client 13: Regular Model Acc: 0.8640
Client 14: Regular Model Acc: 0.9671
Client 15: Regular Model Acc: 0.9894
Client 16: Regular Model Acc: 0.9540
Client 17: Regular Model Acc: 0.8944
Client 18: Regular Model Acc: 0.9124
Client 19: Regular Model Acc: 0.8394
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9242
Client 1: Prototype Model Acc: 0.9225
Client 2: Prototype Model Acc: 0.8994
Client 3: Prototype Model Acc: 0.7389
Client 4: Prototype Model Acc: 0.9338
Client 5: Prototype Model Acc: 0.8642
Client 6: Prototype Model Acc: 0.4665
Client 7: Prototype Model Acc: 0.9571
Client 8: Prototype Model Acc: 0.8964
Client 9: Prototype Model Acc: 0.9678
Client 10: Prototype Model Acc: 0.8711
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9261
Client 13: Prototype Model Acc: 0.8474
Client 14: Prototype Model Acc: 0.9651
Client 15: Prototype Model Acc: 0.9820
Client 16: Prototype Model Acc: 0.9384
Client 17: Prototype Model Acc: 0.8564
Client 18: Prototype Model Acc: 0.8826
Client 19: Prototype Model Acc: 0.7036
Averaged Test Accuracy (Regular Model): 0.9349
Averaged Test Accuracy (Prototype Model): 0.9087
Std Test Accuracy (Regular Model): 0.0478
Std Test Accuracy (Prototype Model): 0.1184
client.id trained 10
local_model_loss tensor(0.1335, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.2775, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0916, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.6414, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.2215, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0683, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.2199, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0618, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0597, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.3001, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0418, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0690, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0423, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.1425, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.0890, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0489, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0474, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.3583, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0276, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.1006, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 256.866752259084
only_train_time: 2248.9843472981593
all_clients_time_cost: 2248.9843472981593
agg_protos_label dict_keys([5, 1, 3, 6, 7, 0, 4, 2, 8, 9])
-------------------------------------------------- 65.96443200111389

-------------Round number: 34-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 7, 3: 0, 4: 39, 5: 0, 6: 4, 7: 108, 8: 16, 9: 574}
Prototype-Based Model Correct Classifications (per class):
{0: 114, 1: 8, 2: 3, 3: 0, 4: 40, 5: 0, 6: 0, 7: 111, 8: 16, 9: 574}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 4, 8: 495, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 5, 6: 271, 7: 8, 8: 474, 9: 100}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 106, 1: 0, 2: 0, 3: 0, 4: 0, 5: 177, 6: 143, 7: 131, 8: 50, 9: 11}
Prototype-Based Model Correct Classifications (per class):
{0: 110, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 136, 7: 131, 8: 51, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 256, 1: 0, 2: 45, 3: 9, 4: 0, 5: 10, 6: 2, 7: 14, 8: 3, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 234, 1: 0, 2: 7, 3: 11, 4: 0, 5: 3, 6: 0, 7: 14, 8: 2, 9: 2}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 81, 1: 2, 2: 185, 3: 19, 4: 0, 5: 0, 6: 18, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 188, 3: 23, 4: 0, 5: 0, 6: 11, 7: 2, 8: 322, 9: 479}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 23, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 49, 7: 0, 8: 19, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 25, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 39, 7: 0, 8: 20, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 6, 1: 0, 2: 8, 3: 0, 4: 0, 5: 0, 6: 235, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 21, 1: 0, 2: 48, 3: 0, 4: 0, 5: 0, 6: 163, 7: 0, 8: 0, 9: 12}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 30, 1: 67, 2: 358, 3: 114, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 30, 1: 65, 2: 359, 3: 118, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 221, 1: 289, 2: 201, 3: 0, 4: 165, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 226, 1: 289, 2: 146, 3: 0, 4: 169, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 62, 1: 140, 2: 0, 3: 0, 4: 1, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 58, 1: 137, 2: 2, 3: 1, 4: 5, 5: 0, 6: 0, 7: 0, 8: 698, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 107, 1: 130, 2: 1, 3: 16, 4: 7, 5: 252, 6: 237, 7: 104, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 117, 1: 129, 2: 1, 3: 18, 4: 8, 5: 252, 6: 218, 7: 105, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1152, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 713, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 239, 1: 0, 2: 54, 3: 61, 4: 0, 5: 55, 6: 0, 7: 286, 8: 0, 9: 92}
Prototype-Based Model Correct Classifications (per class):
{0: 201, 1: 0, 2: 61, 3: 69, 4: 0, 5: 46, 6: 0, 7: 275, 8: 0, 9: 94}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 25, 1: 138, 2: 232, 3: 2, 4: 61, 5: 81, 6: 0, 7: 20, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 26, 1: 135, 2: 226, 3: 4, 4: 54, 5: 84, 6: 1, 7: 17, 8: 14, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 150, 1: 122, 2: 132, 3: 0, 4: 10, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 148, 1: 120, 2: 134, 3: 0, 4: 7, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 9, 1: 0, 2: 97, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 7, 1: 0, 2: 98, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 346, 4: 54, 5: 0, 6: 235, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 349, 4: 61, 5: 0, 6: 205, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 98, 1: 69, 2: 193, 3: 186, 4: 24, 5: 4, 6: 70, 7: 441, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 106, 1: 69, 2: 181, 3: 184, 4: 19, 5: 11, 6: 40, 7: 434, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 113, 5: 50, 6: 27, 7: 36, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 15, 1: 15, 2: 0, 3: 14, 4: 89, 5: 51, 6: 29, 7: 38, 8: 46, 9: 265}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 15, 1: 26, 2: 0, 3: 86, 4: 0, 5: 0, 6: 180, 7: 43, 8: 20, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 21, 1: 26, 2: 0, 3: 92, 4: 6, 5: 0, 6: 89, 7: 43, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9434
Client 1: Regular Model Acc: 0.9559
Client 2: Regular Model Acc: 0.9009
Client 3: Regular Model Acc: 0.8851
Client 4: Regular Model Acc: 0.9457
Client 5: Regular Model Acc: 0.8858
Client 6: Regular Model Acc: 0.7609
Client 7: Regular Model Acc: 0.9553
Client 8: Regular Model Acc: 0.9260
Client 9: Regular Model Acc: 0.9764
Client 10: Regular Model Acc: 0.8804
Client 11: Regular Model Acc: 0.9915
Client 12: Regular Model Acc: 0.9226
Client 13: Regular Model Acc: 0.8640
Client 14: Regular Model Acc: 0.9692
Client 15: Regular Model Acc: 0.9883
Client 16: Regular Model Acc: 0.9514
Client 17: Regular Model Acc: 0.8952
Client 18: Regular Model Acc: 0.9108
Client 19: Regular Model Acc: 0.8371
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9242
Client 1: Prototype Model Acc: 0.9236
Client 2: Prototype Model Acc: 0.9009
Client 3: Prototype Model Acc: 0.7128
Client 4: Prototype Model Acc: 0.9338
Client 5: Prototype Model Acc: 0.8580
Client 6: Prototype Model Acc: 0.7114
Client 7: Prototype Model Acc: 0.9580
Client 8: Prototype Model Acc: 0.8774
Client 9: Prototype Model Acc: 0.9667
Client 10: Prototype Model Acc: 0.8742
Client 11: Prototype Model Acc: 0.9920
Client 12: Prototype Model Acc: 0.8746
Client 13: Prototype Model Acc: 0.8474
Client 14: Prototype Model Acc: 0.9641
Client 15: Prototype Model Acc: 0.9873
Client 16: Prototype Model Acc: 0.9358
Client 17: Prototype Model Acc: 0.8614
Client 18: Prototype Model Acc: 0.8795
Client 19: Prototype Model Acc: 0.6787
Averaged Test Accuracy (Regular Model): 0.9331
Averaged Test Accuracy (Prototype Model): 0.9092
Std Test Accuracy (Regular Model): 0.0549
Std Test Accuracy (Prototype Model): 0.0877
client.id trained 10
local_model_loss tensor(0.1299, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0695, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0672, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0926, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0583, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.2501, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.1280, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.3001, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0427, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0366, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.2700, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0574, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.2156, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.1241, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0269, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0459, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.1570, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.2171, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0661, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0457, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 264.23052780807484
only_train_time: 2312.017668550019
all_clients_time_cost: 2312.017668550019
agg_protos_label dict_keys([5, 1, 3, 6, 7, 0, 4, 2, 8, 9])
-------------------------------------------------- 64.72063684463501

-------------Round number: 35-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 7, 3: 0, 4: 39, 5: 0, 6: 4, 7: 108, 8: 16, 9: 575}
Prototype-Based Model Correct Classifications (per class):
{0: 114, 1: 8, 2: 3, 3: 0, 4: 41, 5: 0, 6: 0, 7: 111, 8: 16, 9: 573}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 4, 8: 495, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 270, 7: 8, 8: 475, 9: 100}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 96, 1: 0, 2: 0, 3: 0, 4: 0, 5: 177, 6: 149, 7: 131, 8: 50, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 100, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 147, 7: 132, 8: 51, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 263, 1: 0, 2: 37, 3: 7, 4: 0, 5: 10, 6: 0, 7: 14, 8: 2, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 247, 1: 0, 2: 15, 3: 11, 4: 0, 5: 2, 6: 1, 7: 14, 8: 2, 9: 3}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 79, 1: 2, 2: 184, 3: 19, 4: 0, 5: 0, 6: 21, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 73, 1: 2, 2: 185, 3: 23, 4: 0, 5: 0, 6: 13, 7: 2, 8: 322, 9: 479}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 26, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 48, 7: 0, 8: 18, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 27, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 39, 7: 0, 8: 20, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 7, 1: 0, 2: 32, 3: 0, 4: 0, 5: 0, 6: 231, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 18, 1: 0, 2: 55, 3: 0, 4: 0, 5: 0, 6: 131, 7: 0, 8: 0, 9: 12}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 30, 1: 67, 2: 358, 3: 115, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 65, 2: 359, 3: 118, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 221, 1: 289, 2: 219, 3: 0, 4: 158, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 289, 2: 172, 3: 0, 4: 168, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 62, 1: 140, 2: 0, 3: 1, 4: 1, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 58, 1: 137, 2: 2, 3: 1, 4: 5, 5: 0, 6: 0, 7: 0, 8: 701, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 103, 1: 130, 2: 1, 3: 16, 4: 7, 5: 252, 6: 240, 7: 104, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 116, 1: 129, 2: 1, 3: 18, 4: 8, 5: 252, 6: 219, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1152, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 238, 1: 0, 2: 56, 3: 65, 4: 0, 5: 59, 6: 0, 7: 288, 8: 0, 9: 93}
Prototype-Based Model Correct Classifications (per class):
{0: 214, 1: 0, 2: 60, 3: 70, 4: 0, 5: 58, 6: 0, 7: 278, 8: 0, 9: 97}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 25, 1: 138, 2: 241, 3: 2, 4: 54, 5: 81, 6: 0, 7: 20, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 25, 1: 135, 2: 234, 3: 4, 4: 50, 5: 84, 6: 1, 7: 17, 8: 14, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 149, 1: 122, 2: 129, 3: 0, 4: 12, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 148, 1: 120, 2: 133, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 9, 1: 0, 2: 98, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 7, 1: 1, 2: 98, 3: 823, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 342, 4: 52, 5: 0, 6: 239, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 349, 4: 59, 5: 0, 6: 212, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 101, 1: 69, 2: 190, 3: 188, 4: 24, 5: 4, 6: 68, 7: 441, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 105, 1: 69, 2: 176, 3: 185, 4: 23, 5: 12, 6: 38, 7: 434, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 113, 5: 50, 6: 27, 7: 35, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 14, 1: 15, 2: 0, 3: 14, 4: 89, 5: 51, 6: 29, 7: 38, 8: 47, 9: 265}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 15, 1: 26, 2: 0, 3: 89, 4: 0, 5: 0, 6: 178, 7: 43, 8: 21, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 21, 1: 26, 2: 1, 3: 92, 4: 5, 5: 0, 6: 106, 7: 43, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9445
Client 1: Regular Model Acc: 0.9559
Client 2: Regular Model Acc: 0.8980
Client 3: Regular Model Acc: 0.8695
Client 4: Regular Model Acc: 0.9457
Client 5: Regular Model Acc: 0.8889
Client 6: Regular Model Acc: 0.8222
Client 7: Regular Model Acc: 0.9562
Client 8: Regular Model Acc: 0.9376
Client 9: Regular Model Acc: 0.9775
Client 10: Regular Model Acc: 0.8794
Client 11: Regular Model Acc: 0.9915
Client 12: Regular Model Acc: 0.9367
Client 13: Regular Model Acc: 0.8671
Client 14: Regular Model Acc: 0.9671
Client 15: Regular Model Acc: 0.9894
Client 16: Regular Model Acc: 0.9506
Client 17: Regular Model Acc: 0.8952
Client 18: Regular Model Acc: 0.9092
Client 19: Regular Model Acc: 0.8416
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9242
Client 1: Prototype Model Acc: 0.9247
Client 2: Prototype Model Acc: 0.9038
Client 3: Prototype Model Acc: 0.7702
Client 4: Prototype Model Acc: 0.9321
Client 5: Prototype Model Acc: 0.8642
Client 6: Prototype Model Acc: 0.6297
Client 7: Prototype Model Acc: 0.9571
Client 8: Prototype Model Acc: 0.9049
Client 9: Prototype Model Acc: 0.9700
Client 10: Prototype Model Acc: 0.8722
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9109
Client 13: Prototype Model Acc: 0.8520
Client 14: Prototype Model Acc: 0.9651
Client 15: Prototype Model Acc: 0.9862
Client 16: Prototype Model Acc: 0.9402
Client 17: Prototype Model Acc: 0.8597
Client 18: Prototype Model Acc: 0.8795
Client 19: Prototype Model Acc: 0.7172
Averaged Test Accuracy (Regular Model): 0.9353
Averaged Test Accuracy (Prototype Model): 0.9136
Std Test Accuracy (Regular Model): 0.0478
Std Test Accuracy (Prototype Model): 0.0892
client.id trained 7
local_model_loss tensor(0.0571, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0262, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0387, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.1343, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0449, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0652, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.2881, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.1360, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.3024, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.3053, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.1000, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0992, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.2131, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0558, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0635, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.1143, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0377, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.2292, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0447, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0705, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 270.99925761902705
only_train_time: 2374.7234052751446
all_clients_time_cost: 2374.7234052751446
agg_protos_label dict_keys([2, 5, 1, 0, 3, 4, 7, 6, 8, 9])
Number of samples: 167
-------------------------------------------------- 65.94450807571411

-------------Round number: 36-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 7, 3: 0, 4: 39, 5: 0, 6: 4, 7: 108, 8: 16, 9: 575}
Prototype-Based Model Correct Classifications (per class):
{0: 114, 1: 8, 2: 3, 3: 0, 4: 41, 5: 0, 6: 1, 7: 111, 8: 16, 9: 573}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 4, 8: 495, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 271, 7: 8, 8: 475, 9: 99}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 121, 1: 0, 2: 0, 3: 0, 4: 0, 5: 178, 6: 120, 7: 131, 8: 48, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 122, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 119, 7: 132, 8: 49, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 255, 1: 0, 2: 46, 3: 9, 4: 0, 5: 10, 6: 2, 7: 14, 8: 3, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 235, 1: 0, 2: 7, 3: 11, 4: 0, 5: 4, 6: 0, 7: 14, 8: 2, 9: 3}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 80, 1: 2, 2: 185, 3: 19, 4: 0, 5: 0, 6: 17, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 187, 3: 23, 4: 0, 5: 0, 6: 11, 7: 2, 8: 322, 9: 479}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 39, 1: 0, 2: 0, 3: 9, 4: 0, 5: 5, 6: 42, 7: 0, 8: 17, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 30, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 37, 7: 0, 8: 19, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 11, 1: 0, 2: 19, 3: 0, 4: 0, 5: 0, 6: 230, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 24, 1: 0, 2: 51, 3: 0, 4: 0, 5: 0, 6: 142, 7: 0, 8: 0, 9: 12}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 31, 1: 67, 2: 358, 3: 113, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 30, 1: 65, 2: 359, 3: 114, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 222, 1: 289, 2: 209, 3: 0, 4: 165, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 226, 1: 289, 2: 164, 3: 0, 4: 169, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 62, 1: 140, 2: 0, 3: 1, 4: 2, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 58, 1: 137, 2: 2, 3: 1, 4: 5, 5: 0, 6: 0, 7: 0, 8: 699, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 109, 1: 130, 2: 1, 3: 17, 4: 7, 5: 252, 6: 237, 7: 104, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 119, 1: 129, 2: 0, 3: 18, 4: 12, 5: 252, 6: 217, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1152, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 240, 1: 0, 2: 55, 3: 65, 4: 0, 5: 59, 6: 0, 7: 288, 8: 0, 9: 93}
Prototype-Based Model Correct Classifications (per class):
{0: 221, 1: 0, 2: 60, 3: 69, 4: 0, 5: 59, 6: 1, 7: 279, 8: 0, 9: 97}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 26, 1: 138, 2: 247, 3: 2, 4: 44, 5: 81, 6: 0, 7: 20, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 27, 1: 134, 2: 245, 3: 4, 4: 39, 5: 84, 6: 1, 7: 17, 8: 13, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 150, 1: 122, 2: 130, 3: 0, 4: 10, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 148, 1: 120, 2: 133, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 9, 1: 0, 2: 97, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 7, 1: 1, 2: 98, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 345, 4: 54, 5: 0, 6: 237, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 349, 4: 59, 5: 0, 6: 211, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 99, 1: 69, 2: 193, 3: 184, 4: 17, 5: 4, 6: 70, 7: 441, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 105, 1: 69, 2: 182, 3: 183, 4: 17, 5: 12, 6: 41, 7: 435, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 10, 4: 116, 5: 50, 6: 22, 7: 37, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 14, 1: 15, 2: 0, 3: 13, 4: 99, 5: 51, 6: 25, 7: 38, 8: 47, 9: 261}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 14, 1: 26, 2: 0, 3: 87, 4: 0, 5: 0, 6: 181, 7: 43, 8: 20, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 21, 1: 26, 2: 0, 3: 92, 4: 6, 5: 0, 6: 93, 7: 43, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9445
Client 1: Regular Model Acc: 0.9559
Client 2: Regular Model Acc: 0.8892
Client 3: Regular Model Acc: 0.8851
Client 4: Regular Model Acc: 0.9440
Client 5: Regular Model Acc: 0.9043
Client 6: Regular Model Acc: 0.7930
Client 7: Regular Model Acc: 0.9553
Client 8: Regular Model Acc: 0.9355
Client 9: Regular Model Acc: 0.9785
Client 10: Regular Model Acc: 0.8835
Client 11: Regular Model Acc: 0.9915
Client 12: Regular Model Acc: 0.9379
Client 13: Regular Model Acc: 0.8625
Client 14: Regular Model Acc: 0.9671
Client 15: Regular Model Acc: 0.9894
Client 16: Regular Model Acc: 0.9532
Client 17: Regular Model Acc: 0.8886
Client 18: Regular Model Acc: 0.9061
Client 19: Regular Model Acc: 0.8394
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9253
Client 1: Prototype Model Acc: 0.9247
Client 2: Prototype Model Acc: 0.8921
Client 3: Prototype Model Acc: 0.7206
Client 4: Prototype Model Acc: 0.9330
Client 5: Prototype Model Acc: 0.8642
Client 6: Prototype Model Acc: 0.6676
Client 7: Prototype Model Acc: 0.9544
Client 8: Prototype Model Acc: 0.8964
Client 9: Prototype Model Acc: 0.9678
Client 10: Prototype Model Acc: 0.8763
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9215
Client 13: Prototype Model Acc: 0.8520
Client 14: Prototype Model Acc: 0.9651
Client 15: Prototype Model Acc: 0.9883
Client 16: Prototype Model Acc: 0.9393
Client 17: Prototype Model Acc: 0.8614
Client 18: Prototype Model Acc: 0.8811
Client 19: Prototype Model Acc: 0.6878
Averaged Test Accuracy (Regular Model): 0.9345
Averaged Test Accuracy (Prototype Model): 0.9124
Std Test Accuracy (Regular Model): 0.0509
Std Test Accuracy (Prototype Model): 0.0910
client.id trained 2
local_model_loss tensor(0.0836, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0872, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0634, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0434, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.2529, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0851, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.2470, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0337, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0416, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0256, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0394, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0611, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.2124, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.1216, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.2575, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0586, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0678, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.1263, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0559, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.2919, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 278.4662870829925
only_train_time: 2438.974760610843
all_clients_time_cost: 2438.974760610843
agg_protos_label dict_keys([7, 5, 4, 6, 9, 8, 0, 1, 2, 3])
-------------------------------------------------- 65.82910561561584

-------------Round number: 37-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 7, 3: 0, 4: 39, 5: 0, 6: 4, 7: 108, 8: 16, 9: 574}
Prototype-Based Model Correct Classifications (per class):
{0: 114, 1: 8, 2: 3, 3: 0, 4: 40, 5: 0, 6: 0, 7: 112, 8: 16, 9: 573}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 4, 8: 496, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 270, 7: 8, 8: 475, 9: 99}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 98, 1: 0, 2: 0, 3: 0, 4: 0, 5: 177, 6: 149, 7: 131, 8: 50, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 102, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 146, 7: 133, 8: 51, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 263, 1: 0, 2: 38, 3: 7, 4: 0, 5: 10, 6: 0, 7: 14, 8: 2, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 247, 1: 0, 2: 17, 3: 11, 4: 0, 5: 2, 6: 3, 7: 14, 8: 2, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 80, 1: 2, 2: 185, 3: 19, 4: 0, 5: 0, 6: 21, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 71, 1: 2, 2: 188, 3: 23, 4: 0, 5: 0, 6: 9, 7: 2, 8: 323, 9: 479}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 37, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 42, 7: 0, 8: 18, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 28, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 38, 7: 0, 8: 20, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 5, 1: 0, 2: 43, 3: 0, 4: 0, 5: 0, 6: 221, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 16, 1: 0, 2: 58, 3: 0, 4: 1, 5: 0, 6: 100, 7: 0, 8: 0, 9: 12}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 30, 1: 68, 2: 356, 3: 115, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 28, 1: 65, 2: 359, 3: 118, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 220, 1: 289, 2: 221, 3: 0, 4: 158, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 289, 2: 172, 3: 0, 4: 168, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 62, 1: 140, 2: 0, 3: 1, 4: 2, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 58, 1: 137, 2: 2, 3: 1, 4: 5, 5: 0, 6: 0, 7: 0, 8: 699, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 109, 1: 130, 2: 1, 3: 17, 4: 8, 5: 253, 6: 235, 7: 104, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 119, 1: 129, 2: 1, 3: 18, 4: 10, 5: 252, 6: 217, 7: 104, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1152, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 241, 1: 0, 2: 55, 3: 65, 4: 0, 5: 60, 6: 0, 7: 286, 8: 0, 9: 93}
Prototype-Based Model Correct Classifications (per class):
{0: 223, 1: 0, 2: 60, 3: 70, 4: 0, 5: 59, 6: 1, 7: 280, 8: 0, 9: 98}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 26, 1: 140, 2: 200, 3: 3, 4: 68, 5: 80, 6: 0, 7: 22, 8: 14, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 25, 1: 136, 2: 199, 3: 5, 4: 63, 5: 84, 6: 1, 7: 18, 8: 14, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 148, 1: 122, 2: 125, 3: 0, 4: 13, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 145, 1: 120, 2: 129, 3: 0, 4: 12, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 9, 1: 0, 2: 98, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 7, 1: 1, 2: 98, 3: 823, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 342, 4: 52, 5: 0, 6: 240, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 349, 4: 59, 5: 0, 6: 214, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 101, 1: 69, 2: 190, 3: 187, 4: 24, 5: 4, 6: 69, 7: 441, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 106, 1: 69, 2: 179, 3: 184, 4: 22, 5: 12, 6: 43, 7: 435, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 114, 5: 50, 6: 27, 7: 34, 8: 46, 9: 272}
Prototype-Based Model Correct Classifications (per class):
{0: 14, 1: 15, 2: 0, 3: 14, 4: 90, 5: 51, 6: 29, 7: 38, 8: 47, 9: 267}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 10, 1: 25, 2: 0, 3: 86, 4: 0, 5: 0, 6: 186, 7: 43, 8: 19, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 19, 1: 26, 2: 0, 3: 89, 4: 4, 5: 0, 6: 142, 7: 43, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9434
Client 1: Regular Model Acc: 0.9569
Client 2: Regular Model Acc: 0.9009
Client 3: Regular Model Acc: 0.8747
Client 4: Regular Model Acc: 0.9474
Client 5: Regular Model Acc: 0.9043
Client 6: Regular Model Acc: 0.8192
Client 7: Regular Model Acc: 0.9553
Client 8: Regular Model Acc: 0.9387
Client 9: Regular Model Acc: 0.9785
Client 10: Regular Model Acc: 0.8835
Client 11: Regular Model Acc: 0.9915
Client 12: Regular Model Acc: 0.9379
Client 13: Regular Model Acc: 0.8353
Client 14: Regular Model Acc: 0.9630
Client 15: Regular Model Acc: 0.9894
Client 16: Regular Model Acc: 0.9514
Client 17: Regular Model Acc: 0.8952
Client 18: Regular Model Acc: 0.9108
Client 19: Regular Model Acc: 0.8348
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9242
Client 1: Prototype Model Acc: 0.9236
Client 2: Prototype Model Acc: 0.9067
Client 3: Prototype Model Acc: 0.7833
Client 4: Prototype Model Acc: 0.9304
Client 5: Prototype Model Acc: 0.8642
Client 6: Prototype Model Acc: 0.5452
Client 7: Prototype Model Acc: 0.9562
Client 8: Prototype Model Acc: 0.9049
Client 9: Prototype Model Acc: 0.9678
Client 10: Prototype Model Acc: 0.8763
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9273
Client 13: Prototype Model Acc: 0.8233
Client 14: Prototype Model Acc: 0.9610
Client 15: Prototype Model Acc: 0.9862
Client 16: Prototype Model Acc: 0.9419
Client 17: Prototype Model Acc: 0.8663
Client 18: Prototype Model Acc: 0.8842
Client 19: Prototype Model Acc: 0.7828
Averaged Test Accuracy (Regular Model): 0.9348
Averaged Test Accuracy (Prototype Model): 0.9141
Std Test Accuracy (Regular Model): 0.0500
Std Test Accuracy (Prototype Model): 0.0978
client.id trained 3
local_model_loss tensor(0.2739, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.1914, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.0776, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0249, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0358, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.2392, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0597, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0794, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.3226, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0838, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.1145, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0405, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0541, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0425, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0616, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0580, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0441, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0530, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.1237, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.2052, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 285.9541631580796
only_train_time: 2503.1150450230343
all_clients_time_cost: 2503.1150450230343
agg_protos_label dict_keys([0, 2, 7, 6, 3, 5, 8, 9, 1, 4])
-------------------------------------------------- 65.87985634803772

-------------Round number: 38-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 7, 3: 0, 4: 39, 5: 0, 6: 4, 7: 108, 8: 16, 9: 577}
Prototype-Based Model Correct Classifications (per class):
{0: 114, 1: 8, 2: 3, 3: 0, 4: 40, 5: 0, 6: 1, 7: 111, 8: 16, 9: 574}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 5, 8: 496, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 271, 7: 7, 8: 474, 9: 99}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 115, 1: 0, 2: 0, 3: 0, 4: 0, 5: 178, 6: 133, 7: 131, 8: 49, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 116, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 131, 7: 132, 8: 51, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 255, 1: 0, 2: 46, 3: 10, 4: 0, 5: 10, 6: 2, 7: 14, 8: 3, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 235, 1: 0, 2: 7, 3: 11, 4: 0, 5: 4, 6: 0, 7: 14, 8: 2, 9: 3}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 79, 1: 2, 2: 184, 3: 19, 4: 0, 5: 0, 6: 21, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 186, 3: 22, 4: 0, 5: 0, 6: 12, 7: 2, 8: 324, 9: 479}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 37, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 42, 7: 0, 8: 18, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 38, 7: 0, 8: 20, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 22, 1: 0, 2: 49, 3: 0, 4: 0, 5: 0, 6: 179, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 23, 1: 1, 2: 58, 3: 0, 4: 1, 5: 0, 6: 33, 7: 0, 8: 0, 9: 12}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 32, 1: 67, 2: 358, 3: 112, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 30, 1: 65, 2: 359, 3: 115, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 220, 1: 289, 2: 221, 3: 0, 4: 156, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 289, 2: 179, 3: 0, 4: 168, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 62, 1: 140, 2: 0, 3: 1, 4: 3, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 58, 1: 137, 2: 2, 3: 1, 4: 5, 5: 0, 6: 0, 7: 0, 8: 698, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 107, 1: 130, 2: 1, 3: 16, 4: 8, 5: 253, 6: 233, 7: 104, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 119, 1: 129, 2: 2, 3: 18, 4: 11, 5: 252, 6: 216, 7: 102, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1152, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 241, 1: 0, 2: 55, 3: 65, 4: 0, 5: 60, 6: 0, 7: 286, 8: 0, 9: 93}
Prototype-Based Model Correct Classifications (per class):
{0: 224, 1: 0, 2: 60, 3: 69, 4: 0, 5: 59, 6: 1, 7: 281, 8: 0, 9: 97}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 26, 1: 138, 2: 247, 3: 2, 4: 41, 5: 81, 6: 0, 7: 20, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 27, 1: 135, 2: 243, 3: 4, 4: 41, 5: 84, 6: 1, 7: 17, 8: 13, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 145, 1: 121, 2: 130, 3: 0, 4: 13, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 141, 1: 121, 2: 132, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 9, 1: 0, 2: 97, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 7, 1: 1, 2: 98, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 344, 4: 54, 5: 0, 6: 239, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 349, 4: 59, 5: 0, 6: 213, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 99, 1: 69, 2: 192, 3: 184, 4: 19, 5: 4, 6: 71, 7: 441, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 106, 1: 69, 2: 181, 3: 183, 4: 20, 5: 12, 6: 44, 7: 435, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 114, 5: 50, 6: 28, 7: 36, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 14, 1: 15, 2: 0, 3: 13, 4: 92, 5: 51, 6: 28, 7: 38, 8: 47, 9: 265}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 14, 1: 26, 2: 0, 3: 86, 4: 0, 5: 0, 6: 183, 7: 43, 8: 20, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 20, 1: 26, 2: 0, 3: 90, 4: 5, 5: 0, 6: 118, 7: 43, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9466
Client 1: Regular Model Acc: 0.9580
Client 2: Regular Model Acc: 0.9023
Client 3: Regular Model Acc: 0.8903
Client 4: Regular Model Acc: 0.9457
Client 5: Regular Model Acc: 0.9043
Client 6: Regular Model Acc: 0.7638
Client 7: Regular Model Acc: 0.9553
Client 8: Regular Model Acc: 0.9366
Client 9: Regular Model Acc: 0.9796
Client 10: Regular Model Acc: 0.8784
Client 11: Regular Model Acc: 0.9915
Client 12: Regular Model Acc: 0.9379
Client 13: Regular Model Acc: 0.8580
Client 14: Regular Model Acc: 0.9641
Client 15: Regular Model Acc: 0.9894
Client 16: Regular Model Acc: 0.9540
Client 17: Regular Model Acc: 0.8903
Client 18: Regular Model Acc: 0.9139
Client 19: Regular Model Acc: 0.8416
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9253
Client 1: Prototype Model Acc: 0.9225
Client 2: Prototype Model Acc: 0.9038
Client 3: Prototype Model Acc: 0.7206
Client 4: Prototype Model Acc: 0.9338
Client 5: Prototype Model Acc: 0.8673
Client 6: Prototype Model Acc: 0.3732
Client 7: Prototype Model Acc: 0.9553
Client 8: Prototype Model Acc: 0.9123
Client 9: Prototype Model Acc: 0.9667
Client 10: Prototype Model Acc: 0.8753
Client 11: Prototype Model Acc: 0.9920
Client 12: Prototype Model Acc: 0.9273
Client 13: Prototype Model Acc: 0.8535
Client 14: Prototype Model Acc: 0.9579
Client 15: Prototype Model Acc: 0.9894
Client 16: Prototype Model Acc: 0.9410
Client 17: Prototype Model Acc: 0.8663
Client 18: Prototype Model Acc: 0.8811
Client 19: Prototype Model Acc: 0.7353
Averaged Test Accuracy (Regular Model): 0.9349
Averaged Test Accuracy (Prototype Model): 0.9095
Std Test Accuracy (Regular Model): 0.0546
Std Test Accuracy (Prototype Model): 0.1345
client.id trained 15
local_model_loss tensor(0.0365, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.2829, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0412, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0363, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.1854, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0527, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.2430, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0243, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.1158, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.2055, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.2128, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0491, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0788, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.0802, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0783, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0598, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0567, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0737, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0382, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.1017, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 292.4678145330399
only_train_time: 2570.6097878477303
all_clients_time_cost: 2570.6097878477303
agg_protos_label dict_keys([3, 2, 0, 1, 7, 6, 5, 8, 9, 4])
-------------------------------------------------- 69.14966154098511

-------------Round number: 39-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 7, 3: 0, 4: 39, 5: 0, 6: 4, 7: 108, 8: 16, 9: 574}
Prototype-Based Model Correct Classifications (per class):
{0: 114, 1: 8, 2: 3, 3: 0, 4: 41, 5: 0, 6: 1, 7: 112, 8: 16, 9: 573}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 5, 8: 496, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 271, 7: 7, 8: 476, 9: 99}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 107, 1: 0, 2: 0, 3: 0, 4: 0, 5: 178, 6: 143, 7: 131, 8: 50, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 110, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 137, 7: 132, 8: 51, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 263, 1: 0, 2: 38, 3: 7, 4: 0, 5: 10, 6: 0, 7: 14, 8: 2, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 249, 1: 0, 2: 23, 3: 11, 4: 0, 5: 2, 6: 3, 7: 14, 8: 2, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 80, 1: 2, 2: 184, 3: 19, 4: 0, 5: 0, 6: 19, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 185, 3: 22, 4: 0, 5: 0, 6: 12, 7: 2, 8: 323, 9: 479}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 38, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 42, 7: 0, 8: 18, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 37, 7: 0, 8: 20, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 13, 1: 0, 2: 35, 3: 0, 4: 0, 5: 0, 6: 218, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 24, 1: 0, 2: 53, 3: 0, 4: 1, 5: 0, 6: 123, 7: 0, 8: 0, 9: 12}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 30, 1: 68, 2: 357, 3: 116, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 28, 1: 65, 2: 359, 3: 119, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 222, 1: 289, 2: 197, 3: 0, 4: 167, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 222, 1: 289, 2: 137, 3: 0, 4: 170, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 62, 1: 140, 2: 0, 3: 1, 4: 2, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 58, 1: 137, 2: 2, 3: 1, 4: 5, 5: 0, 6: 0, 7: 0, 8: 700, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 108, 1: 129, 2: 1, 3: 16, 4: 7, 5: 253, 6: 234, 7: 104, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 119, 1: 129, 2: 1, 3: 18, 4: 11, 5: 252, 6: 213, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1152, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 241, 1: 0, 2: 55, 3: 65, 4: 0, 5: 60, 6: 0, 7: 286, 8: 0, 9: 93}
Prototype-Based Model Correct Classifications (per class):
{0: 225, 1: 0, 2: 59, 3: 69, 4: 0, 5: 59, 6: 1, 7: 282, 8: 0, 9: 96}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 25, 1: 138, 2: 242, 3: 2, 4: 52, 5: 81, 6: 0, 7: 20, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 26, 1: 135, 2: 236, 3: 4, 4: 50, 5: 84, 6: 1, 7: 17, 8: 14, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 147, 1: 122, 2: 129, 3: 0, 4: 13, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 144, 1: 120, 2: 131, 3: 0, 4: 11, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 9, 1: 0, 2: 97, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 98, 3: 824, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 341, 4: 51, 5: 0, 6: 240, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 347, 4: 58, 5: 0, 6: 215, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 102, 1: 69, 2: 190, 3: 188, 4: 24, 5: 4, 6: 69, 7: 441, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 106, 1: 69, 2: 179, 3: 184, 4: 22, 5: 12, 6: 44, 7: 436, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 114, 5: 50, 6: 28, 7: 35, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 14, 1: 15, 2: 0, 3: 13, 4: 92, 5: 51, 6: 28, 7: 38, 8: 47, 9: 266}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 15, 1: 26, 2: 0, 3: 87, 4: 1, 5: 0, 6: 180, 7: 43, 8: 20, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 21, 1: 26, 2: 1, 3: 90, 4: 5, 5: 0, 6: 132, 7: 43, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9434
Client 1: Regular Model Acc: 0.9580
Client 2: Regular Model Acc: 0.9067
Client 3: Regular Model Acc: 0.8747
Client 4: Regular Model Acc: 0.9449
Client 5: Regular Model Acc: 0.9074
Client 6: Regular Model Acc: 0.8105
Client 7: Regular Model Acc: 0.9571
Client 8: Regular Model Acc: 0.9249
Client 9: Regular Model Acc: 0.9785
Client 10: Regular Model Acc: 0.8784
Client 11: Regular Model Acc: 0.9915
Client 12: Regular Model Acc: 0.9379
Client 13: Regular Model Acc: 0.8656
Client 14: Regular Model Acc: 0.9661
Client 15: Regular Model Acc: 0.9883
Client 16: Regular Model Acc: 0.9497
Client 17: Regular Model Acc: 0.8969
Client 18: Regular Model Acc: 0.9124
Client 19: Regular Model Acc: 0.8439
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9264
Client 1: Prototype Model Acc: 0.9247
Client 2: Prototype Model Acc: 0.9038
Client 3: Prototype Model Acc: 0.8042
Client 4: Prototype Model Acc: 0.9321
Client 5: Prototype Model Acc: 0.8642
Client 6: Prototype Model Acc: 0.6210
Client 7: Prototype Model Acc: 0.9571
Client 8: Prototype Model Acc: 0.8647
Client 9: Prototype Model Acc: 0.9689
Client 10: Prototype Model Acc: 0.8722
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9273
Client 13: Prototype Model Acc: 0.8565
Client 14: Prototype Model Acc: 0.9610
Client 15: Prototype Model Acc: 0.9883
Client 16: Prototype Model Acc: 0.9402
Client 17: Prototype Model Acc: 0.8680
Client 18: Prototype Model Acc: 0.8826
Client 19: Prototype Model Acc: 0.7715
Averaged Test Accuracy (Regular Model): 0.9354
Averaged Test Accuracy (Prototype Model): 0.9150
Std Test Accuracy (Regular Model): 0.0479
Std Test Accuracy (Prototype Model): 0.0841
client.id trained 14
local_model_loss tensor(0.0333, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0237, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.1969, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0332, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.3151, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.1901, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0582, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0510, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.1130, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0692, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.2615, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.0715, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0553, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0550, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.1861, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.2632, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0369, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0769, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0402, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0460, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 298.9527255090652
only_train_time: 2635.033737059566
all_clients_time_cost: 2635.033737059566
agg_protos_label dict_keys([2, 5, 0, 4, 1, 3, 9, 6, 8, 7])
Number of samples: 167
-------------------------------------------------- 67.2278618812561

-------------Round number: 40-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 7, 3: 0, 4: 39, 5: 0, 6: 4, 7: 108, 8: 16, 9: 577}
Prototype-Based Model Correct Classifications (per class):
{0: 114, 1: 8, 2: 3, 3: 0, 4: 40, 5: 0, 6: 1, 7: 111, 8: 16, 9: 574}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 5, 8: 496, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 271, 7: 7, 8: 476, 9: 100}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 105, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 147, 7: 131, 8: 50, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 105, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 144, 7: 133, 8: 51, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 255, 1: 0, 2: 46, 3: 11, 4: 0, 5: 10, 6: 2, 7: 14, 8: 3, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 236, 1: 0, 2: 11, 3: 11, 4: 0, 5: 5, 6: 0, 7: 14, 8: 2, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 79, 1: 2, 2: 183, 3: 19, 4: 0, 5: 0, 6: 20, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 184, 3: 22, 4: 0, 5: 0, 6: 13, 7: 2, 8: 323, 9: 478}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 35, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 44, 7: 0, 8: 18, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 28, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 39, 7: 0, 8: 20, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 6, 1: 0, 2: 27, 3: 0, 4: 0, 5: 0, 6: 231, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 18, 1: 0, 2: 54, 3: 0, 4: 1, 5: 0, 6: 136, 7: 0, 8: 0, 9: 11}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 32, 1: 67, 2: 358, 3: 111, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 30, 1: 65, 2: 359, 3: 114, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 220, 1: 289, 2: 222, 3: 0, 4: 156, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 289, 2: 181, 3: 0, 4: 168, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 62, 1: 140, 2: 0, 3: 1, 4: 3, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 59, 1: 137, 2: 2, 3: 1, 4: 6, 5: 0, 6: 0, 7: 0, 8: 698, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 114, 1: 130, 2: 1, 3: 17, 4: 7, 5: 253, 6: 230, 7: 105, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 121, 1: 129, 2: 0, 3: 18, 4: 10, 5: 252, 6: 205, 7: 104, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1152, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 241, 1: 0, 2: 55, 3: 64, 4: 0, 5: 60, 6: 0, 7: 286, 8: 0, 9: 93}
Prototype-Based Model Correct Classifications (per class):
{0: 226, 1: 0, 2: 59, 3: 69, 4: 0, 5: 59, 6: 1, 7: 283, 8: 0, 9: 96}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 25, 1: 138, 2: 236, 3: 2, 4: 56, 5: 81, 6: 0, 7: 20, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 26, 1: 135, 2: 233, 3: 4, 4: 51, 5: 84, 6: 1, 7: 17, 8: 14, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 146, 1: 122, 2: 126, 3: 0, 4: 13, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 143, 1: 120, 2: 130, 3: 0, 4: 12, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 9, 1: 0, 2: 97, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 7, 1: 1, 2: 98, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 342, 4: 53, 5: 0, 6: 239, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 348, 4: 58, 5: 0, 6: 216, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 99, 1: 69, 2: 192, 3: 184, 4: 21, 5: 4, 6: 71, 7: 441, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 106, 1: 69, 2: 181, 3: 184, 4: 19, 5: 12, 6: 46, 7: 436, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 114, 5: 50, 6: 28, 7: 36, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 14, 1: 15, 2: 0, 3: 13, 4: 93, 5: 51, 6: 28, 7: 38, 8: 47, 9: 266}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 5, 1: 25, 2: 0, 3: 85, 4: 0, 5: 0, 6: 191, 7: 43, 8: 18, 9: 2}
Prototype-Based Model Correct Classifications (per class):
{0: 16, 1: 24, 2: 0, 3: 89, 4: 3, 5: 0, 6: 159, 7: 43, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9466
Client 1: Regular Model Acc: 0.9580
Client 2: Regular Model Acc: 0.9096
Client 3: Regular Model Acc: 0.8930
Client 4: Regular Model Acc: 0.9440
Client 5: Regular Model Acc: 0.9043
Client 6: Regular Model Acc: 0.8047
Client 7: Regular Model Acc: 0.9544
Client 8: Regular Model Acc: 0.9376
Client 9: Regular Model Acc: 0.9796
Client 10: Regular Model Acc: 0.8835
Client 11: Regular Model Acc: 0.9915
Client 12: Regular Model Acc: 0.9367
Client 13: Regular Model Acc: 0.8625
Client 14: Regular Model Acc: 0.9620
Client 15: Regular Model Acc: 0.9894
Client 16: Regular Model Acc: 0.9514
Client 17: Regular Model Acc: 0.8919
Client 18: Regular Model Acc: 0.9139
Client 19: Regular Model Acc: 0.8348
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9253
Client 1: Prototype Model Acc: 0.9257
Client 2: Prototype Model Acc: 0.9082
Client 3: Prototype Model Acc: 0.7389
Client 4: Prototype Model Acc: 0.9313
Client 5: Prototype Model Acc: 0.8673
Client 6: Prototype Model Acc: 0.6414
Client 7: Prototype Model Acc: 0.9544
Client 8: Prototype Model Acc: 0.9144
Client 9: Prototype Model Acc: 0.9689
Client 10: Prototype Model Acc: 0.8649
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9297
Client 13: Prototype Model Acc: 0.8535
Client 14: Prototype Model Acc: 0.9600
Client 15: Prototype Model Acc: 0.9894
Client 16: Prototype Model Acc: 0.9419
Client 17: Prototype Model Acc: 0.8688
Client 18: Prototype Model Acc: 0.8842
Client 19: Prototype Model Acc: 0.8077
Averaged Test Accuracy (Regular Model): 0.9360
Averaged Test Accuracy (Prototype Model): 0.9174
Std Test Accuracy (Regular Model): 0.0488
Std Test Accuracy (Prototype Model): 0.0834
client.id trained 12
local_model_loss tensor(0.0652, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0391, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.2728, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0492, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.2535, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0566, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0335, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0323, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.2103, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.2078, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0351, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0516, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.0926, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0437, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0758, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.1931, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0528, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0232, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.1055, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.0646, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 305.3022391150007
only_train_time: 2694.4956652476685
all_clients_time_cost: 2694.4956652476685
agg_protos_label dict_keys([0, 7, 5, 2, 3, 9, 6, 8, 4, 1])
-------------------------------------------------- 61.27637457847595

-------------Round number: 41-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 7, 3: 0, 4: 39, 5: 0, 6: 4, 7: 108, 8: 16, 9: 574}
Prototype-Based Model Correct Classifications (per class):
{0: 114, 1: 8, 2: 3, 3: 0, 4: 40, 5: 0, 6: 1, 7: 112, 8: 16, 9: 573}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 5, 8: 497, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 271, 7: 7, 8: 477, 9: 100}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 107, 1: 0, 2: 0, 3: 0, 4: 0, 5: 178, 6: 146, 7: 131, 8: 50, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 109, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 142, 7: 133, 8: 51, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 263, 1: 0, 2: 38, 3: 8, 4: 0, 5: 10, 6: 1, 7: 14, 8: 2, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 249, 1: 0, 2: 27, 3: 11, 4: 0, 5: 3, 6: 3, 7: 14, 8: 2, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 79, 1: 2, 2: 183, 3: 19, 4: 0, 5: 0, 6: 20, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 184, 3: 22, 4: 0, 5: 0, 6: 13, 7: 2, 8: 323, 9: 478}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 26, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 48, 7: 0, 8: 20, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 24, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 39, 7: 0, 8: 20, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 9, 1: 0, 2: 42, 3: 0, 4: 0, 5: 0, 6: 220, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 19, 1: 0, 2: 57, 3: 0, 4: 1, 5: 0, 6: 109, 7: 0, 8: 0, 9: 12}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 31, 1: 68, 2: 357, 3: 116, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 28, 1: 65, 2: 359, 3: 120, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 220, 1: 289, 2: 218, 3: 0, 4: 158, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 289, 2: 178, 3: 0, 4: 168, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 62, 1: 140, 2: 0, 3: 1, 4: 3, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 59, 1: 137, 2: 2, 3: 1, 4: 6, 5: 0, 6: 0, 7: 0, 8: 700, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 116, 1: 129, 2: 1, 3: 16, 4: 8, 5: 253, 6: 225, 7: 104, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 122, 1: 129, 2: 2, 3: 18, 4: 12, 5: 252, 6: 206, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1152, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 240, 1: 0, 2: 55, 3: 65, 4: 0, 5: 60, 6: 0, 7: 286, 8: 0, 9: 93}
Prototype-Based Model Correct Classifications (per class):
{0: 226, 1: 0, 2: 59, 3: 69, 4: 0, 5: 59, 6: 1, 7: 283, 8: 0, 9: 96}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 26, 1: 140, 2: 203, 3: 3, 4: 68, 5: 80, 6: 1, 7: 22, 8: 14, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 26, 1: 136, 2: 201, 3: 5, 4: 62, 5: 83, 6: 1, 7: 18, 8: 15, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 145, 1: 122, 2: 120, 3: 0, 4: 15, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 140, 1: 120, 2: 126, 3: 0, 4: 13, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 9, 1: 0, 2: 97, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 98, 3: 824, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 342, 4: 51, 5: 0, 6: 240, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 346, 4: 58, 5: 0, 6: 217, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 100, 1: 69, 2: 191, 3: 186, 4: 24, 5: 4, 6: 70, 7: 441, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 106, 1: 69, 2: 179, 3: 184, 4: 22, 5: 12, 6: 46, 7: 436, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 114, 5: 50, 6: 28, 7: 36, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 14, 1: 15, 2: 0, 3: 13, 4: 95, 5: 50, 6: 29, 7: 38, 8: 47, 9: 265}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 15, 1: 26, 2: 0, 3: 91, 4: 2, 5: 0, 6: 175, 7: 43, 8: 21, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 20, 1: 26, 2: 1, 3: 92, 4: 5, 5: 0, 6: 125, 7: 43, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9434
Client 1: Regular Model Acc: 0.9591
Client 2: Regular Model Acc: 0.9111
Client 3: Regular Model Acc: 0.8799
Client 4: Regular Model Acc: 0.9440
Client 5: Regular Model Acc: 0.8951
Client 6: Regular Model Acc: 0.8251
Client 7: Regular Model Acc: 0.9580
Client 8: Regular Model Acc: 0.9355
Client 9: Regular Model Acc: 0.9796
Client 10: Regular Model Acc: 0.8784
Client 11: Regular Model Acc: 0.9915
Client 12: Regular Model Acc: 0.9367
Client 13: Regular Model Acc: 0.8414
Client 14: Regular Model Acc: 0.9569
Client 15: Regular Model Acc: 0.9883
Client 16: Regular Model Acc: 0.9506
Client 17: Regular Model Acc: 0.8952
Client 18: Regular Model Acc: 0.9139
Client 19: Regular Model Acc: 0.8439
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9253
Client 1: Prototype Model Acc: 0.9268
Client 2: Prototype Model Acc: 0.9111
Client 3: Prototype Model Acc: 0.8172
Client 4: Prototype Model Acc: 0.9313
Client 5: Prototype Model Acc: 0.8549
Client 6: Prototype Model Acc: 0.5773
Client 7: Prototype Model Acc: 0.9580
Client 8: Prototype Model Acc: 0.9112
Client 9: Prototype Model Acc: 0.9710
Client 10: Prototype Model Acc: 0.8701
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9297
Client 13: Prototype Model Acc: 0.8263
Client 14: Prototype Model Acc: 0.9538
Client 15: Prototype Model Acc: 0.9883
Client 16: Prototype Model Acc: 0.9410
Client 17: Prototype Model Acc: 0.8696
Client 18: Prototype Model Acc: 0.8858
Client 19: Prototype Model Acc: 0.7579
Averaged Test Accuracy (Regular Model): 0.9349
Averaged Test Accuracy (Prototype Model): 0.9156
Std Test Accuracy (Regular Model): 0.0479
Std Test Accuracy (Prototype Model): 0.0926
client.id trained 4
local_model_loss tensor(0.0414, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0384, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0479, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0618, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0226, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0318, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.2265, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0531, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0691, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0817, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.2500, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0307, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.0620, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.0932, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.1842, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0334, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.2505, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.1048, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.2055, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0552, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 310.8738972209394
only_train_time: 2748.3570396227296
all_clients_time_cost: 2748.3570396227296
agg_protos_label dict_keys([9, 8, 0, 2, 6, 3, 7, 4, 1, 5])
-------------------------------------------------- 55.67858576774597

-------------Round number: 42-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 7, 3: 0, 4: 39, 5: 0, 6: 4, 7: 107, 8: 16, 9: 577}
Prototype-Based Model Correct Classifications (per class):
{0: 114, 1: 8, 2: 3, 3: 0, 4: 40, 5: 0, 6: 1, 7: 111, 8: 16, 9: 574}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 5, 8: 497, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 271, 7: 7, 8: 479, 9: 100}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 107, 1: 0, 2: 0, 3: 0, 4: 0, 5: 178, 6: 143, 7: 131, 8: 50, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 111, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 139, 7: 133, 8: 51, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 254, 1: 0, 2: 46, 3: 11, 4: 0, 5: 10, 6: 2, 7: 14, 8: 3, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 235, 1: 0, 2: 14, 3: 12, 4: 0, 5: 6, 6: 0, 7: 14, 8: 3, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 79, 1: 2, 2: 183, 3: 19, 4: 0, 5: 0, 6: 20, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 184, 3: 22, 4: 0, 5: 0, 6: 13, 7: 2, 8: 323, 9: 478}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 23, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 48, 7: 0, 8: 20, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 24, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 39, 7: 0, 8: 20, 9: 178}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 12, 1: 0, 2: 50, 3: 0, 4: 0, 5: 0, 6: 193, 7: 1, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 21, 1: 0, 2: 58, 3: 0, 4: 1, 5: 0, 6: 59, 7: 0, 8: 0, 9: 12}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 32, 1: 67, 2: 358, 3: 111, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 30, 1: 65, 2: 359, 3: 114, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 220, 1: 289, 2: 218, 3: 0, 4: 158, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 226, 1: 289, 2: 183, 3: 0, 4: 168, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 62, 1: 140, 2: 0, 3: 1, 4: 3, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 59, 1: 137, 2: 2, 3: 1, 4: 6, 5: 0, 6: 0, 7: 0, 8: 698, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 112, 1: 129, 2: 1, 3: 16, 4: 8, 5: 253, 6: 230, 7: 104, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 119, 1: 129, 2: 2, 3: 18, 4: 13, 5: 252, 6: 213, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1152, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 240, 1: 0, 2: 55, 3: 65, 4: 0, 5: 60, 6: 0, 7: 286, 8: 0, 9: 92}
Prototype-Based Model Correct Classifications (per class):
{0: 226, 1: 0, 2: 59, 3: 69, 4: 0, 5: 59, 6: 1, 7: 284, 8: 0, 9: 96}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 27, 1: 139, 2: 252, 3: 2, 4: 36, 5: 81, 6: 0, 7: 20, 8: 12, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 28, 1: 134, 2: 246, 3: 4, 4: 35, 5: 84, 6: 1, 7: 17, 8: 13, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 145, 1: 122, 2: 118, 3: 0, 4: 15, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 140, 1: 120, 2: 125, 3: 0, 4: 13, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 9, 1: 0, 2: 97, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 7, 1: 1, 2: 98, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 342, 4: 50, 5: 0, 6: 240, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 348, 4: 57, 5: 0, 6: 219, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 102, 1: 69, 2: 191, 3: 186, 4: 24, 5: 4, 6: 69, 7: 441, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 106, 1: 69, 2: 179, 3: 184, 4: 22, 5: 12, 6: 45, 7: 436, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 114, 5: 50, 6: 27, 7: 35, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 14, 1: 15, 2: 0, 3: 13, 4: 95, 5: 50, 6: 28, 7: 38, 8: 47, 9: 267}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 14, 1: 26, 2: 0, 3: 87, 4: 1, 5: 0, 6: 182, 7: 43, 8: 19, 9: 2}
Prototype-Based Model Correct Classifications (per class):
{0: 19, 1: 26, 2: 0, 3: 91, 4: 4, 5: 0, 6: 142, 7: 43, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9456
Client 1: Regular Model Acc: 0.9591
Client 2: Regular Model Acc: 0.9067
Client 3: Regular Model Acc: 0.8903
Client 4: Regular Model Acc: 0.9440
Client 5: Regular Model Acc: 0.8858
Client 6: Regular Model Acc: 0.7813
Client 7: Regular Model Acc: 0.9544
Client 8: Regular Model Acc: 0.9355
Client 9: Regular Model Acc: 0.9796
Client 10: Regular Model Acc: 0.8794
Client 11: Regular Model Acc: 0.9915
Client 12: Regular Model Acc: 0.9355
Client 13: Regular Model Acc: 0.8595
Client 14: Regular Model Acc: 0.9548
Client 15: Regular Model Acc: 0.9894
Client 16: Regular Model Acc: 0.9497
Client 17: Regular Model Acc: 0.8960
Client 18: Regular Model Acc: 0.9108
Client 19: Regular Model Acc: 0.8462
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9253
Client 1: Prototype Model Acc: 0.9290
Client 2: Prototype Model Acc: 0.9096
Client 3: Prototype Model Acc: 0.7520
Client 4: Prototype Model Acc: 0.9313
Client 5: Prototype Model Acc: 0.8519
Client 6: Prototype Model Acc: 0.4402
Client 7: Prototype Model Acc: 0.9544
Client 8: Prototype Model Acc: 0.9154
Client 9: Prototype Model Acc: 0.9689
Client 10: Prototype Model Acc: 0.8753
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9308
Client 13: Prototype Model Acc: 0.8489
Client 14: Prototype Model Acc: 0.9528
Client 15: Prototype Model Acc: 0.9894
Client 16: Prototype Model Acc: 0.9436
Client 17: Prototype Model Acc: 0.8688
Client 18: Prototype Model Acc: 0.8873
Client 19: Prototype Model Acc: 0.7873
Averaged Test Accuracy (Regular Model): 0.9344
Averaged Test Accuracy (Prototype Model): 0.9135
Std Test Accuracy (Regular Model): 0.0514
Std Test Accuracy (Prototype Model): 0.1182
client.id trained 12
local_model_loss tensor(0.0588, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0311, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.1589, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.2060, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.1840, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.1068, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0464, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.1631, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0312, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.1860, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0536, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0393, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0462, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.2193, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0220, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0492, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0749, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0321, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0371, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.2627, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 316.5759958010167
only_train_time: 2799.1873697896954
all_clients_time_cost: 2799.1873697896954
agg_protos_label dict_keys([0, 7, 5, 2, 3, 9, 6, 8, 4, 1])
-------------------------------------------------- 52.5130078792572

-------------Round number: 43-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 7, 3: 0, 4: 39, 5: 0, 6: 4, 7: 108, 8: 16, 9: 574}
Prototype-Based Model Correct Classifications (per class):
{0: 114, 1: 8, 2: 3, 3: 0, 4: 40, 5: 0, 6: 1, 7: 112, 8: 16, 9: 573}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 5, 8: 497, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 271, 7: 7, 8: 479, 9: 100}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 110, 1: 0, 2: 0, 3: 0, 4: 0, 5: 177, 6: 138, 7: 131, 8: 49, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 109, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 132, 7: 133, 8: 49, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 263, 1: 0, 2: 38, 3: 8, 4: 0, 5: 10, 6: 1, 7: 14, 8: 2, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 249, 1: 0, 2: 28, 3: 11, 4: 0, 5: 3, 6: 3, 7: 14, 8: 2, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 79, 1: 2, 2: 183, 3: 19, 4: 0, 5: 0, 6: 21, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 184, 3: 22, 4: 0, 5: 0, 6: 16, 7: 2, 8: 323, 9: 478}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 35, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 44, 7: 0, 8: 19, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 39, 7: 0, 8: 20, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 17, 1: 0, 2: 35, 3: 0, 4: 0, 5: 0, 6: 204, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 24, 1: 0, 2: 52, 3: 0, 4: 2, 5: 0, 6: 108, 7: 0, 8: 0, 9: 12}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 31, 1: 68, 2: 357, 3: 116, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 65, 2: 359, 3: 120, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 220, 1: 289, 2: 223, 3: 0, 4: 156, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 289, 2: 183, 3: 0, 4: 168, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 62, 1: 140, 2: 0, 3: 1, 4: 3, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 59, 1: 137, 2: 1, 3: 1, 4: 7, 5: 0, 6: 0, 7: 0, 8: 699, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 108, 1: 130, 2: 1, 3: 17, 4: 7, 5: 253, 6: 234, 7: 105, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 116, 1: 129, 2: 0, 3: 18, 4: 11, 5: 252, 6: 217, 7: 104, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1152, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 240, 1: 0, 2: 55, 3: 65, 4: 0, 5: 60, 6: 0, 7: 286, 8: 0, 9: 92}
Prototype-Based Model Correct Classifications (per class):
{0: 226, 1: 0, 2: 59, 3: 69, 4: 0, 5: 59, 6: 1, 7: 284, 8: 0, 9: 96}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 25, 1: 138, 2: 236, 3: 2, 4: 56, 5: 81, 6: 0, 7: 20, 8: 14, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 26, 1: 135, 2: 230, 3: 4, 4: 53, 5: 84, 6: 1, 7: 18, 8: 15, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 145, 1: 122, 2: 118, 3: 0, 4: 15, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 140, 1: 120, 2: 125, 3: 0, 4: 14, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 9, 1: 0, 2: 97, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 98, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 341, 4: 51, 5: 0, 6: 240, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 346, 4: 57, 5: 0, 6: 219, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 104, 1: 69, 2: 190, 3: 189, 4: 26, 5: 4, 6: 63, 7: 441, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 106, 1: 69, 2: 178, 3: 185, 4: 29, 5: 12, 6: 38, 7: 436, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 114, 5: 50, 6: 28, 7: 36, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 14, 1: 15, 2: 0, 3: 13, 4: 94, 5: 51, 6: 29, 7: 38, 8: 47, 9: 267}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 14, 1: 25, 2: 0, 3: 87, 4: 1, 5: 0, 6: 184, 7: 43, 8: 19, 9: 2}
Prototype-Based Model Correct Classifications (per class):
{0: 19, 1: 26, 2: 1, 3: 89, 4: 2, 5: 0, 6: 159, 7: 43, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9434
Client 1: Regular Model Acc: 0.9591
Client 2: Regular Model Acc: 0.9009
Client 3: Regular Model Acc: 0.8799
Client 4: Regular Model Acc: 0.9449
Client 5: Regular Model Acc: 0.9074
Client 6: Regular Model Acc: 0.7813
Client 7: Regular Model Acc: 0.9580
Client 8: Regular Model Acc: 0.9387
Client 9: Regular Model Acc: 0.9796
Client 10: Regular Model Acc: 0.8814
Client 11: Regular Model Acc: 0.9915
Client 12: Regular Model Acc: 0.9355
Client 13: Regular Model Acc: 0.8640
Client 14: Regular Model Acc: 0.9548
Client 15: Regular Model Acc: 0.9894
Client 16: Regular Model Acc: 0.9497
Client 17: Regular Model Acc: 0.8960
Client 18: Regular Model Acc: 0.9139
Client 19: Regular Model Acc: 0.8484
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9253
Client 1: Prototype Model Acc: 0.9290
Client 2: Prototype Model Acc: 0.8936
Client 3: Prototype Model Acc: 0.8198
Client 4: Prototype Model Acc: 0.9338
Client 5: Prototype Model Acc: 0.8704
Client 6: Prototype Model Acc: 0.5773
Client 7: Prototype Model Acc: 0.9589
Client 8: Prototype Model Acc: 0.9165
Client 9: Prototype Model Acc: 0.9700
Client 10: Prototype Model Acc: 0.8732
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9308
Client 13: Prototype Model Acc: 0.8550
Client 14: Prototype Model Acc: 0.9538
Client 15: Prototype Model Acc: 0.9904
Client 16: Prototype Model Acc: 0.9419
Client 17: Prototype Model Acc: 0.8688
Client 18: Prototype Model Acc: 0.8889
Client 19: Prototype Model Acc: 0.8190
Averaged Test Accuracy (Regular Model): 0.9352
Averaged Test Accuracy (Prototype Model): 0.9189
Std Test Accuracy (Regular Model): 0.0510
Std Test Accuracy (Prototype Model): 0.0881
client.id trained 12
local_model_loss tensor(0.0560, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0479, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0215, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.2000, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.2866, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0522, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0377, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.0988, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0363, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.0613, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0562, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.1627, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.2008, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0306, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.2391, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0451, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0685, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.0792, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0284, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0283, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 324.47453821101226
only_train_time: 2861.3765633900184
all_clients_time_cost: 2861.3765633900184
agg_protos_label dict_keys([0, 7, 5, 2, 3, 9, 6, 8, 4, 1])
Number of samples: 167
-------------------------------------------------- 65.05014872550964

-------------Round number: 44-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 7, 3: 0, 4: 39, 5: 0, 6: 4, 7: 108, 8: 16, 9: 575}
Prototype-Based Model Correct Classifications (per class):
{0: 114, 1: 8, 2: 3, 3: 0, 4: 40, 5: 0, 6: 1, 7: 112, 8: 16, 9: 574}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 5, 8: 497, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 271, 7: 7, 8: 479, 9: 100}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 107, 1: 1, 2: 0, 3: 0, 4: 0, 5: 178, 6: 146, 7: 131, 8: 50, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 108, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 142, 7: 133, 8: 51, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 253, 1: 0, 2: 46, 3: 11, 4: 0, 5: 10, 6: 2, 7: 14, 8: 3, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 235, 1: 0, 2: 19, 3: 12, 4: 0, 5: 6, 6: 1, 7: 14, 8: 3, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 79, 1: 2, 2: 183, 3: 19, 4: 0, 5: 0, 6: 20, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 184, 3: 22, 4: 0, 5: 0, 6: 15, 7: 2, 8: 323, 9: 478}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 39, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 41, 7: 0, 8: 18, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 31, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 38, 7: 0, 8: 20, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 4, 1: 0, 2: 6, 3: 0, 4: 0, 5: 0, 6: 236, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 11, 1: 0, 2: 47, 3: 0, 4: 0, 5: 0, 6: 202, 7: 0, 8: 0, 9: 11}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 32, 1: 67, 2: 358, 3: 112, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 31, 1: 65, 2: 359, 3: 114, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 220, 1: 289, 2: 208, 3: 0, 4: 166, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 225, 1: 289, 2: 167, 3: 0, 4: 170, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 62, 1: 140, 2: 0, 3: 1, 4: 3, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 59, 1: 137, 2: 2, 3: 1, 4: 6, 5: 0, 6: 0, 7: 0, 8: 698, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 118, 1: 130, 2: 2, 3: 16, 4: 8, 5: 254, 6: 220, 7: 104, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 123, 1: 129, 2: 2, 3: 18, 4: 10, 5: 252, 6: 202, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1152, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 240, 1: 0, 2: 55, 3: 65, 4: 0, 5: 60, 6: 0, 7: 286, 8: 0, 9: 92}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 0, 2: 59, 3: 69, 4: 0, 5: 59, 6: 1, 7: 285, 8: 0, 9: 96}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 25, 1: 138, 2: 238, 3: 2, 4: 55, 5: 81, 6: 0, 7: 20, 8: 14, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 26, 1: 135, 2: 236, 3: 4, 4: 50, 5: 84, 6: 1, 7: 18, 8: 15, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 146, 1: 122, 2: 118, 3: 0, 4: 15, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 140, 1: 120, 2: 125, 3: 0, 4: 13, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 9, 1: 0, 2: 97, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 98, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 340, 4: 49, 5: 0, 6: 240, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 347, 4: 56, 5: 0, 6: 221, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 99, 1: 69, 2: 192, 3: 183, 4: 17, 5: 4, 6: 69, 7: 440, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 105, 1: 69, 2: 184, 3: 183, 4: 20, 5: 12, 6: 42, 7: 436, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 114, 5: 50, 6: 27, 7: 36, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 14, 1: 15, 2: 0, 3: 13, 4: 96, 5: 50, 6: 28, 7: 38, 8: 47, 9: 267}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 15, 1: 27, 2: 0, 3: 87, 4: 2, 5: 0, 6: 180, 7: 43, 8: 21, 9: 2}
Prototype-Based Model Correct Classifications (per class):
{0: 22, 1: 27, 2: 0, 3: 89, 4: 4, 5: 0, 6: 138, 7: 43, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9445
Client 1: Regular Model Acc: 0.9591
Client 2: Regular Model Acc: 0.9125
Client 3: Regular Model Acc: 0.8877
Client 4: Regular Model Acc: 0.9440
Client 5: Regular Model Acc: 0.9074
Client 6: Regular Model Acc: 0.7522
Client 7: Regular Model Acc: 0.9553
Client 8: Regular Model Acc: 0.9334
Client 9: Regular Model Acc: 0.9796
Client 10: Regular Model Acc: 0.8784
Client 11: Regular Model Acc: 0.9915
Client 12: Regular Model Acc: 0.9355
Client 13: Regular Model Acc: 0.8656
Client 14: Regular Model Acc: 0.9559
Client 15: Regular Model Acc: 0.9894
Client 16: Regular Model Acc: 0.9471
Client 17: Regular Model Acc: 0.8853
Client 18: Regular Model Acc: 0.9124
Client 19: Regular Model Acc: 0.8529
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9264
Client 1: Prototype Model Acc: 0.9290
Client 2: Prototype Model Acc: 0.9096
Client 3: Prototype Model Acc: 0.7676
Client 4: Prototype Model Acc: 0.9330
Client 5: Prototype Model Acc: 0.8735
Client 6: Prototype Model Acc: 0.7901
Client 7: Prototype Model Acc: 0.9553
Client 8: Prototype Model Acc: 0.8996
Client 9: Prototype Model Acc: 0.9689
Client 10: Prototype Model Acc: 0.8649
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9332
Client 13: Prototype Model Acc: 0.8595
Client 14: Prototype Model Acc: 0.9528
Client 15: Prototype Model Acc: 0.9904
Client 16: Prototype Model Acc: 0.9436
Client 17: Prototype Model Acc: 0.8672
Client 18: Prototype Model Acc: 0.8889
Client 19: Prototype Model Acc: 0.7828
Averaged Test Accuracy (Regular Model): 0.9339
Averaged Test Accuracy (Prototype Model): 0.9203
Std Test Accuracy (Regular Model): 0.0547
Std Test Accuracy (Prototype Model): 0.0637
client.id trained 7
local_model_loss tensor(0.0434, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.2529, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0293, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0268, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.0546, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.1794, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0535, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.0754, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.1735, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0282, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0508, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0808, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0210, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0432, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.2178, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0459, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.1834, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0354, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.0917, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0357, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 332.23971995001193
only_train_time: 2927.2253172700293
all_clients_time_cost: 2927.2253172700293
agg_protos_label dict_keys([2, 5, 1, 0, 3, 4, 7, 6, 8, 9])
-------------------------------------------------- 67.57565951347351

-------------Round number: 45-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 7, 3: 0, 4: 39, 5: 0, 6: 4, 7: 108, 8: 16, 9: 574}
Prototype-Based Model Correct Classifications (per class):
{0: 114, 1: 8, 2: 3, 3: 0, 4: 40, 5: 0, 6: 1, 7: 112, 8: 16, 9: 572}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 5, 8: 497, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 271, 7: 7, 8: 479, 9: 100}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 101, 1: 1, 2: 0, 3: 0, 4: 0, 5: 178, 6: 149, 7: 131, 8: 50, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 103, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 148, 7: 133, 8: 51, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 262, 1: 0, 2: 38, 3: 8, 4: 0, 5: 10, 6: 1, 7: 14, 8: 2, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 249, 1: 0, 2: 35, 3: 11, 4: 0, 5: 4, 6: 3, 7: 14, 8: 3, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 79, 1: 2, 2: 182, 3: 19, 4: 0, 5: 0, 6: 22, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 184, 3: 22, 4: 0, 5: 0, 6: 17, 7: 2, 8: 323, 9: 478}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 37, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 42, 7: 0, 8: 19, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 36, 7: 0, 8: 20, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 9, 1: 0, 2: 38, 3: 0, 4: 0, 5: 0, 6: 224, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 18, 1: 0, 2: 55, 3: 0, 4: 1, 5: 0, 6: 143, 7: 0, 8: 0, 9: 12}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 31, 1: 68, 2: 357, 3: 117, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 65, 2: 359, 3: 120, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 220, 1: 289, 2: 222, 3: 0, 4: 156, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 289, 2: 184, 3: 0, 4: 168, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 62, 1: 140, 2: 0, 3: 1, 4: 3, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 59, 1: 137, 2: 1, 3: 1, 4: 7, 5: 0, 6: 0, 7: 0, 8: 699, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 118, 1: 130, 2: 2, 3: 16, 4: 8, 5: 254, 6: 219, 7: 105, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 123, 1: 129, 2: 2, 3: 18, 4: 10, 5: 252, 6: 202, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1152, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 240, 1: 0, 2: 55, 3: 65, 4: 0, 5: 60, 6: 0, 7: 286, 8: 0, 9: 92}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 0, 2: 59, 3: 69, 4: 0, 5: 59, 6: 1, 7: 285, 8: 0, 9: 96}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 27, 1: 139, 2: 251, 3: 2, 4: 36, 5: 81, 6: 0, 7: 20, 8: 12, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 28, 1: 135, 2: 247, 3: 4, 4: 36, 5: 84, 6: 1, 7: 17, 8: 14, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 147, 1: 122, 2: 119, 3: 0, 4: 15, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 142, 1: 120, 2: 126, 3: 0, 4: 13, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 9, 1: 0, 2: 97, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 98, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 340, 4: 49, 5: 0, 6: 240, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 347, 4: 56, 5: 0, 6: 222, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 99, 1: 69, 2: 188, 3: 186, 4: 23, 5: 4, 6: 72, 7: 441, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 106, 1: 69, 2: 180, 3: 184, 4: 24, 5: 12, 6: 49, 7: 436, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 11, 4: 119, 5: 50, 6: 19, 7: 37, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 14, 1: 15, 2: 0, 3: 13, 4: 105, 5: 51, 6: 24, 7: 38, 8: 47, 9: 261}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 17, 1: 27, 2: 0, 3: 87, 4: 2, 5: 0, 6: 176, 7: 43, 8: 21, 9: 2}
Prototype-Based Model Correct Classifications (per class):
{0: 21, 1: 27, 2: 1, 3: 91, 4: 3, 5: 0, 6: 144, 7: 43, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9434
Client 1: Regular Model Acc: 0.9591
Client 2: Regular Model Acc: 0.9082
Client 3: Regular Model Acc: 0.8773
Client 4: Regular Model Acc: 0.9449
Client 5: Regular Model Acc: 0.9074
Client 6: Regular Model Acc: 0.8251
Client 7: Regular Model Acc: 0.9589
Client 8: Regular Model Acc: 0.9376
Client 9: Regular Model Acc: 0.9796
Client 10: Regular Model Acc: 0.8784
Client 11: Regular Model Acc: 0.9915
Client 12: Regular Model Acc: 0.9355
Client 13: Regular Model Acc: 0.8580
Client 14: Regular Model Acc: 0.9579
Client 15: Regular Model Acc: 0.9894
Client 16: Regular Model Acc: 0.9471
Client 17: Regular Model Acc: 0.8927
Client 18: Regular Model Acc: 0.9077
Client 19: Regular Model Acc: 0.8484
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9242
Client 1: Prototype Model Acc: 0.9290
Client 2: Prototype Model Acc: 0.9111
Client 3: Prototype Model Acc: 0.8433
Client 4: Prototype Model Acc: 0.9347
Client 5: Prototype Model Acc: 0.8611
Client 6: Prototype Model Acc: 0.6676
Client 7: Prototype Model Acc: 0.9589
Client 8: Prototype Model Acc: 0.9175
Client 9: Prototype Model Acc: 0.9700
Client 10: Prototype Model Acc: 0.8649
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9332
Client 13: Prototype Model Acc: 0.8550
Client 14: Prototype Model Acc: 0.9559
Client 15: Prototype Model Acc: 0.9904
Client 16: Prototype Model Acc: 0.9445
Client 17: Prototype Model Acc: 0.8746
Client 18: Prototype Model Acc: 0.8889
Client 19: Prototype Model Acc: 0.7986
Averaged Test Accuracy (Regular Model): 0.9354
Averaged Test Accuracy (Prototype Model): 0.9216
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0733
client.id trained 11
local_model_loss tensor(0.0205, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0652, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.1783, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.1687, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0261, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0423, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0345, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0495, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0251, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.1811, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0346, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.1855, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.0861, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.2142, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0511, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.0563, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0282, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0419, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0464, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.2278, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 339.7925560850417
only_train_time: 2991.544362201006
all_clients_time_cost: 2991.544362201006
agg_protos_label dict_keys([4, 1, 3, 2, 0, 9, 5, 8, 6, 7])
-------------------------------------------------- 66.09855484962463

-------------Round number: 46-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 7, 3: 0, 4: 39, 5: 0, 6: 4, 7: 107, 8: 16, 9: 577}
Prototype-Based Model Correct Classifications (per class):
{0: 114, 1: 8, 2: 3, 3: 0, 4: 40, 5: 0, 6: 1, 7: 112, 8: 16, 9: 574}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 5, 8: 497, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 271, 7: 7, 8: 480, 9: 100}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 101, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 149, 7: 131, 8: 50, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 103, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 147, 7: 133, 8: 51, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 252, 1: 0, 2: 46, 3: 11, 4: 0, 5: 10, 6: 2, 7: 14, 8: 3, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 234, 1: 0, 2: 23, 3: 12, 4: 0, 5: 6, 6: 1, 7: 14, 8: 3, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 78, 1: 2, 2: 183, 3: 19, 4: 0, 5: 0, 6: 21, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 184, 3: 22, 4: 0, 5: 0, 6: 17, 7: 2, 8: 323, 9: 478}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 39, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 41, 7: 0, 8: 19, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 30, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 37, 7: 0, 8: 20, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 7, 1: 0, 2: 30, 3: 0, 4: 0, 5: 0, 6: 230, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 17, 1: 0, 2: 48, 3: 0, 4: 1, 5: 0, 6: 176, 7: 0, 8: 0, 9: 11}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 32, 1: 68, 2: 358, 3: 112, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 31, 1: 65, 2: 359, 3: 118, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 219, 1: 290, 2: 220, 3: 0, 4: 157, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 226, 1: 289, 2: 183, 3: 0, 4: 169, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 62, 1: 140, 2: 0, 3: 1, 4: 4, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 59, 1: 137, 2: 1, 3: 1, 4: 7, 5: 0, 6: 0, 7: 0, 8: 698, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 117, 1: 130, 2: 1, 3: 16, 4: 8, 5: 253, 6: 212, 7: 103, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 123, 1: 129, 2: 1, 3: 18, 4: 14, 5: 253, 6: 191, 7: 102, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1152, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 240, 1: 0, 2: 55, 3: 65, 4: 0, 5: 60, 6: 0, 7: 286, 8: 0, 9: 92}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 0, 2: 59, 3: 69, 4: 0, 5: 59, 6: 1, 7: 285, 8: 0, 9: 96}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 26, 1: 140, 2: 193, 3: 3, 4: 71, 5: 80, 6: 1, 7: 22, 8: 14, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 26, 1: 135, 2: 191, 3: 5, 4: 67, 5: 83, 6: 1, 7: 19, 8: 15, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 147, 1: 122, 2: 120, 3: 0, 4: 15, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 144, 1: 120, 2: 128, 3: 0, 4: 13, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 8, 1: 0, 2: 97, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 98, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 341, 4: 49, 5: 0, 6: 240, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 347, 4: 56, 5: 0, 6: 222, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 105, 1: 69, 2: 187, 3: 188, 4: 25, 5: 4, 6: 68, 7: 440, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 106, 1: 69, 2: 178, 3: 184, 4: 24, 5: 12, 6: 46, 7: 436, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 115, 5: 50, 6: 23, 7: 35, 8: 46, 9: 272}
Prototype-Based Model Correct Classifications (per class):
{0: 14, 1: 15, 2: 0, 3: 13, 4: 95, 5: 50, 6: 26, 7: 38, 8: 47, 9: 268}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 10, 1: 25, 2: 0, 3: 87, 4: 0, 5: 0, 6: 189, 7: 43, 8: 19, 9: 2}
Prototype-Based Model Correct Classifications (per class):
{0: 17, 1: 26, 2: 0, 3: 90, 4: 2, 5: 0, 6: 166, 7: 42, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9456
Client 1: Regular Model Acc: 0.9591
Client 2: Regular Model Acc: 0.9067
Client 3: Regular Model Acc: 0.8851
Client 4: Regular Model Acc: 0.9440
Client 5: Regular Model Acc: 0.9105
Client 6: Regular Model Acc: 0.8134
Client 7: Regular Model Acc: 0.9562
Client 8: Regular Model Acc: 0.9366
Client 9: Regular Model Acc: 0.9807
Client 10: Regular Model Acc: 0.8660
Client 11: Regular Model Acc: 0.9915
Client 12: Regular Model Acc: 0.9355
Client 13: Regular Model Acc: 0.8308
Client 14: Regular Model Acc: 0.9589
Client 15: Regular Model Acc: 0.9883
Client 16: Regular Model Acc: 0.9480
Client 17: Regular Model Acc: 0.8960
Client 18: Regular Model Acc: 0.9077
Client 19: Regular Model Acc: 0.8484
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9264
Client 1: Prototype Model Acc: 0.9300
Client 2: Prototype Model Acc: 0.9096
Client 3: Prototype Model Acc: 0.7755
Client 4: Prototype Model Acc: 0.9347
Client 5: Prototype Model Acc: 0.8673
Client 6: Prototype Model Acc: 0.7376
Client 7: Prototype Model Acc: 0.9589
Client 8: Prototype Model Acc: 0.9165
Client 9: Prototype Model Acc: 0.9689
Client 10: Prototype Model Acc: 0.8567
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9332
Client 13: Prototype Model Acc: 0.8187
Client 14: Prototype Model Acc: 0.9600
Client 15: Prototype Model Acc: 0.9904
Client 16: Prototype Model Acc: 0.9445
Client 17: Prototype Model Acc: 0.8705
Client 18: Prototype Model Acc: 0.8858
Client 19: Prototype Model Acc: 0.8281
Averaged Test Accuracy (Regular Model): 0.9338
Averaged Test Accuracy (Prototype Model): 0.9204
Std Test Accuracy (Regular Model): 0.0500
Std Test Accuracy (Prototype Model): 0.0680
client.id trained 16
local_model_loss tensor(0.0269, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0447, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0608, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.0800, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.2453, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0324, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0430, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.1783, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0261, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.2291, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.1779, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0338, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0482, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0489, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0200, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0589, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.0682, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.1409, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0240, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.1127, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 347.27803363802377
only_train_time: 3056.6048174620373
all_clients_time_cost: 3056.6048174620373
agg_protos_label dict_keys([7, 4, 3, 1, 6, 0, 2, 5, 8, 9])
-------------------------------------------------- 66.86518001556396

-------------Round number: 47-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 7, 3: 0, 4: 39, 5: 0, 6: 3, 7: 108, 8: 16, 9: 574}
Prototype-Based Model Correct Classifications (per class):
{0: 113, 1: 8, 2: 3, 3: 0, 4: 40, 5: 0, 6: 1, 7: 112, 8: 16, 9: 573}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 5, 8: 497, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 271, 7: 7, 8: 479, 9: 101}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 103, 1: 1, 2: 0, 3: 0, 4: 0, 5: 178, 6: 148, 7: 131, 8: 49, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 106, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 145, 7: 132, 8: 51, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 262, 1: 0, 2: 39, 3: 8, 4: 0, 5: 10, 6: 1, 7: 14, 8: 2, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 250, 1: 0, 2: 40, 3: 11, 4: 0, 5: 5, 6: 2, 7: 13, 8: 3, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 78, 1: 2, 2: 182, 3: 19, 4: 0, 5: 0, 6: 22, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 183, 3: 22, 4: 0, 5: 0, 6: 17, 7: 2, 8: 324, 9: 478}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 37, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 42, 7: 0, 8: 19, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 36, 7: 0, 8: 20, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 9, 1: 0, 2: 40, 3: 0, 4: 0, 5: 0, 6: 223, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 18, 1: 0, 2: 53, 3: 0, 4: 1, 5: 0, 6: 135, 7: 0, 8: 0, 9: 12}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 29, 1: 68, 2: 352, 3: 120, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 28, 1: 65, 2: 354, 3: 123, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 220, 1: 289, 2: 224, 3: 0, 4: 155, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 226, 1: 289, 2: 187, 3: 0, 4: 168, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 62, 1: 140, 2: 0, 3: 1, 4: 3, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 59, 1: 137, 2: 1, 3: 1, 4: 7, 5: 0, 6: 0, 7: 0, 8: 699, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 120, 1: 130, 2: 2, 3: 16, 4: 9, 5: 254, 6: 216, 7: 104, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 124, 1: 129, 2: 2, 3: 18, 4: 11, 5: 252, 6: 200, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1152, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 239, 1: 0, 2: 55, 3: 65, 4: 0, 5: 60, 6: 0, 7: 286, 8: 0, 9: 92}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 0, 2: 59, 3: 69, 4: 0, 5: 59, 6: 1, 7: 285, 8: 0, 9: 96}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 25, 1: 140, 2: 238, 3: 2, 4: 56, 5: 81, 6: 0, 7: 20, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 26, 1: 135, 2: 229, 3: 4, 4: 53, 5: 83, 6: 1, 7: 18, 8: 15, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 147, 1: 122, 2: 121, 3: 0, 4: 14, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 144, 1: 120, 2: 127, 3: 0, 4: 13, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 9, 1: 0, 2: 97, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 98, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 341, 4: 49, 5: 0, 6: 240, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 347, 4: 55, 5: 0, 6: 224, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 104, 1: 69, 2: 187, 3: 186, 4: 25, 5: 4, 6: 70, 7: 440, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 106, 1: 69, 2: 178, 3: 183, 4: 24, 5: 12, 6: 50, 7: 436, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 115, 5: 50, 6: 22, 7: 35, 8: 46, 9: 272}
Prototype-Based Model Correct Classifications (per class):
{0: 14, 1: 15, 2: 0, 3: 13, 4: 99, 5: 50, 6: 28, 7: 38, 8: 47, 9: 268}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 15, 1: 26, 2: 0, 3: 93, 4: 2, 5: 0, 6: 169, 7: 43, 8: 20, 9: 2}
Prototype-Based Model Correct Classifications (per class):
{0: 19, 1: 26, 2: 1, 3: 95, 4: 4, 5: 0, 6: 132, 7: 42, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9424
Client 1: Regular Model Acc: 0.9591
Client 2: Regular Model Acc: 0.9082
Client 3: Regular Model Acc: 0.8799
Client 4: Regular Model Acc: 0.9440
Client 5: Regular Model Acc: 0.9074
Client 6: Regular Model Acc: 0.8280
Client 7: Regular Model Acc: 0.9553
Client 8: Regular Model Acc: 0.9387
Client 9: Regular Model Acc: 0.9796
Client 10: Regular Model Acc: 0.8773
Client 11: Regular Model Acc: 0.9915
Client 12: Regular Model Acc: 0.9343
Client 13: Regular Model Acc: 0.8686
Client 14: Regular Model Acc: 0.9589
Client 15: Regular Model Acc: 0.9894
Client 16: Regular Model Acc: 0.9480
Client 17: Regular Model Acc: 0.8952
Client 18: Regular Model Acc: 0.9061
Client 19: Regular Model Acc: 0.8371
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9242
Client 1: Prototype Model Acc: 0.9300
Client 2: Prototype Model Acc: 0.9096
Client 3: Prototype Model Acc: 0.8564
Client 4: Prototype Model Acc: 0.9347
Client 5: Prototype Model Acc: 0.8611
Client 6: Prototype Model Acc: 0.6385
Client 7: Prototype Model Acc: 0.9562
Client 8: Prototype Model Acc: 0.9197
Client 9: Prototype Model Acc: 0.9700
Client 10: Prototype Model Acc: 0.8649
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9332
Client 13: Prototype Model Acc: 0.8520
Client 14: Prototype Model Acc: 0.9589
Client 15: Prototype Model Acc: 0.9904
Client 16: Prototype Model Acc: 0.9454
Client 17: Prototype Model Acc: 0.8729
Client 18: Prototype Model Acc: 0.8951
Client 19: Prototype Model Acc: 0.7738
Averaged Test Accuracy (Regular Model): 0.9355
Averaged Test Accuracy (Prototype Model): 0.9209
Std Test Accuracy (Regular Model): 0.0461
Std Test Accuracy (Prototype Model): 0.0796
client.id trained 7
local_model_loss tensor(0.0390, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0314, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0418, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.0625, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.0878, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.1711, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0239, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0559, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0469, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.1372, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.0506, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0330, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0229, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0395, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.2166, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0468, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.1994, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0195, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.1692, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0259, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 354.1227215969702
only_train_time: 3124.6059153279057
all_clients_time_cost: 3124.6059153279057
agg_protos_label dict_keys([2, 5, 1, 0, 3, 4, 9, 8, 6, 7])
Number of samples: 167
-------------------------------------------------- 72.76010274887085

-------------Round number: 48-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 7, 3: 0, 4: 39, 5: 0, 6: 3, 7: 108, 8: 16, 9: 575}
Prototype-Based Model Correct Classifications (per class):
{0: 113, 1: 8, 2: 3, 3: 0, 4: 40, 5: 0, 6: 1, 7: 112, 8: 16, 9: 572}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 5, 8: 499, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 271, 7: 7, 8: 480, 9: 101}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 98, 1: 1, 2: 0, 3: 0, 4: 0, 5: 178, 6: 149, 7: 131, 8: 49, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 100, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 149, 7: 133, 8: 51, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 252, 1: 0, 2: 46, 3: 11, 4: 0, 5: 10, 6: 2, 7: 14, 8: 3, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 235, 1: 0, 2: 28, 3: 12, 4: 0, 5: 7, 6: 1, 7: 14, 8: 3, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 78, 1: 2, 2: 182, 3: 19, 4: 0, 5: 0, 6: 22, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 184, 3: 22, 4: 0, 5: 0, 6: 17, 7: 2, 8: 324, 9: 478}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 29, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 44, 7: 0, 8: 20, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 38, 7: 0, 8: 20, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 7, 1: 0, 2: 39, 3: 0, 4: 0, 5: 0, 6: 225, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 13, 1: 0, 2: 55, 3: 0, 4: 1, 5: 0, 6: 161, 7: 0, 8: 0, 9: 12}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 32, 1: 68, 2: 358, 3: 114, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 65, 2: 359, 3: 118, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 219, 1: 290, 2: 220, 3: 0, 4: 157, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 289, 2: 184, 3: 0, 4: 168, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 62, 1: 140, 2: 0, 3: 1, 4: 4, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 59, 1: 137, 2: 1, 3: 1, 4: 7, 5: 0, 6: 0, 7: 0, 8: 699, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 117, 1: 130, 2: 2, 3: 16, 4: 10, 5: 254, 6: 220, 7: 105, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 122, 1: 129, 2: 2, 3: 18, 4: 11, 5: 252, 6: 200, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1152, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 240, 1: 0, 2: 55, 3: 65, 4: 0, 5: 60, 6: 0, 7: 286, 8: 0, 9: 92}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 0, 2: 59, 3: 69, 4: 0, 5: 59, 6: 1, 7: 285, 8: 0, 9: 96}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 26, 1: 140, 2: 223, 3: 2, 4: 67, 5: 81, 6: 0, 7: 21, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 26, 1: 135, 2: 213, 3: 5, 4: 60, 5: 83, 6: 1, 7: 19, 8: 15, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 147, 1: 122, 2: 121, 3: 0, 4: 15, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 144, 1: 120, 2: 129, 3: 0, 4: 13, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 8, 1: 0, 2: 97, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 98, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 341, 4: 49, 5: 0, 6: 240, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 347, 4: 55, 5: 0, 6: 224, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 105, 1: 69, 2: 191, 3: 191, 4: 26, 5: 4, 6: 54, 7: 441, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 106, 1: 69, 2: 180, 3: 186, 4: 29, 5: 11, 6: 31, 7: 437, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 115, 5: 50, 6: 22, 7: 36, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 14, 1: 15, 2: 0, 3: 13, 4: 99, 5: 50, 6: 28, 7: 38, 8: 47, 9: 267}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 15, 1: 27, 2: 0, 3: 87, 4: 2, 5: 0, 6: 182, 7: 43, 8: 20, 9: 2}
Prototype-Based Model Correct Classifications (per class):
{0: 21, 1: 27, 2: 0, 3: 90, 4: 3, 5: 0, 6: 149, 7: 43, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9434
Client 1: Regular Model Acc: 0.9612
Client 2: Regular Model Acc: 0.9023
Client 3: Regular Model Acc: 0.8851
Client 4: Regular Model Acc: 0.9440
Client 5: Regular Model Acc: 0.8920
Client 6: Regular Model Acc: 0.8251
Client 7: Regular Model Acc: 0.9580
Client 8: Regular Model Acc: 0.9366
Client 9: Regular Model Acc: 0.9807
Client 10: Regular Model Acc: 0.8804
Client 11: Regular Model Acc: 0.9915
Client 12: Regular Model Acc: 0.9355
Client 13: Regular Model Acc: 0.8656
Client 14: Regular Model Acc: 0.9600
Client 15: Regular Model Acc: 0.9883
Client 16: Regular Model Acc: 0.9480
Client 17: Regular Model Acc: 0.8919
Client 18: Regular Model Acc: 0.9061
Client 19: Regular Model Acc: 0.8552
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9232
Client 1: Prototype Model Acc: 0.9311
Client 2: Prototype Model Acc: 0.9082
Client 3: Prototype Model Acc: 0.7937
Client 4: Prototype Model Acc: 0.9355
Client 5: Prototype Model Acc: 0.8673
Client 6: Prototype Model Acc: 0.7055
Client 7: Prototype Model Acc: 0.9571
Client 8: Prototype Model Acc: 0.9175
Client 9: Prototype Model Acc: 0.9700
Client 10: Prototype Model Acc: 0.8629
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9332
Client 13: Prototype Model Acc: 0.8414
Client 14: Prototype Model Acc: 0.9610
Client 15: Prototype Model Acc: 0.9904
Client 16: Prototype Model Acc: 0.9454
Client 17: Prototype Model Acc: 0.8655
Client 18: Prototype Model Acc: 0.8936
Client 19: Prototype Model Acc: 0.8054
Averaged Test Accuracy (Regular Model): 0.9356
Averaged Test Accuracy (Prototype Model): 0.9207
Std Test Accuracy (Regular Model): 0.0456
Std Test Accuracy (Prototype Model): 0.0707
client.id trained 2
local_model_loss tensor(0.0470, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.1827, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0219, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0449, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.1363, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.0784, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0190, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0401, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0248, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0250, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0374, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.0586, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0456, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.1807, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.2387, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.1936, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0296, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0444, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0322, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0558, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 361.5792866719421
only_train_time: 3194.211359704146
all_clients_time_cost: 3194.211359704146
agg_protos_label dict_keys([7, 5, 4, 6, 9, 8, 0, 1, 2, 3])
-------------------------------------------------- 71.40829157829285

-------------Round number: 49-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 7, 3: 0, 4: 39, 5: 0, 6: 3, 7: 108, 8: 16, 9: 575}
Prototype-Based Model Correct Classifications (per class):
{0: 114, 1: 8, 2: 3, 3: 0, 4: 40, 5: 0, 6: 1, 7: 112, 8: 16, 9: 571}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 5, 8: 499, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 271, 7: 7, 8: 480, 9: 101}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 99, 1: 1, 2: 0, 3: 0, 4: 0, 5: 178, 6: 149, 7: 131, 8: 49, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 100, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 148, 7: 132, 8: 51, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 263, 1: 0, 2: 38, 3: 8, 4: 0, 5: 10, 6: 3, 7: 14, 8: 2, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 250, 1: 0, 2: 39, 3: 11, 4: 0, 5: 5, 6: 2, 7: 13, 8: 3, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 78, 1: 2, 2: 182, 3: 19, 4: 0, 5: 0, 6: 23, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 183, 3: 22, 4: 0, 5: 0, 6: 17, 7: 2, 8: 324, 9: 478}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 23, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 48, 7: 0, 8: 20, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 24, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 39, 7: 0, 8: 20, 9: 178}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 9, 1: 0, 2: 13, 3: 0, 4: 0, 5: 0, 6: 233, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 20, 1: 0, 2: 45, 3: 0, 4: 0, 5: 0, 6: 187, 7: 0, 8: 0, 9: 11}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 32, 1: 68, 2: 358, 3: 115, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 65, 2: 359, 3: 119, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 219, 1: 289, 2: 225, 3: 0, 4: 155, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 226, 1: 289, 2: 189, 3: 0, 4: 167, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 62, 1: 140, 2: 0, 3: 1, 4: 3, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 59, 1: 137, 2: 1, 3: 1, 4: 7, 5: 0, 6: 0, 7: 0, 8: 699, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 122, 1: 130, 2: 2, 3: 16, 4: 10, 5: 254, 6: 211, 7: 104, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 125, 1: 129, 2: 2, 3: 18, 4: 11, 5: 252, 6: 195, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 239, 1: 0, 2: 56, 3: 65, 4: 0, 5: 60, 6: 0, 7: 286, 8: 0, 9: 93}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 0, 2: 59, 3: 69, 4: 0, 5: 59, 6: 1, 7: 285, 8: 0, 9: 96}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 26, 1: 139, 2: 243, 3: 2, 4: 49, 5: 81, 6: 0, 7: 20, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 28, 1: 135, 2: 240, 3: 4, 4: 49, 5: 83, 6: 2, 7: 18, 8: 14, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 147, 1: 122, 2: 124, 3: 0, 4: 15, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 144, 1: 120, 2: 129, 3: 0, 4: 13, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 8, 1: 0, 2: 97, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 98, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 341, 4: 49, 5: 0, 6: 240, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 347, 4: 55, 5: 0, 6: 225, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 96, 1: 69, 2: 187, 3: 185, 4: 24, 5: 4, 6: 74, 7: 440, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 104, 1: 68, 2: 177, 3: 185, 4: 25, 5: 12, 6: 50, 7: 436, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 113, 5: 50, 6: 27, 7: 36, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 14, 1: 15, 2: 0, 3: 13, 4: 98, 5: 50, 6: 28, 7: 38, 8: 47, 9: 267}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 15, 1: 27, 2: 0, 3: 87, 4: 2, 5: 0, 6: 181, 7: 43, 8: 20, 9: 2}
Prototype-Based Model Correct Classifications (per class):
{0: 21, 1: 27, 2: 1, 3: 90, 4: 2, 5: 0, 6: 153, 7: 42, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9434
Client 1: Regular Model Acc: 0.9612
Client 2: Regular Model Acc: 0.9038
Client 3: Regular Model Acc: 0.8851
Client 4: Regular Model Acc: 0.9449
Client 5: Regular Model Acc: 0.8858
Client 6: Regular Model Acc: 0.7784
Client 7: Regular Model Acc: 0.9589
Client 8: Regular Model Acc: 0.9387
Client 9: Regular Model Acc: 0.9796
Client 10: Regular Model Acc: 0.8753
Client 11: Regular Model Acc: 0.9920
Client 12: Regular Model Acc: 0.9367
Client 13: Regular Model Acc: 0.8656
Client 14: Regular Model Acc: 0.9630
Client 15: Regular Model Acc: 0.9883
Client 16: Regular Model Acc: 0.9480
Client 17: Regular Model Acc: 0.8903
Client 18: Regular Model Acc: 0.9108
Client 19: Regular Model Acc: 0.8529
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9232
Client 1: Prototype Model Acc: 0.9311
Client 2: Prototype Model Acc: 0.9052
Client 3: Prototype Model Acc: 0.8538
Client 4: Prototype Model Acc: 0.9347
Client 5: Prototype Model Acc: 0.8519
Client 6: Prototype Model Acc: 0.7668
Client 7: Prototype Model Acc: 0.9580
Client 8: Prototype Model Acc: 0.9207
Client 9: Prototype Model Acc: 0.9700
Client 10: Prototype Model Acc: 0.8608
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9332
Client 13: Prototype Model Acc: 0.8656
Client 14: Prototype Model Acc: 0.9610
Client 15: Prototype Model Acc: 0.9894
Client 16: Prototype Model Acc: 0.9462
Client 17: Prototype Model Acc: 0.8721
Client 18: Prototype Model Acc: 0.8920
Client 19: Prototype Model Acc: 0.8122
Averaged Test Accuracy (Regular Model): 0.9348
Averaged Test Accuracy (Prototype Model): 0.9244
Std Test Accuracy (Regular Model): 0.0520
Std Test Accuracy (Prototype Model): 0.0581
client.id trained 0
local_model_loss tensor(0.0394, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0316, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0185, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0239, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.1324, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.1753, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.0725, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0445, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.1672, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0431, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0778, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0284, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0361, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0212, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.0449, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.1476, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0399, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.0624, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.2064, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0221, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 369.16069114091806
only_train_time: 3258.989432701259
all_clients_time_cost: 3258.989432701259
agg_protos_label dict_keys([9, 7, 0, 6, 2, 1, 5, 8, 4, 3])
-------------------------------------------------- 66.61135506629944

-------------Round number: 50-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 7, 3: 0, 4: 39, 5: 0, 6: 3, 7: 108, 8: 16, 9: 575}
Prototype-Based Model Correct Classifications (per class):
{0: 113, 1: 8, 2: 3, 3: 0, 4: 40, 5: 0, 6: 1, 7: 112, 8: 16, 9: 572}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 5, 8: 499, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 271, 7: 7, 8: 481, 9: 101}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 96, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 149, 7: 132, 8: 49, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 98, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 148, 7: 132, 8: 50, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 253, 1: 0, 2: 46, 3: 11, 4: 0, 5: 10, 6: 2, 7: 14, 8: 3, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 236, 1: 0, 2: 35, 3: 12, 4: 0, 5: 7, 6: 2, 7: 14, 8: 3, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 77, 1: 2, 2: 182, 3: 19, 4: 0, 5: 0, 6: 23, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 183, 3: 22, 4: 0, 5: 0, 6: 19, 7: 2, 8: 324, 9: 478}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 29, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 45, 7: 0, 8: 20, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 38, 7: 0, 8: 20, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 11, 1: 0, 2: 42, 3: 0, 4: 0, 5: 0, 6: 214, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 20, 1: 0, 2: 53, 3: 0, 4: 1, 5: 0, 6: 131, 7: 0, 8: 0, 9: 12}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 32, 1: 68, 2: 358, 3: 114, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 65, 2: 359, 3: 119, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 220, 1: 290, 2: 219, 3: 0, 4: 159, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 225, 1: 289, 2: 184, 3: 0, 4: 168, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 62, 1: 140, 2: 0, 3: 1, 4: 4, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 59, 1: 137, 2: 1, 3: 1, 4: 7, 5: 0, 6: 0, 7: 0, 8: 699, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 121, 1: 131, 2: 2, 3: 17, 4: 10, 5: 254, 6: 216, 7: 103, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 125, 1: 129, 2: 2, 3: 18, 4: 11, 5: 252, 6: 198, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 240, 1: 0, 2: 56, 3: 65, 4: 0, 5: 60, 6: 0, 7: 286, 8: 0, 9: 93}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 0, 2: 59, 3: 69, 4: 0, 5: 59, 6: 1, 7: 285, 8: 0, 9: 96}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 26, 1: 139, 2: 240, 3: 2, 4: 53, 5: 81, 6: 0, 7: 20, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 26, 1: 135, 2: 237, 3: 4, 4: 51, 5: 83, 6: 1, 7: 18, 8: 15, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 147, 1: 122, 2: 125, 3: 0, 4: 15, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 145, 1: 120, 2: 129, 3: 0, 4: 13, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 8, 1: 0, 2: 97, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 98, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 341, 4: 49, 5: 0, 6: 240, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 347, 4: 55, 5: 0, 6: 225, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 99, 1: 69, 2: 186, 3: 183, 4: 25, 5: 4, 6: 74, 7: 440, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 106, 1: 69, 2: 179, 3: 183, 4: 24, 5: 12, 6: 51, 7: 436, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 116, 5: 50, 6: 23, 7: 34, 8: 46, 9: 272}
Prototype-Based Model Correct Classifications (per class):
{0: 14, 1: 15, 2: 0, 3: 13, 4: 95, 5: 50, 6: 25, 7: 38, 8: 47, 9: 270}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 17, 1: 27, 2: 0, 3: 85, 4: 2, 5: 0, 6: 178, 7: 43, 8: 21, 9: 2}
Prototype-Based Model Correct Classifications (per class):
{0: 22, 1: 27, 2: 1, 3: 86, 4: 3, 5: 0, 6: 150, 7: 42, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9434
Client 1: Regular Model Acc: 0.9612
Client 2: Regular Model Acc: 0.8994
Client 3: Regular Model Acc: 0.8877
Client 4: Regular Model Acc: 0.9440
Client 5: Regular Model Acc: 0.8951
Client 6: Regular Model Acc: 0.8134
Client 7: Regular Model Acc: 0.9580
Client 8: Regular Model Acc: 0.9387
Client 9: Regular Model Acc: 0.9807
Client 10: Regular Model Acc: 0.8804
Client 11: Regular Model Acc: 0.9920
Client 12: Regular Model Acc: 0.9379
Client 13: Regular Model Acc: 0.8671
Client 14: Regular Model Acc: 0.9641
Client 15: Regular Model Acc: 0.9883
Client 16: Regular Model Acc: 0.9480
Client 17: Regular Model Acc: 0.8911
Client 18: Regular Model Acc: 0.9077
Client 19: Regular Model Acc: 0.8484
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9232
Client 1: Prototype Model Acc: 0.9322
Client 2: Prototype Model Acc: 0.9009
Client 3: Prototype Model Acc: 0.8172
Client 4: Prototype Model Acc: 0.9364
Client 5: Prototype Model Acc: 0.8673
Client 6: Prototype Model Acc: 0.6327
Client 7: Prototype Model Acc: 0.9580
Client 8: Prototype Model Acc: 0.9154
Client 9: Prototype Model Acc: 0.9700
Client 10: Prototype Model Acc: 0.8639
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9332
Client 13: Prototype Model Acc: 0.8610
Client 14: Prototype Model Acc: 0.9620
Client 15: Prototype Model Acc: 0.9904
Client 16: Prototype Model Acc: 0.9462
Client 17: Prototype Model Acc: 0.8746
Client 18: Prototype Model Acc: 0.8873
Client 19: Prototype Model Acc: 0.8009
Averaged Test Accuracy (Regular Model): 0.9358
Averaged Test Accuracy (Prototype Model): 0.9208
Std Test Accuracy (Regular Model): 0.0474
Std Test Accuracy (Prototype Model): 0.0800
client.id trained 6
local_model_loss tensor(0.1987, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.0711, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0224, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0364, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0377, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.2043, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0414, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.2271, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.1831, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0515, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0274, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0180, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.0424, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0309, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0348, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.0538, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0199, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0433, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.1802, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0229, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 375.8638694869587
only_train_time: 3324.229154339875
all_clients_time_cost: 3324.229154339875
agg_protos_label dict_keys([6, 2, 7, 0, 9, 1, 4, 5, 8, 3])
-------------------------------------------------- 67.06406021118164

-------------Round number: 51-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 7, 3: 0, 4: 39, 5: 0, 6: 3, 7: 108, 8: 16, 9: 575}
Prototype-Based Model Correct Classifications (per class):
{0: 114, 1: 8, 2: 3, 3: 0, 4: 40, 5: 0, 6: 1, 7: 112, 8: 16, 9: 571}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 5, 8: 499, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 271, 7: 8, 8: 482, 9: 102}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 99, 1: 1, 2: 0, 3: 0, 4: 0, 5: 178, 6: 149, 7: 132, 8: 49, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 100, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 148, 7: 132, 8: 50, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 263, 1: 0, 2: 37, 3: 8, 4: 0, 5: 10, 6: 3, 7: 14, 8: 2, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 252, 1: 0, 2: 39, 3: 11, 4: 0, 5: 5, 6: 2, 7: 13, 8: 3, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 77, 1: 2, 2: 182, 3: 19, 4: 0, 5: 0, 6: 23, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 183, 3: 22, 4: 0, 5: 0, 6: 19, 7: 2, 8: 324, 9: 478}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 40, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 37, 7: 0, 8: 18, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 33, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 34, 7: 0, 8: 20, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 17, 1: 0, 2: 44, 3: 0, 4: 0, 5: 0, 6: 199, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 21, 1: 0, 2: 54, 3: 0, 4: 1, 5: 0, 6: 110, 7: 0, 8: 0, 9: 11}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 30, 1: 68, 2: 357, 3: 117, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 65, 2: 359, 3: 120, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 219, 1: 289, 2: 224, 3: 0, 4: 155, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 226, 1: 289, 2: 192, 3: 0, 4: 167, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 62, 1: 140, 2: 0, 3: 1, 4: 4, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 59, 1: 137, 2: 1, 3: 1, 4: 7, 5: 0, 6: 0, 7: 0, 8: 699, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 122, 1: 130, 2: 2, 3: 16, 4: 10, 5: 254, 6: 213, 7: 104, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 124, 1: 129, 2: 2, 3: 18, 4: 11, 5: 252, 6: 197, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 240, 1: 0, 2: 56, 3: 65, 4: 0, 5: 60, 6: 0, 7: 286, 8: 0, 9: 93}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 0, 2: 59, 3: 69, 4: 0, 5: 59, 6: 1, 7: 285, 8: 0, 9: 96}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 26, 1: 141, 2: 205, 3: 3, 4: 68, 5: 80, 6: 2, 7: 21, 8: 14, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 26, 1: 135, 2: 203, 3: 5, 4: 65, 5: 82, 6: 1, 7: 20, 8: 15, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 148, 1: 122, 2: 125, 3: 0, 4: 15, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 146, 1: 120, 2: 129, 3: 0, 4: 13, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 8, 1: 0, 2: 97, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 98, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 341, 4: 49, 5: 0, 6: 240, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 347, 4: 55, 5: 0, 6: 225, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 105, 1: 69, 2: 188, 3: 188, 4: 26, 5: 4, 6: 66, 7: 440, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 105, 1: 68, 2: 179, 3: 185, 4: 27, 5: 11, 6: 45, 7: 437, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 116, 5: 50, 6: 22, 7: 36, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 14, 1: 15, 2: 0, 3: 13, 4: 102, 5: 50, 6: 28, 7: 38, 8: 47, 9: 268}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 5, 1: 25, 2: 0, 3: 87, 4: 1, 5: 0, 6: 189, 7: 43, 8: 19, 9: 2}
Prototype-Based Model Correct Classifications (per class):
{0: 15, 1: 26, 2: 0, 3: 90, 4: 2, 5: 0, 6: 173, 7: 41, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9434
Client 1: Regular Model Acc: 0.9612
Client 2: Regular Model Acc: 0.9052
Client 3: Regular Model Acc: 0.8825
Client 4: Regular Model Acc: 0.9440
Client 5: Regular Model Acc: 0.8981
Client 6: Regular Model Acc: 0.7930
Client 7: Regular Model Acc: 0.9580
Client 8: Regular Model Acc: 0.9376
Client 9: Regular Model Acc: 0.9807
Client 10: Regular Model Acc: 0.8773
Client 11: Regular Model Acc: 0.9920
Client 12: Regular Model Acc: 0.9379
Client 13: Regular Model Acc: 0.8459
Client 14: Regular Model Acc: 0.9651
Client 15: Regular Model Acc: 0.9883
Client 16: Regular Model Acc: 0.9480
Client 17: Regular Model Acc: 0.8960
Client 18: Regular Model Acc: 0.9077
Client 19: Regular Model Acc: 0.8394
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9232
Client 1: Prototype Model Acc: 0.9354
Client 2: Prototype Model Acc: 0.9038
Client 3: Prototype Model Acc: 0.8590
Client 4: Prototype Model Acc: 0.9364
Client 5: Prototype Model Acc: 0.8673
Client 6: Prototype Model Acc: 0.5743
Client 7: Prototype Model Acc: 0.9589
Client 8: Prototype Model Acc: 0.9239
Client 9: Prototype Model Acc: 0.9700
Client 10: Prototype Model Acc: 0.8619
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9332
Client 13: Prototype Model Acc: 0.8338
Client 14: Prototype Model Acc: 0.9630
Client 15: Prototype Model Acc: 0.9894
Client 16: Prototype Model Acc: 0.9462
Client 17: Prototype Model Acc: 0.8721
Client 18: Prototype Model Acc: 0.8998
Client 19: Prototype Model Acc: 0.8371
Averaged Test Accuracy (Regular Model): 0.9347
Averaged Test Accuracy (Prototype Model): 0.9214
Std Test Accuracy (Regular Model): 0.0520
Std Test Accuracy (Prototype Model): 0.0881
client.id trained 11
local_model_loss tensor(0.0176, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0303, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0369, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0399, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.1331, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0203, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0357, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0422, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0221, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0848, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.0414, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.1690, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.1975, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.0572, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.0638, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0260, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.1655, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.1225, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0366, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0193, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 386.469960627961
only_train_time: 3394.90743928717
all_clients_time_cost: 3394.90743928717
agg_protos_label dict_keys([4, 1, 3, 2, 0, 8, 7, 6, 5, 9])
Number of samples: 167
-------------------------------------------------- 73.74845695495605

-------------Round number: 52-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 7, 3: 0, 4: 39, 5: 0, 6: 3, 7: 108, 8: 16, 9: 575}
Prototype-Based Model Correct Classifications (per class):
{0: 114, 1: 8, 2: 3, 3: 0, 4: 40, 5: 0, 6: 2, 7: 112, 8: 16, 9: 571}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 5, 8: 499, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 271, 7: 8, 8: 483, 9: 101}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 94, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 149, 7: 132, 8: 49, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 96, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 149, 7: 132, 8: 50, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 253, 1: 0, 2: 46, 3: 11, 4: 0, 5: 10, 6: 2, 7: 14, 8: 3, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 236, 1: 0, 2: 35, 3: 12, 4: 0, 5: 7, 6: 3, 7: 14, 8: 3, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 77, 1: 2, 2: 181, 3: 19, 4: 0, 5: 0, 6: 24, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 73, 1: 2, 2: 184, 3: 22, 4: 0, 5: 0, 6: 21, 7: 2, 8: 324, 9: 478}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 37, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 41, 7: 0, 8: 19, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 30, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 34, 7: 0, 8: 20, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 10, 1: 0, 2: 40, 3: 0, 4: 0, 5: 0, 6: 220, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 17, 1: 0, 2: 52, 3: 0, 4: 1, 5: 0, 6: 156, 7: 0, 8: 0, 9: 12}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 32, 1: 67, 2: 361, 3: 103, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 32, 1: 65, 2: 360, 3: 111, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 220, 1: 290, 2: 220, 3: 0, 4: 158, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 225, 1: 289, 2: 186, 3: 0, 4: 168, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 62, 1: 140, 2: 0, 3: 1, 4: 4, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 59, 1: 137, 2: 1, 3: 1, 4: 7, 5: 0, 6: 0, 7: 0, 8: 699, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 115, 1: 130, 2: 2, 3: 16, 4: 10, 5: 254, 6: 228, 7: 104, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 120, 1: 129, 2: 2, 3: 18, 4: 11, 5: 253, 6: 213, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 240, 1: 0, 2: 56, 3: 65, 4: 0, 5: 60, 6: 0, 7: 286, 8: 0, 9: 93}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 0, 2: 59, 3: 70, 4: 0, 5: 59, 6: 1, 7: 285, 8: 0, 9: 96}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 26, 1: 139, 2: 245, 3: 2, 4: 48, 5: 81, 6: 0, 7: 20, 8: 14, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 28, 1: 135, 2: 242, 3: 4, 4: 46, 5: 83, 6: 2, 7: 19, 8: 14, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 148, 1: 122, 2: 125, 3: 0, 4: 14, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 146, 1: 120, 2: 129, 3: 0, 4: 11, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 8, 1: 0, 2: 97, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 98, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 342, 4: 49, 5: 0, 6: 240, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 347, 4: 55, 5: 0, 6: 225, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 100, 1: 69, 2: 185, 3: 183, 4: 25, 5: 4, 6: 75, 7: 439, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 105, 1: 68, 2: 177, 3: 184, 4: 26, 5: 12, 6: 53, 7: 436, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 11, 4: 117, 5: 50, 6: 24, 7: 37, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 13, 4: 104, 5: 51, 6: 25, 7: 38, 8: 46, 9: 264}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 18, 1: 27, 2: 0, 3: 87, 4: 2, 5: 0, 6: 178, 7: 43, 8: 21, 9: 2}
Prototype-Based Model Correct Classifications (per class):
{0: 23, 1: 27, 2: 1, 3: 90, 4: 3, 5: 0, 6: 147, 7: 42, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9434
Client 1: Regular Model Acc: 0.9612
Client 2: Regular Model Acc: 0.8965
Client 3: Regular Model Acc: 0.8877
Client 4: Regular Model Acc: 0.9440
Client 5: Regular Model Acc: 0.9043
Client 6: Regular Model Acc: 0.8222
Client 7: Regular Model Acc: 0.9500
Client 8: Regular Model Acc: 0.9387
Client 9: Regular Model Acc: 0.9807
Client 10: Regular Model Acc: 0.8856
Client 11: Regular Model Acc: 0.9920
Client 12: Regular Model Acc: 0.9379
Client 13: Regular Model Acc: 0.8686
Client 14: Regular Model Acc: 0.9641
Client 15: Regular Model Acc: 0.9883
Client 16: Regular Model Acc: 0.9488
Client 17: Regular Model Acc: 0.8911
Client 18: Regular Model Acc: 0.9124
Client 19: Regular Model Acc: 0.8552
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9242
Client 1: Prototype Model Acc: 0.9354
Client 2: Prototype Model Acc: 0.8994
Client 3: Prototype Model Acc: 0.8198
Client 4: Prototype Model Acc: 0.9381
Client 5: Prototype Model Acc: 0.8580
Client 6: Prototype Model Acc: 0.6939
Client 7: Prototype Model Acc: 0.9544
Client 8: Prototype Model Acc: 0.9175
Client 9: Prototype Model Acc: 0.9700
Client 10: Prototype Model Acc: 0.8753
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9343
Client 13: Prototype Model Acc: 0.8656
Client 14: Prototype Model Acc: 0.9610
Client 15: Prototype Model Acc: 0.9904
Client 16: Prototype Model Acc: 0.9462
Client 17: Prototype Model Acc: 0.8754
Client 18: Prototype Model Acc: 0.8889
Client 19: Prototype Model Acc: 0.8054
Averaged Test Accuracy (Regular Model): 0.9363
Averaged Test Accuracy (Prototype Model): 0.9231
Std Test Accuracy (Regular Model): 0.0452
Std Test Accuracy (Prototype Model): 0.0697
client.id trained 11
local_model_loss tensor(0.0171, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.1145, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.2184, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0470, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0212, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0183, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0296, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0384, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.0394, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.1522, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.1664, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.1880, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.0471, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0204, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.0652, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0340, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0253, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0353, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0411, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0873, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 394.05523207294755
only_train_time: 3460.94504226523
all_clients_time_cost: 3460.94504226523
agg_protos_label dict_keys([4, 1, 3, 2, 0, 5, 6, 7, 8, 9])
-------------------------------------------------- 67.61528182029724

-------------Round number: 53-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 7, 3: 0, 4: 39, 5: 0, 6: 3, 7: 108, 8: 16, 9: 575}
Prototype-Based Model Correct Classifications (per class):
{0: 116, 1: 8, 2: 4, 3: 0, 4: 40, 5: 0, 6: 2, 7: 112, 8: 16, 9: 570}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 5, 8: 500, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 270, 7: 8, 8: 481, 9: 101}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 102, 1: 1, 2: 0, 3: 0, 4: 0, 5: 178, 6: 149, 7: 132, 8: 50, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 104, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 146, 7: 132, 8: 50, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 263, 1: 0, 2: 38, 3: 8, 4: 0, 5: 10, 6: 3, 7: 14, 8: 2, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 252, 1: 0, 2: 40, 3: 11, 4: 0, 5: 4, 6: 3, 7: 13, 8: 3, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 77, 1: 2, 2: 182, 3: 19, 4: 0, 5: 0, 6: 23, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 73, 1: 2, 2: 184, 3: 22, 4: 0, 5: 0, 6: 21, 7: 2, 8: 324, 9: 478}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 39, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 40, 7: 0, 8: 19, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 31, 1: 0, 2: 1, 3: 10, 4: 0, 5: 5, 6: 34, 7: 0, 8: 20, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 8, 1: 0, 2: 13, 3: 0, 4: 0, 5: 0, 6: 233, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 17, 1: 0, 2: 38, 3: 0, 4: 0, 5: 0, 6: 205, 7: 0, 8: 0, 9: 11}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 30, 1: 66, 2: 356, 3: 119, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 19, 1: 62, 2: 358, 3: 121, 4: 1, 5: 499, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 219, 1: 289, 2: 224, 3: 0, 4: 155, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 289, 2: 195, 3: 0, 4: 166, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 62, 1: 140, 2: 0, 3: 1, 4: 4, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 59, 1: 137, 2: 1, 3: 1, 4: 7, 5: 0, 6: 0, 7: 0, 8: 699, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 120, 1: 131, 2: 2, 3: 16, 4: 10, 5: 254, 6: 218, 7: 103, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 124, 1: 129, 2: 2, 3: 18, 4: 11, 5: 252, 6: 201, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 239, 1: 0, 2: 56, 3: 65, 4: 0, 5: 60, 6: 0, 7: 286, 8: 0, 9: 93}
Prototype-Based Model Correct Classifications (per class):
{0: 228, 1: 0, 2: 59, 3: 69, 4: 0, 5: 59, 6: 1, 7: 285, 8: 0, 9: 96}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 26, 1: 140, 2: 237, 3: 2, 4: 56, 5: 81, 6: 0, 7: 20, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 26, 1: 135, 2: 228, 3: 4, 4: 54, 5: 83, 6: 2, 7: 19, 8: 15, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 148, 1: 122, 2: 125, 3: 0, 4: 15, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 146, 1: 120, 2: 127, 3: 0, 4: 13, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 8, 1: 0, 2: 97, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 98, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 343, 4: 49, 5: 0, 6: 240, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 347, 4: 55, 5: 0, 6: 227, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 100, 1: 69, 2: 186, 3: 183, 4: 25, 5: 4, 6: 74, 7: 439, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 105, 1: 68, 2: 177, 3: 184, 4: 29, 5: 12, 6: 51, 7: 436, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 116, 5: 50, 6: 20, 7: 36, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 13, 1: 15, 2: 0, 3: 13, 4: 102, 5: 50, 6: 28, 7: 38, 8: 47, 9: 269}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 20, 1: 27, 2: 0, 3: 87, 4: 2, 5: 0, 6: 176, 7: 43, 8: 21, 9: 2}
Prototype-Based Model Correct Classifications (per class):
{0: 24, 1: 27, 2: 2, 3: 89, 4: 3, 5: 0, 6: 148, 7: 42, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9434
Client 1: Regular Model Acc: 0.9623
Client 2: Regular Model Acc: 0.9111
Client 3: Regular Model Acc: 0.8851
Client 4: Regular Model Acc: 0.9440
Client 5: Regular Model Acc: 0.9074
Client 6: Regular Model Acc: 0.7755
Client 7: Regular Model Acc: 0.9571
Client 8: Regular Model Acc: 0.9376
Client 9: Regular Model Acc: 0.9807
Client 10: Regular Model Acc: 0.8804
Client 11: Regular Model Acc: 0.9920
Client 12: Regular Model Acc: 0.9367
Client 13: Regular Model Acc: 0.8686
Client 14: Regular Model Acc: 0.9651
Client 15: Regular Model Acc: 0.9883
Client 16: Regular Model Acc: 0.9497
Client 17: Regular Model Acc: 0.8911
Client 18: Regular Model Acc: 0.9045
Client 19: Regular Model Acc: 0.8552
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9264
Client 1: Prototype Model Acc: 0.9322
Client 2: Prototype Model Acc: 0.9067
Client 3: Prototype Model Acc: 0.8616
Client 4: Prototype Model Acc: 0.9381
Client 5: Prototype Model Acc: 0.8642
Client 6: Prototype Model Acc: 0.7901
Client 7: Prototype Model Acc: 0.9473
Client 8: Prototype Model Acc: 0.9271
Client 9: Prototype Model Acc: 0.9700
Client 10: Prototype Model Acc: 0.8660
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9343
Client 13: Prototype Model Acc: 0.8550
Client 14: Prototype Model Acc: 0.9610
Client 15: Prototype Model Acc: 0.9894
Client 16: Prototype Model Acc: 0.9480
Client 17: Prototype Model Acc: 0.8762
Client 18: Prototype Model Acc: 0.8998
Client 19: Prototype Model Acc: 0.8100
Averaged Test Accuracy (Regular Model): 0.9359
Averaged Test Accuracy (Prototype Model): 0.9260
Std Test Accuracy (Regular Model): 0.0515
Std Test Accuracy (Prototype Model): 0.0546
client.id trained 17
local_model_loss tensor(0.0594, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0290, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.1475, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.2132, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0175, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.1581, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.1880, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0205, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0241, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0524, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0370, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.1623, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0632, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0345, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0187, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.0376, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0167, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0400, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0349, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.0437, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 401.73295905592386
only_train_time: 3523.917912983219
all_clients_time_cost: 3523.917912983219
agg_protos_label dict_keys([7, 6, 2, 1, 3, 4, 0, 5, 8, 9])
-------------------------------------------------- 64.67552661895752

-------------Round number: 54-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 7, 3: 0, 4: 39, 5: 0, 6: 3, 7: 108, 8: 16, 9: 575}
Prototype-Based Model Correct Classifications (per class):
{0: 116, 1: 8, 2: 4, 3: 0, 4: 40, 5: 0, 6: 2, 7: 112, 8: 16, 9: 572}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 5, 8: 500, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 270, 7: 8, 8: 483, 9: 101}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 94, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 149, 7: 132, 8: 49, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 97, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 147, 7: 132, 8: 50, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 253, 1: 0, 2: 46, 3: 11, 4: 0, 5: 10, 6: 3, 7: 14, 8: 3, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 236, 1: 0, 2: 40, 3: 12, 4: 0, 5: 7, 6: 3, 7: 13, 8: 3, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 76, 1: 2, 2: 182, 3: 19, 4: 0, 5: 0, 6: 24, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 73, 1: 2, 2: 184, 3: 22, 4: 0, 5: 0, 6: 21, 7: 2, 8: 325, 9: 478}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 37, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 41, 7: 0, 8: 19, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 30, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 36, 7: 0, 8: 20, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 11, 1: 0, 2: 40, 3: 0, 4: 0, 5: 0, 6: 219, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 18, 1: 0, 2: 52, 3: 0, 4: 1, 5: 0, 6: 143, 7: 0, 8: 0, 9: 11}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 30, 1: 67, 2: 356, 3: 118, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 26, 1: 64, 2: 356, 3: 121, 4: 0, 5: 499, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 220, 1: 290, 2: 220, 3: 0, 4: 158, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 225, 1: 289, 2: 189, 3: 0, 4: 168, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 62, 1: 140, 2: 0, 3: 1, 4: 4, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 59, 1: 137, 2: 1, 3: 1, 4: 7, 5: 0, 6: 0, 7: 1, 8: 699, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 120, 1: 131, 2: 2, 3: 16, 4: 10, 5: 254, 6: 216, 7: 103, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 123, 1: 129, 2: 2, 3: 18, 4: 11, 5: 253, 6: 202, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 239, 1: 0, 2: 56, 3: 65, 4: 0, 5: 60, 6: 0, 7: 286, 8: 0, 9: 93}
Prototype-Based Model Correct Classifications (per class):
{0: 228, 1: 0, 2: 59, 3: 70, 4: 0, 5: 59, 6: 1, 7: 285, 8: 0, 9: 96}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 27, 1: 140, 2: 238, 3: 2, 4: 55, 5: 81, 6: 0, 7: 20, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 28, 1: 136, 2: 234, 3: 4, 4: 51, 5: 83, 6: 2, 7: 19, 8: 14, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 148, 1: 122, 2: 126, 3: 0, 4: 14, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 146, 1: 120, 2: 127, 3: 0, 4: 13, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 8, 1: 0, 2: 97, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 98, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 343, 4: 49, 5: 0, 6: 240, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 347, 4: 55, 5: 0, 6: 227, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 105, 1: 69, 2: 187, 3: 187, 4: 26, 5: 4, 6: 68, 7: 440, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 105, 1: 68, 2: 177, 3: 186, 4: 29, 5: 11, 6: 48, 7: 437, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 113, 5: 50, 6: 27, 7: 36, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 13, 4: 98, 5: 50, 6: 28, 7: 38, 8: 47, 9: 269}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 18, 1: 27, 2: 0, 3: 85, 4: 2, 5: 0, 6: 177, 7: 43, 8: 21, 9: 2}
Prototype-Based Model Correct Classifications (per class):
{0: 23, 1: 27, 2: 2, 3: 86, 4: 3, 5: 0, 6: 153, 7: 42, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9434
Client 1: Regular Model Acc: 0.9623
Client 2: Regular Model Acc: 0.8965
Client 3: Regular Model Acc: 0.8903
Client 4: Regular Model Acc: 0.9440
Client 5: Regular Model Acc: 0.9043
Client 6: Regular Model Acc: 0.8222
Client 7: Regular Model Acc: 0.9571
Client 8: Regular Model Acc: 0.9387
Client 9: Regular Model Acc: 0.9807
Client 10: Regular Model Acc: 0.8784
Client 11: Regular Model Acc: 0.9920
Client 12: Regular Model Acc: 0.9367
Client 13: Regular Model Acc: 0.8701
Client 14: Regular Model Acc: 0.9651
Client 15: Regular Model Acc: 0.9883
Client 16: Regular Model Acc: 0.9497
Client 17: Regular Model Acc: 0.8960
Client 18: Regular Model Acc: 0.9108
Client 19: Regular Model Acc: 0.8484
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9285
Client 1: Prototype Model Acc: 0.9343
Client 2: Prototype Model Acc: 0.8980
Client 3: Prototype Model Acc: 0.8303
Client 4: Prototype Model Acc: 0.9389
Client 5: Prototype Model Acc: 0.8642
Client 6: Prototype Model Acc: 0.6560
Client 7: Prototype Model Acc: 0.9526
Client 8: Prototype Model Acc: 0.9207
Client 9: Prototype Model Acc: 0.9710
Client 10: Prototype Model Acc: 0.8670
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9355
Client 13: Prototype Model Acc: 0.8625
Client 14: Prototype Model Acc: 0.9610
Client 15: Prototype Model Acc: 0.9904
Client 16: Prototype Model Acc: 0.9480
Client 17: Prototype Model Acc: 0.8754
Client 18: Prototype Model Acc: 0.8920
Client 19: Prototype Model Acc: 0.8122
Averaged Test Accuracy (Regular Model): 0.9367
Averaged Test Accuracy (Prototype Model): 0.9228
Std Test Accuracy (Regular Model): 0.0460
Std Test Accuracy (Prototype Model): 0.0749
client.id trained 19
local_model_loss tensor(0.1456, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0171, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.0545, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0183, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.0770, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0332, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.1534, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0232, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.0362, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0162, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.1365, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0197, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0532, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0390, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0299, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0284, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0357, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.2088, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.1057, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0444, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 409.20936126983725
only_train_time: 3588.5415142399725
all_clients_time_cost: 3588.5415142399725
agg_protos_label dict_keys([8, 3, 6, 7, 1, 2, 0, 4, 9, 5])
-------------------------------------------------- 66.18537402153015

-------------Round number: 55-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 8, 3: 0, 4: 39, 5: 0, 6: 3, 7: 108, 8: 16, 9: 575}
Prototype-Based Model Correct Classifications (per class):
{0: 115, 1: 8, 2: 4, 3: 0, 4: 40, 5: 0, 6: 2, 7: 112, 8: 16, 9: 570}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 5, 8: 500, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 270, 7: 8, 8: 483, 9: 100}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 99, 1: 1, 2: 0, 3: 0, 4: 0, 5: 178, 6: 149, 7: 132, 8: 50, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 101, 1: 1, 2: 0, 3: 0, 4: 0, 5: 178, 6: 147, 7: 132, 8: 50, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 263, 1: 0, 2: 38, 3: 8, 4: 0, 5: 10, 6: 3, 7: 14, 8: 2, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 253, 1: 0, 2: 40, 3: 11, 4: 0, 5: 7, 6: 3, 7: 13, 8: 3, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 76, 1: 2, 2: 180, 3: 19, 4: 0, 5: 0, 6: 24, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 73, 1: 2, 2: 184, 3: 22, 4: 0, 5: 0, 6: 21, 7: 2, 8: 325, 9: 478}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 32, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 43, 7: 0, 8: 19, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 0, 2: 1, 3: 10, 4: 0, 5: 5, 6: 36, 7: 0, 8: 20, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 19, 1: 0, 2: 43, 3: 0, 4: 0, 5: 0, 6: 197, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 24, 1: 0, 2: 52, 3: 0, 4: 1, 5: 0, 6: 120, 7: 0, 8: 0, 9: 12}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 31, 1: 68, 2: 356, 3: 115, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 65, 2: 357, 3: 119, 4: 0, 5: 499, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 219, 1: 289, 2: 224, 3: 0, 4: 155, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 227, 1: 289, 2: 196, 3: 0, 4: 166, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 62, 1: 140, 2: 0, 3: 1, 4: 4, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 59, 1: 137, 2: 1, 3: 1, 4: 7, 5: 0, 6: 0, 7: 2, 8: 699, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 113, 1: 130, 2: 1, 3: 17, 4: 9, 5: 254, 6: 227, 7: 104, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 118, 1: 129, 2: 1, 3: 18, 4: 11, 5: 254, 6: 210, 7: 102, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 239, 1: 0, 2: 56, 3: 65, 4: 0, 5: 60, 6: 0, 7: 286, 8: 0, 9: 93}
Prototype-Based Model Correct Classifications (per class):
{0: 228, 1: 0, 2: 59, 3: 70, 4: 0, 5: 59, 6: 1, 7: 285, 8: 0, 9: 96}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 26, 1: 140, 2: 240, 3: 2, 4: 55, 5: 81, 6: 0, 7: 20, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 26, 1: 136, 2: 231, 3: 4, 4: 53, 5: 83, 6: 2, 7: 19, 8: 15, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 148, 1: 122, 2: 126, 3: 0, 4: 14, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 146, 1: 120, 2: 128, 3: 0, 4: 12, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 97, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 98, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 343, 4: 50, 5: 0, 6: 241, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 347, 4: 55, 5: 0, 6: 227, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 101, 1: 70, 2: 184, 3: 184, 4: 27, 5: 4, 6: 73, 7: 439, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 105, 1: 68, 2: 176, 3: 184, 4: 29, 5: 11, 6: 50, 7: 437, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 117, 5: 50, 6: 19, 7: 34, 8: 46, 9: 272}
Prototype-Based Model Correct Classifications (per class):
{0: 13, 1: 15, 2: 0, 3: 13, 4: 104, 5: 50, 6: 25, 7: 37, 8: 47, 9: 269}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 19, 1: 27, 2: 0, 3: 87, 4: 2, 5: 0, 6: 175, 7: 43, 8: 21, 9: 2}
Prototype-Based Model Correct Classifications (per class):
{0: 23, 1: 27, 2: 2, 3: 90, 4: 3, 5: 0, 6: 148, 7: 40, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9445
Client 1: Regular Model Acc: 0.9623
Client 2: Regular Model Acc: 0.9067
Client 3: Regular Model Acc: 0.8851
Client 4: Regular Model Acc: 0.9423
Client 5: Regular Model Acc: 0.8951
Client 6: Regular Model Acc: 0.7901
Client 7: Regular Model Acc: 0.9562
Client 8: Regular Model Acc: 0.9376
Client 9: Regular Model Acc: 0.9807
Client 10: Regular Model Acc: 0.8814
Client 11: Regular Model Acc: 0.9920
Client 12: Regular Model Acc: 0.9367
Client 13: Regular Model Acc: 0.8716
Client 14: Regular Model Acc: 0.9651
Client 15: Regular Model Acc: 0.9894
Client 16: Regular Model Acc: 0.9514
Client 17: Regular Model Acc: 0.8927
Client 18: Regular Model Acc: 0.9030
Client 19: Regular Model Acc: 0.8507
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9253
Client 1: Prototype Model Acc: 0.9333
Client 2: Prototype Model Acc: 0.9052
Client 3: Prototype Model Acc: 0.8721
Client 4: Prototype Model Acc: 0.9389
Client 5: Prototype Model Acc: 0.8642
Client 6: Prototype Model Acc: 0.6093
Client 7: Prototype Model Acc: 0.9553
Client 8: Prototype Model Acc: 0.9281
Client 9: Prototype Model Acc: 0.9721
Client 10: Prototype Model Acc: 0.8691
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9355
Client 13: Prototype Model Acc: 0.8595
Client 14: Prototype Model Acc: 0.9610
Client 15: Prototype Model Acc: 0.9904
Client 16: Prototype Model Acc: 0.9480
Client 17: Prototype Model Acc: 0.8746
Client 18: Prototype Model Acc: 0.8967
Client 19: Prototype Model Acc: 0.8054
Averaged Test Accuracy (Regular Model): 0.9359
Averaged Test Accuracy (Prototype Model): 0.9235
Std Test Accuracy (Regular Model): 0.0500
Std Test Accuracy (Prototype Model): 0.0822
client.id trained 15
local_model_loss tensor(0.0170, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.0390, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0298, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0323, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0225, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.1793, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0448, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0279, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.0540, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0344, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0158, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.1715, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.2308, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.1350, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.0347, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0189, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0470, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.0998, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0380, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0167, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 416.6767625157954
only_train_time: 3652.201032083947
all_clients_time_cost: 3652.201032083947
agg_protos_label dict_keys([3, 2, 0, 1, 5, 6, 7, 4, 9, 8])
Number of samples: 167
-------------------------------------------------- 66.65324974060059

-------------Round number: 56-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 8, 3: 0, 4: 39, 5: 0, 6: 3, 7: 108, 8: 16, 9: 575}
Prototype-Based Model Correct Classifications (per class):
{0: 116, 1: 8, 2: 3, 3: 0, 4: 40, 5: 0, 6: 2, 7: 112, 8: 16, 9: 573}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 5, 8: 500, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 270, 7: 8, 8: 483, 9: 100}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 94, 1: 1, 2: 0, 3: 0, 4: 0, 5: 178, 6: 149, 7: 132, 8: 49, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 98, 1: 1, 2: 0, 3: 0, 4: 0, 5: 176, 6: 147, 7: 132, 8: 50, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 253, 1: 0, 2: 46, 3: 11, 4: 0, 5: 11, 6: 4, 7: 14, 8: 3, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 236, 1: 0, 2: 42, 3: 12, 4: 0, 5: 7, 6: 2, 7: 13, 8: 3, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 76, 1: 2, 2: 182, 3: 19, 4: 0, 5: 0, 6: 24, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 184, 3: 22, 4: 0, 5: 0, 6: 22, 7: 2, 8: 325, 9: 478}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 21, 1: 0, 2: 0, 3: 9, 4: 0, 5: 5, 6: 50, 7: 0, 8: 20, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 24, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 42, 7: 0, 8: 20, 9: 178}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 13, 1: 0, 2: 45, 3: 0, 4: 0, 5: 0, 6: 212, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 18, 1: 0, 2: 53, 3: 0, 4: 1, 5: 0, 6: 141, 7: 0, 8: 0, 9: 12}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 31, 1: 68, 2: 356, 3: 114, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 31, 1: 65, 2: 356, 3: 119, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 220, 1: 290, 2: 222, 3: 0, 4: 155, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 226, 1: 289, 2: 193, 3: 0, 4: 167, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 62, 1: 140, 2: 0, 3: 1, 4: 4, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 59, 1: 137, 2: 1, 3: 1, 4: 7, 5: 0, 6: 0, 7: 2, 8: 699, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 119, 1: 131, 2: 2, 3: 16, 4: 10, 5: 254, 6: 217, 7: 103, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 123, 1: 129, 2: 2, 3: 18, 4: 11, 5: 252, 6: 202, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 239, 1: 0, 2: 56, 3: 65, 4: 0, 5: 60, 6: 0, 7: 286, 8: 0, 9: 93}
Prototype-Based Model Correct Classifications (per class):
{0: 229, 1: 0, 2: 59, 3: 70, 4: 0, 5: 59, 6: 1, 7: 285, 8: 0, 9: 96}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 27, 1: 140, 2: 240, 3: 2, 4: 55, 5: 81, 6: 0, 7: 20, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 26, 1: 136, 2: 232, 3: 4, 4: 53, 5: 83, 6: 2, 7: 19, 8: 15, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 148, 1: 122, 2: 126, 3: 0, 4: 14, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 147, 1: 120, 2: 130, 3: 0, 4: 10, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 97, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 98, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 343, 4: 50, 5: 0, 6: 241, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 347, 4: 55, 5: 0, 6: 227, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 100, 1: 70, 2: 184, 3: 184, 4: 27, 5: 4, 6: 76, 7: 439, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 104, 1: 69, 2: 177, 3: 184, 4: 29, 5: 11, 6: 53, 7: 437, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 113, 5: 50, 6: 27, 7: 36, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 13, 4: 101, 5: 50, 6: 28, 7: 37, 8: 47, 9: 269}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 17, 1: 27, 2: 0, 3: 87, 4: 2, 5: 0, 6: 176, 7: 43, 8: 21, 9: 2}
Prototype-Based Model Correct Classifications (per class):
{0: 21, 1: 27, 2: 2, 3: 90, 4: 4, 5: 0, 6: 138, 7: 43, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9445
Client 1: Regular Model Acc: 0.9623
Client 2: Regular Model Acc: 0.8980
Client 3: Regular Model Acc: 0.8956
Client 4: Regular Model Acc: 0.9440
Client 5: Regular Model Acc: 0.8827
Client 6: Regular Model Acc: 0.8222
Client 7: Regular Model Acc: 0.9553
Client 8: Regular Model Acc: 0.9376
Client 9: Regular Model Acc: 0.9807
Client 10: Regular Model Acc: 0.8784
Client 11: Regular Model Acc: 0.9920
Client 12: Regular Model Acc: 0.9367
Client 13: Regular Model Acc: 0.8731
Client 14: Regular Model Acc: 0.9651
Client 15: Regular Model Acc: 0.9894
Client 16: Regular Model Acc: 0.9514
Client 17: Regular Model Acc: 0.8944
Client 18: Regular Model Acc: 0.9108
Client 19: Regular Model Acc: 0.8484
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9285
Client 1: Prototype Model Acc: 0.9333
Client 2: Prototype Model Acc: 0.8980
Client 3: Prototype Model Acc: 0.8329
Client 4: Prototype Model Acc: 0.9406
Client 5: Prototype Model Acc: 0.8611
Client 6: Prototype Model Acc: 0.6560
Client 7: Prototype Model Acc: 0.9571
Client 8: Prototype Model Acc: 0.9249
Client 9: Prototype Model Acc: 0.9721
Client 10: Prototype Model Acc: 0.8660
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9367
Client 13: Prototype Model Acc: 0.8610
Client 14: Prototype Model Acc: 0.9620
Client 15: Prototype Model Acc: 0.9904
Client 16: Prototype Model Acc: 0.9480
Client 17: Prototype Model Acc: 0.8779
Client 18: Prototype Model Acc: 0.8951
Client 19: Prototype Model Acc: 0.7873
Averaged Test Accuracy (Regular Model): 0.9365
Averaged Test Accuracy (Prototype Model): 0.9231
Std Test Accuracy (Regular Model): 0.0465
Std Test Accuracy (Prototype Model): 0.0769
client.id trained 11
local_model_loss tensor(0.0154, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0160, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0332, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0429, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0283, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.0951, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0164, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.0332, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0183, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0273, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0372, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0440, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.1388, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.0585, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.1245, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.0380, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0216, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0313, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.1512, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.1993, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 423.09285987273324
only_train_time: 3716.7410500616534
all_clients_time_cost: 3716.7410500616534
agg_protos_label dict_keys([4, 1, 3, 2, 0, 5, 7, 9, 6, 8])
-------------------------------------------------- 66.16288256645203

-------------Round number: 57-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 8, 3: 0, 4: 39, 5: 0, 6: 3, 7: 108, 8: 16, 9: 575}
Prototype-Based Model Correct Classifications (per class):
{0: 115, 1: 8, 2: 3, 3: 0, 4: 40, 5: 0, 6: 2, 7: 112, 8: 16, 9: 572}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 5, 8: 500, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 270, 7: 8, 8: 483, 9: 100}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 99, 1: 1, 2: 0, 3: 0, 4: 0, 5: 178, 6: 149, 7: 132, 8: 50, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 101, 1: 1, 2: 0, 3: 0, 4: 0, 5: 178, 6: 147, 7: 132, 8: 50, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 262, 1: 0, 2: 39, 3: 9, 4: 0, 5: 10, 6: 3, 7: 14, 8: 2, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 252, 1: 0, 2: 41, 3: 12, 4: 0, 5: 7, 6: 3, 7: 13, 8: 3, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 76, 1: 2, 2: 182, 3: 19, 4: 0, 5: 0, 6: 24, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 184, 3: 22, 4: 0, 5: 0, 6: 21, 7: 2, 8: 324, 9: 477}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 29, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 48, 7: 0, 8: 20, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 40, 7: 0, 8: 20, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 7, 1: 0, 2: 31, 3: 0, 4: 0, 5: 0, 6: 229, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 13, 1: 0, 2: 49, 3: 0, 4: 1, 5: 0, 6: 194, 7: 0, 8: 0, 9: 11}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 31, 1: 68, 2: 356, 3: 113, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 31, 1: 65, 2: 355, 3: 120, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 220, 1: 289, 2: 226, 3: 0, 4: 155, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 226, 1: 289, 2: 197, 3: 0, 4: 166, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 63, 1: 140, 2: 0, 3: 1, 4: 4, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 59, 1: 137, 2: 1, 3: 1, 4: 7, 5: 0, 6: 0, 7: 2, 8: 699, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 124, 1: 131, 2: 2, 3: 16, 4: 10, 5: 254, 6: 208, 7: 103, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 124, 1: 129, 2: 2, 3: 18, 4: 11, 5: 253, 6: 192, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 239, 1: 0, 2: 56, 3: 65, 4: 0, 5: 60, 6: 0, 7: 286, 8: 0, 9: 93}
Prototype-Based Model Correct Classifications (per class):
{0: 229, 1: 0, 2: 59, 3: 70, 4: 0, 5: 59, 6: 1, 7: 285, 8: 0, 9: 96}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 27, 1: 141, 2: 237, 3: 2, 4: 56, 5: 81, 6: 1, 7: 20, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 26, 1: 136, 2: 226, 3: 4, 4: 53, 5: 83, 6: 2, 7: 19, 8: 15, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 148, 1: 122, 2: 126, 3: 0, 4: 15, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 146, 1: 120, 2: 129, 3: 0, 4: 10, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 97, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 98, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 344, 4: 50, 5: 0, 6: 241, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 347, 4: 55, 5: 0, 6: 227, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 105, 1: 69, 2: 191, 3: 189, 4: 24, 5: 4, 6: 57, 7: 441, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 105, 1: 68, 2: 178, 3: 189, 4: 32, 5: 11, 6: 30, 7: 437, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 117, 5: 50, 6: 18, 7: 34, 8: 46, 9: 272}
Prototype-Based Model Correct Classifications (per class):
{0: 13, 1: 15, 2: 0, 3: 13, 4: 106, 5: 50, 6: 24, 7: 37, 8: 47, 9: 270}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 19, 1: 27, 2: 0, 3: 87, 4: 2, 5: 0, 6: 176, 7: 43, 8: 21, 9: 2}
Prototype-Based Model Correct Classifications (per class):
{0: 23, 1: 27, 2: 2, 3: 90, 4: 3, 5: 0, 6: 153, 7: 42, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9445
Client 1: Regular Model Acc: 0.9623
Client 2: Regular Model Acc: 0.9067
Client 3: Regular Model Acc: 0.8877
Client 4: Regular Model Acc: 0.9440
Client 5: Regular Model Acc: 0.9043
Client 6: Regular Model Acc: 0.8134
Client 7: Regular Model Acc: 0.9544
Client 8: Regular Model Acc: 0.9408
Client 9: Regular Model Acc: 0.9818
Client 10: Regular Model Acc: 0.8742
Client 11: Regular Model Acc: 0.9920
Client 12: Regular Model Acc: 0.9367
Client 13: Regular Model Acc: 0.8731
Client 14: Regular Model Acc: 0.9661
Client 15: Regular Model Acc: 0.9894
Client 16: Regular Model Acc: 0.9523
Client 17: Regular Model Acc: 0.8911
Client 18: Regular Model Acc: 0.9014
Client 19: Regular Model Acc: 0.8529
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9264
Client 1: Prototype Model Acc: 0.9333
Client 2: Prototype Model Acc: 0.9052
Client 3: Prototype Model Acc: 0.8747
Client 4: Prototype Model Acc: 0.9381
Client 5: Prototype Model Acc: 0.8735
Client 6: Prototype Model Acc: 0.7813
Client 7: Prototype Model Acc: 0.9571
Client 8: Prototype Model Acc: 0.9281
Client 9: Prototype Model Acc: 0.9721
Client 10: Prototype Model Acc: 0.8577
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9367
Client 13: Prototype Model Acc: 0.8520
Client 14: Prototype Model Acc: 0.9600
Client 15: Prototype Model Acc: 0.9904
Client 16: Prototype Model Acc: 0.9480
Client 17: Prototype Model Acc: 0.8663
Client 18: Prototype Model Acc: 0.8998
Client 19: Prototype Model Acc: 0.8213
Averaged Test Accuracy (Regular Model): 0.9365
Averaged Test Accuracy (Prototype Model): 0.9262
Std Test Accuracy (Regular Model): 0.0471
Std Test Accuracy (Prototype Model): 0.0553
client.id trained 6
local_model_loss tensor(0.2224, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.1449, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0306, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0177, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0276, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0156, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.0473, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.1791, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0268, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.0323, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.0588, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0361, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0150, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.1716, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0447, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.1292, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0207, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0398, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0148, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0320, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 430.9937649386702
only_train_time: 3779.9295131088
all_clients_time_cost: 3779.9295131088
agg_protos_label dict_keys([6, 2, 7, 0, 9, 1, 4, 5, 8, 3])
-------------------------------------------------- 64.86634278297424

-------------Round number: 58-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 8, 3: 0, 4: 39, 5: 0, 6: 3, 7: 108, 8: 16, 9: 575}
Prototype-Based Model Correct Classifications (per class):
{0: 116, 1: 8, 2: 4, 3: 0, 4: 40, 5: 0, 6: 2, 7: 112, 8: 16, 9: 573}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 5, 8: 500, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 270, 7: 8, 8: 484, 9: 100}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 96, 1: 1, 2: 0, 3: 0, 4: 0, 5: 178, 6: 149, 7: 132, 8: 50, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 97, 1: 1, 2: 0, 3: 0, 4: 0, 5: 178, 6: 148, 7: 132, 8: 50, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 252, 1: 0, 2: 46, 3: 11, 4: 0, 5: 11, 6: 4, 7: 14, 8: 3, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 234, 1: 0, 2: 42, 3: 12, 4: 0, 5: 7, 6: 3, 7: 13, 8: 3, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 76, 1: 2, 2: 180, 3: 19, 4: 0, 5: 0, 6: 25, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 184, 3: 22, 4: 0, 5: 0, 6: 22, 7: 2, 8: 325, 9: 477}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 34, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 42, 7: 0, 8: 19, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 39, 7: 0, 8: 20, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 9, 1: 0, 2: 37, 3: 0, 4: 0, 5: 0, 6: 220, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 19, 1: 0, 2: 54, 3: 0, 4: 1, 5: 0, 6: 140, 7: 0, 8: 0, 9: 11}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 31, 1: 68, 2: 355, 3: 112, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 31, 1: 65, 2: 356, 3: 120, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 220, 1: 290, 2: 222, 3: 0, 4: 155, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 225, 1: 289, 2: 195, 3: 0, 4: 167, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 63, 1: 140, 2: 0, 3: 1, 4: 4, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 59, 1: 137, 2: 1, 3: 1, 4: 7, 5: 0, 6: 0, 7: 2, 8: 699, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 117, 1: 131, 2: 2, 3: 17, 4: 10, 5: 254, 6: 219, 7: 104, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 122, 1: 129, 2: 2, 3: 18, 4: 11, 5: 252, 6: 202, 7: 102, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 239, 1: 0, 2: 56, 3: 65, 4: 0, 5: 60, 6: 0, 7: 286, 8: 0, 9: 93}
Prototype-Based Model Correct Classifications (per class):
{0: 229, 1: 0, 2: 59, 3: 70, 4: 0, 5: 59, 6: 1, 7: 285, 8: 0, 9: 96}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 28, 1: 140, 2: 240, 3: 2, 4: 53, 5: 81, 6: 0, 7: 20, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 136, 2: 237, 3: 4, 4: 48, 5: 83, 6: 2, 7: 19, 8: 13, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 148, 1: 122, 2: 126, 3: 0, 4: 15, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 146, 1: 120, 2: 126, 3: 0, 4: 12, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 97, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 98, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 344, 4: 50, 5: 0, 6: 241, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 347, 4: 55, 5: 0, 6: 227, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 103, 1: 70, 2: 183, 3: 186, 4: 27, 5: 4, 6: 72, 7: 439, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 105, 1: 68, 2: 176, 3: 186, 4: 29, 5: 11, 6: 52, 7: 437, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 113, 5: 50, 6: 27, 7: 36, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 13, 4: 99, 5: 50, 6: 28, 7: 37, 8: 47, 9: 269}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 19, 1: 27, 2: 0, 3: 87, 4: 2, 5: 0, 6: 176, 7: 43, 8: 21, 9: 2}
Prototype-Based Model Correct Classifications (per class):
{0: 23, 1: 27, 2: 2, 3: 88, 4: 3, 5: 0, 6: 153, 7: 40, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9445
Client 1: Regular Model Acc: 0.9623
Client 2: Regular Model Acc: 0.9023
Client 3: Regular Model Acc: 0.8930
Client 4: Regular Model Acc: 0.9432
Client 5: Regular Model Acc: 0.8981
Client 6: Regular Model Acc: 0.8105
Client 7: Regular Model Acc: 0.9526
Client 8: Regular Model Acc: 0.9376
Client 9: Regular Model Acc: 0.9818
Client 10: Regular Model Acc: 0.8804
Client 11: Regular Model Acc: 0.9920
Client 12: Regular Model Acc: 0.9367
Client 13: Regular Model Acc: 0.8716
Client 14: Regular Model Acc: 0.9661
Client 15: Regular Model Acc: 0.9894
Client 16: Regular Model Acc: 0.9523
Client 17: Regular Model Acc: 0.8944
Client 18: Regular Model Acc: 0.9108
Client 19: Regular Model Acc: 0.8529
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9296
Client 1: Prototype Model Acc: 0.9343
Client 2: Prototype Model Acc: 0.9009
Client 3: Prototype Model Acc: 0.8303
Client 4: Prototype Model Acc: 0.9398
Client 5: Prototype Model Acc: 0.8704
Client 6: Prototype Model Acc: 0.6560
Client 7: Prototype Model Acc: 0.9580
Client 8: Prototype Model Acc: 0.9260
Client 9: Prototype Model Acc: 0.9721
Client 10: Prototype Model Acc: 0.8639
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9367
Client 13: Prototype Model Acc: 0.8625
Client 14: Prototype Model Acc: 0.9589
Client 15: Prototype Model Acc: 0.9904
Client 16: Prototype Model Acc: 0.9480
Client 17: Prototype Model Acc: 0.8779
Client 18: Prototype Model Acc: 0.8920
Client 19: Prototype Model Acc: 0.8122
Averaged Test Accuracy (Regular Model): 0.9368
Averaged Test Accuracy (Prototype Model): 0.9238
Std Test Accuracy (Regular Model): 0.0469
Std Test Accuracy (Prototype Model): 0.0751
client.id trained 4
local_model_loss tensor(0.0201, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0263, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.0922, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0151, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.0309, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.1860, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0146, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0295, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0354, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0154, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0310, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.1289, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0393, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.1104, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.0452, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0171, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.1612, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0372, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0263, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.0341, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 438.4583983486518
only_train_time: 3845.7565417076694
all_clients_time_cost: 3845.7565417076694
agg_protos_label dict_keys([9, 8, 0, 2, 6, 3, 7, 4, 1, 5])
-------------------------------------------------- 67.58242988586426

-------------Round number: 59-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 8, 3: 0, 4: 39, 5: 0, 6: 3, 7: 108, 8: 16, 9: 575}
Prototype-Based Model Correct Classifications (per class):
{0: 115, 1: 8, 2: 4, 3: 0, 4: 40, 5: 0, 6: 2, 7: 112, 8: 16, 9: 571}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 5, 8: 500, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 270, 7: 8, 8: 484, 9: 100}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 99, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 149, 7: 132, 8: 50, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 99, 1: 1, 2: 0, 3: 0, 4: 0, 5: 178, 6: 147, 7: 132, 8: 50, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 261, 1: 0, 2: 40, 3: 10, 4: 0, 5: 10, 6: 3, 7: 14, 8: 2, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 252, 1: 0, 2: 42, 3: 12, 4: 0, 5: 7, 6: 2, 7: 13, 8: 3, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 76, 1: 2, 2: 180, 3: 19, 4: 0, 5: 0, 6: 25, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 184, 3: 22, 4: 0, 5: 0, 6: 21, 7: 2, 8: 325, 9: 477}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 37, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 41, 7: 0, 8: 19, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 30, 1: 0, 2: 1, 3: 10, 4: 0, 5: 5, 6: 34, 7: 0, 8: 20, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 17, 1: 0, 2: 38, 3: 0, 4: 0, 5: 0, 6: 204, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 23, 1: 0, 2: 50, 3: 0, 4: 2, 5: 0, 6: 143, 7: 0, 8: 0, 9: 11}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 31, 1: 68, 2: 355, 3: 113, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 31, 1: 65, 2: 356, 3: 120, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 220, 1: 289, 2: 226, 3: 0, 4: 155, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 226, 1: 289, 2: 199, 3: 0, 4: 166, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 63, 1: 140, 2: 0, 3: 1, 4: 4, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 59, 1: 137, 2: 1, 3: 1, 4: 7, 5: 0, 6: 0, 7: 2, 8: 699, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 118, 1: 131, 2: 2, 3: 16, 4: 10, 5: 254, 6: 219, 7: 103, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 123, 1: 129, 2: 2, 3: 18, 4: 11, 5: 253, 6: 205, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 239, 1: 0, 2: 56, 3: 65, 4: 0, 5: 60, 6: 0, 7: 286, 8: 0, 9: 94}
Prototype-Based Model Correct Classifications (per class):
{0: 228, 1: 0, 2: 59, 3: 70, 4: 0, 5: 59, 6: 1, 7: 285, 8: 0, 9: 96}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 28, 1: 140, 2: 241, 3: 2, 4: 52, 5: 81, 6: 0, 7: 20, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 28, 1: 136, 2: 238, 3: 4, 4: 51, 5: 83, 6: 2, 7: 19, 8: 15, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 148, 1: 122, 2: 126, 3: 0, 4: 14, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 147, 1: 120, 2: 129, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 97, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 98, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 344, 4: 50, 5: 0, 6: 241, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 347, 4: 55, 5: 0, 6: 227, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 101, 1: 70, 2: 182, 3: 186, 4: 27, 5: 4, 6: 74, 7: 439, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 104, 1: 68, 2: 177, 3: 186, 4: 29, 5: 11, 6: 53, 7: 437, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 117, 5: 50, 6: 18, 7: 34, 8: 46, 9: 272}
Prototype-Based Model Correct Classifications (per class):
{0: 13, 1: 15, 2: 0, 3: 13, 4: 107, 5: 50, 6: 24, 7: 37, 8: 47, 9: 270}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 19, 1: 27, 2: 0, 3: 87, 4: 2, 5: 0, 6: 177, 7: 43, 8: 21, 9: 2}
Prototype-Based Model Correct Classifications (per class):
{0: 23, 1: 27, 2: 2, 3: 90, 4: 2, 5: 0, 6: 154, 7: 40, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9445
Client 1: Regular Model Acc: 0.9623
Client 2: Regular Model Acc: 0.9052
Client 3: Regular Model Acc: 0.8903
Client 4: Regular Model Acc: 0.9432
Client 5: Regular Model Acc: 0.9043
Client 6: Regular Model Acc: 0.7901
Client 7: Regular Model Acc: 0.9535
Client 8: Regular Model Acc: 0.9408
Client 9: Regular Model Acc: 0.9818
Client 10: Regular Model Acc: 0.8794
Client 11: Regular Model Acc: 0.9920
Client 12: Regular Model Acc: 0.9379
Client 13: Regular Model Acc: 0.8716
Client 14: Regular Model Acc: 0.9651
Client 15: Regular Model Acc: 0.9894
Client 16: Regular Model Acc: 0.9523
Client 17: Regular Model Acc: 0.8936
Client 18: Regular Model Acc: 0.9014
Client 19: Regular Model Acc: 0.8552
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9264
Client 1: Prototype Model Acc: 0.9343
Client 2: Prototype Model Acc: 0.9023
Client 3: Prototype Model Acc: 0.8747
Client 4: Prototype Model Acc: 0.9389
Client 5: Prototype Model Acc: 0.8611
Client 6: Prototype Model Acc: 0.6676
Client 7: Prototype Model Acc: 0.9580
Client 8: Prototype Model Acc: 0.9302
Client 9: Prototype Model Acc: 0.9721
Client 10: Prototype Model Acc: 0.8701
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9355
Client 13: Prototype Model Acc: 0.8701
Client 14: Prototype Model Acc: 0.9600
Client 15: Prototype Model Acc: 0.9894
Client 16: Prototype Model Acc: 0.9480
Client 17: Prototype Model Acc: 0.8787
Client 18: Prototype Model Acc: 0.9014
Client 19: Prototype Model Acc: 0.8167
Averaged Test Accuracy (Regular Model): 0.9364
Averaged Test Accuracy (Prototype Model): 0.9260
Std Test Accuracy (Regular Model): 0.0495
Std Test Accuracy (Prototype Model): 0.0711
client.id trained 3
local_model_loss tensor(0.1691, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.1015, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0344, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.0867, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.1306, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0289, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.0314, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0145, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0299, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0389, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.0296, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.1476, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0253, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.0478, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0138, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0142, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0165, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0258, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0348, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0194, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 445.98042963969056
only_train_time: 3910.887227434665
all_clients_time_cost: 3910.887227434665
agg_protos_label dict_keys([0, 2, 7, 6, 3, 5, 8, 9, 1, 4])
Number of samples: 167
-------------------------------------------------- 68.10898351669312

-------------Round number: 60-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 8, 3: 0, 4: 39, 5: 0, 6: 3, 7: 108, 8: 16, 9: 575}
Prototype-Based Model Correct Classifications (per class):
{0: 115, 1: 8, 2: 4, 3: 0, 4: 40, 5: 0, 6: 2, 7: 112, 8: 16, 9: 572}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 5, 8: 500, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 270, 7: 8, 8: 484, 9: 100}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 100, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 149, 7: 132, 8: 50, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 103, 1: 1, 2: 0, 3: 0, 4: 0, 5: 178, 6: 147, 7: 132, 8: 50, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 252, 1: 0, 2: 46, 3: 11, 4: 0, 5: 11, 6: 4, 7: 14, 8: 3, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 233, 1: 0, 2: 42, 3: 12, 4: 0, 5: 7, 6: 3, 7: 13, 8: 3, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 76, 1: 2, 2: 180, 3: 19, 4: 0, 5: 0, 6: 25, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 184, 3: 22, 4: 0, 5: 0, 6: 22, 7: 2, 8: 325, 9: 477}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 39, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 39, 7: 0, 8: 19, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 31, 1: 0, 2: 1, 3: 10, 4: 0, 5: 5, 6: 34, 7: 0, 8: 20, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 15, 1: 0, 2: 39, 3: 0, 4: 0, 5: 0, 6: 216, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 18, 1: 0, 2: 49, 3: 0, 4: 1, 5: 0, 6: 156, 7: 0, 8: 0, 9: 11}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 31, 1: 68, 2: 354, 3: 113, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 31, 1: 65, 2: 355, 3: 120, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 220, 1: 290, 2: 223, 3: 0, 4: 155, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 225, 1: 289, 2: 196, 3: 0, 4: 166, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 63, 1: 140, 2: 0, 3: 1, 4: 5, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 59, 1: 137, 2: 1, 3: 1, 4: 7, 5: 0, 6: 0, 7: 2, 8: 699, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 120, 1: 131, 2: 2, 3: 17, 4: 10, 5: 254, 6: 217, 7: 103, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 124, 1: 129, 2: 2, 3: 18, 4: 11, 5: 253, 6: 203, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 1, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 239, 1: 0, 2: 56, 3: 65, 4: 0, 5: 60, 6: 0, 7: 286, 8: 0, 9: 94}
Prototype-Based Model Correct Classifications (per class):
{0: 228, 1: 0, 2: 59, 3: 70, 4: 0, 5: 59, 6: 1, 7: 285, 8: 0, 9: 96}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 28, 1: 140, 2: 241, 3: 2, 4: 52, 5: 81, 6: 0, 7: 20, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 28, 1: 136, 2: 238, 3: 4, 4: 52, 5: 83, 6: 2, 7: 19, 8: 15, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 148, 1: 122, 2: 126, 3: 0, 4: 12, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 147, 1: 120, 2: 130, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 97, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 98, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 345, 4: 50, 5: 0, 6: 241, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 347, 4: 55, 5: 0, 6: 227, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 105, 1: 70, 2: 189, 3: 189, 4: 25, 5: 4, 6: 61, 7: 440, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 105, 1: 68, 2: 181, 3: 189, 4: 29, 5: 11, 6: 40, 7: 437, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 113, 5: 50, 6: 27, 7: 35, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 13, 4: 102, 5: 50, 6: 28, 7: 37, 8: 47, 9: 269}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 19, 1: 27, 2: 0, 3: 87, 4: 2, 5: 0, 6: 176, 7: 43, 8: 21, 9: 2}
Prototype-Based Model Correct Classifications (per class):
{0: 23, 1: 27, 2: 2, 3: 90, 4: 2, 5: 0, 6: 152, 7: 40, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9445
Client 1: Regular Model Acc: 0.9623
Client 2: Regular Model Acc: 0.9067
Client 3: Regular Model Acc: 0.8930
Client 4: Regular Model Acc: 0.9432
Client 5: Regular Model Acc: 0.9043
Client 6: Regular Model Acc: 0.8222
Client 7: Regular Model Acc: 0.9526
Client 8: Regular Model Acc: 0.9387
Client 9: Regular Model Acc: 0.9828
Client 10: Regular Model Acc: 0.8804
Client 11: Regular Model Acc: 0.9926
Client 12: Regular Model Acc: 0.9379
Client 13: Regular Model Acc: 0.8716
Client 14: Regular Model Acc: 0.9630
Client 15: Regular Model Acc: 0.9894
Client 16: Regular Model Acc: 0.9532
Client 17: Regular Model Acc: 0.8936
Client 18: Regular Model Acc: 0.9092
Client 19: Regular Model Acc: 0.8529
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9274
Client 1: Prototype Model Acc: 0.9343
Client 2: Prototype Model Acc: 0.9082
Client 3: Prototype Model Acc: 0.8277
Client 4: Prototype Model Acc: 0.9398
Client 5: Prototype Model Acc: 0.8642
Client 6: Prototype Model Acc: 0.6851
Client 7: Prototype Model Acc: 0.9571
Client 8: Prototype Model Acc: 0.9260
Client 9: Prototype Model Acc: 0.9721
Client 10: Prototype Model Acc: 0.8691
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9355
Client 13: Prototype Model Acc: 0.8716
Client 14: Prototype Model Acc: 0.9610
Client 15: Prototype Model Acc: 0.9894
Client 16: Prototype Model Acc: 0.9480
Client 17: Prototype Model Acc: 0.8746
Client 18: Prototype Model Acc: 0.8967
Client 19: Prototype Model Acc: 0.8122
Averaged Test Accuracy (Regular Model): 0.9373
Averaged Test Accuracy (Prototype Model): 0.9249
Std Test Accuracy (Regular Model): 0.0454
Std Test Accuracy (Prototype Model): 0.0703
client.id trained 10
local_model_loss tensor(0.0294, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.0952, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.1495, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.0414, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.0286, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0360, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0335, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0288, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0138, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.2960, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0253, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.0823, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0139, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0238, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0160, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0187, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0134, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0327, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0278, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.1699, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 453.60104816267267
only_train_time: 3974.6957048507174
all_clients_time_cost: 3974.6957048507174
agg_protos_label dict_keys([5, 1, 3, 6, 7, 0, 4, 2, 9, 8])
-------------------------------------------------- 65.51664638519287

-------------Round number: 61-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 8, 3: 0, 4: 39, 5: 0, 6: 3, 7: 108, 8: 16, 9: 575}
Prototype-Based Model Correct Classifications (per class):
{0: 115, 1: 8, 2: 4, 3: 0, 4: 40, 5: 0, 6: 2, 7: 112, 8: 16, 9: 572}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 273, 7: 5, 8: 501, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 270, 7: 8, 8: 484, 9: 100}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 101, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 148, 7: 132, 8: 50, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 103, 1: 1, 2: 0, 3: 0, 4: 0, 5: 178, 6: 145, 7: 132, 8: 50, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 261, 1: 0, 2: 41, 3: 10, 4: 0, 5: 11, 6: 4, 7: 14, 8: 3, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 246, 1: 0, 2: 43, 3: 12, 4: 0, 5: 7, 6: 4, 7: 13, 8: 4, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 76, 1: 2, 2: 182, 3: 19, 4: 0, 5: 0, 6: 25, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 184, 3: 22, 4: 0, 5: 0, 6: 22, 7: 2, 8: 325, 9: 477}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 37, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 41, 7: 0, 8: 19, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 30, 1: 0, 2: 1, 3: 10, 4: 0, 5: 5, 6: 34, 7: 0, 8: 20, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 8, 1: 0, 2: 37, 3: 0, 4: 0, 5: 0, 6: 222, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 13, 1: 0, 2: 50, 3: 0, 4: 1, 5: 0, 6: 185, 7: 0, 8: 0, 9: 11}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 31, 1: 68, 2: 354, 3: 113, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 31, 1: 65, 2: 356, 3: 120, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 220, 1: 289, 2: 227, 3: 0, 4: 155, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 226, 1: 289, 2: 199, 3: 0, 4: 166, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 63, 1: 140, 2: 0, 3: 1, 4: 5, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 59, 1: 137, 2: 1, 3: 1, 4: 7, 5: 0, 6: 0, 7: 2, 8: 699, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 118, 1: 131, 2: 2, 3: 17, 4: 10, 5: 254, 6: 217, 7: 103, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 123, 1: 129, 2: 2, 3: 18, 4: 11, 5: 253, 6: 204, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 1, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 239, 1: 0, 2: 56, 3: 65, 4: 0, 5: 60, 6: 0, 7: 286, 8: 0, 9: 94}
Prototype-Based Model Correct Classifications (per class):
{0: 228, 1: 0, 2: 59, 3: 70, 4: 0, 5: 59, 6: 1, 7: 285, 8: 0, 9: 96}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 27, 1: 141, 2: 237, 3: 2, 4: 56, 5: 81, 6: 1, 7: 20, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 26, 1: 136, 2: 226, 3: 4, 4: 55, 5: 83, 6: 2, 7: 19, 8: 15, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 148, 1: 122, 2: 126, 3: 0, 4: 14, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 147, 1: 120, 2: 129, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 97, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 98, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 345, 4: 50, 5: 0, 6: 241, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 347, 4: 55, 5: 0, 6: 227, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 97, 1: 70, 2: 182, 3: 185, 4: 27, 5: 5, 6: 77, 7: 439, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 104, 1: 69, 2: 177, 3: 185, 4: 29, 5: 11, 6: 53, 7: 437, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 117, 5: 50, 6: 19, 7: 35, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 13, 4: 107, 5: 50, 6: 25, 7: 37, 8: 47, 9: 270}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 18, 1: 26, 2: 1, 3: 96, 4: 2, 5: 0, 6: 116, 7: 43, 8: 18, 9: 2}
Prototype-Based Model Correct Classifications (per class):
{0: 17, 1: 26, 2: 1, 3: 97, 4: 6, 5: 0, 6: 31, 7: 42, 8: 17, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9445
Client 1: Regular Model Acc: 0.9634
Client 2: Regular Model Acc: 0.9067
Client 3: Regular Model Acc: 0.9008
Client 4: Regular Model Acc: 0.9449
Client 5: Regular Model Acc: 0.9043
Client 6: Regular Model Acc: 0.8134
Client 7: Regular Model Acc: 0.9526
Client 8: Regular Model Acc: 0.9419
Client 9: Regular Model Acc: 0.9828
Client 10: Regular Model Acc: 0.8784
Client 11: Regular Model Acc: 0.9926
Client 12: Regular Model Acc: 0.9379
Client 13: Regular Model Acc: 0.8731
Client 14: Regular Model Acc: 0.9651
Client 15: Regular Model Acc: 0.9894
Client 16: Regular Model Acc: 0.9532
Client 17: Regular Model Acc: 0.8927
Client 18: Regular Model Acc: 0.9030
Client 19: Regular Model Acc: 0.7285
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9274
Client 1: Prototype Model Acc: 0.9343
Client 2: Prototype Model Acc: 0.9052
Client 3: Prototype Model Acc: 0.8695
Client 4: Prototype Model Acc: 0.9398
Client 5: Prototype Model Acc: 0.8611
Client 6: Prototype Model Acc: 0.7580
Client 7: Prototype Model Acc: 0.9580
Client 8: Prototype Model Acc: 0.9302
Client 9: Prototype Model Acc: 0.9721
Client 10: Prototype Model Acc: 0.8691
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9355
Client 13: Prototype Model Acc: 0.8550
Client 14: Prototype Model Acc: 0.9600
Client 15: Prototype Model Acc: 0.9894
Client 16: Prototype Model Acc: 0.9480
Client 17: Prototype Model Acc: 0.8787
Client 18: Prototype Model Acc: 0.9014
Client 19: Prototype Model Acc: 0.5407
Averaged Test Accuracy (Regular Model): 0.9343
Averaged Test Accuracy (Prototype Model): 0.9203
Std Test Accuracy (Regular Model): 0.0616
Std Test Accuracy (Prototype Model): 0.0979
client.id trained 13
local_model_loss tensor(0.3246, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0248, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0155, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0234, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0181, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.1751, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0134, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0309, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0337, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.0277, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0279, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0271, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0136, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0134, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.1335, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.0405, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.1169, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0327, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.1364, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.0280, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 461.07026025268715
only_train_time: 4039.119702510303
all_clients_time_cost: 4039.119702510303
agg_protos_label dict_keys([5, 0, 4, 6, 2, 1, 7, 8, 3, 9])
-------------------------------------------------- 66.06378412246704

-------------Round number: 62-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 8, 3: 0, 4: 39, 5: 0, 6: 3, 7: 108, 8: 16, 9: 575}
Prototype-Based Model Correct Classifications (per class):
{0: 116, 1: 8, 2: 4, 3: 0, 4: 40, 5: 0, 6: 2, 7: 112, 8: 16, 9: 572}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 272, 7: 5, 8: 501, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 270, 7: 8, 8: 484, 9: 101}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 101, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 148, 7: 132, 8: 50, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 103, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 146, 7: 132, 8: 50, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 250, 1: 0, 2: 46, 3: 11, 4: 0, 5: 11, 6: 4, 7: 14, 8: 3, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 235, 1: 0, 2: 41, 3: 12, 4: 0, 5: 7, 6: 3, 7: 13, 8: 3, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 76, 1: 2, 2: 182, 3: 19, 4: 0, 5: 0, 6: 25, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 184, 3: 22, 4: 0, 5: 0, 6: 22, 7: 2, 8: 325, 9: 477}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 32, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 43, 7: 0, 8: 19, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 39, 7: 0, 8: 20, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 13, 1: 0, 2: 29, 3: 0, 4: 0, 5: 0, 6: 225, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 20, 1: 0, 2: 46, 3: 0, 4: 1, 5: 0, 6: 185, 7: 0, 8: 0, 9: 11}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 31, 1: 68, 2: 354, 3: 113, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 31, 1: 65, 2: 355, 3: 119, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 220, 1: 290, 2: 224, 3: 0, 4: 156, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 225, 1: 289, 2: 197, 3: 0, 4: 166, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 63, 1: 140, 2: 0, 3: 1, 4: 4, 5: 0, 6: 0, 7: 0, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 59, 1: 137, 2: 1, 3: 1, 4: 7, 5: 0, 6: 0, 7: 2, 8: 700, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 120, 1: 131, 2: 2, 3: 17, 4: 10, 5: 254, 6: 216, 7: 103, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 124, 1: 129, 2: 2, 3: 18, 4: 11, 5: 252, 6: 202, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 1, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 239, 1: 0, 2: 56, 3: 65, 4: 0, 5: 60, 6: 0, 7: 286, 8: 0, 9: 94}
Prototype-Based Model Correct Classifications (per class):
{0: 228, 1: 0, 2: 59, 3: 70, 4: 0, 5: 59, 6: 1, 7: 285, 8: 0, 9: 96}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 28, 1: 141, 2: 237, 3: 2, 4: 54, 5: 79, 6: 0, 7: 21, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 25, 1: 139, 2: 231, 3: 4, 4: 53, 5: 82, 6: 1, 7: 20, 8: 12, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 148, 1: 122, 2: 128, 3: 0, 4: 12, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 147, 1: 120, 2: 131, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 97, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 98, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 345, 4: 51, 5: 0, 6: 240, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 347, 4: 55, 5: 0, 6: 227, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 101, 1: 70, 2: 182, 3: 187, 4: 27, 5: 5, 6: 74, 7: 439, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 104, 1: 68, 2: 179, 3: 188, 4: 29, 5: 11, 6: 53, 7: 437, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 114, 5: 50, 6: 23, 7: 35, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 13, 4: 102, 5: 50, 6: 28, 7: 37, 8: 47, 9: 270}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 19, 1: 27, 2: 1, 3: 87, 4: 2, 5: 0, 6: 176, 7: 43, 8: 21, 9: 2}
Prototype-Based Model Correct Classifications (per class):
{0: 23, 1: 27, 2: 2, 3: 91, 4: 4, 5: 0, 6: 151, 7: 43, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9445
Client 1: Regular Model Acc: 0.9623
Client 2: Regular Model Acc: 0.9067
Client 3: Regular Model Acc: 0.8877
Client 4: Regular Model Acc: 0.9449
Client 5: Regular Model Acc: 0.8951
Client 6: Regular Model Acc: 0.8134
Client 7: Regular Model Acc: 0.9526
Client 8: Regular Model Acc: 0.9408
Client 9: Regular Model Acc: 0.9818
Client 10: Regular Model Acc: 0.8794
Client 11: Regular Model Acc: 0.9926
Client 12: Regular Model Acc: 0.9379
Client 13: Regular Model Acc: 0.8686
Client 14: Regular Model Acc: 0.9651
Client 15: Regular Model Acc: 0.9894
Client 16: Regular Model Acc: 0.9532
Client 17: Regular Model Acc: 0.8952
Client 18: Regular Model Acc: 0.9045
Client 19: Regular Model Acc: 0.8552
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9285
Client 1: Prototype Model Acc: 0.9354
Client 2: Prototype Model Acc: 0.9052
Client 3: Prototype Model Acc: 0.8303
Client 4: Prototype Model Acc: 0.9398
Client 5: Prototype Model Acc: 0.8704
Client 6: Prototype Model Acc: 0.7668
Client 7: Prototype Model Acc: 0.9562
Client 8: Prototype Model Acc: 0.9271
Client 9: Prototype Model Acc: 0.9732
Client 10: Prototype Model Acc: 0.8670
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9355
Client 13: Prototype Model Acc: 0.8565
Client 14: Prototype Model Acc: 0.9620
Client 15: Prototype Model Acc: 0.9894
Client 16: Prototype Model Acc: 0.9480
Client 17: Prototype Model Acc: 0.8820
Client 18: Prototype Model Acc: 0.8983
Client 19: Prototype Model Acc: 0.8235
Averaged Test Accuracy (Regular Model): 0.9369
Averaged Test Accuracy (Prototype Model): 0.9269
Std Test Accuracy (Regular Model): 0.0470
Std Test Accuracy (Prototype Model): 0.0582
client.id trained 11
local_model_loss tensor(0.0131, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0244, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.0269, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0319, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0177, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.0836, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0329, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0271, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0293, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.1139, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.1610, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0126, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0130, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0222, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.1545, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0264, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.2818, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0151, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.0387, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.0264, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 467.48595571063925
only_train_time: 4102.096269862959
all_clients_time_cost: 4102.096269862959
agg_protos_label dict_keys([4, 1, 3, 2, 0, 8, 7, 6, 5, 9])
-------------------------------------------------- 64.78491044044495

-------------Round number: 63-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 8, 3: 0, 4: 39, 5: 0, 6: 3, 7: 108, 8: 16, 9: 575}
Prototype-Based Model Correct Classifications (per class):
{0: 115, 1: 8, 2: 4, 3: 0, 4: 40, 5: 0, 6: 2, 7: 112, 8: 16, 9: 572}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 272, 7: 5, 8: 501, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 270, 7: 8, 8: 484, 9: 101}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 101, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 148, 7: 132, 8: 50, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 104, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 145, 7: 132, 8: 50, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 258, 1: 0, 2: 43, 3: 11, 4: 0, 5: 11, 6: 4, 7: 14, 8: 3, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 244, 1: 0, 2: 44, 3: 12, 4: 0, 5: 7, 6: 4, 7: 13, 8: 4, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 76, 1: 2, 2: 182, 3: 19, 4: 0, 5: 0, 6: 25, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 184, 3: 22, 4: 0, 5: 0, 6: 22, 7: 2, 8: 325, 9: 477}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 21, 1: 0, 2: 0, 3: 9, 4: 0, 5: 5, 6: 49, 7: 0, 8: 20, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 24, 1: 0, 2: 1, 3: 10, 4: 0, 5: 5, 6: 44, 7: 0, 8: 20, 9: 178}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 7, 1: 0, 2: 27, 3: 0, 4: 0, 5: 0, 6: 229, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 13, 1: 0, 2: 49, 3: 0, 4: 1, 5: 0, 6: 169, 7: 0, 8: 0, 9: 11}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 31, 1: 68, 2: 354, 3: 113, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 31, 1: 65, 2: 355, 3: 119, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 220, 1: 289, 2: 227, 3: 0, 4: 155, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 226, 1: 289, 2: 199, 3: 0, 4: 166, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 63, 1: 140, 2: 0, 3: 1, 4: 5, 5: 0, 6: 0, 7: 1, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 58, 1: 137, 2: 1, 3: 1, 4: 7, 5: 0, 6: 0, 7: 2, 8: 699, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 119, 1: 131, 2: 2, 3: 17, 4: 10, 5: 254, 6: 216, 7: 102, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 123, 1: 129, 2: 3, 3: 18, 4: 12, 5: 253, 6: 204, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 1, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 239, 1: 0, 2: 56, 3: 65, 4: 0, 5: 60, 6: 0, 7: 286, 8: 0, 9: 94}
Prototype-Based Model Correct Classifications (per class):
{0: 228, 1: 0, 2: 59, 3: 70, 4: 0, 5: 59, 6: 1, 7: 285, 8: 0, 9: 96}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 27, 1: 140, 2: 241, 3: 2, 4: 52, 5: 81, 6: 0, 7: 20, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 136, 2: 239, 3: 4, 4: 51, 5: 83, 6: 2, 7: 19, 8: 13, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 147, 1: 122, 2: 128, 3: 0, 4: 11, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 147, 1: 120, 2: 130, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 97, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 98, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 345, 4: 51, 5: 0, 6: 239, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 347, 4: 56, 5: 0, 6: 227, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 103, 1: 70, 2: 183, 3: 188, 4: 26, 5: 5, 6: 70, 7: 439, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 105, 1: 69, 2: 180, 3: 189, 4: 29, 5: 11, 6: 48, 7: 437, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 117, 5: 50, 6: 19, 7: 35, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 13, 4: 106, 5: 50, 6: 25, 7: 37, 8: 47, 9: 270}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 19, 1: 27, 2: 1, 3: 87, 4: 2, 5: 0, 6: 176, 7: 43, 8: 21, 9: 2}
Prototype-Based Model Correct Classifications (per class):
{0: 23, 1: 27, 2: 2, 3: 90, 4: 3, 5: 0, 6: 155, 7: 40, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9445
Client 1: Regular Model Acc: 0.9623
Client 2: Regular Model Acc: 0.9067
Client 3: Regular Model Acc: 0.9008
Client 4: Regular Model Acc: 0.9449
Client 5: Regular Model Acc: 0.8796
Client 6: Regular Model Acc: 0.8017
Client 7: Regular Model Acc: 0.9526
Client 8: Regular Model Acc: 0.9419
Client 9: Regular Model Acc: 0.9839
Client 10: Regular Model Acc: 0.8773
Client 11: Regular Model Acc: 0.9926
Client 12: Regular Model Acc: 0.9379
Client 13: Regular Model Acc: 0.8701
Client 14: Regular Model Acc: 0.9630
Client 15: Regular Model Acc: 0.9894
Client 16: Regular Model Acc: 0.9523
Client 17: Regular Model Acc: 0.8944
Client 18: Regular Model Acc: 0.9030
Client 19: Regular Model Acc: 0.8552
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9274
Client 1: Prototype Model Acc: 0.9354
Client 2: Prototype Model Acc: 0.9052
Client 3: Prototype Model Acc: 0.8668
Client 4: Prototype Model Acc: 0.9398
Client 5: Prototype Model Acc: 0.8704
Client 6: Prototype Model Acc: 0.7085
Client 7: Prototype Model Acc: 0.9562
Client 8: Prototype Model Acc: 0.9302
Client 9: Prototype Model Acc: 0.9710
Client 10: Prototype Model Acc: 0.8711
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9355
Client 13: Prototype Model Acc: 0.8701
Client 14: Prototype Model Acc: 0.9610
Client 15: Prototype Model Acc: 0.9894
Client 16: Prototype Model Acc: 0.9488
Client 17: Prototype Model Acc: 0.8812
Client 18: Prototype Model Acc: 0.8998
Client 19: Prototype Model Acc: 0.8213
Averaged Test Accuracy (Regular Model): 0.9365
Averaged Test Accuracy (Prototype Model): 0.9273
Std Test Accuracy (Regular Model): 0.0487
Std Test Accuracy (Prototype Model): 0.0640
client.id trained 19
local_model_loss tensor(0.1073, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0216, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.0946, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0171, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0128, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0240, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.0363, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.1542, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.1372, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.0250, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.0762, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0121, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0257, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0312, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.0261, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0279, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0125, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0262, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0146, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0317, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 473.99649456865154
only_train_time: 4166.231090227724
all_clients_time_cost: 4166.231090227724
agg_protos_label dict_keys([8, 3, 6, 7, 1, 2, 0, 4, 9, 5])
Number of samples: 167
-------------------------------------------------- 67.13991165161133

-------------Round number: 64-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 8, 3: 0, 4: 38, 5: 0, 6: 3, 7: 108, 8: 16, 9: 575}
Prototype-Based Model Correct Classifications (per class):
{0: 115, 1: 8, 2: 4, 3: 0, 4: 40, 5: 0, 6: 2, 7: 112, 8: 16, 9: 572}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 272, 7: 5, 8: 501, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 270, 7: 8, 8: 484, 9: 101}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 101, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 148, 7: 132, 8: 50, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 104, 1: 1, 2: 0, 3: 0, 4: 0, 5: 178, 6: 145, 7: 132, 8: 50, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 247, 1: 0, 2: 45, 3: 11, 4: 0, 5: 11, 6: 5, 7: 14, 8: 3, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 228, 1: 0, 2: 42, 3: 12, 4: 0, 5: 7, 6: 4, 7: 13, 8: 4, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 76, 1: 2, 2: 182, 3: 19, 4: 0, 5: 0, 6: 25, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 184, 3: 22, 4: 0, 5: 0, 6: 22, 7: 2, 8: 325, 9: 477}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 28, 1: 0, 2: 0, 3: 9, 4: 0, 5: 5, 6: 48, 7: 0, 8: 20, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 28, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 42, 7: 0, 8: 20, 9: 178}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 18, 1: 0, 2: 41, 3: 0, 4: 0, 5: 0, 6: 202, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 21, 1: 0, 2: 50, 3: 0, 4: 1, 5: 0, 6: 147, 7: 0, 8: 0, 9: 11}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 31, 1: 68, 2: 355, 3: 114, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 31, 1: 65, 2: 355, 3: 120, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 221, 1: 290, 2: 226, 3: 0, 4: 156, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 225, 1: 289, 2: 198, 3: 0, 4: 166, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 63, 1: 140, 2: 0, 3: 1, 4: 5, 5: 0, 6: 0, 7: 1, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 59, 1: 137, 2: 1, 3: 1, 4: 7, 5: 0, 6: 0, 7: 2, 8: 699, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 119, 1: 131, 2: 3, 3: 18, 4: 11, 5: 254, 6: 216, 7: 102, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 123, 1: 129, 2: 3, 3: 18, 4: 12, 5: 253, 6: 202, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 1, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 239, 1: 0, 2: 57, 3: 65, 4: 0, 5: 60, 6: 0, 7: 286, 8: 0, 9: 94}
Prototype-Based Model Correct Classifications (per class):
{0: 228, 1: 0, 2: 59, 3: 70, 4: 0, 5: 59, 6: 1, 7: 285, 8: 0, 9: 96}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 28, 1: 140, 2: 240, 3: 2, 4: 52, 5: 81, 6: 1, 7: 20, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 136, 2: 237, 3: 4, 4: 52, 5: 83, 6: 2, 7: 19, 8: 15, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 147, 1: 122, 2: 128, 3: 0, 4: 11, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 147, 1: 120, 2: 131, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 97, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 98, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 347, 4: 51, 5: 0, 6: 239, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 347, 4: 55, 5: 0, 6: 226, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 98, 1: 70, 2: 181, 3: 186, 4: 27, 5: 5, 6: 78, 7: 439, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 104, 1: 69, 2: 178, 3: 185, 4: 29, 5: 11, 6: 53, 7: 437, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 113, 5: 50, 6: 25, 7: 35, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 13, 4: 102, 5: 50, 6: 28, 7: 37, 8: 47, 9: 270}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 19, 1: 27, 2: 1, 3: 88, 4: 2, 5: 0, 6: 175, 7: 43, 8: 21, 9: 2}
Prototype-Based Model Correct Classifications (per class):
{0: 23, 1: 27, 2: 2, 3: 90, 4: 3, 5: 0, 6: 154, 7: 40, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9434
Client 1: Regular Model Acc: 0.9623
Client 2: Regular Model Acc: 0.9067
Client 3: Regular Model Acc: 0.8799
Client 4: Regular Model Acc: 0.9449
Client 5: Regular Model Acc: 0.8981
Client 6: Regular Model Acc: 0.7959
Client 7: Regular Model Acc: 0.9544
Client 8: Regular Model Acc: 0.9440
Client 9: Regular Model Acc: 0.9839
Client 10: Regular Model Acc: 0.8804
Client 11: Regular Model Acc: 0.9926
Client 12: Regular Model Acc: 0.9390
Client 13: Regular Model Acc: 0.8716
Client 14: Regular Model Acc: 0.9630
Client 15: Regular Model Acc: 0.9894
Client 16: Regular Model Acc: 0.9540
Client 17: Regular Model Acc: 0.8944
Client 18: Regular Model Acc: 0.9061
Client 19: Regular Model Acc: 0.8552
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9274
Client 1: Prototype Model Acc: 0.9354
Client 2: Prototype Model Acc: 0.9067
Client 3: Prototype Model Acc: 0.8198
Client 4: Prototype Model Acc: 0.9398
Client 5: Prototype Model Acc: 0.8735
Client 6: Prototype Model Acc: 0.6706
Client 7: Prototype Model Acc: 0.9571
Client 8: Prototype Model Acc: 0.9281
Client 9: Prototype Model Acc: 0.9721
Client 10: Prototype Model Acc: 0.8691
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9355
Client 13: Prototype Model Acc: 0.8716
Client 14: Prototype Model Acc: 0.9620
Client 15: Prototype Model Acc: 0.9894
Client 16: Prototype Model Acc: 0.9471
Client 17: Prototype Model Acc: 0.8795
Client 18: Prototype Model Acc: 0.8983
Client 19: Prototype Model Acc: 0.8190
Averaged Test Accuracy (Regular Model): 0.9370
Averaged Test Accuracy (Prototype Model): 0.9253
Std Test Accuracy (Regular Model): 0.0493
Std Test Accuracy (Prototype Model): 0.0724
client.id trained 7
local_model_loss tensor(0.0265, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0207, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.1513, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0121, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.1404, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0253, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0166, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0141, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0118, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.0238, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.2367, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0250, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0124, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0304, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.0709, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0303, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.0351, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0235, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.0253, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.0865, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 480.62514436861966
only_train_time: 4229.349778507603
all_clients_time_cost: 4229.349778507603
agg_protos_label dict_keys([2, 5, 1, 0, 3, 4, 7, 6, 8, 9])
-------------------------------------------------- 64.80341649055481

-------------Round number: 65-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 8, 3: 0, 4: 38, 5: 0, 6: 3, 7: 108, 8: 16, 9: 575}
Prototype-Based Model Correct Classifications (per class):
{0: 115, 1: 8, 2: 4, 3: 0, 4: 40, 5: 0, 6: 2, 7: 112, 8: 16, 9: 572}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 272, 7: 5, 8: 501, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 270, 7: 8, 8: 484, 9: 101}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 101, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 148, 7: 132, 8: 50, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 104, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 145, 7: 133, 8: 50, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 254, 1: 0, 2: 45, 3: 11, 4: 0, 5: 11, 6: 7, 7: 14, 8: 3, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 240, 1: 0, 2: 45, 3: 12, 4: 0, 5: 7, 6: 3, 7: 13, 8: 3, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 76, 1: 2, 2: 182, 3: 19, 4: 0, 5: 0, 6: 25, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 184, 3: 22, 4: 0, 5: 0, 6: 22, 7: 2, 8: 325, 9: 477}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 24, 1: 0, 2: 0, 3: 9, 4: 0, 5: 5, 6: 48, 7: 0, 8: 20, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 27, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 43, 7: 0, 8: 20, 9: 178}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 16, 1: 0, 2: 40, 3: 0, 4: 0, 5: 0, 6: 212, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 18, 1: 0, 2: 49, 3: 0, 4: 1, 5: 0, 6: 157, 7: 0, 8: 0, 9: 11}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 31, 1: 68, 2: 355, 3: 114, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 30, 1: 65, 2: 354, 3: 120, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 221, 1: 289, 2: 227, 3: 0, 4: 155, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 226, 1: 289, 2: 199, 3: 0, 4: 165, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 63, 1: 140, 2: 0, 3: 1, 4: 5, 5: 0, 6: 0, 7: 1, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 59, 1: 137, 2: 1, 3: 1, 4: 7, 5: 0, 6: 0, 7: 2, 8: 699, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 119, 1: 131, 2: 3, 3: 18, 4: 11, 5: 254, 6: 216, 7: 102, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 123, 1: 129, 2: 3, 3: 18, 4: 12, 5: 253, 6: 203, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 1, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 239, 1: 0, 2: 57, 3: 65, 4: 0, 5: 60, 6: 0, 7: 286, 8: 0, 9: 94}
Prototype-Based Model Correct Classifications (per class):
{0: 228, 1: 0, 2: 59, 3: 70, 4: 0, 5: 59, 6: 1, 7: 285, 8: 0, 9: 96}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 28, 1: 140, 2: 240, 3: 2, 4: 53, 5: 81, 6: 1, 7: 20, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 28, 1: 136, 2: 233, 3: 4, 4: 52, 5: 83, 6: 2, 7: 20, 8: 15, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 147, 1: 122, 2: 129, 3: 0, 4: 11, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 147, 1: 120, 2: 131, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 97, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 98, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 347, 4: 51, 5: 0, 6: 239, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 347, 4: 55, 5: 0, 6: 227, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 101, 1: 70, 2: 181, 3: 187, 4: 26, 5: 5, 6: 73, 7: 439, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 104, 1: 69, 2: 180, 3: 188, 4: 29, 5: 11, 6: 53, 7: 437, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 117, 5: 50, 6: 20, 7: 35, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 13, 4: 103, 5: 50, 6: 25, 7: 37, 8: 47, 9: 270}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 16, 1: 27, 2: 0, 3: 88, 4: 2, 5: 0, 6: 180, 7: 43, 8: 21, 9: 2}
Prototype-Based Model Correct Classifications (per class):
{0: 20, 1: 27, 2: 2, 3: 92, 4: 2, 5: 0, 6: 158, 7: 40, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9434
Client 1: Regular Model Acc: 0.9623
Client 2: Regular Model Acc: 0.9067
Client 3: Regular Model Acc: 0.9034
Client 4: Regular Model Acc: 0.9449
Client 5: Regular Model Acc: 0.8858
Client 6: Regular Model Acc: 0.8163
Client 7: Regular Model Acc: 0.9544
Client 8: Regular Model Acc: 0.9429
Client 9: Regular Model Acc: 0.9839
Client 10: Regular Model Acc: 0.8804
Client 11: Regular Model Acc: 0.9926
Client 12: Regular Model Acc: 0.9390
Client 13: Regular Model Acc: 0.8731
Client 14: Regular Model Acc: 0.9641
Client 15: Regular Model Acc: 0.9894
Client 16: Regular Model Acc: 0.9540
Client 17: Regular Model Acc: 0.8927
Client 18: Regular Model Acc: 0.9045
Client 19: Regular Model Acc: 0.8575
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9274
Client 1: Prototype Model Acc: 0.9354
Client 2: Prototype Model Acc: 0.9067
Client 3: Prototype Model Acc: 0.8538
Client 4: Prototype Model Acc: 0.9398
Client 5: Prototype Model Acc: 0.8735
Client 6: Prototype Model Acc: 0.6880
Client 7: Prototype Model Acc: 0.9553
Client 8: Prototype Model Acc: 0.9292
Client 9: Prototype Model Acc: 0.9721
Client 10: Prototype Model Acc: 0.8701
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9355
Client 13: Prototype Model Acc: 0.8656
Client 14: Prototype Model Acc: 0.9620
Client 15: Prototype Model Acc: 0.9894
Client 16: Prototype Model Acc: 0.9480
Client 17: Prototype Model Acc: 0.8837
Client 18: Prototype Model Acc: 0.8951
Client 19: Prototype Model Acc: 0.8235
Averaged Test Accuracy (Regular Model): 0.9376
Averaged Test Accuracy (Prototype Model): 0.9265
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0677
client.id trained 6
local_model_loss tensor(0.0740, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.0337, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.0675, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0283, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0203, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.1394, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.0226, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.1309, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0231, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0246, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0117, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0297, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.1013, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0121, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0244, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0138, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.0246, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0161, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0113, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0253, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 487.13716366968583
only_train_time: 4293.6888505066745
all_clients_time_cost: 4293.6888505066745
agg_protos_label dict_keys([6, 2, 7, 0, 9, 1, 4, 5, 8, 3])
-------------------------------------------------- 66.1555905342102

-------------Round number: 66-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 8, 3: 0, 4: 38, 5: 0, 6: 3, 7: 108, 8: 16, 9: 575}
Prototype-Based Model Correct Classifications (per class):
{0: 115, 1: 8, 2: 4, 3: 0, 4: 40, 5: 0, 6: 2, 7: 112, 8: 16, 9: 572}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 272, 7: 5, 8: 501, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 270, 7: 8, 8: 484, 9: 101}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 102, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 148, 7: 132, 8: 50, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 104, 1: 1, 2: 0, 3: 0, 4: 0, 5: 178, 6: 145, 7: 133, 8: 50, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 255, 1: 0, 2: 44, 3: 11, 4: 0, 5: 11, 6: 5, 7: 14, 8: 3, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 240, 1: 0, 2: 44, 3: 12, 4: 0, 5: 7, 6: 3, 7: 13, 8: 4, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 76, 1: 2, 2: 183, 3: 19, 4: 0, 5: 0, 6: 25, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 184, 3: 22, 4: 0, 5: 0, 6: 22, 7: 2, 8: 325, 9: 477}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 30, 1: 0, 2: 0, 3: 9, 4: 0, 5: 5, 6: 48, 7: 0, 8: 20, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 41, 7: 0, 8: 20, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 13, 1: 0, 2: 38, 3: 0, 4: 0, 5: 0, 6: 217, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 18, 1: 0, 2: 50, 3: 0, 4: 1, 5: 0, 6: 170, 7: 0, 8: 0, 9: 11}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 31, 1: 68, 2: 355, 3: 114, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 30, 1: 65, 2: 355, 3: 120, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 221, 1: 290, 2: 225, 3: 0, 4: 156, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 226, 1: 289, 2: 199, 3: 0, 4: 166, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 63, 1: 140, 2: 0, 3: 1, 4: 5, 5: 0, 6: 0, 7: 1, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 59, 1: 137, 2: 1, 3: 1, 4: 7, 5: 0, 6: 0, 7: 2, 8: 700, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 120, 1: 131, 2: 3, 3: 18, 4: 11, 5: 254, 6: 216, 7: 101, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 123, 1: 129, 2: 3, 3: 18, 4: 13, 5: 253, 6: 204, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 1, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 240, 1: 0, 2: 57, 3: 66, 4: 0, 5: 60, 6: 0, 7: 286, 8: 0, 9: 94}
Prototype-Based Model Correct Classifications (per class):
{0: 228, 1: 0, 2: 59, 3: 70, 4: 0, 5: 59, 6: 1, 7: 285, 8: 0, 9: 96}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 28, 1: 140, 2: 240, 3: 2, 4: 50, 5: 81, 6: 1, 7: 20, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 136, 2: 237, 3: 4, 4: 52, 5: 83, 6: 2, 7: 19, 8: 15, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 147, 1: 122, 2: 130, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 147, 1: 120, 2: 132, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 97, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 98, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 347, 4: 51, 5: 0, 6: 239, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 347, 4: 55, 5: 0, 6: 227, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 102, 1: 70, 2: 183, 3: 189, 4: 27, 5: 5, 6: 71, 7: 439, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 103, 1: 69, 2: 181, 3: 189, 4: 30, 5: 11, 6: 49, 7: 437, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 115, 5: 50, 6: 23, 7: 35, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 13, 4: 102, 5: 50, 6: 28, 7: 37, 8: 46, 9: 270}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 19, 1: 27, 2: 1, 3: 87, 4: 2, 5: 0, 6: 176, 7: 43, 8: 21, 9: 2}
Prototype-Based Model Correct Classifications (per class):
{0: 23, 1: 27, 2: 2, 3: 90, 4: 3, 5: 0, 6: 153, 7: 40, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9434
Client 1: Regular Model Acc: 0.9623
Client 2: Regular Model Acc: 0.9082
Client 3: Regular Model Acc: 0.8982
Client 4: Regular Model Acc: 0.9457
Client 5: Regular Model Acc: 0.9043
Client 6: Regular Model Acc: 0.8163
Client 7: Regular Model Acc: 0.9544
Client 8: Regular Model Acc: 0.9429
Client 9: Regular Model Acc: 0.9839
Client 10: Regular Model Acc: 0.8804
Client 11: Regular Model Acc: 0.9926
Client 12: Regular Model Acc: 0.9414
Client 13: Regular Model Acc: 0.8686
Client 14: Regular Model Acc: 0.9630
Client 15: Regular Model Acc: 0.9894
Client 16: Regular Model Acc: 0.9540
Client 17: Regular Model Acc: 0.8960
Client 18: Regular Model Acc: 0.9061
Client 19: Regular Model Acc: 0.8552
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9274
Client 1: Prototype Model Acc: 0.9354
Client 2: Prototype Model Acc: 0.9082
Client 3: Prototype Model Acc: 0.8538
Client 4: Prototype Model Acc: 0.9398
Client 5: Prototype Model Acc: 0.8765
Client 6: Prototype Model Acc: 0.7289
Client 7: Prototype Model Acc: 0.9562
Client 8: Prototype Model Acc: 0.9302
Client 9: Prototype Model Acc: 0.9732
Client 10: Prototype Model Acc: 0.8722
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9355
Client 13: Prototype Model Acc: 0.8716
Client 14: Prototype Model Acc: 0.9630
Client 15: Prototype Model Acc: 0.9894
Client 16: Prototype Model Acc: 0.9480
Client 17: Prototype Model Acc: 0.8820
Client 18: Prototype Model Acc: 0.8967
Client 19: Prototype Model Acc: 0.8167
Averaged Test Accuracy (Regular Model): 0.9381
Averaged Test Accuracy (Prototype Model): 0.9277
Std Test Accuracy (Regular Model): 0.0461
Std Test Accuracy (Prototype Model): 0.0617
client.id trained 7
local_model_loss tensor(0.0242, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0238, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0275, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.1009, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.1437, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0290, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0194, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0118, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.1358, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.0216, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.0240, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0157, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0110, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0237, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0133, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0227, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.0704, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.0317, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0113, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.0733, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 493.79740657063667
only_train_time: 4357.652826240868
all_clients_time_cost: 4357.652826240868
agg_protos_label dict_keys([2, 5, 1, 0, 3, 4, 7, 9, 6, 8])
-------------------------------------------------- 65.5036952495575

-------------Round number: 67-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 8, 3: 0, 4: 38, 5: 0, 6: 3, 7: 108, 8: 16, 9: 575}
Prototype-Based Model Correct Classifications (per class):
{0: 115, 1: 8, 2: 4, 3: 0, 4: 40, 5: 0, 6: 2, 7: 112, 8: 16, 9: 572}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 272, 7: 5, 8: 501, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 270, 7: 8, 8: 484, 9: 101}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 102, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 148, 7: 132, 8: 50, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 104, 1: 1, 2: 0, 3: 0, 4: 0, 5: 178, 6: 145, 7: 133, 8: 50, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 257, 1: 0, 2: 43, 3: 11, 4: 0, 5: 11, 6: 5, 7: 14, 8: 3, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 245, 1: 0, 2: 44, 3: 12, 4: 0, 5: 7, 6: 4, 7: 13, 8: 4, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 76, 1: 2, 2: 183, 3: 19, 4: 0, 5: 0, 6: 25, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 184, 3: 22, 4: 0, 5: 0, 6: 22, 7: 2, 8: 325, 9: 477}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 43, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 35, 7: 0, 8: 18, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 36, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 32, 7: 0, 8: 19, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 16, 1: 0, 2: 38, 3: 0, 4: 0, 5: 0, 6: 214, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 18, 1: 0, 2: 50, 3: 0, 4: 1, 5: 0, 6: 171, 7: 0, 8: 0, 9: 11}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 31, 1: 68, 2: 355, 3: 114, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 30, 1: 65, 2: 355, 3: 120, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 221, 1: 289, 2: 227, 3: 0, 4: 156, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 226, 1: 289, 2: 199, 3: 0, 4: 165, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 63, 1: 140, 2: 0, 3: 1, 4: 5, 5: 0, 6: 0, 7: 2, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 59, 1: 137, 2: 1, 3: 1, 4: 7, 5: 0, 6: 0, 7: 2, 8: 700, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 120, 1: 130, 2: 3, 3: 18, 4: 11, 5: 254, 6: 216, 7: 101, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 123, 1: 129, 2: 3, 3: 18, 4: 13, 5: 253, 6: 204, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 1, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 241, 1: 0, 2: 57, 3: 66, 4: 0, 5: 60, 6: 0, 7: 286, 8: 0, 9: 94}
Prototype-Based Model Correct Classifications (per class):
{0: 228, 1: 0, 2: 59, 3: 70, 4: 0, 5: 59, 6: 1, 7: 285, 8: 0, 9: 96}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 28, 1: 140, 2: 249, 3: 2, 4: 40, 5: 81, 6: 0, 7: 20, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 136, 2: 240, 3: 4, 4: 43, 5: 83, 6: 2, 7: 19, 8: 14, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 147, 1: 122, 2: 130, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 147, 1: 120, 2: 131, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 97, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 98, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 347, 4: 51, 5: 0, 6: 239, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 347, 4: 55, 5: 0, 6: 227, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 101, 1: 70, 2: 180, 3: 187, 4: 26, 5: 5, 6: 76, 7: 439, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 102, 1: 69, 2: 181, 3: 189, 4: 29, 5: 11, 6: 52, 7: 437, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 116, 5: 50, 6: 23, 7: 35, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 13, 4: 103, 5: 50, 6: 28, 7: 37, 8: 46, 9: 270}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 20, 1: 27, 2: 1, 3: 89, 4: 2, 5: 0, 6: 174, 7: 43, 8: 21, 9: 2}
Prototype-Based Model Correct Classifications (per class):
{0: 23, 1: 27, 2: 2, 3: 91, 4: 3, 5: 0, 6: 152, 7: 40, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9434
Client 1: Regular Model Acc: 0.9623
Client 2: Regular Model Acc: 0.9082
Client 3: Regular Model Acc: 0.9008
Client 4: Regular Model Acc: 0.9457
Client 5: Regular Model Acc: 0.9012
Client 6: Regular Model Acc: 0.8163
Client 7: Regular Model Acc: 0.9544
Client 8: Regular Model Acc: 0.9440
Client 9: Regular Model Acc: 0.9850
Client 10: Regular Model Acc: 0.8794
Client 11: Regular Model Acc: 0.9926
Client 12: Regular Model Acc: 0.9426
Client 13: Regular Model Acc: 0.8656
Client 14: Regular Model Acc: 0.9630
Client 15: Regular Model Acc: 0.9894
Client 16: Regular Model Acc: 0.9540
Client 17: Regular Model Acc: 0.8944
Client 18: Regular Model Acc: 0.9077
Client 19: Regular Model Acc: 0.8575
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9274
Client 1: Prototype Model Acc: 0.9354
Client 2: Prototype Model Acc: 0.9082
Client 3: Prototype Model Acc: 0.8695
Client 4: Prototype Model Acc: 0.9398
Client 5: Prototype Model Acc: 0.8673
Client 6: Prototype Model Acc: 0.7318
Client 7: Prototype Model Acc: 0.9562
Client 8: Prototype Model Acc: 0.9292
Client 9: Prototype Model Acc: 0.9732
Client 10: Prototype Model Acc: 0.8722
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9355
Client 13: Prototype Model Acc: 0.8610
Client 14: Prototype Model Acc: 0.9620
Client 15: Prototype Model Acc: 0.9894
Client 16: Prototype Model Acc: 0.9480
Client 17: Prototype Model Acc: 0.8828
Client 18: Prototype Model Acc: 0.8983
Client 19: Prototype Model Acc: 0.8167
Averaged Test Accuracy (Regular Model): 0.9381
Averaged Test Accuracy (Prototype Model): 0.9276
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0612
client.id trained 12
local_model_loss tensor(0.0231, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.0302, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0109, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.0731, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0130, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0231, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0190, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0232, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.1298, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0262, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0153, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.1470, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0115, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0107, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.0654, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.0234, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0284, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0223, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.0207, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.1015, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 500.2117243545363
only_train_time: 4421.417099440703
all_clients_time_cost: 4421.417099440703
agg_protos_label dict_keys([0, 7, 5, 2, 3, 9, 6, 8, 4, 1])
Number of samples: 167
-------------------------------------------------- 66.56305742263794

-------------Round number: 68-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 8, 3: 0, 4: 37, 5: 0, 6: 3, 7: 108, 8: 16, 9: 575}
Prototype-Based Model Correct Classifications (per class):
{0: 115, 1: 8, 2: 4, 3: 0, 4: 40, 5: 0, 6: 2, 7: 112, 8: 16, 9: 572}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 272, 7: 5, 8: 501, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 270, 7: 8, 8: 484, 9: 101}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 103, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 148, 7: 132, 8: 50, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 104, 1: 1, 2: 0, 3: 0, 4: 0, 5: 178, 6: 145, 7: 133, 8: 50, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 243, 1: 0, 2: 45, 3: 11, 4: 0, 5: 11, 6: 6, 7: 14, 8: 3, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 230, 1: 0, 2: 44, 3: 12, 4: 0, 5: 7, 6: 4, 7: 13, 8: 4, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 76, 1: 2, 2: 183, 3: 19, 4: 0, 5: 0, 6: 25, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 184, 3: 22, 4: 0, 5: 0, 6: 22, 7: 2, 8: 325, 9: 477}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 35, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 39, 7: 0, 8: 19, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 30, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 37, 7: 0, 8: 20, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 13, 1: 0, 2: 38, 3: 0, 4: 0, 5: 0, 6: 217, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 16, 1: 0, 2: 50, 3: 0, 4: 0, 5: 0, 6: 180, 7: 0, 8: 0, 9: 11}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 31, 1: 68, 2: 355, 3: 114, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 30, 1: 65, 2: 355, 3: 120, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 221, 1: 290, 2: 226, 3: 0, 4: 156, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 225, 1: 289, 2: 199, 3: 0, 4: 166, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 63, 1: 140, 2: 0, 3: 1, 4: 5, 5: 0, 6: 0, 7: 2, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 59, 1: 137, 2: 1, 3: 1, 4: 7, 5: 0, 6: 0, 7: 2, 8: 700, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 119, 1: 130, 2: 3, 3: 18, 4: 12, 5: 254, 6: 217, 7: 101, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 123, 1: 129, 2: 3, 3: 18, 4: 13, 5: 253, 6: 206, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 1, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 240, 1: 0, 2: 57, 3: 66, 4: 0, 5: 60, 6: 1, 7: 286, 8: 0, 9: 94}
Prototype-Based Model Correct Classifications (per class):
{0: 228, 1: 0, 2: 59, 3: 70, 4: 0, 5: 59, 6: 1, 7: 285, 8: 0, 9: 96}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 28, 1: 140, 2: 237, 3: 2, 4: 57, 5: 81, 6: 2, 7: 20, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 136, 2: 230, 3: 5, 4: 53, 5: 83, 6: 2, 7: 19, 8: 15, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 147, 1: 122, 2: 130, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 147, 1: 120, 2: 132, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 97, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 98, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 347, 4: 51, 5: 0, 6: 239, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 347, 4: 55, 5: 0, 6: 227, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 99, 1: 70, 2: 180, 3: 186, 4: 26, 5: 5, 6: 76, 7: 439, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 102, 1: 69, 2: 181, 3: 189, 4: 29, 5: 11, 6: 53, 7: 437, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 115, 5: 50, 6: 24, 7: 35, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 13, 4: 102, 5: 50, 6: 28, 7: 37, 8: 46, 9: 270}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 21, 1: 27, 2: 1, 3: 88, 4: 2, 5: 0, 6: 174, 7: 43, 8: 21, 9: 2}
Prototype-Based Model Correct Classifications (per class):
{0: 23, 1: 27, 2: 2, 3: 90, 4: 3, 5: 0, 6: 150, 7: 40, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9424
Client 1: Regular Model Acc: 0.9623
Client 2: Regular Model Acc: 0.9096
Client 3: Regular Model Acc: 0.8721
Client 4: Regular Model Acc: 0.9457
Client 5: Regular Model Acc: 0.8920
Client 6: Regular Model Acc: 0.8163
Client 7: Regular Model Acc: 0.9544
Client 8: Regular Model Acc: 0.9440
Client 9: Regular Model Acc: 0.9850
Client 10: Regular Model Acc: 0.8804
Client 11: Regular Model Acc: 0.9926
Client 12: Regular Model Acc: 0.9426
Client 13: Regular Model Acc: 0.8761
Client 14: Regular Model Acc: 0.9630
Client 15: Regular Model Acc: 0.9894
Client 16: Regular Model Acc: 0.9540
Client 17: Regular Model Acc: 0.8919
Client 18: Regular Model Acc: 0.9077
Client 19: Regular Model Acc: 0.8575
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9274
Client 1: Prototype Model Acc: 0.9354
Client 2: Prototype Model Acc: 0.9082
Client 3: Prototype Model Acc: 0.8303
Client 4: Prototype Model Acc: 0.9398
Client 5: Prototype Model Acc: 0.8673
Client 6: Prototype Model Acc: 0.7493
Client 7: Prototype Model Acc: 0.9562
Client 8: Prototype Model Acc: 0.9292
Client 9: Prototype Model Acc: 0.9732
Client 10: Prototype Model Acc: 0.8742
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9355
Client 13: Prototype Model Acc: 0.8640
Client 14: Prototype Model Acc: 0.9630
Client 15: Prototype Model Acc: 0.9894
Client 16: Prototype Model Acc: 0.9480
Client 17: Prototype Model Acc: 0.8837
Client 18: Prototype Model Acc: 0.8967
Client 19: Prototype Model Acc: 0.8100
Averaged Test Accuracy (Regular Model): 0.9376
Averaged Test Accuracy (Prototype Model): 0.9272
Std Test Accuracy (Regular Model): 0.0472
Std Test Accuracy (Prototype Model): 0.0611
client.id trained 5
local_model_loss tensor(0.1405, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.0292, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.1346, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.0198, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0224, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0106, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.0941, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0149, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0255, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0223, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0183, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0103, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.0229, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0278, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0225, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.0628, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.0631, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0220, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0127, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0112, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 506.88674025353976
only_train_time: 4485.0957647194155
all_clients_time_cost: 4485.0957647194155
agg_protos_label dict_keys([9, 0, 6, 5, 8, 3, 1, 2, 7, 4])
-------------------------------------------------- 65.34215378761292

-------------Round number: 69-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 8, 3: 0, 4: 37, 5: 0, 6: 3, 7: 109, 8: 16, 9: 575}
Prototype-Based Model Correct Classifications (per class):
{0: 115, 1: 8, 2: 4, 3: 0, 4: 40, 5: 0, 6: 2, 7: 112, 8: 16, 9: 572}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 272, 7: 5, 8: 501, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 270, 7: 8, 8: 484, 9: 101}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 103, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 148, 7: 132, 8: 50, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 104, 1: 1, 2: 0, 3: 0, 4: 0, 5: 178, 6: 145, 7: 133, 8: 50, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 255, 1: 0, 2: 44, 3: 11, 4: 0, 5: 11, 6: 5, 7: 14, 8: 3, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 242, 1: 0, 2: 44, 3: 12, 4: 0, 5: 7, 6: 4, 7: 13, 8: 4, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 76, 1: 2, 2: 184, 3: 19, 4: 0, 5: 0, 6: 25, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 184, 3: 22, 4: 0, 5: 0, 6: 22, 7: 2, 8: 325, 9: 477}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 42, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 37, 7: 0, 8: 19, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 33, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 36, 7: 0, 8: 20, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 11, 1: 0, 2: 37, 3: 0, 4: 0, 5: 0, 6: 219, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 14, 1: 0, 2: 49, 3: 0, 4: 0, 5: 0, 6: 187, 7: 0, 8: 0, 9: 11}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 31, 1: 68, 2: 355, 3: 114, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 30, 1: 65, 2: 353, 3: 119, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 221, 1: 289, 2: 227, 3: 0, 4: 156, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 225, 1: 289, 2: 199, 3: 0, 4: 165, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 63, 1: 140, 2: 0, 3: 1, 4: 5, 5: 0, 6: 0, 7: 2, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 59, 1: 137, 2: 1, 3: 1, 4: 7, 5: 0, 6: 0, 7: 2, 8: 700, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 119, 1: 130, 2: 3, 3: 18, 4: 12, 5: 254, 6: 217, 7: 101, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 123, 1: 129, 2: 3, 3: 18, 4: 13, 5: 253, 6: 205, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 1, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 241, 1: 0, 2: 57, 3: 66, 4: 0, 5: 60, 6: 1, 7: 286, 8: 0, 9: 94}
Prototype-Based Model Correct Classifications (per class):
{0: 228, 1: 0, 2: 59, 3: 70, 4: 0, 5: 59, 6: 1, 7: 285, 8: 0, 9: 96}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 28, 1: 140, 2: 240, 3: 2, 4: 55, 5: 81, 6: 2, 7: 20, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 136, 2: 231, 3: 5, 4: 54, 5: 83, 6: 2, 7: 20, 8: 15, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 147, 1: 122, 2: 130, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 147, 1: 120, 2: 132, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 97, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 98, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 347, 4: 51, 5: 0, 6: 239, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 347, 4: 55, 5: 0, 6: 226, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 102, 1: 70, 2: 182, 3: 188, 4: 27, 5: 5, 6: 72, 7: 439, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 103, 1: 69, 2: 181, 3: 189, 4: 30, 5: 11, 6: 52, 7: 437, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 116, 5: 50, 6: 23, 7: 35, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 13, 4: 102, 5: 50, 6: 28, 7: 37, 8: 46, 9: 270}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 19, 1: 27, 2: 1, 3: 84, 4: 2, 5: 0, 6: 179, 7: 43, 8: 21, 9: 2}
Prototype-Based Model Correct Classifications (per class):
{0: 22, 1: 27, 2: 2, 3: 88, 4: 2, 5: 0, 6: 165, 7: 40, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9434
Client 1: Regular Model Acc: 0.9623
Client 2: Regular Model Acc: 0.9096
Client 3: Regular Model Acc: 0.8982
Client 4: Regular Model Acc: 0.9466
Client 5: Regular Model Acc: 0.9074
Client 6: Regular Model Acc: 0.8134
Client 7: Regular Model Acc: 0.9544
Client 8: Regular Model Acc: 0.9440
Client 9: Regular Model Acc: 0.9850
Client 10: Regular Model Acc: 0.8804
Client 11: Regular Model Acc: 0.9926
Client 12: Regular Model Acc: 0.9437
Client 13: Regular Model Acc: 0.8776
Client 14: Regular Model Acc: 0.9630
Client 15: Regular Model Acc: 0.9894
Client 16: Regular Model Acc: 0.9540
Client 17: Regular Model Acc: 0.8952
Client 18: Regular Model Acc: 0.9077
Client 19: Regular Model Acc: 0.8552
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9274
Client 1: Prototype Model Acc: 0.9354
Client 2: Prototype Model Acc: 0.9082
Client 3: Prototype Model Acc: 0.8616
Client 4: Prototype Model Acc: 0.9398
Client 5: Prototype Model Acc: 0.8735
Client 6: Prototype Model Acc: 0.7609
Client 7: Prototype Model Acc: 0.9535
Client 8: Prototype Model Acc: 0.9281
Client 9: Prototype Model Acc: 0.9732
Client 10: Prototype Model Acc: 0.8732
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9355
Client 13: Prototype Model Acc: 0.8686
Client 14: Prototype Model Acc: 0.9630
Client 15: Prototype Model Acc: 0.9894
Client 16: Prototype Model Acc: 0.9471
Client 17: Prototype Model Acc: 0.8845
Client 18: Prototype Model Acc: 0.8967
Client 19: Prototype Model Acc: 0.8348
Averaged Test Accuracy (Regular Model): 0.9388
Averaged Test Accuracy (Prototype Model): 0.9287
Std Test Accuracy (Regular Model): 0.0460
Std Test Accuracy (Prototype Model): 0.0554
client.id trained 6
local_model_loss tensor(0.0590, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.0969, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.0223, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0110, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0123, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0214, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.0583, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0220, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0100, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0102, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0179, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.1228, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0216, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.0279, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0245, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.1222, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.0189, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0145, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0272, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0218, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 513.7682349235984
only_train_time: 4550.441457235487
all_clients_time_cost: 4550.441457235487
agg_protos_label dict_keys([6, 2, 7, 0, 9, 1, 4, 5, 8, 3])
-------------------------------------------------- 67.08650922775269

-------------Round number: 70-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 8, 3: 0, 4: 37, 5: 0, 6: 3, 7: 109, 8: 16, 9: 575}
Prototype-Based Model Correct Classifications (per class):
{0: 115, 1: 8, 2: 4, 3: 0, 4: 40, 5: 0, 6: 2, 7: 112, 8: 16, 9: 572}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 272, 7: 5, 8: 501, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 270, 7: 8, 8: 487, 9: 101}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 104, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 148, 7: 132, 8: 50, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 104, 1: 1, 2: 0, 3: 0, 4: 0, 5: 178, 6: 145, 7: 133, 8: 50, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 254, 1: 0, 2: 45, 3: 11, 4: 0, 5: 11, 6: 5, 7: 14, 8: 3, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 240, 1: 0, 2: 44, 3: 12, 4: 0, 5: 7, 6: 4, 7: 13, 8: 4, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 76, 1: 2, 2: 184, 3: 19, 4: 0, 5: 0, 6: 25, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 185, 3: 22, 4: 0, 5: 0, 6: 22, 7: 2, 8: 325, 9: 477}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 33, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 41, 7: 0, 8: 19, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 39, 7: 0, 8: 20, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 15, 1: 0, 2: 38, 3: 0, 4: 0, 5: 0, 6: 214, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 18, 1: 0, 2: 49, 3: 0, 4: 1, 5: 0, 6: 177, 7: 0, 8: 0, 9: 11}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 31, 1: 68, 2: 355, 3: 114, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 30, 1: 65, 2: 354, 3: 119, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 221, 1: 290, 2: 225, 3: 0, 4: 156, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 224, 1: 289, 2: 199, 3: 0, 4: 166, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 63, 1: 140, 2: 0, 3: 1, 4: 5, 5: 0, 6: 0, 7: 2, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 59, 1: 137, 2: 1, 3: 1, 4: 7, 5: 0, 6: 0, 7: 2, 8: 700, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 120, 1: 130, 2: 3, 3: 18, 4: 12, 5: 254, 6: 217, 7: 101, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 123, 1: 129, 2: 3, 3: 18, 4: 13, 5: 253, 6: 205, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 1, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 240, 1: 0, 2: 57, 3: 66, 4: 0, 5: 60, 6: 1, 7: 286, 8: 0, 9: 94}
Prototype-Based Model Correct Classifications (per class):
{0: 228, 1: 0, 2: 59, 3: 70, 4: 0, 5: 59, 6: 1, 7: 285, 8: 0, 9: 97}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 28, 1: 140, 2: 240, 3: 2, 4: 53, 5: 81, 6: 2, 7: 20, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 136, 2: 233, 3: 5, 4: 53, 5: 83, 6: 2, 7: 20, 8: 15, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 147, 1: 122, 2: 130, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 147, 1: 120, 2: 132, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 97, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 98, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 347, 4: 52, 5: 0, 6: 239, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 347, 4: 55, 5: 0, 6: 226, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 102, 1: 70, 2: 182, 3: 188, 4: 27, 5: 5, 6: 73, 7: 439, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 103, 1: 69, 2: 181, 3: 189, 4: 30, 5: 11, 6: 52, 7: 437, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 115, 5: 50, 6: 24, 7: 35, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 13, 4: 102, 5: 50, 6: 28, 7: 37, 8: 47, 9: 270}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 21, 1: 27, 2: 1, 3: 89, 4: 2, 5: 0, 6: 170, 7: 43, 8: 21, 9: 2}
Prototype-Based Model Correct Classifications (per class):
{0: 23, 1: 27, 2: 2, 3: 91, 4: 3, 5: 0, 6: 150, 7: 40, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9434
Client 1: Regular Model Acc: 0.9623
Client 2: Regular Model Acc: 0.9111
Client 3: Regular Model Acc: 0.8982
Client 4: Regular Model Acc: 0.9466
Client 5: Regular Model Acc: 0.8920
Client 6: Regular Model Acc: 0.8134
Client 7: Regular Model Acc: 0.9544
Client 8: Regular Model Acc: 0.9429
Client 9: Regular Model Acc: 0.9850
Client 10: Regular Model Acc: 0.8814
Client 11: Regular Model Acc: 0.9926
Client 12: Regular Model Acc: 0.9426
Client 13: Regular Model Acc: 0.8746
Client 14: Regular Model Acc: 0.9630
Client 15: Regular Model Acc: 0.9894
Client 16: Regular Model Acc: 0.9549
Client 17: Regular Model Acc: 0.8960
Client 18: Regular Model Acc: 0.9077
Client 19: Regular Model Acc: 0.8507
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9274
Client 1: Prototype Model Acc: 0.9386
Client 2: Prototype Model Acc: 0.9082
Client 3: Prototype Model Acc: 0.8564
Client 4: Prototype Model Acc: 0.9406
Client 5: Prototype Model Acc: 0.8704
Client 6: Prototype Model Acc: 0.7464
Client 7: Prototype Model Acc: 0.9544
Client 8: Prototype Model Acc: 0.9281
Client 9: Prototype Model Acc: 0.9732
Client 10: Prototype Model Acc: 0.8732
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9367
Client 13: Prototype Model Acc: 0.8701
Client 14: Prototype Model Acc: 0.9630
Client 15: Prototype Model Acc: 0.9894
Client 16: Prototype Model Acc: 0.9471
Client 17: Prototype Model Acc: 0.8845
Client 18: Prototype Model Acc: 0.8983
Client 19: Prototype Model Acc: 0.8122
Averaged Test Accuracy (Regular Model): 0.9384
Averaged Test Accuracy (Prototype Model): 0.9281
Std Test Accuracy (Regular Model): 0.0468
Std Test Accuracy (Prototype Model): 0.0595
client.id trained 2
local_model_loss tensor(0.0218, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.0181, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.0554, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.0268, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0099, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0120, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0239, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.1385, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0098, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0215, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.0864, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.2286, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0141, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0173, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0212, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0107, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0265, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0206, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.1175, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0213, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 520.2756010936573
only_train_time: 4614.550208595581
all_clients_time_cost: 4614.550208595581
agg_protos_label dict_keys([7, 5, 4, 6, 9, 8, 0, 1, 2, 3])
-------------------------------------------------- 65.83621072769165

-------------Round number: 71-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 8, 3: 0, 4: 37, 5: 0, 6: 3, 7: 109, 8: 16, 9: 575}
Prototype-Based Model Correct Classifications (per class):
{0: 115, 1: 8, 2: 4, 3: 0, 4: 40, 5: 0, 6: 2, 7: 112, 8: 16, 9: 572}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 271, 7: 5, 8: 501, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 270, 7: 8, 8: 486, 9: 101}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 104, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 148, 7: 132, 8: 50, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 105, 1: 1, 2: 0, 3: 0, 4: 0, 5: 178, 6: 145, 7: 134, 8: 50, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 262, 1: 0, 2: 38, 3: 9, 4: 0, 5: 11, 6: 3, 7: 14, 8: 2, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 253, 1: 0, 2: 41, 3: 12, 4: 0, 5: 7, 6: 5, 7: 13, 8: 4, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 76, 1: 2, 2: 184, 3: 19, 4: 0, 5: 0, 6: 25, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 185, 3: 22, 4: 0, 5: 0, 6: 21, 7: 2, 8: 325, 9: 477}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 26, 1: 0, 2: 0, 3: 9, 4: 0, 5: 5, 6: 48, 7: 0, 8: 20, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 30, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 45, 7: 0, 8: 20, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 18, 1: 0, 2: 48, 3: 0, 4: 0, 5: 0, 6: 190, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 18, 1: 0, 2: 54, 3: 0, 4: 2, 5: 0, 6: 108, 7: 0, 8: 0, 9: 11}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 31, 1: 68, 2: 354, 3: 115, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 30, 1: 65, 2: 353, 3: 119, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 221, 1: 290, 2: 227, 3: 0, 4: 156, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 225, 1: 289, 2: 199, 3: 0, 4: 165, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 63, 1: 140, 2: 0, 3: 1, 4: 5, 5: 0, 6: 0, 7: 2, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 58, 1: 137, 2: 1, 3: 1, 4: 7, 5: 0, 6: 0, 7: 2, 8: 700, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 120, 1: 130, 2: 3, 3: 18, 4: 12, 5: 254, 6: 216, 7: 101, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 123, 1: 129, 2: 3, 3: 18, 4: 13, 5: 253, 6: 204, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 1, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 241, 1: 0, 2: 57, 3: 66, 4: 0, 5: 60, 6: 1, 7: 286, 8: 0, 9: 94}
Prototype-Based Model Correct Classifications (per class):
{0: 229, 1: 0, 2: 59, 3: 70, 4: 0, 5: 59, 6: 1, 7: 285, 8: 0, 9: 97}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 28, 1: 140, 2: 240, 3: 2, 4: 53, 5: 81, 6: 2, 7: 20, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 136, 2: 236, 3: 5, 4: 53, 5: 83, 6: 2, 7: 20, 8: 15, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 147, 1: 122, 2: 130, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 147, 1: 120, 2: 131, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 97, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 98, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 347, 4: 53, 5: 0, 6: 239, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 347, 4: 55, 5: 0, 6: 226, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 101, 1: 70, 2: 181, 3: 187, 4: 27, 5: 5, 6: 77, 7: 439, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 103, 1: 69, 2: 181, 3: 189, 4: 30, 5: 11, 6: 51, 7: 437, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 115, 5: 50, 6: 24, 7: 35, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 13, 4: 102, 5: 50, 6: 28, 7: 37, 8: 47, 9: 270}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 19, 1: 27, 2: 1, 3: 85, 4: 2, 5: 0, 6: 177, 7: 43, 8: 21, 9: 2}
Prototype-Based Model Correct Classifications (per class):
{0: 23, 1: 27, 2: 2, 3: 89, 4: 3, 5: 0, 6: 159, 7: 40, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9434
Client 1: Regular Model Acc: 0.9612
Client 2: Regular Model Acc: 0.9111
Client 3: Regular Model Acc: 0.8877
Client 4: Regular Model Acc: 0.9466
Client 5: Regular Model Acc: 0.8920
Client 6: Regular Model Acc: 0.7813
Client 7: Regular Model Acc: 0.9544
Client 8: Regular Model Acc: 0.9450
Client 9: Regular Model Acc: 0.9850
Client 10: Regular Model Acc: 0.8804
Client 11: Regular Model Acc: 0.9926
Client 12: Regular Model Acc: 0.9437
Client 13: Regular Model Acc: 0.8746
Client 14: Regular Model Acc: 0.9630
Client 15: Regular Model Acc: 0.9894
Client 16: Regular Model Acc: 0.9558
Client 17: Regular Model Acc: 0.8969
Client 18: Regular Model Acc: 0.9077
Client 19: Regular Model Acc: 0.8529
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9274
Client 1: Prototype Model Acc: 0.9376
Client 2: Prototype Model Acc: 0.9111
Client 3: Prototype Model Acc: 0.8851
Client 4: Prototype Model Acc: 0.9398
Client 5: Prototype Model Acc: 0.8920
Client 6: Prototype Model Acc: 0.5627
Client 7: Prototype Model Acc: 0.9535
Client 8: Prototype Model Acc: 0.9281
Client 9: Prototype Model Acc: 0.9721
Client 10: Prototype Model Acc: 0.8722
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9379
Client 13: Prototype Model Acc: 0.8746
Client 14: Prototype Model Acc: 0.9620
Client 15: Prototype Model Acc: 0.9894
Client 16: Prototype Model Acc: 0.9471
Client 17: Prototype Model Acc: 0.8837
Client 18: Prototype Model Acc: 0.8983
Client 19: Prototype Model Acc: 0.8281
Averaged Test Accuracy (Regular Model): 0.9377
Averaged Test Accuracy (Prototype Model): 0.9259
Std Test Accuracy (Regular Model): 0.0512
Std Test Accuracy (Prototype Model): 0.0887
client.id trained 8
local_model_loss tensor(0.0169, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0105, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0206, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.0530, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0138, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0209, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0259, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.1185, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.0213, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0096, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.0888, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0095, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.1310, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.0259, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0117, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0199, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.0174, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.1174, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0230, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0209, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 526.8161611356772
only_train_time: 4677.977184973541
all_clients_time_cost: 4677.977184973541
agg_protos_label dict_keys([0, 1, 2, 4, 3, 7, 5, 9, 6, 8])
Number of samples: 167
-------------------------------------------------- 66.24157428741455

-------------Round number: 72-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 8, 3: 0, 4: 37, 5: 0, 6: 4, 7: 109, 8: 16, 9: 575}
Prototype-Based Model Correct Classifications (per class):
{0: 115, 1: 8, 2: 4, 3: 0, 4: 40, 5: 0, 6: 2, 7: 112, 8: 16, 9: 572}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 271, 7: 5, 8: 501, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 270, 7: 8, 8: 487, 9: 103}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 104, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 147, 7: 132, 8: 50, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 104, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 145, 7: 134, 8: 50, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 252, 1: 0, 2: 45, 3: 11, 4: 0, 5: 11, 6: 7, 7: 14, 8: 3, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 240, 1: 0, 2: 45, 3: 12, 4: 0, 5: 7, 6: 3, 7: 13, 8: 4, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 76, 1: 2, 2: 184, 3: 19, 4: 0, 5: 0, 6: 25, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 185, 3: 22, 4: 0, 5: 0, 6: 22, 7: 2, 8: 325, 9: 477}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 29, 1: 0, 2: 0, 3: 9, 4: 0, 5: 5, 6: 48, 7: 0, 8: 20, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 44, 7: 0, 8: 20, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 11, 1: 0, 2: 35, 3: 0, 4: 0, 5: 0, 6: 220, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 15, 1: 0, 2: 50, 3: 0, 4: 0, 5: 0, 6: 177, 7: 0, 8: 0, 9: 11}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 31, 1: 68, 2: 354, 3: 116, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 30, 1: 65, 2: 354, 3: 119, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 221, 1: 290, 2: 227, 3: 0, 4: 156, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 224, 1: 289, 2: 199, 3: 0, 4: 166, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 63, 1: 140, 2: 0, 3: 1, 4: 5, 5: 0, 6: 0, 7: 2, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 58, 1: 137, 2: 1, 3: 1, 4: 7, 5: 0, 6: 0, 7: 2, 8: 700, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 120, 1: 130, 2: 3, 3: 18, 4: 12, 5: 254, 6: 216, 7: 101, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 122, 1: 129, 2: 3, 3: 18, 4: 13, 5: 253, 6: 206, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 1, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 241, 1: 0, 2: 57, 3: 66, 4: 0, 5: 60, 6: 1, 7: 286, 8: 0, 9: 94}
Prototype-Based Model Correct Classifications (per class):
{0: 229, 1: 0, 2: 59, 3: 70, 4: 0, 5: 59, 6: 1, 7: 285, 8: 0, 9: 97}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 28, 1: 140, 2: 240, 3: 2, 4: 52, 5: 81, 6: 2, 7: 20, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 136, 2: 236, 3: 5, 4: 53, 5: 83, 6: 2, 7: 20, 8: 15, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 147, 1: 122, 2: 130, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 147, 1: 120, 2: 131, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 97, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 98, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 347, 4: 53, 5: 0, 6: 239, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 347, 4: 55, 5: 0, 6: 226, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 102, 1: 70, 2: 182, 3: 188, 4: 27, 5: 5, 6: 73, 7: 439, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 103, 1: 69, 2: 181, 3: 189, 4: 29, 5: 11, 6: 52, 7: 438, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 115, 5: 50, 6: 25, 7: 35, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 13, 4: 102, 5: 50, 6: 28, 7: 37, 8: 47, 9: 270}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 18, 1: 27, 2: 1, 3: 90, 4: 2, 5: 0, 6: 179, 7: 43, 8: 21, 9: 2}
Prototype-Based Model Correct Classifications (per class):
{0: 23, 1: 27, 2: 2, 3: 92, 4: 2, 5: 0, 6: 162, 7: 40, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9445
Client 1: Regular Model Acc: 0.9612
Client 2: Regular Model Acc: 0.9096
Client 3: Regular Model Acc: 0.8982
Client 4: Regular Model Acc: 0.9466
Client 5: Regular Model Acc: 0.9012
Client 6: Regular Model Acc: 0.8105
Client 7: Regular Model Acc: 0.9553
Client 8: Regular Model Acc: 0.9450
Client 9: Regular Model Acc: 0.9850
Client 10: Regular Model Acc: 0.8804
Client 11: Regular Model Acc: 0.9926
Client 12: Regular Model Acc: 0.9437
Client 13: Regular Model Acc: 0.8731
Client 14: Regular Model Acc: 0.9630
Client 15: Regular Model Acc: 0.9894
Client 16: Regular Model Acc: 0.9558
Client 17: Regular Model Acc: 0.8960
Client 18: Regular Model Acc: 0.9092
Client 19: Regular Model Acc: 0.8665
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9274
Client 1: Prototype Model Acc: 0.9408
Client 2: Prototype Model Acc: 0.9082
Client 3: Prototype Model Acc: 0.8564
Client 4: Prototype Model Acc: 0.9406
Client 5: Prototype Model Acc: 0.8858
Client 6: Prototype Model Acc: 0.7376
Client 7: Prototype Model Acc: 0.9544
Client 8: Prototype Model Acc: 0.9281
Client 9: Prototype Model Acc: 0.9721
Client 10: Prototype Model Acc: 0.8732
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9379
Client 13: Prototype Model Acc: 0.8746
Client 14: Prototype Model Acc: 0.9620
Client 15: Prototype Model Acc: 0.9894
Client 16: Prototype Model Acc: 0.9471
Client 17: Prototype Model Acc: 0.8845
Client 18: Prototype Model Acc: 0.8983
Client 19: Prototype Model Acc: 0.8394
Averaged Test Accuracy (Regular Model): 0.9391
Averaged Test Accuracy (Prototype Model): 0.9292
Std Test Accuracy (Regular Model): 0.0460
Std Test Accuracy (Prototype Model): 0.0582
client.id trained 9
local_model_loss tensor(0.0206, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.0249, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.0771, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0192, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.1288, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.1130, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0093, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0135, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0103, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0164, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0254, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0225, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0201, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0115, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.0508, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0205, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.0168, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.0209, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0093, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.1220, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 533.4469014677452
only_train_time: 4743.466033371398
all_clients_time_cost: 4743.466033371398
agg_protos_label dict_keys([1, 8, 7, 2, 4, 0, 6, 3, 5, 9])
-------------------------------------------------- 67.22223424911499

-------------Round number: 73-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 8, 3: 0, 4: 37, 5: 0, 6: 4, 7: 109, 8: 16, 9: 575}
Prototype-Based Model Correct Classifications (per class):
{0: 115, 1: 8, 2: 4, 3: 0, 4: 40, 5: 0, 6: 2, 7: 112, 8: 16, 9: 572}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 271, 7: 5, 8: 501, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 270, 7: 8, 8: 487, 9: 103}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 104, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 147, 7: 132, 8: 50, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 105, 1: 1, 2: 0, 3: 0, 4: 0, 5: 178, 6: 145, 7: 134, 8: 50, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 261, 1: 0, 2: 42, 3: 11, 4: 0, 5: 11, 6: 3, 7: 14, 8: 3, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 248, 1: 0, 2: 43, 3: 12, 4: 0, 5: 7, 6: 3, 7: 13, 8: 4, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 76, 1: 2, 2: 184, 3: 19, 4: 0, 5: 0, 6: 25, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 185, 3: 22, 4: 0, 5: 0, 6: 22, 7: 2, 8: 325, 9: 477}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 23, 1: 0, 2: 0, 3: 9, 4: 0, 5: 5, 6: 48, 7: 0, 8: 20, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 27, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 45, 7: 0, 8: 20, 9: 178}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 2, 1: 0, 2: 36, 3: 0, 4: 0, 5: 0, 6: 228, 7: 0, 8: 0, 9: 11}
Prototype-Based Model Correct Classifications (per class):
{0: 4, 1: 0, 2: 47, 3: 0, 4: 0, 5: 0, 6: 210, 7: 0, 8: 0, 9: 11}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 31, 1: 68, 2: 354, 3: 116, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 30, 1: 65, 2: 354, 3: 119, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 221, 1: 290, 2: 227, 3: 0, 4: 156, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 224, 1: 289, 2: 199, 3: 0, 4: 165, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 63, 1: 140, 2: 0, 3: 1, 4: 5, 5: 0, 6: 0, 7: 2, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 58, 1: 137, 2: 1, 3: 1, 4: 7, 5: 0, 6: 0, 7: 2, 8: 700, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 121, 1: 130, 2: 3, 3: 18, 4: 12, 5: 254, 6: 216, 7: 101, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 122, 1: 129, 2: 3, 3: 18, 4: 13, 5: 253, 6: 207, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 1, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 241, 1: 0, 2: 57, 3: 66, 4: 0, 5: 60, 6: 1, 7: 286, 8: 0, 9: 94}
Prototype-Based Model Correct Classifications (per class):
{0: 229, 1: 0, 2: 59, 3: 70, 4: 0, 5: 59, 6: 1, 7: 285, 8: 0, 9: 97}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 28, 1: 140, 2: 240, 3: 2, 4: 52, 5: 81, 6: 2, 7: 20, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 136, 2: 236, 3: 5, 4: 53, 5: 83, 6: 2, 7: 20, 8: 15, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 147, 1: 122, 2: 130, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 147, 1: 120, 2: 131, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 97, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 98, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 347, 4: 53, 5: 0, 6: 238, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 347, 4: 55, 5: 0, 6: 226, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 102, 1: 70, 2: 183, 3: 189, 4: 27, 5: 5, 6: 73, 7: 439, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 103, 1: 69, 2: 183, 3: 189, 4: 30, 5: 11, 6: 49, 7: 438, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 115, 5: 50, 6: 24, 7: 35, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 13, 4: 102, 5: 50, 6: 28, 7: 37, 8: 47, 9: 270}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 21, 1: 27, 2: 1, 3: 90, 4: 2, 5: 0, 6: 171, 7: 43, 8: 21, 9: 2}
Prototype-Based Model Correct Classifications (per class):
{0: 23, 1: 27, 2: 2, 3: 91, 4: 3, 5: 0, 6: 153, 7: 40, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9445
Client 1: Regular Model Acc: 0.9612
Client 2: Regular Model Acc: 0.9096
Client 3: Regular Model Acc: 0.9034
Client 4: Regular Model Acc: 0.9466
Client 5: Regular Model Acc: 0.8827
Client 6: Regular Model Acc: 0.8076
Client 7: Regular Model Acc: 0.9553
Client 8: Regular Model Acc: 0.9450
Client 9: Regular Model Acc: 0.9850
Client 10: Regular Model Acc: 0.8814
Client 11: Regular Model Acc: 0.9926
Client 12: Regular Model Acc: 0.9437
Client 13: Regular Model Acc: 0.8731
Client 14: Regular Model Acc: 0.9630
Client 15: Regular Model Acc: 0.9894
Client 16: Regular Model Acc: 0.9549
Client 17: Regular Model Acc: 0.8977
Client 18: Regular Model Acc: 0.9077
Client 19: Regular Model Acc: 0.8552
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9274
Client 1: Prototype Model Acc: 0.9408
Client 2: Prototype Model Acc: 0.9111
Client 3: Prototype Model Acc: 0.8721
Client 4: Prototype Model Acc: 0.9406
Client 5: Prototype Model Acc: 0.8796
Client 6: Prototype Model Acc: 0.7930
Client 7: Prototype Model Acc: 0.9544
Client 8: Prototype Model Acc: 0.9271
Client 9: Prototype Model Acc: 0.9721
Client 10: Prototype Model Acc: 0.8742
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9379
Client 13: Prototype Model Acc: 0.8746
Client 14: Prototype Model Acc: 0.9620
Client 15: Prototype Model Acc: 0.9894
Client 16: Prototype Model Acc: 0.9471
Client 17: Prototype Model Acc: 0.8845
Client 18: Prototype Model Acc: 0.8983
Client 19: Prototype Model Acc: 0.8190
Averaged Test Accuracy (Regular Model): 0.9385
Averaged Test Accuracy (Prototype Model): 0.9301
Std Test Accuracy (Regular Model): 0.0476
Std Test Accuracy (Prototype Model): 0.0517
client.id trained 8
local_model_loss tensor(0.0161, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0200, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.0239, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0112, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0218, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0196, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.0835, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.1522, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.0488, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.1159, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0090, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0100, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0132, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0249, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0090, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.0205, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.0630, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0203, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0185, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.0162, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 539.8623815317405
only_train_time: 4807.966551943566
all_clients_time_cost: 4807.966551943566
agg_protos_label dict_keys([0, 1, 2, 4, 3, 9, 7, 6, 5, 8])
-------------------------------------------------- 66.04121279716492

-------------Round number: 74-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 8, 3: 0, 4: 37, 5: 0, 6: 4, 7: 109, 8: 16, 9: 575}
Prototype-Based Model Correct Classifications (per class):
{0: 116, 1: 8, 2: 4, 3: 0, 4: 40, 5: 0, 6: 2, 7: 112, 8: 16, 9: 572}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 271, 7: 5, 8: 501, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 270, 7: 8, 8: 487, 9: 103}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 104, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 147, 7: 132, 8: 50, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 105, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 145, 7: 134, 8: 50, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 251, 1: 0, 2: 45, 3: 11, 4: 0, 5: 11, 6: 7, 7: 14, 8: 3, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 241, 1: 0, 2: 44, 3: 12, 4: 0, 5: 7, 6: 3, 7: 13, 8: 4, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 76, 1: 2, 2: 184, 3: 19, 4: 0, 5: 0, 6: 25, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 185, 3: 22, 4: 0, 5: 0, 6: 22, 7: 2, 8: 325, 9: 477}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 30, 1: 0, 2: 0, 3: 9, 4: 0, 5: 5, 6: 48, 7: 0, 8: 20, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 44, 7: 0, 8: 20, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 16, 1: 0, 2: 38, 3: 0, 4: 0, 5: 0, 6: 212, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 19, 1: 0, 2: 50, 3: 0, 4: 1, 5: 0, 6: 177, 7: 0, 8: 0, 9: 11}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 31, 1: 68, 2: 354, 3: 116, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 30, 1: 65, 2: 354, 3: 119, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 221, 1: 290, 2: 226, 3: 0, 4: 156, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 224, 1: 289, 2: 199, 3: 0, 4: 166, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 63, 1: 140, 2: 0, 3: 1, 4: 5, 5: 0, 6: 0, 7: 2, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 59, 1: 137, 2: 1, 3: 1, 4: 7, 5: 0, 6: 0, 7: 2, 8: 700, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 120, 1: 131, 2: 4, 3: 18, 4: 12, 5: 254, 6: 217, 7: 101, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 121, 1: 129, 2: 3, 3: 18, 4: 13, 5: 253, 6: 208, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 1, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 240, 1: 0, 2: 57, 3: 66, 4: 0, 5: 60, 6: 1, 7: 286, 8: 0, 9: 94}
Prototype-Based Model Correct Classifications (per class):
{0: 228, 1: 0, 2: 59, 3: 70, 4: 0, 5: 59, 6: 1, 7: 285, 8: 0, 9: 97}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 28, 1: 140, 2: 240, 3: 2, 4: 52, 5: 81, 6: 2, 7: 20, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 137, 2: 236, 3: 5, 4: 53, 5: 83, 6: 2, 7: 20, 8: 15, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 147, 1: 122, 2: 130, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 147, 1: 120, 2: 133, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 97, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 98, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 347, 4: 53, 5: 0, 6: 238, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 347, 4: 55, 5: 0, 6: 225, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 102, 1: 70, 2: 183, 3: 189, 4: 27, 5: 5, 6: 73, 7: 439, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 103, 1: 69, 2: 183, 3: 189, 4: 27, 5: 11, 6: 51, 7: 438, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 114, 5: 50, 6: 26, 7: 35, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 13, 4: 102, 5: 50, 6: 28, 7: 37, 8: 47, 9: 270}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 18, 1: 27, 2: 1, 3: 84, 4: 2, 5: 0, 6: 183, 7: 43, 8: 21, 9: 2}
Prototype-Based Model Correct Classifications (per class):
{0: 20, 1: 27, 2: 2, 3: 89, 4: 2, 5: 0, 6: 165, 7: 40, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9445
Client 1: Regular Model Acc: 0.9612
Client 2: Regular Model Acc: 0.9096
Client 3: Regular Model Acc: 0.8956
Client 4: Regular Model Acc: 0.9466
Client 5: Regular Model Acc: 0.9043
Client 6: Regular Model Acc: 0.8105
Client 7: Regular Model Acc: 0.9553
Client 8: Regular Model Acc: 0.9440
Client 9: Regular Model Acc: 0.9850
Client 10: Regular Model Acc: 0.8835
Client 11: Regular Model Acc: 0.9926
Client 12: Regular Model Acc: 0.9426
Client 13: Regular Model Acc: 0.8731
Client 14: Regular Model Acc: 0.9630
Client 15: Regular Model Acc: 0.9894
Client 16: Regular Model Acc: 0.9549
Client 17: Regular Model Acc: 0.8977
Client 18: Regular Model Acc: 0.9092
Client 19: Regular Model Acc: 0.8620
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9285
Client 1: Prototype Model Acc: 0.9408
Client 2: Prototype Model Acc: 0.9096
Client 3: Prototype Model Acc: 0.8564
Client 4: Prototype Model Acc: 0.9406
Client 5: Prototype Model Acc: 0.8858
Client 6: Prototype Model Acc: 0.7522
Client 7: Prototype Model Acc: 0.9544
Client 8: Prototype Model Acc: 0.9281
Client 9: Prototype Model Acc: 0.9732
Client 10: Prototype Model Acc: 0.8742
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9367
Client 13: Prototype Model Acc: 0.8761
Client 14: Prototype Model Acc: 0.9641
Client 15: Prototype Model Acc: 0.9894
Client 16: Prototype Model Acc: 0.9462
Client 17: Prototype Model Acc: 0.8837
Client 18: Prototype Model Acc: 0.8983
Client 19: Prototype Model Acc: 0.8326
Averaged Test Accuracy (Regular Model): 0.9391
Averaged Test Accuracy (Prototype Model): 0.9295
Std Test Accuracy (Regular Model): 0.0460
Std Test Accuracy (Prototype Model): 0.0566
client.id trained 12
local_model_loss tensor(0.0191, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.1074, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0087, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0244, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0212, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0156, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.1078, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.0155, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.0540, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0196, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0129, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.0231, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.0201, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0179, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.0469, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0098, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0089, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.0917, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0200, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0109, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 547.5540424187202
only_train_time: 4873.417381097446
all_clients_time_cost: 4873.417381097446
agg_protos_label dict_keys([0, 7, 5, 2, 3, 9, 6, 8, 4, 1])
-------------------------------------------------- 67.1189911365509

-------------Round number: 75-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 8, 3: 0, 4: 37, 5: 0, 6: 4, 7: 109, 8: 15, 9: 575}
Prototype-Based Model Correct Classifications (per class):
{0: 115, 1: 8, 2: 4, 3: 0, 4: 40, 5: 0, 6: 2, 7: 112, 8: 16, 9: 572}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 271, 7: 5, 8: 501, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 270, 7: 8, 8: 487, 9: 103}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 104, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 146, 7: 132, 8: 50, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 105, 1: 1, 2: 0, 3: 0, 4: 0, 5: 178, 6: 145, 7: 134, 8: 50, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 253, 1: 0, 2: 45, 3: 11, 4: 0, 5: 11, 6: 5, 7: 14, 8: 3, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 243, 1: 0, 2: 44, 3: 12, 4: 0, 5: 7, 6: 4, 7: 13, 8: 4, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 76, 1: 2, 2: 184, 3: 19, 4: 0, 5: 0, 6: 25, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 185, 3: 22, 4: 0, 5: 0, 6: 22, 7: 2, 8: 325, 9: 477}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 33, 1: 0, 2: 0, 3: 9, 4: 0, 5: 5, 6: 44, 7: 0, 8: 19, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 40, 7: 0, 8: 20, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 15, 1: 0, 2: 37, 3: 0, 4: 0, 5: 0, 6: 216, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 18, 1: 0, 2: 49, 3: 0, 4: 1, 5: 0, 6: 184, 7: 0, 8: 0, 9: 11}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 31, 1: 68, 2: 354, 3: 116, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 30, 1: 65, 2: 353, 3: 119, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 221, 1: 290, 2: 227, 3: 0, 4: 156, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 224, 1: 289, 2: 200, 3: 0, 4: 165, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 63, 1: 140, 2: 0, 3: 1, 4: 5, 5: 0, 6: 0, 7: 2, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 59, 1: 137, 2: 1, 3: 1, 4: 7, 5: 0, 6: 0, 7: 2, 8: 700, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 121, 1: 131, 2: 4, 3: 18, 4: 12, 5: 254, 6: 217, 7: 101, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 122, 1: 129, 2: 3, 3: 18, 4: 13, 5: 253, 6: 207, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 1, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 240, 1: 0, 2: 57, 3: 66, 4: 0, 5: 60, 6: 1, 7: 286, 8: 0, 9: 94}
Prototype-Based Model Correct Classifications (per class):
{0: 229, 1: 0, 2: 59, 3: 70, 4: 0, 5: 59, 6: 1, 7: 285, 8: 0, 9: 97}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 28, 1: 140, 2: 243, 3: 2, 4: 49, 5: 81, 6: 2, 7: 20, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 137, 2: 236, 3: 5, 4: 53, 5: 83, 6: 2, 7: 20, 8: 15, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 147, 1: 122, 2: 130, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 147, 1: 120, 2: 131, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 97, 3: 826, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 98, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 347, 4: 53, 5: 0, 6: 238, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 347, 4: 55, 5: 0, 6: 226, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 102, 1: 70, 2: 183, 3: 189, 4: 27, 5: 5, 6: 73, 7: 439, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 103, 1: 69, 2: 183, 3: 189, 4: 30, 5: 11, 6: 49, 7: 438, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 115, 5: 50, 6: 25, 7: 35, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 13, 4: 102, 5: 50, 6: 28, 7: 37, 8: 47, 9: 270}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 22, 1: 27, 2: 1, 3: 90, 4: 2, 5: 0, 6: 167, 7: 43, 8: 21, 9: 2}
Prototype-Based Model Correct Classifications (per class):
{0: 23, 1: 27, 2: 2, 3: 91, 4: 3, 5: 0, 6: 151, 7: 40, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9434
Client 1: Regular Model Acc: 0.9612
Client 2: Regular Model Acc: 0.9082
Client 3: Regular Model Acc: 0.8956
Client 4: Regular Model Acc: 0.9466
Client 5: Regular Model Acc: 0.8981
Client 6: Regular Model Acc: 0.8163
Client 7: Regular Model Acc: 0.9553
Client 8: Regular Model Acc: 0.9450
Client 9: Regular Model Acc: 0.9850
Client 10: Regular Model Acc: 0.8845
Client 11: Regular Model Acc: 0.9926
Client 12: Regular Model Acc: 0.9426
Client 13: Regular Model Acc: 0.8731
Client 14: Regular Model Acc: 0.9630
Client 15: Regular Model Acc: 0.9894
Client 16: Regular Model Acc: 0.9549
Client 17: Regular Model Acc: 0.8977
Client 18: Regular Model Acc: 0.9092
Client 19: Regular Model Acc: 0.8484
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9274
Client 1: Prototype Model Acc: 0.9408
Client 2: Prototype Model Acc: 0.9111
Client 3: Prototype Model Acc: 0.8642
Client 4: Prototype Model Acc: 0.9406
Client 5: Prototype Model Acc: 0.8735
Client 6: Prototype Model Acc: 0.7668
Client 7: Prototype Model Acc: 0.9535
Client 8: Prototype Model Acc: 0.9281
Client 9: Prototype Model Acc: 0.9732
Client 10: Prototype Model Acc: 0.8742
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9379
Client 13: Prototype Model Acc: 0.8761
Client 14: Prototype Model Acc: 0.9620
Client 15: Prototype Model Acc: 0.9894
Client 16: Prototype Model Acc: 0.9471
Client 17: Prototype Model Acc: 0.8845
Client 18: Prototype Model Acc: 0.8983
Client 19: Prototype Model Acc: 0.8145
Averaged Test Accuracy (Regular Model): 0.9387
Averaged Test Accuracy (Prototype Model): 0.9293
Std Test Accuracy (Regular Model): 0.0465
Std Test Accuracy (Prototype Model): 0.0559
client.id trained 7
local_model_loss tensor(0.0172, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.1028, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.0224, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.0196, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.0150, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0206, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0096, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0238, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.1386, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0126, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0107, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.0451, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0191, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.0503, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0197, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0085, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.0739, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0186, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0152, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0086, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 554.0155013487674
only_train_time: 4937.445181145449
all_clients_time_cost: 4937.445181145449
agg_protos_label dict_keys([2, 5, 1, 0, 3, 4, 7, 6, 8, 9])
Number of samples: 167
-------------------------------------------------- 67.11024117469788

-------------Round number: 76-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 8, 3: 0, 4: 37, 5: 0, 6: 4, 7: 109, 8: 15, 9: 575}
Prototype-Based Model Correct Classifications (per class):
{0: 115, 1: 8, 2: 4, 3: 0, 4: 40, 5: 0, 6: 2, 7: 112, 8: 16, 9: 572}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 270, 7: 5, 8: 501, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 270, 7: 8, 8: 488, 9: 103}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 104, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 146, 7: 132, 8: 50, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 105, 1: 1, 2: 0, 3: 0, 4: 0, 5: 178, 6: 145, 7: 134, 8: 50, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 253, 1: 0, 2: 45, 3: 11, 4: 0, 5: 11, 6: 5, 7: 14, 8: 3, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 243, 1: 0, 2: 45, 3: 12, 4: 0, 5: 7, 6: 4, 7: 13, 8: 4, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 76, 1: 2, 2: 184, 3: 19, 4: 0, 5: 0, 6: 25, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 185, 3: 22, 4: 0, 5: 0, 6: 22, 7: 2, 8: 325, 9: 477}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 35, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 40, 7: 0, 8: 19, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 0, 2: 1, 3: 10, 4: 0, 5: 5, 6: 35, 7: 0, 8: 20, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 13, 1: 0, 2: 37, 3: 0, 4: 0, 5: 0, 6: 217, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 17, 1: 0, 2: 49, 3: 0, 4: 1, 5: 0, 6: 191, 7: 0, 8: 0, 9: 11}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 31, 1: 68, 2: 354, 3: 116, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 30, 1: 65, 2: 353, 3: 119, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 221, 1: 290, 2: 227, 3: 0, 4: 156, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 224, 1: 289, 2: 200, 3: 0, 4: 165, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 63, 1: 140, 2: 0, 3: 1, 4: 5, 5: 0, 6: 0, 7: 2, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 59, 1: 137, 2: 1, 3: 1, 4: 7, 5: 0, 6: 0, 7: 2, 8: 700, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 120, 1: 131, 2: 4, 3: 18, 4: 12, 5: 254, 6: 217, 7: 101, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 121, 1: 129, 2: 3, 3: 18, 4: 13, 5: 253, 6: 208, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 1, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 240, 1: 0, 2: 57, 3: 66, 4: 0, 5: 60, 6: 1, 7: 286, 8: 0, 9: 94}
Prototype-Based Model Correct Classifications (per class):
{0: 229, 1: 0, 2: 59, 3: 70, 4: 0, 5: 59, 6: 1, 7: 285, 8: 0, 9: 97}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 28, 1: 140, 2: 240, 3: 2, 4: 53, 5: 81, 6: 2, 7: 20, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 136, 2: 235, 3: 5, 4: 54, 5: 83, 6: 2, 7: 20, 8: 15, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 147, 1: 122, 2: 130, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 147, 1: 120, 2: 133, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 97, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 98, 3: 824, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 347, 4: 53, 5: 0, 6: 238, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 347, 4: 55, 5: 0, 6: 226, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 102, 1: 70, 2: 183, 3: 189, 4: 26, 5: 5, 6: 72, 7: 439, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 103, 1: 69, 2: 182, 3: 190, 4: 30, 5: 11, 6: 50, 7: 438, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 114, 5: 50, 6: 26, 7: 35, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 13, 4: 102, 5: 50, 6: 28, 7: 37, 8: 47, 9: 270}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 19, 1: 27, 2: 1, 3: 86, 4: 2, 5: 0, 6: 179, 7: 43, 8: 21, 9: 2}
Prototype-Based Model Correct Classifications (per class):
{0: 21, 1: 27, 2: 2, 3: 89, 4: 2, 5: 0, 6: 163, 7: 40, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9434
Client 1: Regular Model Acc: 0.9602
Client 2: Regular Model Acc: 0.9082
Client 3: Regular Model Acc: 0.8956
Client 4: Regular Model Acc: 0.9466
Client 5: Regular Model Acc: 0.8951
Client 6: Regular Model Acc: 0.8134
Client 7: Regular Model Acc: 0.9553
Client 8: Regular Model Acc: 0.9450
Client 9: Regular Model Acc: 0.9850
Client 10: Regular Model Acc: 0.8835
Client 11: Regular Model Acc: 0.9926
Client 12: Regular Model Acc: 0.9426
Client 13: Regular Model Acc: 0.8746
Client 14: Regular Model Acc: 0.9630
Client 15: Regular Model Acc: 0.9883
Client 16: Regular Model Acc: 0.9549
Client 17: Regular Model Acc: 0.8960
Client 18: Regular Model Acc: 0.9092
Client 19: Regular Model Acc: 0.8597
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9274
Client 1: Prototype Model Acc: 0.9419
Client 2: Prototype Model Acc: 0.9111
Client 3: Prototype Model Acc: 0.8668
Client 4: Prototype Model Acc: 0.9406
Client 5: Prototype Model Acc: 0.8611
Client 6: Prototype Model Acc: 0.7843
Client 7: Prototype Model Acc: 0.9535
Client 8: Prototype Model Acc: 0.9281
Client 9: Prototype Model Acc: 0.9732
Client 10: Prototype Model Acc: 0.8742
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9379
Client 13: Prototype Model Acc: 0.8746
Client 14: Prototype Model Acc: 0.9641
Client 15: Prototype Model Acc: 0.9883
Client 16: Prototype Model Acc: 0.9471
Client 17: Prototype Model Acc: 0.8853
Client 18: Prototype Model Acc: 0.8983
Client 19: Prototype Model Acc: 0.8303
Averaged Test Accuracy (Regular Model): 0.9387
Averaged Test Accuracy (Prototype Model): 0.9300
Std Test Accuracy (Regular Model): 0.0460
Std Test Accuracy (Prototype Model): 0.0529
client.id trained 5
local_model_loss tensor(0.1084, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0094, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.0434, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0148, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0085, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0123, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0182, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.1011, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.0775, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0201, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0187, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0104, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0194, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.0144, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0233, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.0193, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.0477, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.0216, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0167, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0082, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 560.552214725758
only_train_time: 5000.823884156416
all_clients_time_cost: 5000.823884156416
agg_protos_label dict_keys([9, 0, 6, 5, 8, 3, 1, 2, 4, 7])
-------------------------------------------------- 65.00262260437012

-------------Round number: 77-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 8, 3: 0, 4: 37, 5: 0, 6: 4, 7: 109, 8: 15, 9: 575}
Prototype-Based Model Correct Classifications (per class):
{0: 114, 1: 8, 2: 4, 3: 0, 4: 40, 5: 0, 6: 2, 7: 112, 8: 16, 9: 572}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 270, 7: 5, 8: 501, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 270, 7: 8, 8: 488, 9: 103}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 104, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 146, 7: 132, 8: 50, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 106, 1: 1, 2: 0, 3: 0, 4: 0, 5: 178, 6: 145, 7: 134, 8: 50, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 257, 1: 0, 2: 43, 3: 11, 4: 0, 5: 11, 6: 6, 7: 14, 8: 3, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 245, 1: 0, 2: 44, 3: 12, 4: 0, 5: 7, 6: 5, 7: 13, 8: 4, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 76, 1: 2, 2: 184, 3: 19, 4: 0, 5: 0, 6: 24, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 185, 3: 22, 4: 0, 5: 0, 6: 21, 7: 2, 8: 325, 9: 477}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 36, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 41, 7: 0, 8: 19, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 30, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 39, 7: 0, 8: 20, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 13, 1: 0, 2: 37, 3: 0, 4: 0, 5: 0, 6: 218, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 16, 1: 0, 2: 49, 3: 0, 4: 1, 5: 0, 6: 192, 7: 0, 8: 0, 9: 11}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 31, 1: 67, 2: 354, 3: 116, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 30, 1: 65, 2: 353, 3: 119, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 221, 1: 290, 2: 227, 3: 0, 4: 156, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 224, 1: 289, 2: 200, 3: 0, 4: 165, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 63, 1: 140, 2: 0, 3: 1, 4: 5, 5: 0, 6: 0, 7: 2, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 59, 1: 137, 2: 0, 3: 1, 4: 7, 5: 0, 6: 0, 7: 2, 8: 700, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 120, 1: 131, 2: 4, 3: 18, 4: 12, 5: 254, 6: 217, 7: 101, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 121, 1: 129, 2: 3, 3: 18, 4: 13, 5: 253, 6: 209, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 1, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 240, 1: 0, 2: 57, 3: 66, 4: 0, 5: 60, 6: 1, 7: 286, 8: 0, 9: 94}
Prototype-Based Model Correct Classifications (per class):
{0: 229, 1: 0, 2: 59, 3: 70, 4: 0, 5: 59, 6: 1, 7: 285, 8: 0, 9: 97}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 28, 1: 140, 2: 244, 3: 2, 4: 51, 5: 81, 6: 2, 7: 20, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 137, 2: 236, 3: 5, 4: 53, 5: 83, 6: 2, 7: 20, 8: 15, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 147, 1: 122, 2: 130, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 147, 1: 120, 2: 132, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 97, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 98, 3: 824, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 347, 4: 53, 5: 0, 6: 238, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 347, 4: 55, 5: 0, 6: 226, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 102, 1: 70, 2: 183, 3: 189, 4: 26, 5: 5, 6: 72, 7: 439, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 103, 1: 69, 2: 183, 3: 191, 4: 30, 5: 11, 6: 49, 7: 438, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 114, 5: 50, 6: 25, 7: 35, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 13, 4: 102, 5: 50, 6: 28, 7: 37, 8: 46, 9: 270}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 22, 1: 27, 2: 1, 3: 90, 4: 2, 5: 0, 6: 168, 7: 43, 8: 21, 9: 2}
Prototype-Based Model Correct Classifications (per class):
{0: 23, 1: 27, 2: 2, 3: 91, 4: 3, 5: 0, 6: 152, 7: 40, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9434
Client 1: Regular Model Acc: 0.9602
Client 2: Regular Model Acc: 0.9082
Client 3: Regular Model Acc: 0.9034
Client 4: Regular Model Acc: 0.9457
Client 5: Regular Model Acc: 0.9012
Client 6: Regular Model Acc: 0.8163
Client 7: Regular Model Acc: 0.9544
Client 8: Regular Model Acc: 0.9450
Client 9: Regular Model Acc: 0.9850
Client 10: Regular Model Acc: 0.8835
Client 11: Regular Model Acc: 0.9926
Client 12: Regular Model Acc: 0.9426
Client 13: Regular Model Acc: 0.8776
Client 14: Regular Model Acc: 0.9630
Client 15: Regular Model Acc: 0.9883
Client 16: Regular Model Acc: 0.9549
Client 17: Regular Model Acc: 0.8960
Client 18: Regular Model Acc: 0.9077
Client 19: Regular Model Acc: 0.8507
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9264
Client 1: Prototype Model Acc: 0.9419
Client 2: Prototype Model Acc: 0.9125
Client 3: Prototype Model Acc: 0.8721
Client 4: Prototype Model Acc: 0.9398
Client 5: Prototype Model Acc: 0.8735
Client 6: Prototype Model Acc: 0.7843
Client 7: Prototype Model Acc: 0.9535
Client 8: Prototype Model Acc: 0.9281
Client 9: Prototype Model Acc: 0.9721
Client 10: Prototype Model Acc: 0.8753
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9379
Client 13: Prototype Model Acc: 0.8761
Client 14: Prototype Model Acc: 0.9630
Client 15: Prototype Model Acc: 0.9883
Client 16: Prototype Model Acc: 0.9471
Client 17: Prototype Model Acc: 0.8861
Client 18: Prototype Model Acc: 0.8967
Client 19: Prototype Model Acc: 0.8167
Averaged Test Accuracy (Regular Model): 0.9387
Averaged Test Accuracy (Prototype Model): 0.9299
Std Test Accuracy (Regular Model): 0.0457
Std Test Accuracy (Prototype Model): 0.0530
client.id trained 2
local_model_loss tensor(0.0189, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.0139, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.0209, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0195, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.0419, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0191, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0120, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0080, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0102, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0229, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0145, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.1270, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0177, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.1577, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0183, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.0693, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0083, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.0455, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0092, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0161, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 567.2175068157958
only_train_time: 5065.856009833631
all_clients_time_cost: 5065.856009833631
agg_protos_label dict_keys([7, 5, 4, 6, 9, 8, 0, 1, 2, 3])
-------------------------------------------------- 66.63031244277954

-------------Round number: 78-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 8, 3: 0, 4: 37, 5: 0, 6: 4, 7: 109, 8: 15, 9: 575}
Prototype-Based Model Correct Classifications (per class):
{0: 116, 1: 8, 2: 4, 3: 0, 4: 40, 5: 0, 6: 2, 7: 112, 8: 16, 9: 572}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 270, 7: 5, 8: 501, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 271, 7: 7, 8: 488, 9: 103}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 104, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 146, 7: 132, 8: 50, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 105, 1: 1, 2: 0, 3: 0, 4: 0, 5: 178, 6: 145, 7: 134, 8: 50, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 244, 1: 0, 2: 45, 3: 11, 4: 0, 5: 11, 6: 8, 7: 14, 8: 3, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 236, 1: 0, 2: 44, 3: 12, 4: 0, 5: 8, 6: 4, 7: 13, 8: 4, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 76, 1: 2, 2: 185, 3: 19, 4: 0, 5: 0, 6: 24, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 185, 3: 22, 4: 0, 5: 0, 6: 22, 7: 2, 8: 325, 9: 477}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 36, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 38, 7: 0, 8: 19, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 31, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 38, 7: 0, 8: 20, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 13, 1: 0, 2: 37, 3: 0, 4: 0, 5: 0, 6: 218, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 15, 1: 0, 2: 49, 3: 0, 4: 0, 5: 0, 6: 195, 7: 0, 8: 0, 9: 11}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 30, 1: 67, 2: 354, 3: 116, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 30, 1: 65, 2: 354, 3: 119, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 221, 1: 290, 2: 227, 3: 0, 4: 156, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 224, 1: 289, 2: 201, 3: 0, 4: 165, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 63, 1: 140, 2: 0, 3: 1, 4: 5, 5: 0, 6: 0, 7: 2, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 59, 1: 137, 2: 1, 3: 1, 4: 7, 5: 0, 6: 0, 7: 2, 8: 700, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 120, 1: 131, 2: 4, 3: 18, 4: 12, 5: 254, 6: 217, 7: 101, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 121, 1: 129, 2: 3, 3: 18, 4: 13, 5: 253, 6: 209, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 1, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 240, 1: 0, 2: 57, 3: 66, 4: 0, 5: 60, 6: 1, 7: 286, 8: 0, 9: 94}
Prototype-Based Model Correct Classifications (per class):
{0: 229, 1: 0, 2: 59, 3: 70, 4: 0, 5: 59, 6: 1, 7: 284, 8: 0, 9: 97}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 28, 1: 140, 2: 241, 3: 2, 4: 52, 5: 81, 6: 2, 7: 20, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 137, 2: 236, 3: 5, 4: 53, 5: 83, 6: 2, 7: 20, 8: 15, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 147, 1: 122, 2: 130, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 147, 1: 120, 2: 133, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 97, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 98, 3: 824, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 347, 4: 53, 5: 0, 6: 238, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 348, 4: 55, 5: 0, 6: 225, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 102, 1: 70, 2: 183, 3: 189, 4: 26, 5: 5, 6: 71, 7: 439, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 103, 1: 69, 2: 184, 3: 190, 4: 28, 5: 11, 6: 50, 7: 438, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 113, 5: 50, 6: 26, 7: 35, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 13, 4: 102, 5: 50, 6: 29, 7: 37, 8: 47, 9: 270}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 19, 1: 27, 2: 1, 3: 86, 4: 2, 5: 0, 6: 179, 7: 43, 8: 21, 9: 2}
Prototype-Based Model Correct Classifications (per class):
{0: 21, 1: 27, 2: 2, 3: 89, 4: 2, 5: 0, 6: 163, 7: 40, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9434
Client 1: Regular Model Acc: 0.9602
Client 2: Regular Model Acc: 0.9082
Client 3: Regular Model Acc: 0.8799
Client 4: Regular Model Acc: 0.9466
Client 5: Regular Model Acc: 0.8920
Client 6: Regular Model Acc: 0.8163
Client 7: Regular Model Acc: 0.9535
Client 8: Regular Model Acc: 0.9450
Client 9: Regular Model Acc: 0.9850
Client 10: Regular Model Acc: 0.8835
Client 11: Regular Model Acc: 0.9926
Client 12: Regular Model Acc: 0.9426
Client 13: Regular Model Acc: 0.8746
Client 14: Regular Model Acc: 0.9630
Client 15: Regular Model Acc: 0.9883
Client 16: Regular Model Acc: 0.9549
Client 17: Regular Model Acc: 0.8952
Client 18: Regular Model Acc: 0.9077
Client 19: Regular Model Acc: 0.8597
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9285
Client 1: Prototype Model Acc: 0.9419
Client 2: Prototype Model Acc: 0.9111
Client 3: Prototype Model Acc: 0.8486
Client 4: Prototype Model Acc: 0.9406
Client 5: Prototype Model Acc: 0.8735
Client 6: Prototype Model Acc: 0.7872
Client 7: Prototype Model Acc: 0.9544
Client 8: Prototype Model Acc: 0.9292
Client 9: Prototype Model Acc: 0.9732
Client 10: Prototype Model Acc: 0.8753
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9367
Client 13: Prototype Model Acc: 0.8761
Client 14: Prototype Model Acc: 0.9641
Client 15: Prototype Model Acc: 0.9883
Client 16: Prototype Model Acc: 0.9471
Client 17: Prototype Model Acc: 0.8853
Client 18: Prototype Model Acc: 0.8998
Client 19: Prototype Model Acc: 0.8303
Averaged Test Accuracy (Regular Model): 0.9381
Averaged Test Accuracy (Prototype Model): 0.9301
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0528
client.id trained 13
local_model_loss tensor(0.0404, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0142, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.1052, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0082, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0090, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0156, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0190, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0077, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0118, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0179, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.0951, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.0436, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.0135, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.0650, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.0203, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0100, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0173, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0224, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 9
local_model_loss tensor(0.0188, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.0186, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 573.79243979475
only_train_time: 5128.9638509985525
all_clients_time_cost: 5128.9638509985525
agg_protos_label dict_keys([5, 0, 4, 6, 2, 1, 7, 8, 3, 9])
-------------------------------------------------- 64.85124826431274

-------------Round number: 79-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 8, 3: 0, 4: 37, 5: 0, 6: 4, 7: 109, 8: 15, 9: 576}
Prototype-Based Model Correct Classifications (per class):
{0: 115, 1: 8, 2: 4, 3: 0, 4: 40, 5: 0, 6: 2, 7: 112, 8: 16, 9: 572}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 270, 7: 5, 8: 501, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 270, 7: 7, 8: 489, 9: 103}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 104, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 146, 7: 132, 8: 50, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 106, 1: 1, 2: 0, 3: 0, 4: 0, 5: 178, 6: 145, 7: 134, 8: 50, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 255, 1: 0, 2: 45, 3: 11, 4: 0, 5: 11, 6: 6, 7: 14, 8: 3, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 243, 1: 0, 2: 45, 3: 12, 4: 0, 5: 8, 6: 4, 7: 13, 8: 4, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 76, 1: 2, 2: 185, 3: 19, 4: 0, 5: 0, 6: 24, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 185, 3: 22, 4: 0, 5: 0, 6: 21, 7: 2, 8: 325, 9: 477}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 25, 1: 0, 2: 0, 3: 9, 4: 0, 5: 5, 6: 51, 7: 0, 8: 20, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 28, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 46, 7: 0, 8: 20, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 13, 1: 0, 2: 37, 3: 0, 4: 0, 5: 0, 6: 217, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 15, 1: 0, 2: 48, 3: 0, 4: 1, 5: 0, 6: 196, 7: 0, 8: 0, 9: 11}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 30, 1: 67, 2: 354, 3: 116, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 65, 2: 353, 3: 119, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 221, 1: 290, 2: 227, 3: 0, 4: 156, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 224, 1: 289, 2: 202, 3: 0, 4: 165, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 63, 1: 141, 2: 0, 3: 1, 4: 5, 5: 0, 6: 0, 7: 2, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 59, 1: 137, 2: 0, 3: 1, 4: 7, 5: 0, 6: 0, 7: 2, 8: 700, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 120, 1: 131, 2: 4, 3: 18, 4: 12, 5: 254, 6: 217, 7: 101, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 121, 1: 129, 2: 3, 3: 18, 4: 13, 5: 253, 6: 209, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 1, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 240, 1: 0, 2: 57, 3: 66, 4: 0, 5: 60, 6: 1, 7: 286, 8: 0, 9: 94}
Prototype-Based Model Correct Classifications (per class):
{0: 229, 1: 0, 2: 59, 3: 70, 4: 0, 5: 59, 6: 1, 7: 285, 8: 0, 9: 97}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 28, 1: 140, 2: 243, 3: 2, 4: 52, 5: 81, 6: 2, 7: 20, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 137, 2: 236, 3: 5, 4: 54, 5: 83, 6: 2, 7: 20, 8: 15, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 147, 1: 122, 2: 130, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 147, 1: 120, 2: 132, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 97, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 98, 3: 824, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 347, 4: 53, 5: 0, 6: 238, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 347, 4: 55, 5: 0, 6: 225, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 102, 1: 70, 2: 183, 3: 189, 4: 26, 5: 5, 6: 73, 7: 439, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 103, 1: 69, 2: 183, 3: 191, 4: 30, 5: 11, 6: 49, 7: 438, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 113, 5: 50, 6: 26, 7: 35, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 13, 4: 102, 5: 50, 6: 28, 7: 37, 8: 47, 9: 270}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 22, 1: 27, 2: 1, 3: 90, 4: 2, 5: 0, 6: 168, 7: 43, 8: 21, 9: 2}
Prototype-Based Model Correct Classifications (per class):
{0: 23, 1: 27, 2: 2, 3: 91, 4: 3, 5: 0, 6: 152, 7: 40, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9445
Client 1: Regular Model Acc: 0.9602
Client 2: Regular Model Acc: 0.9082
Client 3: Regular Model Acc: 0.9034
Client 4: Regular Model Acc: 0.9466
Client 5: Regular Model Acc: 0.8981
Client 6: Regular Model Acc: 0.8134
Client 7: Regular Model Acc: 0.9535
Client 8: Regular Model Acc: 0.9450
Client 9: Regular Model Acc: 0.9861
Client 10: Regular Model Acc: 0.8835
Client 11: Regular Model Acc: 0.9926
Client 12: Regular Model Acc: 0.9426
Client 13: Regular Model Acc: 0.8776
Client 14: Regular Model Acc: 0.9630
Client 15: Regular Model Acc: 0.9883
Client 16: Regular Model Acc: 0.9549
Client 17: Regular Model Acc: 0.8969
Client 18: Regular Model Acc: 0.9077
Client 19: Regular Model Acc: 0.8507
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9274
Client 1: Prototype Model Acc: 0.9419
Client 2: Prototype Model Acc: 0.9125
Client 3: Prototype Model Acc: 0.8695
Client 4: Prototype Model Acc: 0.9398
Client 5: Prototype Model Acc: 0.8889
Client 6: Prototype Model Acc: 0.7901
Client 7: Prototype Model Acc: 0.9526
Client 8: Prototype Model Acc: 0.9302
Client 9: Prototype Model Acc: 0.9721
Client 10: Prototype Model Acc: 0.8753
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9379
Client 13: Prototype Model Acc: 0.8776
Client 14: Prototype Model Acc: 0.9630
Client 15: Prototype Model Acc: 0.9883
Client 16: Prototype Model Acc: 0.9462
Client 17: Prototype Model Acc: 0.8861
Client 18: Prototype Model Acc: 0.8983
Client 19: Prototype Model Acc: 0.8167
Averaged Test Accuracy (Regular Model): 0.9388
Averaged Test Accuracy (Prototype Model): 0.9304
Std Test Accuracy (Regular Model): 0.0462
Std Test Accuracy (Prototype Model): 0.0518
client.id trained 9
local_model_loss tensor(0.0185, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 10
local_model_loss tensor(0.0131, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 5
local_model_loss tensor(0.1095, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 15
local_model_loss tensor(0.0075, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 19
local_model_loss tensor(0.0640, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 8
local_model_loss tensor(0.0138, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 14
local_model_loss tensor(0.0080, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 17
local_model_loss tensor(0.0196, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 18
local_model_loss tensor(0.0185, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 11
local_model_loss tensor(0.0088, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 3
local_model_loss tensor(0.0905, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 1
local_model_loss tensor(0.0220, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 7
local_model_loss tensor(0.0150, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 13
local_model_loss tensor(0.0390, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 12
local_model_loss tensor(0.0169, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 2
local_model_loss tensor(0.0182, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 16
local_model_loss tensor(0.0098, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 0
local_model_loss tensor(0.0175, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 4
local_model_loss tensor(0.0115, grad_fn=<DivBackward0>)
local_gl_loss 0.0
client.id trained 6
local_model_loss tensor(0.0419, grad_fn=<DivBackward0>)
local_gl_loss 0.0
server_global_time: 583.6298149668146
only_train_time: 5195.428970596753
all_clients_time_cost: 5195.428970596753
agg_protos_label dict_keys([1, 8, 7, 2, 4, 0, 6, 3, 5, 9])
Number of samples: 167
-------------------------------------------------- 69.4261212348938

-------------Round number: 80-------------

Evaluate heterogeneous models
--------------------
client id 0
Regular Model Correct Classifications (per class):
{0: 128, 1: 8, 2: 8, 3: 0, 4: 37, 5: 0, 6: 4, 7: 109, 8: 15, 9: 576}
Prototype-Based Model Correct Classifications (per class):
{0: 116, 1: 8, 2: 4, 3: 0, 4: 40, 5: 0, 6: 2, 7: 112, 8: 16, 9: 572}
--------------------
client id 1
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 0, 4: 0, 5: 5, 6: 270, 7: 5, 8: 501, 9: 110}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 5, 6: 271, 7: 7, 8: 489, 9: 103}
--------------------
client id 2
Regular Model Correct Classifications (per class):
{0: 104, 1: 1, 2: 0, 3: 0, 4: 0, 5: 177, 6: 146, 7: 132, 8: 50, 9: 13}
Prototype-Based Model Correct Classifications (per class):
{0: 106, 1: 1, 2: 0, 3: 0, 4: 0, 5: 178, 6: 145, 7: 134, 8: 50, 9: 12}
--------------------
client id 3
Regular Model Correct Classifications (per class):
{0: 253, 1: 0, 2: 45, 3: 11, 4: 0, 5: 11, 6: 7, 7: 14, 8: 3, 9: 1}
Prototype-Based Model Correct Classifications (per class):
{0: 243, 1: 0, 2: 45, 3: 12, 4: 0, 5: 8, 6: 4, 7: 13, 8: 4, 9: 4}
--------------------
client id 4
Regular Model Correct Classifications (per class):
{0: 76, 1: 2, 2: 185, 3: 19, 4: 0, 5: 0, 6: 24, 7: 1, 8: 331, 9: 478}
Prototype-Based Model Correct Classifications (per class):
{0: 74, 1: 2, 2: 185, 3: 22, 4: 0, 5: 0, 6: 21, 7: 2, 8: 325, 9: 477}
--------------------
client id 5
Regular Model Correct Classifications (per class):
{0: 30, 1: 0, 2: 0, 3: 9, 4: 0, 5: 5, 6: 48, 7: 0, 8: 20, 9: 181}
Prototype-Based Model Correct Classifications (per class):
{0: 28, 1: 0, 2: 0, 3: 10, 4: 0, 5: 5, 6: 45, 7: 0, 8: 20, 9: 179}
--------------------
client id 6
Regular Model Correct Classifications (per class):
{0: 13, 1: 0, 2: 37, 3: 0, 4: 0, 5: 0, 6: 217, 7: 0, 8: 0, 9: 12}
Prototype-Based Model Correct Classifications (per class):
{0: 15, 1: 0, 2: 48, 3: 0, 4: 1, 5: 0, 6: 198, 7: 0, 8: 0, 9: 11}
--------------------
client id 7
Regular Model Correct Classifications (per class):
{0: 30, 1: 66, 2: 354, 3: 116, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 65, 2: 353, 3: 119, 4: 0, 5: 500, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 8
Regular Model Correct Classifications (per class):
{0: 221, 1: 290, 2: 227, 3: 0, 4: 156, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 224, 1: 289, 2: 202, 3: 0, 4: 165, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 9
Regular Model Correct Classifications (per class):
{0: 63, 1: 141, 2: 0, 3: 1, 4: 5, 5: 0, 6: 0, 7: 2, 8: 707, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 59, 1: 137, 2: 0, 3: 1, 4: 7, 5: 0, 6: 0, 7: 2, 8: 700, 9: 0}
--------------------
client id 10
Regular Model Correct Classifications (per class):
{0: 120, 1: 131, 2: 4, 3: 18, 4: 12, 5: 254, 6: 218, 7: 101, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 121, 1: 129, 2: 3, 3: 18, 4: 13, 5: 253, 6: 210, 7: 103, 8: 0, 9: 0}
--------------------
client id 11
Regular Model Correct Classifications (per class):
{0: 1, 1: 714, 2: 0, 3: 0, 4: 1153, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 714, 2: 0, 3: 0, 4: 1154, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 12
Regular Model Correct Classifications (per class):
{0: 240, 1: 0, 2: 57, 3: 66, 4: 0, 5: 60, 6: 1, 7: 286, 8: 0, 9: 94}
Prototype-Based Model Correct Classifications (per class):
{0: 229, 1: 0, 2: 59, 3: 70, 4: 0, 5: 59, 6: 1, 7: 284, 8: 0, 9: 97}
--------------------
client id 13
Regular Model Correct Classifications (per class):
{0: 28, 1: 140, 2: 240, 3: 2, 4: 52, 5: 81, 6: 2, 7: 20, 8: 13, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 29, 1: 137, 2: 236, 3: 5, 4: 55, 5: 83, 6: 2, 7: 20, 8: 15, 9: 0}
--------------------
client id 14
Regular Model Correct Classifications (per class):
{0: 147, 1: 122, 2: 130, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 147, 1: 120, 2: 132, 3: 0, 4: 9, 5: 530, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 15
Regular Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 97, 3: 825, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 8, 1: 1, 2: 98, 3: 824, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
--------------------
client id 16
Regular Model Correct Classifications (per class):
{0: 0, 1: 1, 2: 0, 3: 347, 4: 53, 5: 0, 6: 238, 7: 462, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 0, 1: 2, 2: 0, 3: 347, 4: 55, 5: 0, 6: 226, 7: 462, 8: 0, 9: 0}
--------------------
client id 17
Regular Model Correct Classifications (per class):
{0: 102, 1: 70, 2: 183, 3: 189, 4: 26, 5: 5, 6: 73, 7: 439, 8: 0, 9: 0}
Prototype-Based Model Correct Classifications (per class):
{0: 103, 1: 69, 2: 183, 3: 191, 4: 29, 5: 11, 6: 48, 7: 438, 8: 0, 9: 0}
--------------------
client id 18
Regular Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 12, 4: 113, 5: 50, 6: 27, 7: 35, 8: 46, 9: 271}
Prototype-Based Model Correct Classifications (per class):
{0: 12, 1: 15, 2: 0, 3: 13, 4: 102, 5: 50, 6: 29, 7: 37, 8: 47, 9: 270}
--------------------
client id 19
Regular Model Correct Classifications (per class):
{0: 19, 1: 27, 2: 1, 3: 86, 4: 2, 5: 0, 6: 178, 7: 43, 8: 21, 9: 2}
Prototype-Based Model Correct Classifications (per class):
{0: 21, 1: 27, 2: 2, 3: 89, 4: 2, 5: 0, 6: 163, 7: 40, 8: 21, 9: 2}
Regular Model Accuracies:
Client 0: Regular Model Acc: 0.9445
Client 1: Regular Model Acc: 0.9602
Client 2: Regular Model Acc: 0.9082
Client 3: Regular Model Acc: 0.9008
Client 4: Regular Model Acc: 0.9466
Client 5: Regular Model Acc: 0.9043
Client 6: Regular Model Acc: 0.8134
Client 7: Regular Model Acc: 0.9526
Client 8: Regular Model Acc: 0.9450
Client 9: Regular Model Acc: 0.9861
Client 10: Regular Model Acc: 0.8845
Client 11: Regular Model Acc: 0.9926
Client 12: Regular Model Acc: 0.9426
Client 13: Regular Model Acc: 0.8731
Client 14: Regular Model Acc: 0.9630
Client 15: Regular Model Acc: 0.9883
Client 16: Regular Model Acc: 0.9549
Client 17: Regular Model Acc: 0.8969
Client 18: Regular Model Acc: 0.9092
Client 19: Regular Model Acc: 0.8575
Prototype Model Accuracies:
Client 0: Prototype Model Acc: 0.9285
Client 1: Prototype Model Acc: 0.9429
Client 2: Prototype Model Acc: 0.9125
Client 3: Prototype Model Acc: 0.8695
Client 4: Prototype Model Acc: 0.9398
Client 5: Prototype Model Acc: 0.8858
Client 6: Prototype Model Acc: 0.7959
Client 7: Prototype Model Acc: 0.9526
Client 8: Prototype Model Acc: 0.9302
Client 9: Prototype Model Acc: 0.9721
Client 10: Prototype Model Acc: 0.8763
Client 11: Prototype Model Acc: 0.9926
Client 12: Prototype Model Acc: 0.9367
Client 13: Prototype Model Acc: 0.8792
Client 14: Prototype Model Acc: 0.9630
Client 15: Prototype Model Acc: 0.9883
Client 16: Prototype Model Acc: 0.9471
Client 17: Prototype Model Acc: 0.8845
Client 18: Prototype Model Acc: 0.8998
Client 19: Prototype Model Acc: 0.8303
Averaged Test Accuracy (Regular Model): 0.9389
Averaged Test Accuracy (Prototype Model): 0.9310
Std Test Accuracy (Regular Model): 0.0457
Std Test Accuracy (Prototype Model): 0.0499

Best accuracy.
0.939052950248472
66.1794986397028
File path: ../results/FashionMNIST_dir_0.3_imbalance_20_FedProto_test_0.h5
Deleted.

Average time cost: 6380.4s.
Length:  81
std for best accurancy: 0.0
mean for best accurancy: 0.939052950248472
All done!

Storage on cpu
-------------------------------------------------------------------------------
Total Tensors: 26961930 	Used Memory: 105.84M
-------------------------------------------------------------------------------
