==================================================
goal = test
device = cuda
device_id = 0
dataset = FashionMNIST_dir_0.3_imbalance_40
num_classes = 10
model_family = HCNNs8
batch_size = 256
local_learning_rate = 0.06
use_decay_scheduler = False
learning_rate_decay = False
learning_rate_decay_gamma = 0.99
global_rounds = 150
edge_epochs = 1
local_epochs = 10
algorithm = FedSAE
join_ratio = 1.0
random_join_ratio = False
num_clients = 40
num_edges = 10
prev = 0
times = 1
eval_gap = 1
save_folder_name = temp
auto_break = False
feature_dim = 512
vocab_size = 98635
max_len = 200
client_drop_rate = 0.0
train_slow_rate = 0.0
send_slow_rate = 0.0
time_select = False
time_threthold = 10000
lamda = 2
trans_delay_simulate = False
agg_type = 0
buffersize = 10
test_useglclassifier = 1
gamma = 1.0
use_beta = True
SAEbeta = 0.2
addTGP = True
drawtsne = True
drawround = 10
noise_dim = 512
generator_learning_rate = 0.005
hidden_dim = 512
server_epochs = 100
alpha = 1.0
beta = 1.0
mentee_learning_rate = 0.005
T_start = 0.95
T_end = 0.98
server_learning_rate = 0.01
margin_threthold = 100.0
generator_path = stylegan/stylegan-xl-models/imagenet64.pkl
stable_diffusion_prompt = a cat
server_batch_size = 100
gen_batch_size = 4
mu = 50.0
==================================================
Random seed set as 42

============= Running time: 0th =============
Creating server and clients ...
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 0
label_counts: defaultdict(<class 'int'>, {5: 106, 1: 338, 0: 287, 3: 26, 9: 545, 6: 3, 2: 98, 4: 1})
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 1
label_counts: defaultdict(<class 'int'>, {4: 630, 7: 199, 1: 507, 2: 18, 5: 47, 0: 18, 3: 3, 6: 2})
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 2
label_counts: defaultdict(<class 'int'>, {0: 190, 5: 157, 7: 312, 9: 99, 6: 67, 8: 6, 2: 3, 3: 30, 4: 11})
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 3
label_counts: defaultdict(<class 'int'>, {6: 100, 3: 171, 8: 190, 9: 19, 4: 51, 2: 395, 0: 3, 5: 4})
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 4
label_counts: defaultdict(<class 'int'>, {5: 553, 0: 327, 1: 428, 2: 202, 4: 5})
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 5
label_counts: defaultdict(<class 'int'>, {4: 421, 6: 633, 2: 58, 3: 41, 8: 45, 1: 100, 7: 11, 5: 13, 0: 1})
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 6
label_counts: defaultdict(<class 'int'>, {4: 260, 9: 425, 8: 384, 3: 24, 1: 12, 2: 6, 6: 31, 7: 1})
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 7
label_counts: defaultdict(<class 'int'>, {9: 477, 8: 645, 6: 335, 7: 16, 3: 38, 5: 13, 4: 53, 0: 36, 1: 11, 2: 7})
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 8
label_counts: defaultdict(<class 'int'>, {4: 502, 9: 102, 0: 124, 6: 63, 2: 81, 8: 26, 5: 17, 3: 9, 1: 3})
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 9
label_counts: defaultdict(<class 'int'>, {3: 943, 2: 177, 1: 139, 0: 75})
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 10
label_counts: defaultdict(<class 'int'>, {8: 445, 4: 883, 2: 57, 0: 32, 3: 12, 5: 19, 7: 1, 6: 1, 1: 1})
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 11
label_counts: defaultdict(<class 'int'>, {6: 147, 4: 230, 8: 220, 9: 88, 3: 44, 1: 58, 5: 54, 2: 13, 7: 8})
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 12
label_counts: defaultdict(<class 'int'>, {6: 248, 3: 165, 1: 263, 9: 14, 0: 206, 5: 101, 7: 1, 4: 1})
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 13
label_counts: defaultdict(<class 'int'>, {3: 402, 2: 795, 4: 7, 7: 197, 0: 11, 5: 3, 1: 7})
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 14
label_counts: defaultdict(<class 'int'>, {9: 218, 0: 312, 3: 131, 4: 21, 5: 65, 1: 57, 2: 44, 8: 3})
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 15
label_counts: defaultdict(<class 'int'>, {6: 980, 5: 215, 3: 12, 1: 39, 0: 83, 4: 2})
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 16
label_counts: defaultdict(<class 'int'>, {4: 58, 3: 83, 0: 140, 1: 860, 5: 68, 8: 280, 6: 18, 7: 1})
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 17
label_counts: defaultdict(<class 'int'>, {8: 642, 5: 490, 0: 104, 4: 28, 3: 30, 2: 16, 7: 1, 6: 21, 1: 2})
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 18
label_counts: defaultdict(<class 'int'>, {8: 391, 1: 105, 2: 1, 4: 108, 7: 229, 3: 33, 5: 27, 6: 2, 0: 1})
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 19
label_counts: defaultdict(<class 'int'>, {1: 364, 0: 1204})
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 20
label_counts: defaultdict(<class 'int'>, {9: 858, 0: 37, 1: 290, 6: 44, 4: 216, 5: 157, 7: 131, 2: 19, 3: 1, 8: 1})
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 21
label_counts: defaultdict(<class 'int'>, {6: 225, 0: 136, 1: 383, 3: 62, 4: 288, 7: 16, 8: 4, 9: 1, 5: 1})
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 22
label_counts: defaultdict(<class 'int'>, {5: 243, 7: 387, 1: 102, 2: 9, 6: 68, 0: 12, 4: 1, 8: 15, 3: 1})
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 23
label_counts: defaultdict(<class 'int'>, {0: 232, 9: 256, 5: 40, 8: 141, 1: 32, 7: 1, 3: 2, 6: 1})
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 24
label_counts: defaultdict(<class 'int'>, {4: 309, 9: 235, 3: 447, 5: 120, 0: 62, 8: 15, 1: 2})
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 25
label_counts: defaultdict(<class 'int'>, {7: 222, 3: 388, 5: 505, 2: 154, 0: 81, 4: 7, 1: 34})
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 26
label_counts: defaultdict(<class 'int'>, {8: 568, 7: 172, 4: 139, 0: 443, 3: 26, 2: 116, 1: 10, 5: 5})
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 27
label_counts: defaultdict(<class 'int'>, {2: 186, 5: 530, 6: 253, 3: 75, 0: 88, 7: 1, 4: 5})
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 28
label_counts: defaultdict(<class 'int'>, {1: 63, 9: 281, 5: 14, 7: 176, 2: 50, 8: 93, 3: 24, 0: 22, 6: 2, 4: 1})
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 29
label_counts: defaultdict(<class 'int'>, {7: 363, 5: 337, 8: 138, 3: 170, 9: 164, 2: 27, 1: 20, 4: 2, 6: 3})
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 30
label_counts: defaultdict(<class 'int'>, {8: 229, 7: 302, 0: 243, 9: 43, 5: 24, 2: 1, 3: 2, 1: 2})
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 31
label_counts: defaultdict(<class 'int'>, {2: 510, 4: 583, 0: 98, 1: 223})
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 32
label_counts: defaultdict(<class 'int'>, {9: 1142, 7: 49, 2: 276, 5: 146, 1: 20, 3: 51, 6: 75, 8: 12, 0: 31, 4: 1})
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 33
label_counts: defaultdict(<class 'int'>, {2: 405, 6: 254, 7: 122, 1: 76, 3: 276, 0: 151, 4: 83})
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 34
label_counts: defaultdict(<class 'int'>, {0: 172, 2: 880, 6: 870, 3: 12, 1: 42, 4: 9})
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 35
label_counts: defaultdict(<class 'int'>, {4: 312, 9: 70, 0: 300, 6: 18, 7: 36, 5: 70, 2: 90, 3: 121, 1: 25, 8: 1})
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 36
label_counts: defaultdict(<class 'int'>, {6: 412, 2: 127, 8: 221, 3: 364, 1: 41, 9: 158, 7: 124, 0: 3, 4: 5})
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 37
label_counts: defaultdict(<class 'int'>, {7: 2178, 3: 1002, 6: 142, 4: 3, 2: 20, 5: 11, 0: 1})
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 38
label_counts: defaultdict(<class 'int'>, {5: 1124, 1: 545, 2: 23, 0: 14, 3: 21, 4: 1})
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 39
label_counts: defaultdict(<class 'int'>, {2: 387, 6: 233, 8: 501, 1: 41, 0: 13, 9: 3, 3: 2, 5: 12, 4: 1, 7: 2})

Join ratio / total clients: 1.0 / 40
Finished creating server and clients.
Trainable_prototypes(
  (embedings): Embedding(10, 512)
  (middle): Sequential(
    (0): Sequential(
      (0): Linear(in_features=512, out_features=512, bias=True)
      (1): ReLU()
    )
  )
  (fc): Linear(in_features=512, out_features=512, bias=True)
)
tobetrained:
[9, 8, 7, 6, 5, 4, 3, 2, 1, 0]
Edge 9 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_10 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_34 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_14 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_27 protos Not Found
Client_14 prev_protos Not Found
Client_10 prev_protos Not Found
Client_34 prev_protos Not Found
Client_27 prev_protos Not Found
Edge 8 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_3 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_31 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_22 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_21 protos Not Found
Client_22 prev_protos Not Found
Client_3 prev_protos Not Found
Client_21 prev_protos Not Found
Client_31 prev_protos Not Found
Edge 7 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_23 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_35 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_6 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_30 protos Not Found
Client_6 prev_protos Not Found
Client_35 prev_protos Not Found
Client_23 prev_protos Not Found
Client_30 prev_protos Not Found
Edge 6 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_4 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_39 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_9 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_8 protos Not Found
Client_4 prev_protos Not Found
Client_39 prev_protos Not Found
Client_9 prev_protos Not Found
Client_8 prev_protos Not Found
Edge 5 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_11 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_32 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_29 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_0 protos Not Found
Client_0 prev_protos Not Found
Client_32 prev_protos Not Found
Client_29 prev_protos Not Found
Client_11 prev_protos Not Found
Edge 4 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_36 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_7 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_1 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_28 protos Not Found
Client_1 prev_protos Not Found
Client_36 prev_protos Not Found
Client_7 prev_protos Not Found
Client_28 prev_protos Not Found
Edge 3 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_37 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_13 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_20 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_18 protos Not Found
Client_20 prev_protos Not Found
Client_13 prev_protos Not Found
Client_18 prev_protos Not Found
Client_37 prev_protos Not Found
Edge 2 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_5 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_25 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_2 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_38 protos Not Found
Client_38 prev_protos Not Found
Client_5 prev_protos Not Found
Client_2 prev_protos Not Found
Client_25 prev_protos Not Found
Edge 1 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_12 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_17 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_33 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_24 protos Not Found
Client_17 prev_protos Not Found
Client_24 prev_protos Not Found
Client_12 prev_protos Not Found
Client_33 prev_protos Not Found
Edge 0 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_26 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_15 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_19 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_16 protos Not Found
Client_19 prev_protos Not Found
Client_16 prev_protos Not Found
Client_15 prev_protos Not Found
Client_26 prev_protos Not Found
readyList:
[7, 1, 5, 2, 6, 8, 0, 4, 9, 3]
aggregation_buffer:
[7, 1, 5, 2, 6, 8, 0, 4, 9, 3]
Edge_0 prev_protos Not Found
Edge_1 prev_protos Not Found
Edge_2 prev_protos Not Found
Edge_3 prev_protos Not Found
Edge_4 prev_protos Not Found
Edge_5 prev_protos Not Found
Edge_6 prev_protos Not Found
Edge_7 prev_protos Not Found
Edge_8 prev_protos Not Found
Edge_9 prev_protos Not Found
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([3.1837, 4.7707, 2.1037, 4.6248, 2.8281, 4.2130, 2.1037, 6.8910, 3.5712,
        6.9715], device='cuda:0')
Server loss: 8.284708976745605
train global classifier
train glclassifier time: 3.6382387951016426
global classifier accuracy: 99.0125
Number of samples: 324
end Update
server_global_time: 1.4473256543278694
only_train_time: 21.779260076582432

-------------Global Round number: 0-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.7592
Averaged Test Accuracy (Prototype Model): 0.6246
Std Test Accuracy (Regular Model): 0.1677
Std Test Accuracy (Prototype Model): 0.2276
tobetrained:
[7, 1, 5, 2, 6, 8, 0, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 5 begin training
Edge 2 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 9, 4, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 9, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([2.6963, 4.1099, 1.7413, 3.2700, 2.0792, 3.9002, 1.7413, 4.5974, 3.3408,
        5.3886], device='cuda:0')
Server loss: 5.358432292938232
train global classifier
train glclassifier time: 3.716139815747738
global classifier accuracy: 99.535
end Update
server_global_time: 4.538846343755722
only_train_time: 68.82665523141623

-------------Global Round number: 1-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.8759
Averaged Test Accuracy (Prototype Model): 0.8455
Std Test Accuracy (Regular Model): 0.0849
Std Test Accuracy (Prototype Model): 0.1000
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 9, 4, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([2.6994, 4.1787, 1.6837, 3.0818, 1.9421, 4.0153, 1.6837, 4.1328, 3.5011,
        5.3489], device='cuda:0')
Server loss: 4.85426139831543
train global classifier
train glclassifier time: 3.734663851559162
global classifier accuracy: 99.6425
end Update
server_global_time: 7.615060374140739
only_train_time: 115.37840677797794

-------------Global Round number: 2-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.8940
Averaged Test Accuracy (Prototype Model): 0.8818
Std Test Accuracy (Regular Model): 0.0757
Std Test Accuracy (Prototype Model): 0.0762
tobetrained:
[7, 6, 1, 8, 0, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 2, 4, 5, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 2, 4, 5, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([2.8158, 4.4628, 1.7574, 3.1575, 2.0576, 4.1731, 1.7574, 4.1731, 3.7795,
        5.5201], device='cuda:0')
Server loss: 4.7087507247924805
train global classifier
train glclassifier time: 3.7194240018725395
global classifier accuracy: 99.85
end Update
server_global_time: 10.729892931878567
only_train_time: 162.54321178793907

-------------Global Round number: 3-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9038
Averaged Test Accuracy (Prototype Model): 0.8931
Std Test Accuracy (Regular Model): 0.0717
Std Test Accuracy (Prototype Model): 0.0746
tobetrained:
[7, 1, 6, 8, 0, 2, 4, 5, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([3.0062, 4.7877, 1.8843, 3.3285, 2.2333, 4.3513, 1.8843, 4.3513, 4.0986,
        5.7484], device='cuda:0')
Server loss: 4.651081085205078
train global classifier
train glclassifier time: 3.6803928688168526
global classifier accuracy: 99.9175
end Update
server_global_time: 13.82815983146429
only_train_time: 208.56054475158453

-------------Global Round number: 4-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9099
Averaged Test Accuracy (Prototype Model): 0.9032
Std Test Accuracy (Regular Model): 0.0628
Std Test Accuracy (Prototype Model): 0.0602
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 0, 5, 4, 9, 2, 3]
aggregation_buffer:
[7, 6, 1, 8, 0, 5, 4, 9, 2, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([3.1960, 5.0917, 2.0188, 3.5233, 2.4102, 4.6031, 2.0188, 4.6031, 4.4018,
        5.9892], device='cuda:0')
Server loss: 4.633944034576416
train global classifier
train glclassifier time: 3.73048634827137
global classifier accuracy: 99.97
end Update
server_global_time: 16.912248916924
only_train_time: 254.76719845086336

-------------Global Round number: 5-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9131
Averaged Test Accuracy (Prototype Model): 0.9044
Std Test Accuracy (Regular Model): 0.0606
Std Test Accuracy (Prototype Model): 0.0611
tobetrained:
[7, 6, 1, 8, 0, 5, 4, 9, 2, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 2 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([3.4018, 5.3882, 2.1901, 3.7399, 2.6041, 4.8761, 2.1901, 4.8761, 4.7153,
        6.2224], device='cuda:0')
Server loss: 4.617279052734375
train global classifier
train glclassifier time: 3.753991574048996
global classifier accuracy: 99.99
end Update
server_global_time: 19.879345200955868
only_train_time: 300.04309839755297

-------------Global Round number: 6-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9102
Averaged Test Accuracy (Prototype Model): 0.9037
Std Test Accuracy (Regular Model): 0.0705
Std Test Accuracy (Prototype Model): 0.0677
tobetrained:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 4, 5, 2, 0, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 4, 5, 2, 0, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([3.5976, 5.6429, 2.3621, 3.9589, 2.8250, 5.1359, 2.3621, 5.1359, 5.0045,
        6.4346], device='cuda:0')
Server loss: 4.603644371032715
train global classifier
train glclassifier time: 3.6588952988386154
global classifier accuracy: 99.995
end Update
server_global_time: 22.98184298723936
only_train_time: 345.7812564969063

-------------Global Round number: 7-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9202
Averaged Test Accuracy (Prototype Model): 0.9115
Std Test Accuracy (Regular Model): 0.0537
Std Test Accuracy (Prototype Model): 0.0564
tobetrained:
[7, 6, 1, 8, 4, 5, 2, 0, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 4 begin training
Edge 5 begin training
Edge 2 begin training
Edge 0 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([3.7798, 5.8538, 2.5387, 4.1593, 3.0144, 5.3857, 2.5387, 5.3857, 5.2498,
        6.6501], device='cuda:0')
Server loss: 4.614232540130615
train global classifier
train glclassifier time: 3.720764644443989
global classifier accuracy: 100.0
end Update
server_global_time: 26.041453048586845
only_train_time: 391.6533602401614

-------------Global Round number: 8-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9157
Averaged Test Accuracy (Prototype Model): 0.9088
Std Test Accuracy (Regular Model): 0.0622
Std Test Accuracy (Prototype Model): 0.0627
tobetrained:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([3.9342, 6.0722, 2.6728, 4.3429, 3.1917, 5.6116, 2.6728, 5.6116, 5.4717,
        6.8497], device='cuda:0')
Server loss: 4.616369724273682
train global classifier
train glclassifier time: 3.745220258831978
global classifier accuracy: 100.0
end Update
server_global_time: 29.128474093973637
only_train_time: 438.0667044594884

-------------Global Round number: 9-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9237
Averaged Test Accuracy (Prototype Model): 0.9172
Std Test Accuracy (Regular Model): 0.0499
Std Test Accuracy (Prototype Model): 0.0529
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 5, 4, 9, 2, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 5, 4, 9, 2, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([4.1200, 6.2544, 2.8909, 4.5803, 3.3827, 5.8214, 2.8909, 5.8214, 5.7120,
        7.0363], device='cuda:0')
Server loss: 4.620408058166504
train global classifier
train glclassifier time: 3.756757512688637
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 32.202922612428665
only_train_time: 486.625600323081

-------------Global Round number: 10-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9242
Averaged Test Accuracy (Prototype Model): 0.9177
Std Test Accuracy (Regular Model): 0.0488
Std Test Accuracy (Prototype Model): 0.0524
tobetrained:
[7, 1, 6, 8, 0, 5, 4, 9, 2, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 2 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 5, 4, 9, 2, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 5, 4, 9, 2, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([4.2927, 6.4487, 3.1282, 4.7971, 3.6022, 6.0199, 3.1282, 6.0199, 5.9601,
        7.2216], device='cuda:0')
Server loss: 4.60850715637207
train global classifier
train glclassifier time: 3.696931414306164
global classifier accuracy: 100.0
end Update
server_global_time: 36.098876908421516
only_train_time: 535.2353790402412

-------------Global Round number: 11-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9208
Averaged Test Accuracy (Prototype Model): 0.9168
Std Test Accuracy (Regular Model): 0.0599
Std Test Accuracy (Prototype Model): 0.0594
tobetrained:
[7, 1, 6, 8, 0, 5, 4, 9, 2, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 2 begin training
Edge 3 begin training
readyList:
[7, 6, 8, 1, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 8, 1, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([4.4899, 6.6187, 3.3527, 5.0231, 3.8096, 6.1915, 3.3527, 6.1915, 6.2047,
        7.3913], device='cuda:0')
Server loss: 4.599883556365967
train global classifier
train glclassifier time: 4.1008263900876045
global classifier accuracy: 100.0
end Update
server_global_time: 39.22329410165548
only_train_time: 581.3969740569592

-------------Global Round number: 12-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9255
Averaged Test Accuracy (Prototype Model): 0.9220
Std Test Accuracy (Regular Model): 0.0482
Std Test Accuracy (Prototype Model): 0.0499
tobetrained:
[7, 6, 8, 1, 0, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 8 begin training
Edge 1 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 4, 5, 0, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 4, 5, 0, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([4.6648, 6.7688, 3.5645, 5.2379, 4.0329, 6.3708, 3.5645, 6.3708, 6.4093,
        7.5615], device='cuda:0')
Server loss: 4.597079277038574
train global classifier
train glclassifier time: 3.6368174701929092
global classifier accuracy: 100.0
end Update
server_global_time: 42.26756604760885
only_train_time: 627.3287678137422

-------------Global Round number: 13-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9261
Averaged Test Accuracy (Prototype Model): 0.9228
Std Test Accuracy (Regular Model): 0.0471
Std Test Accuracy (Prototype Model): 0.0496
tobetrained:
[7, 1, 6, 8, 2, 4, 5, 0, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 0 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([4.8043, 6.8761, 3.7518, 5.4255, 4.2262, 6.5294, 3.7518, 6.5294, 6.6011,
        7.7104], device='cuda:0')
Server loss: 4.58956241607666
train global classifier
train glclassifier time: 3.825868807733059
global classifier accuracy: 100.0
end Update
server_global_time: 45.38382637500763
only_train_time: 673.3516646921635

-------------Global Round number: 14-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9264
Averaged Test Accuracy (Prototype Model): 0.9233
Std Test Accuracy (Regular Model): 0.0477
Std Test Accuracy (Prototype Model): 0.0487
tobetrained:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 4, 5, 2, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 4, 5, 2, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([4.9557, 6.9992, 3.9270, 5.6106, 4.4202, 6.6689, 3.9270, 6.6689, 6.7889,
        7.8377], device='cuda:0')
Server loss: 4.567653656005859
train global classifier
train glclassifier time: 3.585532158613205
global classifier accuracy: 100.0
end Update
server_global_time: 48.452154725790024
only_train_time: 719.3846812620759

-------------Global Round number: 15-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9250
Averaged Test Accuracy (Prototype Model): 0.9226
Std Test Accuracy (Regular Model): 0.0518
Std Test Accuracy (Prototype Model): 0.0512
tobetrained:
[7, 1, 6, 8, 0, 4, 5, 2, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 4 begin training
Edge 5 begin training
Edge 2 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 5, 0, 2, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 5, 0, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([5.1070, 7.1182, 4.1019, 5.7745, 4.6134, 6.8134, 4.1019, 6.8134, 6.9596,
        7.9816], device='cuda:0')
Server loss: 4.566965103149414
train global classifier
train glclassifier time: 3.6779695972800255
global classifier accuracy: 100.0
end Update
server_global_time: 51.582332976162434
only_train_time: 764.4270074367523

-------------Global Round number: 16-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9266
Averaged Test Accuracy (Prototype Model): 0.9247
Std Test Accuracy (Regular Model): 0.0485
Std Test Accuracy (Prototype Model): 0.0477
tobetrained:
[7, 1, 6, 8, 5, 0, 2, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 5 begin training
Edge 0 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([5.2603, 7.2329, 4.2930, 5.9187, 4.8084, 6.9432, 4.2930, 6.9432, 7.1439,
        8.1154], device='cuda:0')
Server loss: 4.550008296966553
train global classifier
train glclassifier time: 3.7263205647468567
global classifier accuracy: 100.0
end Update
server_global_time: 54.67876049876213
only_train_time: 810.5855958163738

-------------Global Round number: 17-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9286
Averaged Test Accuracy (Prototype Model): 0.9257
Std Test Accuracy (Regular Model): 0.0454
Std Test Accuracy (Prototype Model): 0.0465
tobetrained:
[7, 6, 1, 8, 0, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 4, 2, 0, 5, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 4, 2, 0, 5, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([5.4059, 7.3337, 4.4768, 6.0508, 4.9890, 7.0679, 4.4768, 7.0679, 7.2999,
        8.2386], device='cuda:0')
Server loss: 4.534860134124756
train global classifier
train glclassifier time: 3.8990062847733498
global classifier accuracy: 100.0
end Update
server_global_time: 57.50014163553715
only_train_time: 855.6416214704514

-------------Global Round number: 18-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9281
Averaged Test Accuracy (Prototype Model): 0.9261
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0473
tobetrained:
[7, 1, 6, 8, 4, 2, 0, 5, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 4 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([5.5491, 7.4305, 4.6389, 6.1770, 5.1569, 7.1780, 4.6389, 7.1780, 7.4502,
        8.3488], device='cuda:0')
Server loss: 4.5172038078308105
train global classifier
train glclassifier time: 3.7739262133836746
global classifier accuracy: 100.0
end Update
server_global_time: 60.54656641930342
only_train_time: 901.749916523695

-------------Global Round number: 19-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9289
Averaged Test Accuracy (Prototype Model): 0.9266
Std Test Accuracy (Regular Model): 0.0457
Std Test Accuracy (Prototype Model): 0.0464
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 8, 6, 5, 0, 2, 4, 9, 3]
aggregation_buffer:
[7, 1, 8, 6, 5, 0, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([5.6749, 7.5168, 4.7921, 6.2880, 5.3093, 7.2942, 4.7921, 7.2942, 7.5856,
        8.4635], device='cuda:0')
Server loss: 4.511648178100586
train global classifier
train glclassifier time: 3.7334965243935585
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 63.610427126288414
only_train_time: 947.9324130341411

-------------Global Round number: 20-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9291
Averaged Test Accuracy (Prototype Model): 0.9270
Std Test Accuracy (Regular Model): 0.0461
Std Test Accuracy (Prototype Model): 0.0465
tobetrained:
[7, 1, 8, 6, 5, 0, 2, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 8 begin training
Edge 6 begin training
Edge 5 begin training
Edge 0 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 4, 5, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 4, 5, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([5.8032, 7.6030, 4.9600, 6.3929, 5.4642, 7.4053, 4.9600, 7.4053, 7.7077,
        8.5619], device='cuda:0')
Server loss: 4.4939141273498535
train global classifier
train glclassifier time: 4.743077673017979
global classifier accuracy: 100.0
end Update
server_global_time: 66.71562974900007
only_train_time: 994.6369206160307

-------------Global Round number: 21-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9284
Averaged Test Accuracy (Prototype Model): 0.9270
Std Test Accuracy (Regular Model): 0.0468
Std Test Accuracy (Prototype Model): 0.0473
tobetrained:
[7, 6, 1, 8, 2, 0, 4, 5, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[1, 6, 7, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[1, 6, 7, 8, 2, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([5.9110, 7.6844, 5.0497, 6.4996, 5.5929, 7.5092, 5.0497, 7.5092, 7.8484,
        8.6592], device='cuda:0')
Server loss: 4.484742164611816
train global classifier
train glclassifier time: 4.4009896367788315
global classifier accuracy: 100.0
end Update
server_global_time: 69.77391467243433
only_train_time: 1041.5822893977165

-------------Global Round number: 22-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9293
Averaged Test Accuracy (Prototype Model): 0.9275
Std Test Accuracy (Regular Model): 0.0461
Std Test Accuracy (Prototype Model): 0.0461
tobetrained:
[1, 6, 7, 8, 2, 5, 0, 4, 9, 3]
Edge 1 begin training
Edge 6 begin training
Edge 7 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([6.0320, 7.7620, 5.2195, 6.5999, 5.7376, 7.5990, 5.2195, 7.5990, 7.9538,
        8.7527], device='cuda:0')
Server loss: 4.464816093444824
train global classifier
train glclassifier time: 3.747179299592972
global classifier accuracy: 100.0
end Update
server_global_time: 72.84049486368895
only_train_time: 1087.9001039266586

-------------Global Round number: 23-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9291
Averaged Test Accuracy (Prototype Model): 0.9278
Std Test Accuracy (Regular Model): 0.0462
Std Test Accuracy (Prototype Model): 0.0461
tobetrained:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 0, 2, 5, 8, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 0, 2, 5, 8, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([6.1403, 7.8330, 5.3672, 6.6889, 5.8672, 7.6907, 5.3672, 7.6907, 8.0553,
        8.8443], device='cuda:0')
Server loss: 4.454118251800537
train global classifier
train glclassifier time: 3.691077895462513
global classifier accuracy: 100.0
end Update
server_global_time: 75.96191424876451
only_train_time: 1134.3205497190356

-------------Global Round number: 24-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9296
Averaged Test Accuracy (Prototype Model): 0.9276
Std Test Accuracy (Regular Model): 0.0461
Std Test Accuracy (Prototype Model): 0.0460
tobetrained:
[7, 6, 1, 0, 2, 5, 8, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 8 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([6.2448, 7.9049, 5.5053, 6.7801, 5.9967, 7.7801, 5.5053, 7.7801, 8.1506,
        8.9351], device='cuda:0')
Server loss: 4.447064399719238
train global classifier
train glclassifier time: 4.060219846665859
global classifier accuracy: 100.0
end Update
server_global_time: 79.02454912662506
only_train_time: 1180.6975315585732

-------------Global Round number: 25-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9293
Averaged Test Accuracy (Prototype Model): 0.9277
Std Test Accuracy (Regular Model): 0.0460
Std Test Accuracy (Prototype Model): 0.0461
tobetrained:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([6.3432, 7.9808, 5.6349, 6.8601, 6.1164, 7.8692, 5.6349, 7.8692, 8.2375,
        9.0207], device='cuda:0')
Server loss: 4.439452648162842
train global classifier
train glclassifier time: 3.7560922279953957
global classifier accuracy: 100.0
end Update
server_global_time: 82.07503125816584
only_train_time: 1225.6887829229236

-------------Global Round number: 26-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9297
Averaged Test Accuracy (Prototype Model): 0.9285
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0457
tobetrained:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([6.4350, 8.0479, 5.7535, 6.9438, 6.2178, 7.9552, 5.7535, 7.9552, 8.3249,
        9.0998], device='cuda:0')
Server loss: 4.430653095245361
train global classifier
train glclassifier time: 4.250981278717518
global classifier accuracy: 100.0
end Update
server_global_time: 85.26330355554819
only_train_time: 1272.803600974381

-------------Global Round number: 27-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9299
Averaged Test Accuracy (Prototype Model): 0.9286
Std Test Accuracy (Regular Model): 0.0462
Std Test Accuracy (Prototype Model): 0.0459
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 2, 8, 4, 0, 9, 5, 3]
aggregation_buffer:
[7, 1, 6, 2, 8, 4, 0, 9, 5, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([6.5212, 8.1152, 5.8647, 7.0248, 6.3125, 8.0324, 5.8647, 8.0324, 8.3995,
        9.1808], device='cuda:0')
Server loss: 4.427691459655762
train global classifier
train glclassifier time: 3.696507729589939
global classifier accuracy: 100.0
end Update
server_global_time: 88.16789094358683
only_train_time: 1319.6240569800138

-------------Global Round number: 28-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9301
Averaged Test Accuracy (Prototype Model): 0.9291
Std Test Accuracy (Regular Model): 0.0461
Std Test Accuracy (Prototype Model): 0.0458
tobetrained:
[7, 1, 6, 2, 8, 4, 0, 9, 5, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 2 begin training
Edge 8 begin training
Edge 4 begin training
Edge 0 begin training
Edge 9 begin training
Edge 5 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 0, 2, 4, 9, 5, 3]
aggregation_buffer:
[7, 6, 1, 8, 0, 2, 4, 9, 5, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([6.5999, 8.1835, 5.9653, 7.1044, 6.3999, 8.1120, 5.9653, 8.1120, 8.4765,
        9.2558], device='cuda:0')
Server loss: 4.419104099273682
train global classifier
train glclassifier time: 3.6224051490426064
global classifier accuracy: 100.0
end Update
server_global_time: 91.18616343289614
only_train_time: 1366.3902398347855

-------------Global Round number: 29-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9303
Averaged Test Accuracy (Prototype Model): 0.9295
Std Test Accuracy (Regular Model): 0.0459
Std Test Accuracy (Prototype Model): 0.0458
tobetrained:
[7, 6, 1, 8, 0, 2, 4, 9, 5, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 5 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([6.6778, 8.2491, 6.0671, 7.1743, 6.4907, 8.1928, 6.0671, 8.1928, 8.5492,
        9.3259], device='cuda:0')
Server loss: 4.408807754516602
train global classifier
train glclassifier time: 4.299255460500717
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 94.20502077788115
only_train_time: 1411.7781316414475

-------------Global Round number: 30-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9309
Averaged Test Accuracy (Prototype Model): 0.9295
Std Test Accuracy (Regular Model): 0.0454
Std Test Accuracy (Prototype Model): 0.0457
tobetrained:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 4, 9, 5, 0, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 4, 9, 5, 0, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([6.7545, 8.3131, 6.1597, 7.2458, 6.5710, 8.2680, 6.1597, 8.2680, 8.6234,
        9.3912], device='cuda:0')
Server loss: 4.397007942199707
train global classifier
train glclassifier time: 4.68815478682518
global classifier accuracy: 100.0
end Update
server_global_time: 97.27840632945299
only_train_time: 1459.4823011755943

-------------Global Round number: 31-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9309
Averaged Test Accuracy (Prototype Model): 0.9298
Std Test Accuracy (Regular Model): 0.0452
Std Test Accuracy (Prototype Model): 0.0452
tobetrained:
[7, 6, 1, 8, 2, 4, 9, 5, 0, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 5 begin training
Edge 0 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 5, 2, 0, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 5, 2, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([6.8213, 8.3772, 6.2437, 7.3104, 6.6504, 8.3358, 6.2437, 8.3358, 8.6951,
        9.4627], device='cuda:0')
Server loss: 4.394405841827393
train global classifier
train glclassifier time: 4.703415393829346
global classifier accuracy: 100.0
end Update
server_global_time: 100.34235789626837
only_train_time: 1505.1552942171693

-------------Global Round number: 32-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9306
Averaged Test Accuracy (Prototype Model): 0.9297
Std Test Accuracy (Regular Model): 0.0456
Std Test Accuracy (Prototype Model): 0.0454
tobetrained:
[7, 6, 1, 8, 5, 2, 0, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 5 begin training
Edge 2 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 4, 0, 5, 8, 9, 2, 3]
aggregation_buffer:
[7, 6, 1, 4, 0, 5, 8, 9, 2, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([6.8825, 8.4304, 6.3290, 7.3702, 6.7310, 8.4050, 6.3290, 8.4050, 8.7711,
        9.5307], device='cuda:0')
Server loss: 4.389913082122803
train global classifier
train glclassifier time: 3.6753112003207207
global classifier accuracy: 100.0
end Update
server_global_time: 103.43879263103008
only_train_time: 1554.642729356885

-------------Global Round number: 33-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9308
Averaged Test Accuracy (Prototype Model): 0.9297
Std Test Accuracy (Regular Model): 0.0455
Std Test Accuracy (Prototype Model): 0.0451
tobetrained:
[7, 6, 1, 4, 0, 5, 8, 9, 2, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 4 begin training
Edge 0 begin training
Edge 5 begin training
Edge 8 begin training
Edge 9 begin training
Edge 2 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([6.9477, 8.4833, 6.4107, 7.4330, 6.8040, 8.4742, 6.4107, 8.4742, 8.8369,
        9.5965], device='cuda:0')
Server loss: 4.387063503265381
train global classifier
train glclassifier time: 3.703155606985092
global classifier accuracy: 100.0
end Update
server_global_time: 106.46271063387394
only_train_time: 1600.0167941972613

-------------Global Round number: 34-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9308
Averaged Test Accuracy (Prototype Model): 0.9297
Std Test Accuracy (Regular Model): 0.0454
Std Test Accuracy (Prototype Model): 0.0452
tobetrained:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([7.0107, 8.5297, 6.4929, 7.4852, 6.8800, 8.5333, 6.4929, 8.5333, 8.9087,
        9.6603], device='cuda:0')
Server loss: 4.3833160400390625
train global classifier
train glclassifier time: 3.6363008320331573
global classifier accuracy: 100.0
end Update
server_global_time: 109.45151872932911
only_train_time: 1645.2502319142222

-------------Global Round number: 35-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9307
Averaged Test Accuracy (Prototype Model): 0.9299
Std Test Accuracy (Regular Model): 0.0454
Std Test Accuracy (Prototype Model): 0.0451
tobetrained:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 8, 0, 2, 5, 9, 4, 6, 3]
aggregation_buffer:
[7, 1, 8, 0, 2, 5, 9, 4, 6, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([7.0687, 8.5817, 6.5643, 7.5425, 6.9517, 8.5950, 6.5643, 8.5950, 8.9766,
        9.7221], device='cuda:0')
Server loss: 4.378923416137695
train global classifier
train glclassifier time: 4.252178490161896
global classifier accuracy: 100.0
end Update
server_global_time: 112.43162548542023
only_train_time: 1690.9835145771503

-------------Global Round number: 36-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9309
Averaged Test Accuracy (Prototype Model): 0.9302
Std Test Accuracy (Regular Model): 0.0454
Std Test Accuracy (Prototype Model): 0.0450
tobetrained:
[7, 1, 8, 0, 2, 5, 9, 4, 6, 3]
Edge 7 begin training
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
readyList:
[6, 7, 1, 2, 0, 5, 4, 8, 9, 3]
aggregation_buffer:
[6, 7, 1, 2, 0, 5, 4, 8, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([7.1284, 8.6299, 6.6347, 7.5936, 7.0176, 8.6582, 6.6347, 8.6582, 9.0474,
        9.7865], device='cuda:0')
Server loss: 4.37942361831665
train global classifier
train glclassifier time: 4.26971335709095
global classifier accuracy: 100.0
end Update
server_global_time: 115.46376432478428
only_train_time: 1737.830280996859

-------------Global Round number: 37-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9311
Averaged Test Accuracy (Prototype Model): 0.9300
Std Test Accuracy (Regular Model): 0.0454
Std Test Accuracy (Prototype Model): 0.0451
tobetrained:
[6, 7, 1, 2, 0, 5, 4, 8, 9, 3]
Edge 6 begin training
Edge 7 begin training
Edge 1 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 8 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([7.1864, 8.6796, 6.7004, 7.6497, 7.0867, 8.7207, 6.7004, 8.7207, 9.1175,
        9.8469], device='cuda:0')
Server loss: 4.3771820068359375
train global classifier
train glclassifier time: 3.671103283762932
global classifier accuracy: 100.0
end Update
server_global_time: 118.40556724369526
only_train_time: 1783.31810285151

-------------Global Round number: 38-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9311
Averaged Test Accuracy (Prototype Model): 0.9301
Std Test Accuracy (Regular Model): 0.0453
Std Test Accuracy (Prototype Model): 0.0454
tobetrained:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 8, 1, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 8, 1, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([7.2458, 8.7295, 6.7709, 7.6990, 7.1532, 8.7773, 6.7709, 8.7773, 9.1815,
        9.9025], device='cuda:0')
Server loss: 4.372220039367676
train global classifier
train glclassifier time: 3.733592838048935
global classifier accuracy: 100.0
end Update
server_global_time: 121.48475594818592
only_train_time: 1829.1517918333411

-------------Global Round number: 39-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9311
Averaged Test Accuracy (Prototype Model): 0.9303
Std Test Accuracy (Regular Model): 0.0453
Std Test Accuracy (Prototype Model): 0.0454
tobetrained:
[7, 6, 8, 1, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 8 begin training
Edge 1 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 4, 5, 0, 2, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 4, 5, 0, 2, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([7.2983, 8.7811, 6.8352, 7.7489, 7.2153, 8.8333, 6.8352, 8.8333, 9.2436,
        9.9609], device='cuda:0')
Server loss: 4.37080717086792
train global classifier
train glclassifier time: 3.756843641400337
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 124.51798451691866
only_train_time: 1874.0428071916103

-------------Global Round number: 40-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9311
Averaged Test Accuracy (Prototype Model): 0.9302
Std Test Accuracy (Regular Model): 0.0455
Std Test Accuracy (Prototype Model): 0.0458
tobetrained:
[7, 6, 1, 8, 4, 5, 0, 2, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 4 begin training
Edge 5 begin training
Edge 0 begin training
Edge 2 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.3554,  8.8254,  6.8977,  7.8035,  7.2767,  8.8911,  6.8977,  8.8911,
         9.3011, 10.0213], device='cuda:0')
Server loss: 4.372844219207764
train global classifier
train glclassifier time: 3.701467491686344
global classifier accuracy: 100.0
end Update
server_global_time: 127.58940175175667
only_train_time: 1920.19224575907

-------------Global Round number: 41-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9310
Averaged Test Accuracy (Prototype Model): 0.9303
Std Test Accuracy (Regular Model): 0.0458
Std Test Accuracy (Prototype Model): 0.0455
tobetrained:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 5, 4, 2, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 5, 4, 2, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.4089,  8.8704,  6.9564,  7.8539,  7.3315,  8.9450,  6.9564,  8.9450,
         9.3639, 10.0752], device='cuda:0')
Server loss: 4.3691086769104
train global classifier
train glclassifier time: 3.6962186694145203
global classifier accuracy: 100.0
end Update
server_global_time: 131.48786973953247
only_train_time: 1968.9495613723993

-------------Global Round number: 42-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9312
Averaged Test Accuracy (Prototype Model): 0.9303
Std Test Accuracy (Regular Model): 0.0454
Std Test Accuracy (Prototype Model): 0.0456
tobetrained:
[7, 1, 6, 8, 0, 5, 4, 2, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 2 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 5, 0, 4, 9, 2, 3]
aggregation_buffer:
[7, 1, 6, 8, 5, 0, 4, 9, 2, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.4611,  8.9166,  7.0177,  7.8967,  7.3931,  9.0017,  7.0177,  9.0017,
         9.4231, 10.1309], device='cuda:0')
Server loss: 4.3685526847839355
train global classifier
train glclassifier time: 3.6639504581689835
global classifier accuracy: 100.0
end Update
server_global_time: 134.50826021283865
only_train_time: 2015.9322924241424

-------------Global Round number: 43-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9309
Averaged Test Accuracy (Prototype Model): 0.9303
Std Test Accuracy (Regular Model): 0.0457
Std Test Accuracy (Prototype Model): 0.0456
tobetrained:
[7, 1, 6, 8, 5, 0, 4, 9, 2, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 2 begin training
Edge 3 begin training
readyList:
[1, 6, 7, 8, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[1, 6, 7, 8, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.5091,  8.9615,  7.0748,  7.9460,  7.4493,  9.0608,  7.0748,  9.0608,
         9.4752, 10.1888], device='cuda:0')
Server loss: 4.370345592498779
train global classifier
train glclassifier time: 3.7402115240693092
global classifier accuracy: 100.0
end Update
server_global_time: 137.53272304683924
only_train_time: 2061.822697877884

-------------Global Round number: 44-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9311
Averaged Test Accuracy (Prototype Model): 0.9303
Std Test Accuracy (Regular Model): 0.0458
Std Test Accuracy (Prototype Model): 0.0454
tobetrained:
[1, 6, 7, 8, 0, 2, 5, 4, 9, 3]
Edge 1 begin training
Edge 6 begin training
Edge 7 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 4, 5, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 4, 5, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.5598,  9.0062,  7.1289,  7.9945,  7.5037,  9.1198,  7.1289,  9.1198,
         9.5366, 10.2374], device='cuda:0')
Server loss: 4.3647003173828125
train global classifier
train glclassifier time: 3.8469522297382355
global classifier accuracy: 100.0
end Update
server_global_time: 140.61937984079123
only_train_time: 2108.3478200882673

-------------Global Round number: 45-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9311
Averaged Test Accuracy (Prototype Model): 0.9304
Std Test Accuracy (Regular Model): 0.0461
Std Test Accuracy (Prototype Model): 0.0453
tobetrained:
[7, 6, 1, 8, 2, 0, 4, 5, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 9, 4, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 9, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.6105,  9.0534,  7.1841,  8.0401,  7.5595,  9.1760,  7.1841,  9.1760,
         9.5884, 10.2925], device='cuda:0')
Server loss: 4.365306377410889
train global classifier
train glclassifier time: 3.7083616703748703
global classifier accuracy: 100.0
end Update
server_global_time: 143.78093657642603
only_train_time: 2156.6546539217234

-------------Global Round number: 46-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9310
Averaged Test Accuracy (Prototype Model): 0.9305
Std Test Accuracy (Regular Model): 0.0461
Std Test Accuracy (Prototype Model): 0.0451
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 9, 4, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 5, 0, 2, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 5, 0, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.6619,  9.0948,  7.2392,  8.0895,  7.6146,  9.2295,  7.2392,  9.2295,
         9.6426, 10.3399], device='cuda:0')
Server loss: 4.359302043914795
train global classifier
train glclassifier time: 3.9802363738417625
global classifier accuracy: 100.0
end Update
server_global_time: 146.8132939040661
only_train_time: 2202.952197380364

-------------Global Round number: 47-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9311
Averaged Test Accuracy (Prototype Model): 0.9305
Std Test Accuracy (Regular Model): 0.0461
Std Test Accuracy (Prototype Model): 0.0452
tobetrained:
[7, 1, 6, 8, 5, 0, 2, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 5 begin training
Edge 0 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 4, 0, 5, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 4, 0, 5, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.7124,  9.1373,  7.2893,  8.1318,  7.6700,  9.2838,  7.2893,  9.2838,
         9.6899, 10.3911], device='cuda:0')
Server loss: 4.3580851554870605
train global classifier
train glclassifier time: 4.79955330491066
global classifier accuracy: 100.0
end Update
server_global_time: 149.83154141902924
only_train_time: 2248.737689860165

-------------Global Round number: 48-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9313
Averaged Test Accuracy (Prototype Model): 0.9306
Std Test Accuracy (Regular Model): 0.0461
Std Test Accuracy (Prototype Model): 0.0451
tobetrained:
[7, 1, 6, 8, 2, 4, 0, 5, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 4 begin training
Edge 0 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 8, 2, 0, 4, 1, 5, 6, 9, 3]
aggregation_buffer:
[7, 8, 2, 0, 4, 1, 5, 6, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.7608,  9.1813,  7.3426,  8.1736,  7.7251,  9.3370,  7.3426,  9.3370,
         9.7395, 10.4384], device='cuda:0')
Server loss: 4.352860450744629
train global classifier
train glclassifier time: 4.206317499279976
global classifier accuracy: 100.0
end Update
server_global_time: 153.23331629484892
only_train_time: 2297.5401099845767

-------------Global Round number: 49-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9313
Averaged Test Accuracy (Prototype Model): 0.9308
Std Test Accuracy (Regular Model): 0.0459
Std Test Accuracy (Prototype Model): 0.0450
tobetrained:
[7, 8, 2, 0, 4, 1, 5, 6, 9, 3]
Edge 7 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 4 begin training
Edge 1 begin training
Edge 5 begin training
Edge 6 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.8072,  9.2251,  7.3923,  8.2212,  7.7725,  9.3872,  7.3923,  9.3872,
         9.7875, 10.4913], device='cuda:0')
Server loss: 4.354715824127197
train global classifier
train glclassifier time: 3.764835089445114
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 156.32467180490494
only_train_time: 2344.3044436350465

-------------Global Round number: 50-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9313
Averaged Test Accuracy (Prototype Model): 0.9310
Std Test Accuracy (Regular Model): 0.0459
Std Test Accuracy (Prototype Model): 0.0449
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.8541,  9.2685,  7.4431,  8.2660,  7.8265,  9.4376,  7.4431,  9.4376,
         9.8383, 10.5399], device='cuda:0')
Server loss: 4.352334976196289
train global classifier
train glclassifier time: 4.160573735833168
global classifier accuracy: 100.0
end Update
server_global_time: 159.36960934102535
only_train_time: 2390.651446841657

-------------Global Round number: 51-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9313
Averaged Test Accuracy (Prototype Model): 0.9309
Std Test Accuracy (Regular Model): 0.0456
Std Test Accuracy (Prototype Model): 0.0449
tobetrained:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 5, 4, 2, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 5, 4, 2, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.8987,  9.3107,  7.4883,  8.3149,  7.8732,  9.4894,  7.4883,  9.4894,
         9.8840, 10.5850], device='cuda:0')
Server loss: 4.3486785888671875
train global classifier
train glclassifier time: 3.7601369470357895
global classifier accuracy: 100.0
end Update
server_global_time: 162.3945905417204
only_train_time: 2436.9474291577935

-------------Global Round number: 52-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9314
Averaged Test Accuracy (Prototype Model): 0.9309
Std Test Accuracy (Regular Model): 0.0456
Std Test Accuracy (Prototype Model): 0.0449
tobetrained:
[7, 1, 6, 8, 0, 5, 4, 2, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 2 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 5, 4, 2, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 5, 4, 2, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.9454,  9.3501,  7.5421,  8.3551,  7.9260,  9.5394,  7.5421,  9.5394,
         9.9300, 10.6316], device='cuda:0')
Server loss: 4.346092224121094
train global classifier
train glclassifier time: 3.5400897338986397
global classifier accuracy: 100.0
end Update
server_global_time: 165.55938554555178
only_train_time: 2485.212316863239

-------------Global Round number: 53-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9315
Averaged Test Accuracy (Prototype Model): 0.9311
Std Test Accuracy (Regular Model): 0.0457
Std Test Accuracy (Prototype Model): 0.0446
tobetrained:
[7, 1, 6, 8, 0, 5, 4, 2, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 2 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.9903,  9.3910,  7.5929,  8.3950,  7.9775,  9.5847,  7.5929,  9.5847,
         9.9749, 10.6776], device='cuda:0')
Server loss: 4.344354629516602
train global classifier
train glclassifier time: 3.641617961227894
global classifier accuracy: 100.0
end Update
server_global_time: 169.27051016688347
only_train_time: 2531.3127716332674

-------------Global Round number: 54-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9315
Averaged Test Accuracy (Prototype Model): 0.9311
Std Test Accuracy (Regular Model): 0.0456
Std Test Accuracy (Prototype Model): 0.0447
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 8, 6, 1, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 8, 6, 1, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.0348,  9.4404,  7.6343,  8.4417,  8.0240,  9.6331,  7.6343,  9.6331,
        10.0295, 10.7221], device='cuda:0')
Server loss: 4.340992450714111
train global classifier
train glclassifier time: 3.819320447742939
global classifier accuracy: 100.0
end Update
server_global_time: 172.3413493782282
only_train_time: 2577.2454950660467

-------------Global Round number: 55-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9315
Averaged Test Accuracy (Prototype Model): 0.9313
Std Test Accuracy (Regular Model): 0.0455
Std Test Accuracy (Prototype Model): 0.0445
tobetrained:
[7, 8, 6, 1, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 8 begin training
Edge 6 begin training
Edge 1 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 8, 1, 0, 5, 9, 4, 2, 3]
aggregation_buffer:
[7, 6, 8, 1, 0, 5, 9, 4, 2, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.0770,  9.4809,  7.6812,  8.4848,  8.0762,  9.6782,  7.6812,  9.6782,
        10.0721, 10.7687], device='cuda:0')
Server loss: 4.339905738830566
train global classifier
train glclassifier time: 3.645603008568287
global classifier accuracy: 100.0
end Update
server_global_time: 175.39203875511885
only_train_time: 2624.295838482678

-------------Global Round number: 56-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9313
Averaged Test Accuracy (Prototype Model): 0.9312
Std Test Accuracy (Regular Model): 0.0458
Std Test Accuracy (Prototype Model): 0.0446
tobetrained:
[7, 6, 8, 1, 0, 5, 9, 4, 2, 3]
Edge 7 begin training
Edge 6 begin training
Edge 8 begin training
Edge 1 begin training
Edge 0 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 2 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.1239,  9.5204,  7.7317,  8.5212,  8.1230,  9.7247,  7.7317,  9.7287,
        10.1182, 10.8191], device='cuda:0')
Server loss: 4.3428192138671875
train global classifier
train glclassifier time: 3.692554533481598
global classifier accuracy: 100.0
end Update
server_global_time: 178.46852826327085
only_train_time: 2671.3093522638083

-------------Global Round number: 57-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9316
Averaged Test Accuracy (Prototype Model): 0.9312
Std Test Accuracy (Regular Model): 0.0455
Std Test Accuracy (Prototype Model): 0.0446
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 9, 4, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 9, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.1679,  9.5569,  7.7812,  8.5555,  8.1732,  9.7606,  7.7812,  9.7749,
        10.1623, 10.8665], device='cuda:0')
Server loss: 4.34322452545166
train global classifier
train glclassifier time: 3.679827205836773
global classifier accuracy: 100.0
end Update
server_global_time: 181.53839518129826
only_train_time: 2717.067946098745

-------------Global Round number: 58-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9314
Averaged Test Accuracy (Prototype Model): 0.9313
Std Test Accuracy (Regular Model): 0.0457
Std Test Accuracy (Prototype Model): 0.0445
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 9, 4, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 4, 2, 5, 0, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 4, 2, 5, 0, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.2081,  9.5974,  7.8266,  8.5941,  8.2179,  9.7985,  7.8266,  9.8294,
        10.2083, 10.9078], device='cuda:0')
Server loss: 4.338000774383545
train global classifier
train glclassifier time: 3.7916475608944893
global classifier accuracy: 100.0
end Update
server_global_time: 184.63099418580532
only_train_time: 2763.8575549572706

-------------Global Round number: 59-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9316
Averaged Test Accuracy (Prototype Model): 0.9312
Std Test Accuracy (Regular Model): 0.0454
Std Test Accuracy (Prototype Model): 0.0446
tobetrained:
[7, 6, 1, 8, 4, 2, 5, 0, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 4 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.2498,  9.6385,  7.8731,  8.6329,  8.2696,  9.8360,  7.8731,  9.8748,
        10.2563, 10.9469], device='cuda:0')
Server loss: 4.332530498504639
train global classifier
train glclassifier time: 3.8628116697072983
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 187.69000613689423
only_train_time: 2810.445136576891

-------------Global Round number: 60-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9319
Averaged Test Accuracy (Prototype Model): 0.9315
Std Test Accuracy (Regular Model): 0.0450
Std Test Accuracy (Prototype Model): 0.0444
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 8, 0, 5, 9, 2, 4, 1, 3]
aggregation_buffer:
[7, 6, 8, 0, 5, 9, 2, 4, 1, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.2913,  9.6793,  7.9148,  8.6718,  8.3156,  9.8753,  7.9148,  9.9239,
        10.3014, 10.9934], device='cuda:0')
Server loss: 4.3338236808776855
train global classifier
train glclassifier time: 3.7378562539815903
global classifier accuracy: 100.0
end Update
server_global_time: 190.70793874561787
only_train_time: 2857.466855496168

-------------Global Round number: 61-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9319
Averaged Test Accuracy (Prototype Model): 0.9315
Std Test Accuracy (Regular Model): 0.0448
Std Test Accuracy (Prototype Model): 0.0443
tobetrained:
[7, 6, 8, 0, 5, 9, 2, 4, 1, 3]
Edge 7 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 9 begin training
Edge 2 begin training
Edge 4 begin training
Edge 1 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 5, 0, 2, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 5, 0, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.3329,  9.7188,  7.9613,  8.7075,  8.3594,  9.9106,  7.9613,  9.9740,
        10.3448, 11.0357], device='cuda:0')
Server loss: 4.330977439880371
train global classifier
train glclassifier time: 3.7683506458997726
global classifier accuracy: 100.0
end Update
server_global_time: 193.79989799112082
only_train_time: 2902.9916766658425

-------------Global Round number: 62-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9317
Averaged Test Accuracy (Prototype Model): 0.9315
Std Test Accuracy (Regular Model): 0.0451
Std Test Accuracy (Prototype Model): 0.0444
tobetrained:
[7, 1, 6, 8, 5, 0, 2, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 5 begin training
Edge 0 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.3721,  9.7580,  8.0045,  8.7466,  8.4070,  9.9500,  8.0045, 10.0218,
        10.3938, 11.0785], device='cuda:0')
Server loss: 4.32988166809082
train global classifier
train glclassifier time: 3.771354168653488
global classifier accuracy: 100.0
end Update
server_global_time: 196.81956785172224
only_train_time: 2949.128413066268

-------------Global Round number: 63-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9317
Averaged Test Accuracy (Prototype Model): 0.9317
Std Test Accuracy (Regular Model): 0.0451
Std Test Accuracy (Prototype Model): 0.0443
tobetrained:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 5, 0, 9, 4, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 5, 0, 9, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.4106,  9.7999,  8.0421,  8.7854,  8.4485,  9.9892,  8.0421, 10.0703,
        10.4395, 11.1252], device='cuda:0')
Server loss: 4.3330769538879395
train global classifier
train glclassifier time: 3.6539885997772217
global classifier accuracy: 100.0
end Update
server_global_time: 200.693045347929
only_train_time: 2996.8391537591815

-------------Global Round number: 64-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9318
Averaged Test Accuracy (Prototype Model): 0.9315
Std Test Accuracy (Regular Model): 0.0451
Std Test Accuracy (Prototype Model): 0.0445
tobetrained:
[7, 1, 6, 8, 2, 5, 0, 9, 4, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 5, 0, 2, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 5, 0, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.4500,  9.8399,  8.0835,  8.8282,  8.4906, 10.0284,  8.0835, 10.1170,
        10.4855, 11.1686], device='cuda:0')
Server loss: 4.333301067352295
train global classifier
train glclassifier time: 3.7927855998277664
global classifier accuracy: 100.0
end Update
server_global_time: 203.74711643904448
only_train_time: 3041.586093276739

-------------Global Round number: 65-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9319
Averaged Test Accuracy (Prototype Model): 0.9314
Std Test Accuracy (Regular Model): 0.0452
Std Test Accuracy (Prototype Model): 0.0447
tobetrained:
[7, 6, 1, 8, 5, 0, 2, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 5 begin training
Edge 0 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 8, 6, 1, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 8, 6, 1, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.4897,  9.8832,  8.1307,  8.8618,  8.5332, 10.0636,  8.1307, 10.1592,
        10.5302, 11.2113], device='cuda:0')
Server loss: 4.332691669464111
train global classifier
train glclassifier time: 3.859613336622715
global classifier accuracy: 100.0
end Update
server_global_time: 206.91375079751015
only_train_time: 3087.640605099499

-------------Global Round number: 66-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9319
Averaged Test Accuracy (Prototype Model): 0.9313
Std Test Accuracy (Regular Model): 0.0452
Std Test Accuracy (Prototype Model): 0.0447
tobetrained:
[7, 8, 6, 1, 0, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 8 begin training
Edge 6 begin training
Edge 1 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 9, 4, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 9, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.5263,  9.9243,  8.1717,  8.8936,  8.5763, 10.0986,  8.1717, 10.2062,
        10.5748, 11.2505], device='cuda:0')
Server loss: 4.32890510559082
train global classifier
train glclassifier time: 3.8809138983488083
global classifier accuracy: 100.0
end Update
server_global_time: 209.91233731806278
only_train_time: 3134.935273103416

-------------Global Round number: 67-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9319
Averaged Test Accuracy (Prototype Model): 0.9313
Std Test Accuracy (Regular Model): 0.0452
Std Test Accuracy (Prototype Model): 0.0448
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 9, 4, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.5647,  9.9628,  8.2111,  8.9289,  8.6170, 10.1408,  8.2111, 10.2577,
        10.6220, 11.2936], device='cuda:0')
Server loss: 4.32924222946167
train global classifier
train glclassifier time: 3.7357648387551308
global classifier accuracy: 100.0
end Update
server_global_time: 213.07922054082155
only_train_time: 3181.750313989818

-------------Global Round number: 68-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9320
Averaged Test Accuracy (Prototype Model): 0.9313
Std Test Accuracy (Regular Model): 0.0453
Std Test Accuracy (Prototype Model): 0.0449
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.6007,  9.9976,  8.2544,  8.9623,  8.6605, 10.1727,  8.2544, 10.3006,
        10.6663, 11.3312], device='cuda:0')
Server loss: 4.325550079345703
train global classifier
train glclassifier time: 3.6377913281321526
global classifier accuracy: 100.0
end Update
server_global_time: 216.132999651134
only_train_time: 3227.38170696795

-------------Global Round number: 69-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9319
Averaged Test Accuracy (Prototype Model): 0.9312
Std Test Accuracy (Regular Model): 0.0454
Std Test Accuracy (Prototype Model): 0.0449
tobetrained:
[7, 6, 1, 8, 0, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 8, 0, 5, 2, 6, 4, 9, 3]
aggregation_buffer:
[7, 1, 8, 0, 5, 2, 6, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.6416, 10.0389,  8.2962,  8.9983,  8.7014, 10.2102,  8.2962, 10.3464,
        10.7089, 11.3692], device='cuda:0')
Server loss: 4.321418285369873
train global classifier
train glclassifier time: 3.7269672080874443
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 219.22585702687502
only_train_time: 3274.239851206541

-------------Global Round number: 70-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9319
Averaged Test Accuracy (Prototype Model): 0.9313
Std Test Accuracy (Regular Model): 0.0453
Std Test Accuracy (Prototype Model): 0.0447
tobetrained:
[7, 1, 8, 0, 5, 2, 6, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 6 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 8, 0, 5, 2, 4, 6, 9, 3]
aggregation_buffer:
[7, 1, 8, 0, 5, 2, 4, 6, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.6803, 10.0798,  8.3313,  9.0288,  8.7386, 10.2517,  8.3313, 10.3974,
        10.7552, 11.4127], device='cuda:0')
Server loss: 4.3231120109558105
train global classifier
train glclassifier time: 3.905839405953884
global classifier accuracy: 100.0
end Update
server_global_time: 222.2694642394781
only_train_time: 3320.435697965324

-------------Global Round number: 71-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9322
Averaged Test Accuracy (Prototype Model): 0.9314
Std Test Accuracy (Regular Model): 0.0450
Std Test Accuracy (Prototype Model): 0.0448
tobetrained:
[7, 1, 8, 0, 5, 2, 4, 6, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 6 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.7171, 10.1197,  8.3710,  9.0598,  8.7749, 10.2867,  8.3710, 10.4424,
        10.7948, 11.4543], device='cuda:0')
Server loss: 4.325374603271484
train global classifier
train glclassifier time: 3.6933958753943443
global classifier accuracy: 100.0
end Update
server_global_time: 225.38395261764526
only_train_time: 3366.6942028701305

-------------Global Round number: 72-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9321
Averaged Test Accuracy (Prototype Model): 0.9312
Std Test Accuracy (Regular Model): 0.0450
Std Test Accuracy (Prototype Model): 0.0449
tobetrained:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 8, 2, 0, 5, 6, 4, 9, 3]
aggregation_buffer:
[7, 1, 8, 2, 0, 5, 6, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.7505, 10.1569,  8.4102,  9.0971,  8.8159, 10.3287,  8.4102, 10.4892,
        10.8395, 11.4944], device='cuda:0')
Server loss: 4.322587013244629
train global classifier
train glclassifier time: 3.586872711777687
global classifier accuracy: 100.0
end Update
server_global_time: 228.38694313168526
only_train_time: 3415.4267619028687

-------------Global Round number: 73-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9321
Averaged Test Accuracy (Prototype Model): 0.9311
Std Test Accuracy (Regular Model): 0.0450
Std Test Accuracy (Prototype Model): 0.0450
tobetrained:
[7, 1, 8, 2, 0, 5, 6, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 6 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.7824, 10.1927,  8.4486,  9.1307,  8.8559, 10.3640,  8.4486, 10.5343,
        10.8852, 11.5331], device='cuda:0')
Server loss: 4.320696830749512
train global classifier
train glclassifier time: 3.679517023265362
global classifier accuracy: 100.0
end Update
server_global_time: 231.41411150991917
only_train_time: 3460.963634803891

-------------Global Round number: 74-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9319
Averaged Test Accuracy (Prototype Model): 0.9311
Std Test Accuracy (Regular Model): 0.0455
Std Test Accuracy (Prototype Model): 0.0451
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 8, 0, 5, 2, 9, 4, 1, 3]
aggregation_buffer:
[7, 6, 8, 0, 5, 2, 9, 4, 1, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.8153, 10.2294,  8.4866,  9.1697,  8.8946, 10.4008,  8.4866, 10.5778,
        10.9290, 11.5709], device='cuda:0')
Server loss: 4.3173370361328125
train global classifier
train glclassifier time: 3.530482307076454
global classifier accuracy: 100.0
end Update
server_global_time: 234.419430680573
only_train_time: 3507.2258416339755

-------------Global Round number: 75-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9319
Averaged Test Accuracy (Prototype Model): 0.9313
Std Test Accuracy (Regular Model): 0.0456
Std Test Accuracy (Prototype Model): 0.0452
tobetrained:
[7, 6, 8, 0, 5, 2, 9, 4, 1, 3]
Edge 7 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 9 begin training
Edge 4 begin training
Edge 1 begin training
Edge 3 begin training
readyList:
[7, 6, 8, 2, 0, 5, 1, 9, 4, 3]
aggregation_buffer:
[7, 6, 8, 2, 0, 5, 1, 9, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.8472, 10.2639,  8.5247,  9.2000,  8.9365, 10.4349,  8.5247, 10.6235,
        10.9679, 11.6123], device='cuda:0')
Server loss: 4.317677974700928
train global classifier
train glclassifier time: 3.678034409880638
global classifier accuracy: 100.0
end Update
server_global_time: 237.49482449144125
only_train_time: 3554.252786375582

-------------Global Round number: 76-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9318
Averaged Test Accuracy (Prototype Model): 0.9313
Std Test Accuracy (Regular Model): 0.0456
Std Test Accuracy (Prototype Model): 0.0453
tobetrained:
[7, 6, 8, 2, 0, 5, 1, 9, 4, 3]
Edge 7 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.8816, 10.3028,  8.5636,  9.2386,  8.9794, 10.4695,  8.5636, 10.6679,
        11.0094, 11.6455], device='cuda:0')
Server loss: 4.30897855758667
train global classifier
train glclassifier time: 3.643910087645054
global classifier accuracy: 100.0
end Update
server_global_time: 240.6192694157362
only_train_time: 3600.7934877946973

-------------Global Round number: 77-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9319
Averaged Test Accuracy (Prototype Model): 0.9313
Std Test Accuracy (Regular Model): 0.0457
Std Test Accuracy (Prototype Model): 0.0453
tobetrained:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.9187, 10.3384,  8.6074,  9.2747,  9.0198, 10.5026,  8.6074, 10.7085,
        11.0521, 11.6842], device='cuda:0')
Server loss: 4.30753755569458
train global classifier
train glclassifier time: 3.647104762494564
global classifier accuracy: 100.0
end Update
server_global_time: 243.62877517938614
only_train_time: 3646.4587420150638

-------------Global Round number: 78-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9318
Averaged Test Accuracy (Prototype Model): 0.9311
Std Test Accuracy (Regular Model): 0.0459
Std Test Accuracy (Prototype Model): 0.0453
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 5, 0, 9, 4, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 5, 0, 9, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.9471, 10.3720,  8.6445,  9.3049,  9.0619, 10.5351,  8.6445, 10.7487,
        11.0932, 11.7251], device='cuda:0')
Server loss: 4.308701038360596
train global classifier
train glclassifier time: 4.046260990202427
global classifier accuracy: 100.0
end Update
server_global_time: 246.6557368338108
only_train_time: 3692.4903088510036

-------------Global Round number: 79-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9320
Averaged Test Accuracy (Prototype Model): 0.9313
Std Test Accuracy (Regular Model): 0.0460
Std Test Accuracy (Prototype Model): 0.0453
tobetrained:
[7, 1, 6, 8, 2, 5, 0, 9, 4, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 6, 8, 2, 5, 0, 1, 9, 4, 3]
aggregation_buffer:
[7, 6, 8, 2, 5, 0, 1, 9, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.9822, 10.4079,  8.6838,  9.3358,  9.1007, 10.5742,  8.6838, 10.7890,
        11.1408, 11.7658], device='cuda:0')
Server loss: 4.310081481933594
train global classifier
train glclassifier time: 3.748379498720169
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 250.57529567927122
only_train_time: 3740.7458467409015

-------------Global Round number: 80-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9318
Averaged Test Accuracy (Prototype Model): 0.9313
Std Test Accuracy (Regular Model): 0.0460
Std Test Accuracy (Prototype Model): 0.0454
tobetrained:
[7, 6, 8, 2, 5, 0, 1, 9, 4, 3]
Edge 7 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[1, 7, 2, 4, 5, 0, 6, 9, 8, 3]
aggregation_buffer:
[1, 7, 2, 4, 5, 0, 6, 9, 8, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.0155, 10.4428,  8.7255,  9.3707,  9.1419, 10.6074,  8.7255, 10.8310,
        11.1778, 11.8037], device='cuda:0')
Server loss: 4.308115005493164
train global classifier
train glclassifier time: 4.088922314345837
global classifier accuracy: 100.0
end Update
server_global_time: 253.59984171390533
only_train_time: 3788.6129361242056

-------------Global Round number: 81-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9320
Averaged Test Accuracy (Prototype Model): 0.9315
Std Test Accuracy (Regular Model): 0.0459
Std Test Accuracy (Prototype Model): 0.0452
tobetrained:
[1, 7, 2, 4, 5, 0, 6, 9, 8, 3]
Edge 1 begin training
Edge 7 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 0 begin training
Edge 6 begin training
Edge 9 begin training
Edge 8 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 5, 9, 4, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 5, 9, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.0502, 10.4804,  8.7648,  9.4060,  9.1825, 10.6408,  8.7648, 10.8679,
        11.2219, 11.8426], device='cuda:0')
Server loss: 4.30679988861084
train global classifier
train glclassifier time: 3.6082202047109604
global classifier accuracy: 100.0
end Update
server_global_time: 256.7823068499565
only_train_time: 3835.0433405414224

-------------Global Round number: 82-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9321
Averaged Test Accuracy (Prototype Model): 0.9315
Std Test Accuracy (Regular Model): 0.0457
Std Test Accuracy (Prototype Model): 0.0452
tobetrained:
[7, 6, 1, 8, 2, 0, 5, 9, 4, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.0848, 10.5200,  8.8045,  9.4415,  9.2247, 10.6756,  8.8045, 10.9100,
        11.2581, 11.8784], device='cuda:0')
Server loss: 4.303097724914551
train global classifier
train glclassifier time: 3.6194893568754196
global classifier accuracy: 100.0
end Update
server_global_time: 259.78463024646044
only_train_time: 3880.6879063993692

-------------Global Round number: 83-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9321
Averaged Test Accuracy (Prototype Model): 0.9314
Std Test Accuracy (Regular Model): 0.0456
Std Test Accuracy (Prototype Model): 0.0452
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 5, 0, 2, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 5, 0, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.1181, 10.5570,  8.8453,  9.4750,  9.2631, 10.7103,  8.8453, 10.9529,
        11.2976, 11.9156], device='cuda:0')
Server loss: 4.300270080566406
train global classifier
train glclassifier time: 3.7070960998535156
global classifier accuracy: 100.0
end Update
server_global_time: 262.8168584257364
only_train_time: 3926.9997862502933

-------------Global Round number: 84-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9321
Averaged Test Accuracy (Prototype Model): 0.9314
Std Test Accuracy (Regular Model): 0.0456
Std Test Accuracy (Prototype Model): 0.0452
tobetrained:
[7, 1, 6, 8, 5, 0, 2, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 5 begin training
Edge 0 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 0, 4, 5, 9, 2, 3]
aggregation_buffer:
[7, 6, 1, 8, 0, 4, 5, 9, 2, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.1524, 10.5841,  8.8828,  9.5075,  9.3030, 10.7441,  8.8828, 10.9975,
        11.3381, 11.9570], device='cuda:0')
Server loss: 4.303876876831055
train global classifier
train glclassifier time: 3.8620766922831535
global classifier accuracy: 100.0
end Update
server_global_time: 266.58666330575943
only_train_time: 3974.3781602680683

-------------Global Round number: 85-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9321
Averaged Test Accuracy (Prototype Model): 0.9316
Std Test Accuracy (Regular Model): 0.0455
Std Test Accuracy (Prototype Model): 0.0450
tobetrained:
[7, 6, 1, 8, 0, 4, 5, 9, 2, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 2 begin training
Edge 3 begin training
readyList:
[7, 1, 8, 6, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 8, 6, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.1811, 10.6169,  8.9172,  9.5381,  9.3438, 10.7782,  8.9172, 11.0426,
        11.3755, 11.9965], device='cuda:0')
Server loss: 4.304465293884277
train global classifier
train glclassifier time: 3.5908515825867653
global classifier accuracy: 100.0
end Update
server_global_time: 269.65054286271334
only_train_time: 4019.9058177396655

-------------Global Round number: 86-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9321
Averaged Test Accuracy (Prototype Model): 0.9316
Std Test Accuracy (Regular Model): 0.0456
Std Test Accuracy (Prototype Model): 0.0450
tobetrained:
[7, 1, 8, 6, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 8 begin training
Edge 6 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 5, 4, 0, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 5, 4, 0, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.2115, 10.6527,  8.9505,  9.5733,  9.3782, 10.8129,  8.9505, 11.0815,
        11.4240, 12.0365], device='cuda:0')
Server loss: 4.305971622467041
train global classifier
train glclassifier time: 3.788544051349163
global classifier accuracy: 100.0
end Update
server_global_time: 272.7118912115693
only_train_time: 4066.5310160964727

-------------Global Round number: 87-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9321
Averaged Test Accuracy (Prototype Model): 0.9316
Std Test Accuracy (Regular Model): 0.0456
Std Test Accuracy (Prototype Model): 0.0449
tobetrained:
[7, 6, 1, 8, 2, 5, 4, 0, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 0 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 5, 4, 9, 0, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 5, 4, 9, 0, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.2455, 10.6828,  8.9894,  9.6072,  9.4181, 10.8458,  8.9894, 11.1224,
        11.4615, 12.0778], device='cuda:0')
Server loss: 4.307379722595215
train global classifier
train glclassifier time: 3.6606860384345055
global classifier accuracy: 100.0
end Update
server_global_time: 276.2029561549425
only_train_time: 4114.10667424649

-------------Global Round number: 88-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9322
Averaged Test Accuracy (Prototype Model): 0.9317
Std Test Accuracy (Regular Model): 0.0456
Std Test Accuracy (Prototype Model): 0.0448
tobetrained:
[7, 6, 1, 8, 2, 5, 4, 9, 0, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 0 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 0, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.2790, 10.7228,  9.0263,  9.6379,  9.4524, 10.8813,  9.0263, 11.1608,
        11.5082, 12.1187], device='cuda:0')
Server loss: 4.310393810272217
train global classifier
train glclassifier time: 3.610073760151863
global classifier accuracy: 100.0
end Update
server_global_time: 279.2759466096759
only_train_time: 4159.825395531952

-------------Global Round number: 89-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9320
Averaged Test Accuracy (Prototype Model): 0.9315
Std Test Accuracy (Regular Model): 0.0455
Std Test Accuracy (Prototype Model): 0.0450
tobetrained:
[7, 6, 1, 8, 0, 5, 2, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 2, 5, 0, 1, 9, 8, 4, 3]
aggregation_buffer:
[7, 6, 2, 5, 0, 1, 9, 8, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.3134, 10.7620,  9.0641,  9.6725,  9.4877, 10.9202,  9.0641, 11.2055,
        11.5486, 12.1594], device='cuda:0')
Server loss: 4.3119306564331055
train global classifier
train glclassifier time: 3.672924280166626
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 282.37139773368835
only_train_time: 4207.696018911898

-------------Global Round number: 90-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9320
Averaged Test Accuracy (Prototype Model): 0.9314
Std Test Accuracy (Regular Model): 0.0458
Std Test Accuracy (Prototype Model): 0.0451
tobetrained:
[7, 6, 2, 5, 0, 1, 9, 8, 4, 3]
Edge 7 begin training
Edge 6 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 1 begin training
Edge 9 begin training
Edge 8 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.3411, 10.7948,  9.1010,  9.7057,  9.5196, 10.9604,  9.1010, 11.2501,
        11.5896, 12.2037], device='cuda:0')
Server loss: 4.316710948944092
train global classifier
train glclassifier time: 3.6695595160126686
global classifier accuracy: 100.0
end Update
server_global_time: 285.438888669014
only_train_time: 4252.432270996273

-------------Global Round number: 91-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9318
Averaged Test Accuracy (Prototype Model): 0.9314
Std Test Accuracy (Regular Model): 0.0461
Std Test Accuracy (Prototype Model): 0.0452
tobetrained:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 8, 6, 5, 2, 0, 4, 9, 3]
aggregation_buffer:
[7, 1, 8, 6, 5, 2, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.3755, 10.8313,  9.1374,  9.7378,  9.5569, 11.0002,  9.1374, 11.2925,
        11.6328, 12.2483], device='cuda:0')
Server loss: 4.322784423828125
train global classifier
train glclassifier time: 3.667102001607418
global classifier accuracy: 100.0
end Update
server_global_time: 288.4875040948391
only_train_time: 4297.6296058520675

-------------Global Round number: 92-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9318
Averaged Test Accuracy (Prototype Model): 0.9314
Std Test Accuracy (Regular Model): 0.0458
Std Test Accuracy (Prototype Model): 0.0452
tobetrained:
[7, 1, 8, 6, 5, 2, 0, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 8 begin training
Edge 6 begin training
Edge 5 begin training
Edge 2 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 2, 0, 5, 4, 8, 9, 3]
aggregation_buffer:
[7, 6, 1, 2, 0, 5, 4, 8, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.4086, 10.8626,  9.1783,  9.7729,  9.5986, 11.0328,  9.1783, 11.3332,
        11.6701, 12.2867], device='cuda:0')
Server loss: 4.32265043258667
train global classifier
train glclassifier time: 4.689425252377987
global classifier accuracy: 100.0
end Update
server_global_time: 291.2386344000697
only_train_time: 4344.122961692512

-------------Global Round number: 93-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9319
Averaged Test Accuracy (Prototype Model): 0.9315
Std Test Accuracy (Regular Model): 0.0458
Std Test Accuracy (Prototype Model): 0.0451
tobetrained:
[7, 6, 1, 2, 0, 5, 4, 8, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 8 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 4, 5, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 4, 5, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.4444, 10.8985,  9.2187,  9.8082,  9.6391, 11.0697,  9.2187, 11.3744,
        11.7102, 12.3231], device='cuda:0')
Server loss: 4.320492744445801
train global classifier
train glclassifier time: 4.589852795004845
global classifier accuracy: 100.0
end Update
server_global_time: 294.2623890861869
only_train_time: 4389.7019961848855

-------------Global Round number: 94-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9321
Averaged Test Accuracy (Prototype Model): 0.9315
Std Test Accuracy (Regular Model): 0.0457
Std Test Accuracy (Prototype Model): 0.0454
tobetrained:
[7, 1, 6, 8, 2, 0, 4, 5, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 0, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.4727, 10.9306,  9.2591,  9.8354,  9.6769, 11.1010,  9.2591, 11.4134,
        11.7480, 12.3643], device='cuda:0')
Server loss: 4.323184013366699
train global classifier
train glclassifier time: 3.660843662917614
global classifier accuracy: 100.0
end Update
server_global_time: 297.27017311006784
only_train_time: 4435.749330446124

-------------Global Round number: 95-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9321
Averaged Test Accuracy (Prototype Model): 0.9315
Std Test Accuracy (Regular Model): 0.0456
Std Test Accuracy (Prototype Model): 0.0455
tobetrained:
[7, 6, 1, 8, 0, 5, 2, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 8, 2, 5, 0, 4, 6, 9, 3]
aggregation_buffer:
[7, 1, 8, 2, 5, 0, 4, 6, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.5042, 10.9641,  9.2980,  9.8693,  9.7162, 11.1367,  9.2980, 11.4545,
        11.7873, 12.4001], device='cuda:0')
Server loss: 4.3214545249938965
train global classifier
train glclassifier time: 3.743519976735115
global classifier accuracy: 100.0
end Update
server_global_time: 300.3491556867957
only_train_time: 4481.926154188812

-------------Global Round number: 96-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9319
Averaged Test Accuracy (Prototype Model): 0.9313
Std Test Accuracy (Regular Model): 0.0457
Std Test Accuracy (Prototype Model): 0.0454
tobetrained:
[7, 1, 8, 2, 5, 0, 4, 6, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 6 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.5324, 10.9966,  9.3337,  9.9031,  9.7528, 11.1694,  9.3337, 11.4950,
        11.8293, 12.4354], device='cuda:0')
Server loss: 4.317521095275879
train global classifier
train glclassifier time: 3.688029073178768
global classifier accuracy: 100.0
end Update
server_global_time: 303.41285971552134
only_train_time: 4527.330851309001

-------------Global Round number: 97-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9319
Averaged Test Accuracy (Prototype Model): 0.9314
Std Test Accuracy (Regular Model): 0.0457
Std Test Accuracy (Prototype Model): 0.0457
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 0, 2, 4, 5, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 0, 2, 4, 5, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.5617, 11.0253,  9.3680,  9.9343,  9.7872, 11.2060,  9.3680, 11.5397,
        11.8703, 12.4777], device='cuda:0')
Server loss: 4.323227882385254
train global classifier
train glclassifier time: 3.571723997592926
global classifier accuracy: 100.0
end Update
server_global_time: 306.4468057155609
only_train_time: 4572.786412499845

-------------Global Round number: 98-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9318
Averaged Test Accuracy (Prototype Model): 0.9315
Std Test Accuracy (Regular Model): 0.0458
Std Test Accuracy (Prototype Model): 0.0453
tobetrained:
[7, 6, 1, 8, 0, 2, 4, 5, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.5897, 11.0578,  9.4062,  9.9656,  9.8235, 11.2378,  9.4062, 11.5813,
        11.9094, 12.5136], device='cuda:0')
Server loss: 4.321539878845215
train global classifier
train glclassifier time: 3.570556119084358
global classifier accuracy: 100.0
end Update
server_global_time: 309.4779275804758
only_train_time: 4618.616565145552

-------------Global Round number: 99-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9319
Averaged Test Accuracy (Prototype Model): 0.9315
Std Test Accuracy (Regular Model): 0.0456
Std Test Accuracy (Prototype Model): 0.0453
tobetrained:
[7, 6, 1, 8, 0, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 0, 2, 9, 5, 4, 3]
aggregation_buffer:
[7, 6, 1, 8, 0, 2, 9, 5, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.6215, 11.0918,  9.4444,  9.9960,  9.8633, 11.2730,  9.4444, 11.6207,
        11.9473, 12.5507], device='cuda:0')
Server loss: 4.320631504058838
train global classifier
train glclassifier time: 3.6631475165486336
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 312.5681934133172
only_train_time: 4667.209939174354

-------------Global Round number: 100-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9319
Averaged Test Accuracy (Prototype Model): 0.9316
Std Test Accuracy (Regular Model): 0.0457
Std Test Accuracy (Prototype Model): 0.0454
tobetrained:
[7, 6, 1, 8, 0, 2, 9, 5, 4, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 9 begin training
Edge 5 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.6516, 11.1201,  9.4799, 10.0342,  9.9009, 11.3126,  9.4799, 11.6645,
        11.9831, 12.5901], device='cuda:0')
Server loss: 4.32142972946167
train global classifier
train glclassifier time: 3.666871100664139
global classifier accuracy: 100.0
end Update
server_global_time: 316.26461961120367
only_train_time: 4714.463406927884

-------------Global Round number: 101-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9319
Averaged Test Accuracy (Prototype Model): 0.9317
Std Test Accuracy (Regular Model): 0.0456
Std Test Accuracy (Prototype Model): 0.0452
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 0, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.6874, 11.1538,  9.5198, 10.0659,  9.9413, 11.3478,  9.5198, 11.7041,
        12.0234, 12.6236], device='cuda:0')
Server loss: 4.3173651695251465
train global classifier
train glclassifier time: 4.098694480955601
global classifier accuracy: 100.0
end Update
server_global_time: 319.4026545062661
only_train_time: 4760.155330978334

-------------Global Round number: 102-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9321
Averaged Test Accuracy (Prototype Model): 0.9316
Std Test Accuracy (Regular Model): 0.0457
Std Test Accuracy (Prototype Model): 0.0453
tobetrained:
[7, 6, 1, 8, 0, 5, 2, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 2, 8, 5, 4, 9, 0, 3]
aggregation_buffer:
[7, 1, 6, 2, 8, 5, 4, 9, 0, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.7151, 11.1836,  9.5546, 10.0963,  9.9714, 11.3851,  9.5546, 11.7474,
        12.0613, 12.6668], device='cuda:0')
Server loss: 4.323434352874756
train global classifier
train glclassifier time: 3.658889412879944
global classifier accuracy: 100.0
end Update
server_global_time: 322.4104321748018
only_train_time: 4806.597973026335

-------------Global Round number: 103-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9320
Averaged Test Accuracy (Prototype Model): 0.9317
Std Test Accuracy (Regular Model): 0.0457
Std Test Accuracy (Prototype Model): 0.0452
tobetrained:
[7, 1, 6, 2, 8, 5, 4, 9, 0, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 0 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 5, 0, 2, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 5, 0, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.7424, 11.2101,  9.5908, 10.1239, 10.0065, 11.4151,  9.5908, 11.7847,
        12.1092, 12.7023], device='cuda:0')
Server loss: 4.322654724121094
train global classifier
train glclassifier time: 3.786931850016117
global classifier accuracy: 100.0
end Update
server_global_time: 325.47236762195826
only_train_time: 4852.233465798199

-------------Global Round number: 104-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9322
Averaged Test Accuracy (Prototype Model): 0.9316
Std Test Accuracy (Regular Model): 0.0459
Std Test Accuracy (Prototype Model): 0.0454
tobetrained:
[7, 6, 1, 8, 5, 0, 2, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 5 begin training
Edge 0 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 0, 2, 4, 5, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 0, 2, 4, 5, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.7724, 11.2432,  9.6290, 10.1537, 10.0422, 11.4476,  9.6290, 11.8237,
        12.1455, 12.7386], device='cuda:0')
Server loss: 4.323384761810303
train global classifier
train glclassifier time: 3.786044381558895
global classifier accuracy: 100.0
end Update
server_global_time: 328.50207591056824
only_train_time: 4898.630247376859

-------------Global Round number: 105-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9323
Averaged Test Accuracy (Prototype Model): 0.9316
Std Test Accuracy (Regular Model): 0.0459
Std Test Accuracy (Prototype Model): 0.0453
tobetrained:
[7, 6, 1, 8, 0, 2, 4, 5, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 8, 6, 2, 0, 5, 4, 1, 9, 3]
aggregation_buffer:
[7, 8, 6, 2, 0, 5, 4, 1, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.8026, 11.2767,  9.6601, 10.1904, 10.0782, 11.4824,  9.6601, 11.8616,
        12.1920, 12.7719], device='cuda:0')
Server loss: 4.319295883178711
train global classifier
train glclassifier time: 3.818385921418667
global classifier accuracy: 100.0
end Update
server_global_time: 331.565632276237
only_train_time: 4945.140313774347

-------------Global Round number: 106-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9323
Averaged Test Accuracy (Prototype Model): 0.9318
Std Test Accuracy (Regular Model): 0.0460
Std Test Accuracy (Prototype Model): 0.0452
tobetrained:
[7, 8, 6, 2, 0, 5, 4, 1, 9, 3]
Edge 7 begin training
Edge 8 begin training
Edge 6 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 1 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[1, 6, 7, 0, 2, 5, 4, 9, 8, 3]
aggregation_buffer:
[1, 6, 7, 0, 2, 5, 4, 9, 8, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.8353, 11.3084,  9.6981, 10.2204, 10.1166, 11.5162,  9.6981, 11.8984,
        12.2251, 12.8110], device='cuda:0')
Server loss: 4.320741176605225
train global classifier
train glclassifier time: 3.593531519174576
global classifier accuracy: 100.0
end Update
server_global_time: 334.5657840371132
only_train_time: 4992.203810445964

-------------Global Round number: 107-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9322
Averaged Test Accuracy (Prototype Model): 0.9317
Std Test Accuracy (Regular Model): 0.0459
Std Test Accuracy (Prototype Model): 0.0451
tobetrained:
[1, 6, 7, 0, 2, 5, 4, 9, 8, 3]
Edge 1 begin training
Edge 6 begin training
Edge 7 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 8 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 4, 5, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 4, 5, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.8674, 11.3428,  9.7374, 10.2522, 10.1513, 11.5514,  9.7374, 11.9357,
        12.2709, 12.8471], device='cuda:0')
Server loss: 4.317970275878906
train global classifier
train glclassifier time: 3.8298563733696938
global classifier accuracy: 100.0
end Update
server_global_time: 337.5537599772215
only_train_time: 5037.568317338824

-------------Global Round number: 108-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9321
Averaged Test Accuracy (Prototype Model): 0.9317
Std Test Accuracy (Regular Model): 0.0460
Std Test Accuracy (Prototype Model): 0.0452
tobetrained:
[7, 6, 1, 8, 2, 0, 4, 5, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 5, 9, 4, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 5, 9, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.8983, 11.3782,  9.7702, 10.2845, 10.1837, 11.5904,  9.7702, 11.9797,
        12.3120, 12.8853], device='cuda:0')
Server loss: 4.318408012390137
train global classifier
train glclassifier time: 3.6290602907538414
global classifier accuracy: 100.0
end Update
server_global_time: 340.5517730861902
only_train_time: 5083.305260524154

-------------Global Round number: 109-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9323
Averaged Test Accuracy (Prototype Model): 0.9317
Std Test Accuracy (Regular Model): 0.0461
Std Test Accuracy (Prototype Model): 0.0451
tobetrained:
[7, 6, 1, 8, 2, 0, 5, 9, 4, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 5, 0, 2, 4, 8, 9, 3]
aggregation_buffer:
[7, 6, 1, 5, 0, 2, 4, 8, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.9295, 11.4111,  9.8079, 10.3153, 10.2199, 11.6236,  9.8079, 12.0155,
        12.3509, 12.9212], device='cuda:0')
Server loss: 4.31724214553833
train global classifier
train glclassifier time: 3.576335556805134
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 343.27744636684656
only_train_time: 5129.118089064956

-------------Global Round number: 110-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9323
Averaged Test Accuracy (Prototype Model): 0.9317
Std Test Accuracy (Regular Model): 0.0462
Std Test Accuracy (Prototype Model): 0.0452
tobetrained:
[7, 6, 1, 5, 0, 2, 4, 8, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 5 begin training
Edge 0 begin training
Edge 2 begin training
Edge 4 begin training
Edge 8 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 5, 2, 9, 4, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 5, 2, 9, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.9628, 11.4488,  9.8383, 10.3504, 10.2571, 11.6613,  9.8383, 12.0569,
        12.3882, 12.9603], device='cuda:0')
Server loss: 4.319486141204834
train global classifier
train glclassifier time: 3.5837411507964134
global classifier accuracy: 100.0
end Update
server_global_time: 346.3155355080962
only_train_time: 5175.480821289122

-------------Global Round number: 111-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9321
Averaged Test Accuracy (Prototype Model): 0.9318
Std Test Accuracy (Regular Model): 0.0460
Std Test Accuracy (Prototype Model): 0.0451
tobetrained:
[7, 1, 6, 8, 0, 5, 2, 9, 4, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 6, 8, 1, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 8, 1, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.9925, 11.4728,  9.8743, 10.3873, 10.2948, 11.6946,  9.8743, 12.0964,
        12.4225, 12.9980], device='cuda:0')
Server loss: 4.319482803344727
train global classifier
train glclassifier time: 3.834086388349533
global classifier accuracy: 100.0
end Update
server_global_time: 350.16965345293283
only_train_time: 5222.010355323553

-------------Global Round number: 112-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9323
Averaged Test Accuracy (Prototype Model): 0.9316
Std Test Accuracy (Regular Model): 0.0462
Std Test Accuracy (Prototype Model): 0.0451
tobetrained:
[7, 6, 8, 1, 0, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 8 begin training
Edge 1 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 2, 5, 0, 4, 9, 8, 3]
aggregation_buffer:
[7, 1, 6, 2, 5, 0, 4, 9, 8, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.0228, 11.5065,  9.9086, 10.4224, 10.3244, 11.7312,  9.9086, 12.1359,
        12.4630, 13.0364], device='cuda:0')
Server loss: 4.3214430809021
train global classifier
train glclassifier time: 3.8238514438271523
global classifier accuracy: 100.0
end Update
server_global_time: 353.1608102694154
only_train_time: 5268.265255890787

-------------Global Round number: 113-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9322
Averaged Test Accuracy (Prototype Model): 0.9317
Std Test Accuracy (Regular Model): 0.0465
Std Test Accuracy (Prototype Model): 0.0453
tobetrained:
[7, 1, 6, 2, 5, 0, 4, 9, 8, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 8 begin training
Edge 3 begin training
readyList:
[7, 6, 5, 2, 8, 1, 9, 0, 4, 3]
aggregation_buffer:
[7, 6, 5, 2, 8, 1, 9, 0, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.0522, 11.5386,  9.9460, 10.4503, 10.3602, 11.7691,  9.9460, 12.1798,
        12.4943, 13.0753], device='cuda:0')
Server loss: 4.322350978851318
train global classifier
train glclassifier time: 3.731504552066326
global classifier accuracy: 100.0
end Update
server_global_time: 356.33705173432827
only_train_time: 5318.028102509677

-------------Global Round number: 114-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9323
Averaged Test Accuracy (Prototype Model): 0.9317
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0453
tobetrained:
[7, 6, 5, 2, 8, 1, 9, 0, 4, 3]
Edge 7 begin training
Edge 6 begin training
Edge 5 begin training
Edge 2 begin training
Edge 8 begin training
Edge 1 begin training
Edge 9 begin training
Edge 0 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.0849, 11.5689,  9.9808, 10.4782, 10.3989, 11.8012,  9.9808, 12.2159,
        12.5389, 13.1107], device='cuda:0')
Server loss: 4.324249267578125
train global classifier
train glclassifier time: 3.853393979370594
global classifier accuracy: 100.0
end Update
server_global_time: 359.3162604570389
only_train_time: 5363.130594789982

-------------Global Round number: 115-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9323
Averaged Test Accuracy (Prototype Model): 0.9318
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0450
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[8, 7, 1, 0, 5, 6, 2, 4, 9, 3]
aggregation_buffer:
[8, 7, 1, 0, 5, 6, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.1165, 11.6048, 10.0163, 10.5061, 10.4323, 11.8375, 10.0163, 12.2565,
        12.5789, 13.1487], device='cuda:0')
Server loss: 4.324089050292969
train global classifier
train glclassifier time: 4.2969022914767265
global classifier accuracy: 100.0
end Update
server_global_time: 362.2753511890769
only_train_time: 5408.863831885159

-------------Global Round number: 116-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9322
Averaged Test Accuracy (Prototype Model): 0.9318
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0450
tobetrained:
[8, 7, 1, 0, 5, 6, 2, 4, 9, 3]
Edge 8 begin training
Edge 7 begin training
Edge 1 begin training
Edge 0 begin training
Edge 5 begin training
Edge 6 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 2, 0, 5, 4, 1, 9, 8, 3]
aggregation_buffer:
[7, 6, 2, 0, 5, 4, 1, 9, 8, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.1491, 11.6391, 10.0506, 10.5406, 10.4685, 11.8721, 10.0506, 12.2951,
        12.6192, 13.1808], device='cuda:0')
Server loss: 4.31995153427124
train global classifier
train glclassifier time: 4.030939161777496
global classifier accuracy: 100.0
end Update
server_global_time: 365.274070315063
only_train_time: 5455.999516166747

-------------Global Round number: 117-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9321
Averaged Test Accuracy (Prototype Model): 0.9318
Std Test Accuracy (Regular Model): 0.0465
Std Test Accuracy (Prototype Model): 0.0449
tobetrained:
[7, 6, 2, 0, 5, 4, 1, 9, 8, 3]
Edge 7 begin training
Edge 6 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 1 begin training
Edge 9 begin training
Edge 8 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.1785, 11.6721, 10.0835, 10.5733, 10.5029, 11.9080, 10.0835, 12.3371,
        12.6590, 13.2154], device='cuda:0')
Server loss: 4.317633628845215
train global classifier
train glclassifier time: 4.076510816812515
global classifier accuracy: 100.0
end Update
server_global_time: 368.2458928525448
only_train_time: 5501.087188646197

-------------Global Round number: 118-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9322
Averaged Test Accuracy (Prototype Model): 0.9318
Std Test Accuracy (Regular Model): 0.0466
Std Test Accuracy (Prototype Model): 0.0449
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 5, 4, 9, 0, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 5, 4, 9, 0, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.2097, 11.7007, 10.1217, 10.6039, 10.5378, 11.9409, 10.1217, 12.3771,
        12.6930, 13.2526], device='cuda:0')
Server loss: 4.318686008453369
train global classifier
train glclassifier time: 3.999635674059391
global classifier accuracy: 100.0
end Update
server_global_time: 371.22978061437607
only_train_time: 5546.749002076685

-------------Global Round number: 119-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9323
Averaged Test Accuracy (Prototype Model): 0.9318
Std Test Accuracy (Regular Model): 0.0466
Std Test Accuracy (Prototype Model): 0.0452
tobetrained:
[7, 6, 1, 8, 2, 5, 4, 9, 0, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 0 begin training
Edge 3 begin training
readyList:
[7, 0, 5, 4, 6, 1, 8, 9, 2, 3]
aggregation_buffer:
[7, 0, 5, 4, 6, 1, 8, 9, 2, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.2348, 11.7339, 10.1548, 10.6344, 10.5700, 11.9741, 10.1548, 12.4134,
        12.7336, 13.2864], device='cuda:0')
Server loss: 4.318502902984619
train global classifier
train glclassifier time: 3.624061994254589
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 374.20075822621584
only_train_time: 5595.284866221249

-------------Global Round number: 120-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9322
Averaged Test Accuracy (Prototype Model): 0.9319
Std Test Accuracy (Regular Model): 0.0466
Std Test Accuracy (Prototype Model): 0.0453
tobetrained:
[7, 0, 5, 4, 6, 1, 8, 9, 2, 3]
Edge 7 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 9 begin training
Edge 2 begin training
Edge 3 begin training
readyList:
[7, 6, 8, 2, 1, 4, 9, 5, 0, 3]
aggregation_buffer:
[7, 6, 8, 2, 1, 4, 9, 5, 0, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.2660, 11.7639, 10.1923, 10.6648, 10.6073, 12.0104, 10.1923, 12.4562,
        12.7629, 13.3229], device='cuda:0')
Server loss: 4.319333076477051
train global classifier
train glclassifier time: 3.779200531542301
global classifier accuracy: 100.0
end Update
server_global_time: 377.1663838401437
only_train_time: 5644.340153567493

-------------Global Round number: 121-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9321
Averaged Test Accuracy (Prototype Model): 0.9319
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0453
tobetrained:
[7, 6, 8, 2, 1, 4, 9, 5, 0, 3]
Edge 7 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 4 begin training
Edge 9 begin training
Edge 5 begin training
Edge 0 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 2, 8, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 2, 8, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.2988, 11.7993, 10.2270, 10.6957, 10.6437, 12.0429, 10.2270, 12.4920,
        12.8014, 13.3591], device='cuda:0')
Server loss: 4.318450450897217
train global classifier
train glclassifier time: 3.7044754326343536
global classifier accuracy: 100.0
end Update
server_global_time: 380.209771245718
only_train_time: 5689.718414068222

-------------Global Round number: 122-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9321
Averaged Test Accuracy (Prototype Model): 0.9319
Std Test Accuracy (Regular Model): 0.0467
Std Test Accuracy (Prototype Model): 0.0452
tobetrained:
[7, 1, 6, 2, 8, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 4, 9, 0, 5, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 4, 9, 0, 5, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.3313, 11.8328, 10.2642, 10.7277, 10.6794, 12.0810, 10.2642, 12.5270,
        12.8403, 13.3959], device='cuda:0')
Server loss: 4.319148063659668
train global classifier
train glclassifier time: 3.7641584798693657
global classifier accuracy: 100.0
end Update
server_global_time: 383.97712770849466
only_train_time: 5738.405852355063

-------------Global Round number: 123-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9321
Averaged Test Accuracy (Prototype Model): 0.9319
Std Test Accuracy (Regular Model): 0.0467
Std Test Accuracy (Prototype Model): 0.0452
tobetrained:
[7, 6, 1, 8, 2, 4, 9, 0, 5, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 0 begin training
Edge 5 begin training
Edge 3 begin training
readyList:
[1, 7, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[1, 7, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.3634, 11.8680, 10.2988, 10.7566, 10.7149, 12.1159, 10.2988, 12.5638,
        12.8785, 13.4324], device='cuda:0')
Server loss: 4.321666240692139
train global classifier
train glclassifier time: 3.7304593175649643
global classifier accuracy: 100.0
end Update
server_global_time: 386.9664666131139
only_train_time: 5784.506007365882

-------------Global Round number: 124-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9320
Averaged Test Accuracy (Prototype Model): 0.9319
Std Test Accuracy (Regular Model): 0.0468
Std Test Accuracy (Prototype Model): 0.0455
tobetrained:
[1, 7, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 1 begin training
Edge 7 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[1, 7, 6, 8, 5, 2, 4, 0, 9, 3]
aggregation_buffer:
[1, 7, 6, 8, 5, 2, 4, 0, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.3939, 11.9006, 10.3322, 10.7906, 10.7469, 12.1534, 10.3322, 12.6016,
        12.9194, 13.4709], device='cuda:0')
Server loss: 4.323114395141602
train global classifier
train glclassifier time: 4.003722138702869
global classifier accuracy: 100.0
end Update
server_global_time: 389.9896331652999
only_train_time: 5831.700961112976

-------------Global Round number: 125-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9321
Averaged Test Accuracy (Prototype Model): 0.9319
Std Test Accuracy (Regular Model): 0.0467
Std Test Accuracy (Prototype Model): 0.0455
tobetrained:
[1, 7, 6, 8, 5, 2, 4, 0, 9, 3]
Edge 1 begin training
Edge 7 begin training
Edge 6 begin training
Edge 8 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 0 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 5, 2, 0, 9, 4, 3]
aggregation_buffer:
[7, 1, 6, 8, 5, 2, 0, 9, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.4223, 11.9303, 10.3673, 10.8207, 10.7800, 12.1870, 10.3673, 12.6401,
        12.9513, 13.5069], device='cuda:0')
Server loss: 4.326251029968262
train global classifier
train glclassifier time: 4.072004899382591
global classifier accuracy: 100.0
end Update
server_global_time: 393.0212898030877
only_train_time: 5877.700203053653

-------------Global Round number: 126-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9322
Averaged Test Accuracy (Prototype Model): 0.9319
Std Test Accuracy (Regular Model): 0.0467
Std Test Accuracy (Prototype Model): 0.0455
tobetrained:
[7, 1, 6, 8, 5, 2, 0, 9, 4, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 5 begin training
Edge 2 begin training
Edge 0 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[1, 6, 7, 2, 8, 5, 0, 4, 9, 3]
aggregation_buffer:
[1, 6, 7, 2, 8, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.4543, 11.9583, 10.4036, 10.8534, 10.8187, 12.2192, 10.4036, 12.6796,
        12.9926, 13.5391], device='cuda:0')
Server loss: 4.321717739105225
train global classifier
train glclassifier time: 3.7977656722068787
global classifier accuracy: 100.0
end Update
server_global_time: 395.9848810657859
only_train_time: 5922.636322513223

-------------Global Round number: 127-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9321
Averaged Test Accuracy (Prototype Model): 0.9319
Std Test Accuracy (Regular Model): 0.0467
Std Test Accuracy (Prototype Model): 0.0455
tobetrained:
[1, 6, 7, 2, 8, 5, 0, 4, 9, 3]
Edge 1 begin training
Edge 6 begin training
Edge 7 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 4, 0, 5, 9, 2, 3]
aggregation_buffer:
[7, 1, 6, 8, 4, 0, 5, 9, 2, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.4886, 11.9876, 10.4358, 10.8860, 10.8547, 12.2579, 10.4358, 12.7223,
        13.0270, 13.5787], device='cuda:0')
Server loss: 4.326502323150635
train global classifier
train glclassifier time: 4.1301615089178085
global classifier accuracy: 100.0
end Update
server_global_time: 399.0888784006238
only_train_time: 5967.528225876391

-------------Global Round number: 128-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9321
Averaged Test Accuracy (Prototype Model): 0.9318
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0456
tobetrained:
[7, 1, 6, 8, 4, 0, 5, 9, 2, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 4 begin training
Edge 0 begin training
Edge 5 begin training
Edge 9 begin training
Edge 2 begin training
Edge 3 begin training
readyList:
[6, 7, 1, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[6, 7, 1, 8, 2, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.5181, 12.0180, 10.4686, 10.9191, 10.8872, 12.2916, 10.4686, 12.7635,
        13.0671, 13.6123], device='cuda:0')
Server loss: 4.325139999389648
train global classifier
train glclassifier time: 4.011761352419853
global classifier accuracy: 100.0
end Update
server_global_time: 402.07212004065514
only_train_time: 6012.754124745727

-------------Global Round number: 129-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9321
Averaged Test Accuracy (Prototype Model): 0.9319
Std Test Accuracy (Regular Model): 0.0465
Std Test Accuracy (Prototype Model): 0.0456
tobetrained:
[6, 7, 1, 8, 2, 5, 0, 4, 9, 3]
Edge 6 begin training
Edge 7 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 0, 5, 4, 9, 2, 3]
aggregation_buffer:
[7, 6, 1, 8, 0, 5, 4, 9, 2, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.5502, 12.0508, 10.5007, 10.9523, 10.9197, 12.3271, 10.5007, 12.8032,
        13.1067, 13.6480], device='cuda:0')
Server loss: 4.3243584632873535
train global classifier
train glclassifier time: 4.021977245807648
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 405.1044912561774
only_train_time: 6058.99630562216

-------------Global Round number: 130-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9321
Averaged Test Accuracy (Prototype Model): 0.9320
Std Test Accuracy (Regular Model): 0.0466
Std Test Accuracy (Prototype Model): 0.0456
tobetrained:
[7, 6, 1, 8, 0, 5, 4, 9, 2, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 2 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.5800, 12.0809, 10.5356, 10.9817, 10.9540, 12.3647, 10.5356, 12.8443,
        13.1417, 13.6852], device='cuda:0')
Server loss: 4.328850746154785
train global classifier
train glclassifier time: 3.9483401402831078
global classifier accuracy: 100.0
end Update
server_global_time: 408.1121675744653
only_train_time: 6104.069147080183

-------------Global Round number: 131-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9322
Averaged Test Accuracy (Prototype Model): 0.9319
Std Test Accuracy (Regular Model): 0.0465
Std Test Accuracy (Prototype Model): 0.0456
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.6124, 12.1136, 10.5672, 11.0153, 10.9836, 12.4047, 10.5672, 12.8828,
        13.1894, 13.7246], device='cuda:0')
Server loss: 4.3309712409973145
train global classifier
train glclassifier time: 3.6250764057040215
global classifier accuracy: 100.0
end Update
server_global_time: 411.1316180229187
only_train_time: 6148.990480311215

-------------Global Round number: 132-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9321
Averaged Test Accuracy (Prototype Model): 0.9321
Std Test Accuracy (Regular Model): 0.0466
Std Test Accuracy (Prototype Model): 0.0455
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.6444, 12.1416, 10.6008, 11.0481, 11.0165, 12.4435, 10.6008, 12.9262,
        13.2223, 13.7636], device='cuda:0')
Server loss: 4.3358306884765625
train global classifier
train glclassifier time: 3.8947105184197426
global classifier accuracy: 100.0
end Update
server_global_time: 414.21460343152285
only_train_time: 6194.571212388575

-------------Global Round number: 133-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9321
Averaged Test Accuracy (Prototype Model): 0.9320
Std Test Accuracy (Regular Model): 0.0466
Std Test Accuracy (Prototype Model): 0.0453
tobetrained:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.6760, 12.1716, 10.6379, 11.0764, 11.0541, 12.4711, 10.6379, 12.9592,
        13.2616, 13.7995], device='cuda:0')
Server loss: 4.334621429443359
train global classifier
train glclassifier time: 3.9165861904621124
global classifier accuracy: 100.0
end Update
server_global_time: 417.1890609636903
only_train_time: 6240.612936124206

-------------Global Round number: 134-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9320
Averaged Test Accuracy (Prototype Model): 0.9321
Std Test Accuracy (Regular Model): 0.0466
Std Test Accuracy (Prototype Model): 0.0452
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 8, 2, 0, 5, 1, 6, 9, 4, 3]
aggregation_buffer:
[7, 8, 2, 0, 5, 1, 6, 9, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.7073, 12.2019, 10.6707, 11.1028, 11.0905, 12.5017, 10.6707, 12.9962,
        13.3012, 13.8337], device='cuda:0')
Server loss: 4.33442497253418
train global classifier
train glclassifier time: 3.6640527322888374
global classifier accuracy: 100.0
end Update
server_global_time: 420.1832192540169
only_train_time: 6287.678364418447

-------------Global Round number: 135-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9322
Averaged Test Accuracy (Prototype Model): 0.9322
Std Test Accuracy (Regular Model): 0.0465
Std Test Accuracy (Prototype Model): 0.0450
tobetrained:
[7, 8, 2, 0, 5, 1, 6, 9, 4, 3]
Edge 7 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 1 begin training
Edge 6 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 8, 2, 5, 0, 1, 4, 6, 9, 3]
aggregation_buffer:
[7, 8, 2, 5, 0, 1, 4, 6, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.7357, 12.2304, 10.7042, 11.1341, 11.1211, 12.5373, 10.7042, 13.0408,
        13.3330, 13.8757], device='cuda:0')
Server loss: 4.340469837188721
train global classifier
train glclassifier time: 4.011116988956928
global classifier accuracy: 100.0
end Update
server_global_time: 423.1451862603426
only_train_time: 6335.329020932317

-------------Global Round number: 136-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9322
Averaged Test Accuracy (Prototype Model): 0.9322
Std Test Accuracy (Regular Model): 0.0466
Std Test Accuracy (Prototype Model): 0.0451
tobetrained:
[7, 8, 2, 5, 0, 1, 4, 6, 9, 3]
Edge 7 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 8, 6, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 8, 6, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.7665, 12.2609, 10.7371, 11.1645, 11.1533, 12.5664, 10.7371, 13.0805,
        13.3753, 13.9103], device='cuda:0')
Server loss: 4.339770793914795
train global classifier
train glclassifier time: 3.660268373787403
global classifier accuracy: 100.0
end Update
server_global_time: 426.1094361245632
only_train_time: 6380.748931668699

-------------Global Round number: 137-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9322
Averaged Test Accuracy (Prototype Model): 0.9322
Std Test Accuracy (Regular Model): 0.0466
Std Test Accuracy (Prototype Model): 0.0451
tobetrained:
[7, 1, 8, 6, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 8 begin training
Edge 6 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 0, 1, 8, 5, 4, 6, 9, 2, 3]
aggregation_buffer:
[7, 0, 1, 8, 5, 4, 6, 9, 2, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.7976, 12.2899, 10.7733, 11.1957, 11.1862, 12.6000, 10.7733, 13.1208,
        13.4075, 13.9482], device='cuda:0')
Server loss: 4.344173431396484
train global classifier
train glclassifier time: 4.1042726412415504
global classifier accuracy: 100.0
end Update
server_global_time: 429.21498293429613
only_train_time: 6426.883320353925

-------------Global Round number: 138-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9319
Averaged Test Accuracy (Prototype Model): 0.9321
Std Test Accuracy (Regular Model): 0.0467
Std Test Accuracy (Prototype Model): 0.0452
tobetrained:
[7, 0, 1, 8, 5, 4, 6, 9, 2, 3]
Edge 7 begin training
Edge 0 begin training
Edge 1 begin training
Edge 8 begin training
Edge 5 begin training
Edge 4 begin training
Edge 6 begin training
Edge 9 begin training
Edge 2 begin training
Edge 3 begin training
readyList:
[7, 1, 8, 2, 0, 5, 6, 4, 9, 3]
aggregation_buffer:
[7, 1, 8, 2, 0, 5, 6, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.8306, 12.3207, 10.8108, 11.2253, 11.2223, 12.6338, 10.8108, 13.1609,
        13.4478, 13.9840], device='cuda:0')
Server loss: 4.343637466430664
train global classifier
train glclassifier time: 3.9899022728204727
global classifier accuracy: 100.0
end Update
server_global_time: 432.24110274016857
only_train_time: 6473.052882261574

-------------Global Round number: 139-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9322
Averaged Test Accuracy (Prototype Model): 0.9322
Std Test Accuracy (Regular Model): 0.0465
Std Test Accuracy (Prototype Model): 0.0453
tobetrained:
[7, 1, 8, 2, 0, 5, 6, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 6 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.8683, 12.3523, 10.8465, 11.2584, 11.2568, 12.6727, 10.8465, 13.2033,
        13.4917, 14.0224], device='cuda:0')
Server loss: 4.344805717468262
train global classifier
train glclassifier time: 4.130412749946117
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 435.2969623282552
only_train_time: 6522.334598504007

-------------Global Round number: 140-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9321
Averaged Test Accuracy (Prototype Model): 0.9320
Std Test Accuracy (Regular Model): 0.0465
Std Test Accuracy (Prototype Model): 0.0453
tobetrained:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 8, 2, 0, 9, 4, 1, 5, 3]
aggregation_buffer:
[7, 6, 8, 2, 0, 9, 4, 1, 5, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.8996, 12.3799, 10.8811, 11.2871, 11.2963, 12.7071, 10.8811, 13.2431,
        13.5273, 14.0603], device='cuda:0')
Server loss: 4.347835063934326
train global classifier
train glclassifier time: 3.5749771744012833
global classifier accuracy: 100.0
end Update
server_global_time: 438.2835831493139
only_train_time: 6570.033309087157

-------------Global Round number: 141-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9320
Averaged Test Accuracy (Prototype Model): 0.9320
Std Test Accuracy (Regular Model): 0.0467
Std Test Accuracy (Prototype Model): 0.0453
tobetrained:
[7, 6, 8, 2, 0, 9, 4, 1, 5, 3]
Edge 7 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 9 begin training
Edge 4 begin training
Edge 1 begin training
Edge 5 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 5, 4, 0, 2, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 5, 4, 0, 2, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.9355, 12.4090, 10.9195, 11.3211, 11.3338, 12.7397, 10.9195, 13.2802,
        13.5713, 14.0924], device='cuda:0')
Server loss: 4.344919681549072
train global classifier
train glclassifier time: 3.747778505086899
global classifier accuracy: 100.0
end Update
server_global_time: 441.26588973402977
only_train_time: 6615.706938251853

-------------Global Round number: 142-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9322
Averaged Test Accuracy (Prototype Model): 0.9321
Std Test Accuracy (Regular Model): 0.0466
Std Test Accuracy (Prototype Model): 0.0454
tobetrained:
[7, 1, 6, 8, 5, 4, 0, 2, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 5 begin training
Edge 4 begin training
Edge 0 begin training
Edge 2 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 0, 5, 2, 6, 4, 9, 8, 3]
aggregation_buffer:
[7, 1, 0, 5, 2, 6, 4, 9, 8, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.9674, 12.4395, 10.9542, 11.3496, 11.3661, 12.7746, 10.9542, 13.3226,
        13.6075, 14.1312], device='cuda:0')
Server loss: 4.347779273986816
train global classifier
train glclassifier time: 3.789191357791424
global classifier accuracy: 100.0
end Update
server_global_time: 444.25844387710094
only_train_time: 6662.468040443957

-------------Global Round number: 143-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9319
Averaged Test Accuracy (Prototype Model): 0.9319
Std Test Accuracy (Regular Model): 0.0466
Std Test Accuracy (Prototype Model): 0.0454
tobetrained:
[7, 1, 0, 5, 2, 6, 4, 9, 8, 3]
Edge 7 begin training
Edge 1 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 6 begin training
Edge 4 begin training
Edge 9 begin training
Edge 8 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 5, 9, 2, 4, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 5, 9, 2, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.9823, 12.4605, 10.9778, 11.3593, 11.3890, 12.7173, 10.9778, 13.2965,
        13.6005, 14.0978], device='cuda:0')
Server loss: 4.320967674255371
train global classifier
train glclassifier time: 3.8956659361720085
global classifier accuracy: 100.0
end Update
server_global_time: 447.2212902009487
only_train_time: 6709.0425456389785

-------------Global Round number: 144-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9319
Averaged Test Accuracy (Prototype Model): 0.9317
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0454
tobetrained:
[7, 1, 6, 8, 0, 5, 9, 2, 4, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 9 begin training
Edge 2 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 5, 9, 4, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 5, 9, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.0149, 12.4949, 11.0149, 11.3950, 11.4200, 12.7503, 11.0158, 13.3296,
        13.6277, 14.1336], device='cuda:0')
Server loss: 4.315059661865234
train global classifier
train glclassifier time: 3.7645503282546997
global classifier accuracy: 100.0
end Update
server_global_time: 450.2318443581462
only_train_time: 6754.417594239116

-------------Global Round number: 145-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9319
Averaged Test Accuracy (Prototype Model): 0.9320
Std Test Accuracy (Regular Model): 0.0465
Std Test Accuracy (Prototype Model): 0.0456
tobetrained:
[7, 6, 1, 8, 2, 0, 5, 9, 4, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.0456, 12.5248, 11.0456, 11.4228, 11.4528, 12.7876, 11.0473, 13.3751,
        13.6633, 14.1740], device='cuda:0')
Server loss: 4.317518711090088
train global classifier
train glclassifier time: 3.7782633751630783
global classifier accuracy: 100.0
end Update
server_global_time: 453.19936741888523
only_train_time: 6799.926121540368

-------------Global Round number: 146-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9321
Averaged Test Accuracy (Prototype Model): 0.9318
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0457
tobetrained:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 9, 5, 4, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 9, 5, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.0812, 12.5595, 11.0777, 11.4554, 11.4889, 12.8236, 11.0777, 13.4137,
        13.7085, 14.2103], device='cuda:0')
Server loss: 4.3202223777771
train global classifier
train glclassifier time: 3.8852504938840866
global classifier accuracy: 100.0
end Update
server_global_time: 456.20470061153173
only_train_time: 6847.245925329626

-------------Global Round number: 147-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9321
Averaged Test Accuracy (Prototype Model): 0.9318
Std Test Accuracy (Regular Model): 0.0465
Std Test Accuracy (Prototype Model): 0.0457
tobetrained:
[7, 1, 6, 8, 2, 0, 9, 5, 4, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 9 begin training
Edge 5 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 4, 9, 5, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 4, 9, 5, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.1072, 12.5921, 11.1072, 11.4864, 11.5186, 12.8561, 11.1091, 13.4509,
        13.7521, 14.2491], device='cuda:0')
Server loss: 4.322265148162842
train global classifier
train glclassifier time: 3.9051083475351334
global classifier accuracy: 100.0
end Update
server_global_time: 459.3145304322243
only_train_time: 6893.500517323613

-------------Global Round number: 148-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9321
Averaged Test Accuracy (Prototype Model): 0.9319
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0458
tobetrained:
[7, 1, 6, 8, 2, 0, 4, 9, 5, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 5 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 0, 2, 4, 5, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 0, 2, 4, 5, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.1386, 12.6214, 11.1386, 11.5151, 11.5526, 12.8918, 11.1424, 13.4946,
        13.7971, 14.2880], device='cuda:0')
Server loss: 4.32402229309082
train global classifier
train glclassifier time: 3.6214710399508476
global classifier accuracy: 100.0
end Update
server_global_time: 462.0440474078059
only_train_time: 6938.1813213303685

-------------Global Round number: 149-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9319
Averaged Test Accuracy (Prototype Model): 0.9318
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0458
tobetrained:
[7, 6, 1, 8, 0, 2, 4, 5, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.1725, 12.6541, 11.1725, 11.5456, 11.5848, 12.9277, 11.1803, 13.5374,
        13.8362, 14.3271], device='cuda:0')
Server loss: 4.326731204986572
train global classifier
train glclassifier time: 3.5925352871418
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 465.04952696710825
only_train_time: 6983.264324955642

-------------Global Round number: 150-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9321
Averaged Test Accuracy (Prototype Model): 0.9319
Std Test Accuracy (Regular Model): 0.0465
Std Test Accuracy (Prototype Model): 0.0459

Best accuracy.
0.9322827452323855
File path: ../results/FashionMNIST_dir_0.3_imbalance_40_FedSAE_test_0.h5
Deleted.

Average time cost: 9988.29s.
Length:  151
std for best accurancy: 0.0
mean for best accurancy: 0.9322827452323855
All done!

Storage on cpu
-------------------------------------------------------------------------------
Total Tensors: 5130 	Used Memory: 20.50K
-------------------------------------------------------------------------------

Storage on cuda:0
-------------------------------------------------------------------------------
Total Tensors: 171040 	Used Memory: 14.35M
The allocated memory on cuda:0: 14.35M
-------------------------------------------------------------------------------
