
cuda is not avaiable.

==================================================
goal = test
device = cpu
device_id = 0
dataset = FashionMNIST_dir_0.3_imbalance_40
num_classes = 10
model_family = HCNNs8
batch_size = 256
local_learning_rate = 0.06
use_decay_scheduler = False
learning_rate_decay = False
learning_rate_decay_gamma = 0.99
global_rounds = 100
edge_epochs = 1
local_epochs = 10
algorithm = FedSAE
join_ratio = 1.0
random_join_ratio = False
num_clients = 40
num_edges = 10
prev = 0
times = 1
eval_gap = 1
save_folder_name = temp
auto_break = False
feature_dim = 512
vocab_size = 98635
max_len = 200
client_drop_rate = 0.0
train_slow_rate = 0.0
send_slow_rate = 0.0
time_select = False
time_threthold = 10000
lamda = 2
trans_delay_simulate = False
agg_type = 0
buffersize = 5
test_useglclassifier = 1
gamma = 1
addTGP = True
drawtsne = True
drawround = 20
noise_dim = 512
generator_learning_rate = 0.005
hidden_dim = 512
server_epochs = 100
alpha = 1.0
beta = 1.0
mentee_learning_rate = 0.005
T_start = 0.95
T_end = 0.98
server_learning_rate = 0.01
margin_threthold = 100.0
generator_path = stylegan/stylegan-xl-models/imagenet64.pkl
stable_diffusion_prompt = a cat
server_batch_size = 100
gen_batch_size = 4
mu = 50.0
==================================================
Random seed set as 42

============= Running time: 0th =============
Creating server and clients ...
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 0
label_counts: defaultdict(<class 'int'>, {5: 106, 1: 338, 0: 287, 3: 26, 9: 545, 6: 3, 2: 98, 4: 1})
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 1
label_counts: defaultdict(<class 'int'>, {4: 630, 7: 199, 1: 507, 2: 18, 5: 47, 0: 18, 3: 3, 6: 2})
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 2
label_counts: defaultdict(<class 'int'>, {0: 190, 5: 157, 7: 312, 9: 99, 6: 67, 8: 6, 2: 3, 3: 30, 4: 11})
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 3
label_counts: defaultdict(<class 'int'>, {6: 100, 3: 171, 8: 190, 9: 19, 4: 51, 2: 395, 0: 3, 5: 4})
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 4
label_counts: defaultdict(<class 'int'>, {5: 553, 0: 327, 1: 428, 2: 202, 4: 5})
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 5
label_counts: defaultdict(<class 'int'>, {4: 421, 6: 633, 2: 58, 3: 41, 8: 45, 1: 100, 7: 11, 5: 13, 0: 1})
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 6
label_counts: defaultdict(<class 'int'>, {4: 260, 9: 425, 8: 384, 3: 24, 1: 12, 2: 6, 6: 31, 7: 1})
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 7
label_counts: defaultdict(<class 'int'>, {9: 477, 8: 645, 6: 335, 7: 16, 3: 38, 5: 13, 4: 53, 0: 36, 1: 11, 2: 7})
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 8
label_counts: defaultdict(<class 'int'>, {4: 502, 9: 102, 0: 124, 6: 63, 2: 81, 8: 26, 5: 17, 3: 9, 1: 3})
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 9
label_counts: defaultdict(<class 'int'>, {3: 943, 2: 177, 1: 139, 0: 75})
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 10
label_counts: defaultdict(<class 'int'>, {8: 445, 4: 883, 2: 57, 0: 32, 3: 12, 5: 19, 7: 1, 6: 1, 1: 1})
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 11
label_counts: defaultdict(<class 'int'>, {6: 147, 4: 230, 8: 220, 9: 88, 3: 44, 1: 58, 5: 54, 2: 13, 7: 8})
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 12
label_counts: defaultdict(<class 'int'>, {6: 248, 3: 165, 1: 263, 9: 14, 0: 206, 5: 101, 7: 1, 4: 1})
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 13
label_counts: defaultdict(<class 'int'>, {3: 402, 2: 795, 4: 7, 7: 197, 0: 11, 5: 3, 1: 7})
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 14
label_counts: defaultdict(<class 'int'>, {9: 218, 0: 312, 3: 131, 4: 21, 5: 65, 1: 57, 2: 44, 8: 3})
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 15
label_counts: defaultdict(<class 'int'>, {6: 980, 5: 215, 3: 12, 1: 39, 0: 83, 4: 2})
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 16
label_counts: defaultdict(<class 'int'>, {4: 58, 3: 83, 0: 140, 1: 860, 5: 68, 8: 280, 6: 18, 7: 1})
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 17
label_counts: defaultdict(<class 'int'>, {8: 642, 5: 490, 0: 104, 4: 28, 3: 30, 2: 16, 7: 1, 6: 21, 1: 2})
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 18
label_counts: defaultdict(<class 'int'>, {8: 391, 1: 105, 2: 1, 4: 108, 7: 229, 3: 33, 5: 27, 6: 2, 0: 1})
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 19
label_counts: defaultdict(<class 'int'>, {1: 364, 0: 1204})
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 20
label_counts: defaultdict(<class 'int'>, {9: 858, 0: 37, 1: 290, 6: 44, 4: 216, 5: 157, 7: 131, 2: 19, 3: 1, 8: 1})
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 21
label_counts: defaultdict(<class 'int'>, {6: 225, 0: 136, 1: 383, 3: 62, 4: 288, 7: 16, 8: 4, 9: 1, 5: 1})
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 22
label_counts: defaultdict(<class 'int'>, {5: 243, 7: 387, 1: 102, 2: 9, 6: 68, 0: 12, 4: 1, 8: 15, 3: 1})
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 23
label_counts: defaultdict(<class 'int'>, {0: 232, 9: 256, 5: 40, 8: 141, 1: 32, 7: 1, 3: 2, 6: 1})
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 24
label_counts: defaultdict(<class 'int'>, {4: 309, 9: 235, 3: 447, 5: 120, 0: 62, 8: 15, 1: 2})
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 25
label_counts: defaultdict(<class 'int'>, {7: 222, 3: 388, 5: 505, 2: 154, 0: 81, 4: 7, 1: 34})
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 26
label_counts: defaultdict(<class 'int'>, {8: 568, 7: 172, 4: 139, 0: 443, 3: 26, 2: 116, 1: 10, 5: 5})
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 27
label_counts: defaultdict(<class 'int'>, {2: 186, 5: 530, 6: 253, 3: 75, 0: 88, 7: 1, 4: 5})
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 28
label_counts: defaultdict(<class 'int'>, {1: 63, 9: 281, 5: 14, 7: 176, 2: 50, 8: 93, 3: 24, 0: 22, 6: 2, 4: 1})
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 29
label_counts: defaultdict(<class 'int'>, {7: 363, 5: 337, 8: 138, 3: 170, 9: 164, 2: 27, 1: 20, 4: 2, 6: 3})
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 30
label_counts: defaultdict(<class 'int'>, {8: 229, 7: 302, 0: 243, 9: 43, 5: 24, 2: 1, 3: 2, 1: 2})
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 31
label_counts: defaultdict(<class 'int'>, {2: 510, 4: 583, 0: 98, 1: 223})
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 32
label_counts: defaultdict(<class 'int'>, {9: 1142, 7: 49, 2: 276, 5: 146, 1: 20, 3: 51, 6: 75, 8: 12, 0: 31, 4: 1})
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 33
label_counts: defaultdict(<class 'int'>, {2: 405, 6: 254, 7: 122, 1: 76, 3: 276, 0: 151, 4: 83})
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 34
label_counts: defaultdict(<class 'int'>, {0: 172, 2: 880, 6: 870, 3: 12, 1: 42, 4: 9})
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 35
label_counts: defaultdict(<class 'int'>, {4: 312, 9: 70, 0: 300, 6: 18, 7: 36, 5: 70, 2: 90, 3: 121, 1: 25, 8: 1})
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 36
label_counts: defaultdict(<class 'int'>, {6: 412, 2: 127, 8: 221, 3: 364, 1: 41, 9: 158, 7: 124, 0: 3, 4: 5})
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 37
label_counts: defaultdict(<class 'int'>, {7: 2178, 3: 1002, 6: 142, 4: 3, 2: 20, 5: 11, 0: 1})
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 38
label_counts: defaultdict(<class 'int'>, {5: 1124, 1: 545, 2: 23, 0: 14, 3: 21, 4: 1})
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 39
label_counts: defaultdict(<class 'int'>, {2: 387, 6: 233, 8: 501, 1: 41, 0: 13, 9: 3, 3: 2, 5: 12, 4: 1, 7: 2})

Join ratio / total clients: 1.0 / 40
Finished creating server and clients.
Trainable_prototypes(
  (embedings): Embedding(10, 512)
  (middle): Sequential(
    (0): Sequential(
      (0): Linear(in_features=512, out_features=512, bias=True)
      (1): ReLU()
    )
  )
  (fc): Linear(in_features=512, out_features=512, bias=True)
)
tobetrained:
[9, 8, 7, 6, 5, 4, 3, 2, 1, 0]
Edge 9 begin training
Server global_protos Not Found
Server glclassifier Not Found
Client_10 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_34 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_14 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_27 protos Not Found
Client_14 prev_protos Not Found
Client_10 prev_protos Not Found
Client_34 prev_protos Not Found
Client_27 prev_protos Not Found
Edge 8 begin training
Server global_protos Not Found
Server glclassifier Not Found
Client_3 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_31 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_22 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_21 protos Not Found
Client_22 prev_protos Not Found
Client_3 prev_protos Not Found
Client_21 prev_protos Not Found
Client_31 prev_protos Not Found
Edge 7 begin training
Server global_protos Not Found
Server glclassifier Not Found
Client_23 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_35 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_6 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_30 protos Not Found
Client_6 prev_protos Not Found
Client_35 prev_protos Not Found
Client_23 prev_protos Not Found
Client_30 prev_protos Not Found
Edge 6 begin training
Server global_protos Not Found
Server glclassifier Not Found
Client_4 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_39 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_9 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_8 protos Not Found
Client_4 prev_protos Not Found
Client_39 prev_protos Not Found
Client_9 prev_protos Not Found
Client_8 prev_protos Not Found
Edge 5 begin training
Server global_protos Not Found
Server glclassifier Not Found
Client_11 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_32 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_29 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_0 protos Not Found
Client_0 prev_protos Not Found
Client_32 prev_protos Not Found
Client_29 prev_protos Not Found
Client_11 prev_protos Not Found
Edge 4 begin training
Server global_protos Not Found
Server glclassifier Not Found
Client_36 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_7 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_1 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_28 protos Not Found
Client_1 prev_protos Not Found
Client_36 prev_protos Not Found
Client_7 prev_protos Not Found
Client_28 prev_protos Not Found
Edge 3 begin training
Server global_protos Not Found
Server glclassifier Not Found
Client_37 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_13 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_20 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_18 protos Not Found
Client_20 prev_protos Not Found
Client_13 prev_protos Not Found
Client_18 prev_protos Not Found
Client_37 prev_protos Not Found
Edge 2 begin training
Server global_protos Not Found
Server glclassifier Not Found
Client_5 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_25 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_2 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_38 protos Not Found
Client_38 prev_protos Not Found
Client_5 prev_protos Not Found
Client_2 prev_protos Not Found
Client_25 prev_protos Not Found
Edge 1 begin training
Server global_protos Not Found
Server glclassifier Not Found
Client_12 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_17 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_33 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_24 protos Not Found
Client_17 prev_protos Not Found
Client_24 prev_protos Not Found
Client_12 prev_protos Not Found
Client_33 prev_protos Not Found
Edge 0 begin training
Server global_protos Not Found
Server glclassifier Not Found
Client_26 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_15 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_19 protos Not Found
Server global_protos Not Found
Server glclassifier Not Found
Client_16 protos Not Found
Client_19 prev_protos Not Found
Client_16 prev_protos Not Found
Client_15 prev_protos Not Found
Client_26 prev_protos Not Found
readyList:
[7, 1, 5, 0, 8, 6, 9, 2, 4, 3]
aggregation_buffer:
[7, 1, 5, 0, 8]
Edge_0 prev_protos Not Found
Edge_1 prev_protos Not Found
Edge_2 prev_protos Not Found
Edge_3 prev_protos Not Found
Edge_4 prev_protos Not Found
Edge_5 prev_protos Not Found
Edge_6 prev_protos Not Found
Edge_7 prev_protos Not Found
Edge_8 prev_protos Not Found
Edge_9 prev_protos Not Found
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([3.8070, 5.6635, 2.9624, 4.5096, 2.9624, 4.1541, 3.4082, 4.3042, 3.8401,
        8.9710])
Server loss: 10.283560752868652
train global classifier
train glclassifier time: 3.8005689340643585
global classifier accuracy: 99.5525
Number of samples: 324
end Update
server_global_time: 6.006858897861093
only_train_time: 197.14717350481078

-------------Global Round number: 0-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.5722
Averaged Test Accuracy (Prototype Model): 0.6244
Std Test Accuracy (Regular Model): 0.2528
Std Test Accuracy (Prototype Model): 0.2275
tobetrained:
[7, 1, 5, 0, 8]
Edge 7 begin training
Edge 1 begin training
Edge 5 begin training
Edge 0 begin training
Edge 8 begin training
readyList:
[6, 9, 2, 4, 1, 5, 7, 0, 8, 3]
aggregation_buffer:
[6, 9, 2, 4, 1]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([3.1470, 5.0228, 2.0998, 3.9062, 2.6829, 3.5969, 2.0998, 3.5969, 3.3473,
        7.1264])
Server loss: 7.5394463539123535
train global classifier
train glclassifier time: 3.709668600000441
global classifier accuracy: 99.1425
end Update
server_global_time: 10.11219744477421
only_train_time: 272.3283045976423

-------------Global Round number: 1-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.7958
Averaged Test Accuracy (Prototype Model): 0.7523
Std Test Accuracy (Regular Model): 0.1526
Std Test Accuracy (Prototype Model): 0.1674
tobetrained:
[6, 9, 2, 4, 1]
Edge 6 begin training
Edge 9 begin training
Edge 2 begin training
Edge 4 begin training
Edge 1 begin training
readyList:
[5, 7, 0, 8, 3, 1, 9, 6, 4, 2]
aggregation_buffer:
[5, 7, 0, 8, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([2.6411, 4.1795, 1.8867, 4.4341, 2.6875, 4.1581, 1.8867, 6.9789, 3.2510,
        5.1299])
Server loss: 6.762643337249756
train global classifier
train glclassifier time: 3.8523133508861065
global classifier accuracy: 99.395
end Update
server_global_time: 13.086174344876781
only_train_time: 354.9530050912872

-------------Global Round number: 2-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.8669
Averaged Test Accuracy (Prototype Model): 0.8399
Std Test Accuracy (Regular Model): 0.0832
Std Test Accuracy (Prototype Model): 0.0897
tobetrained:
[5, 7, 0, 8, 3]
Edge 5 begin training
Edge 7 begin training
Edge 0 begin training
Edge 8 begin training
Edge 3 begin training
readyList:
[1, 9, 6, 4, 2, 7, 8, 0, 5, 3]
aggregation_buffer:
[1, 9, 6, 4, 2]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([2.5912, 4.4848, 1.7823, 4.4522, 2.2277, 4.2962, 1.7823, 7.2938, 3.5182,
        5.5759])
Server loss: 6.4347405433654785
train global classifier
train glclassifier time: 3.7242834439966828
global classifier accuracy: 99.46
end Update
server_global_time: 16.471112383762375
only_train_time: 441.147654469125

-------------Global Round number: 3-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.8809
Averaged Test Accuracy (Prototype Model): 0.8604
Std Test Accuracy (Regular Model): 0.0819
Std Test Accuracy (Prototype Model): 0.0858
tobetrained:
[1, 9, 6, 4, 2]
Edge 1 begin training
Edge 9 begin training
Edge 6 begin training
Edge 4 begin training
Edge 2 begin training
readyList:
[7, 8, 0, 5, 1, 9, 6, 2, 4, 3]
aggregation_buffer:
[7, 8, 0, 5, 1]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([3.2844, 5.6304, 1.9044, 3.8078, 2.2840, 4.9242, 1.9044, 4.9391, 4.1602,
        6.2359])
Server loss: 4.879267692565918
train global classifier
train glclassifier time: 3.749312774045393
global classifier accuracy: 99.71
end Update
server_global_time: 20.652930929791182
only_train_time: 522.8749380277004

-------------Global Round number: 4-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.8908
Averaged Test Accuracy (Prototype Model): 0.8706
Std Test Accuracy (Regular Model): 0.0815
Std Test Accuracy (Prototype Model): 0.0798
tobetrained:
[7, 8, 0, 5, 1]
Edge 7 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 1 begin training
readyList:
[9, 6, 2, 4, 7, 1, 3, 5, 0, 8]
aggregation_buffer:
[9, 6, 2, 4, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([3.6484, 6.4109, 2.0577, 4.2390, 2.5361, 5.6078, 2.0577, 5.6078, 4.8989,
        7.1660])
Server loss: 5.342799186706543
train global classifier
train glclassifier time: 3.714422939810902
global classifier accuracy: 99.75
end Update
server_global_time: 24.619614127790555
only_train_time: 597.1869182025548

-------------Global Round number: 5-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.8944
Averaged Test Accuracy (Prototype Model): 0.8776
Std Test Accuracy (Regular Model): 0.0770
Std Test Accuracy (Prototype Model): 0.0776
tobetrained:
[9, 6, 2, 4, 7]
Edge 9 begin training
Edge 6 begin training
Edge 2 begin training
Edge 4 begin training
Edge 7 begin training
readyList:
[1, 3, 5, 0, 8, 7, 9, 6, 4, 2]
aggregation_buffer:
[1, 3, 5, 0, 8]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([4.1561, 7.1519, 2.2262, 4.4594, 2.6557, 5.9015, 2.2262, 5.9015, 5.3713,
        7.6915])
Server loss: 5.416383266448975
train global classifier
train glclassifier time: 3.819271554937586
global classifier accuracy: 99.7475
end Update
server_global_time: 25.917885173810646
only_train_time: 676.0812396423426

-------------Global Round number: 6-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.8981
Averaged Test Accuracy (Prototype Model): 0.8795
Std Test Accuracy (Regular Model): 0.0695
Std Test Accuracy (Prototype Model): 0.0694
tobetrained:
[1, 3, 5, 0, 8]
Edge 1 begin training
Edge 3 begin training
Edge 5 begin training
Edge 0 begin training
Edge 8 begin training
readyList:
[7, 9, 6, 1, 4, 2, 5, 0, 8, 3]
aggregation_buffer:
[7, 9, 6, 1, 4]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([4.5543, 7.8038, 2.4123, 4.9736, 3.1058, 6.6638, 2.4123, 6.6638, 6.2070,
        8.4841])
Server loss: 5.681720733642578
train global classifier
train glclassifier time: 3.8446492708753794
global classifier accuracy: 99.765
end Update
server_global_time: 30.465845794649795
only_train_time: 762.3764256762806

-------------Global Round number: 7-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9026
Averaged Test Accuracy (Prototype Model): 0.8850
Std Test Accuracy (Regular Model): 0.0683
Std Test Accuracy (Prototype Model): 0.0681
tobetrained:
[7, 9, 6, 1, 4]
Edge 7 begin training
Edge 9 begin training
Edge 6 begin training
Edge 1 begin training
Edge 4 begin training
readyList:
[2, 5, 0, 8, 1, 9, 7, 6, 4, 3]
aggregation_buffer:
[2, 5, 0, 8, 1]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([5.0753, 8.6662, 2.7101, 5.6991, 3.3768, 7.5461, 2.7101, 7.5461, 6.8230,
        9.1374])
Server loss: 5.877390384674072
train global classifier
train glclassifier time: 4.282202234957367
global classifier accuracy: 99.88
end Update
server_global_time: 34.85853970074095
only_train_time: 841.4350064110477

-------------Global Round number: 8-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9047
Averaged Test Accuracy (Prototype Model): 0.8905
Std Test Accuracy (Regular Model): 0.0702
Std Test Accuracy (Prototype Model): 0.0631
tobetrained:
[2, 5, 0, 8, 1]
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 8 begin training
Edge 1 begin training
readyList:
[9, 7, 6, 4, 3, 1, 5, 0, 8, 2]
aggregation_buffer:
[9, 7, 6, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([5.4454, 9.0421, 2.9341, 6.0710, 3.8520, 7.8309, 2.9341, 7.8309, 7.5259,
        9.5796])
Server loss: 5.7941060066223145
train global classifier
train glclassifier time: 3.956828528083861
global classifier accuracy: 99.9025
end Update
server_global_time: 37.41088216076605
only_train_time: 927.2715617027134

-------------Global Round number: 9-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9069
Averaged Test Accuracy (Prototype Model): 0.8912
Std Test Accuracy (Regular Model): 0.0669
Std Test Accuracy (Prototype Model): 0.0649
tobetrained:
[9, 7, 6, 4, 3]
Edge 9 begin training
Edge 7 begin training
Edge 6 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[1, 5, 0, 8, 7, 9, 6, 4, 2, 3]
aggregation_buffer:
[1, 5, 0, 8, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 6.1926,  9.8184,  3.2248,  6.4991,  4.2450,  8.6935,  3.2248,  8.6935,
         8.2408, 10.4693])
Server loss: 6.133855819702148
train global classifier
train glclassifier time: 3.8763572450261563
global classifier accuracy: 99.9
end Update
server_global_time: 41.57220902177505
only_train_time: 1014.1276992587373

-------------Global Round number: 10-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9085
Averaged Test Accuracy (Prototype Model): 0.8953
Std Test Accuracy (Regular Model): 0.0660
Std Test Accuracy (Prototype Model): 0.0626
tobetrained:
[1, 5, 0, 8, 7]
Edge 1 begin training
Edge 5 begin training
Edge 0 begin training
Edge 8 begin training
Edge 7 begin training
readyList:
[9, 6, 4, 2, 1, 7, 5, 0, 8, 3]
aggregation_buffer:
[9, 6, 4, 2, 1]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 6.4687, 10.4232,  3.6362,  7.3761,  5.0296,  9.5200,  3.6362,  9.6465,
         9.0092, 11.0495])
Server loss: 6.203979969024658
train global classifier
train glclassifier time: 3.923164526000619
global classifier accuracy: 99.9075
end Update
server_global_time: 45.64588281069882
only_train_time: 1088.6823637236375

-------------Global Round number: 11-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9100
Averaged Test Accuracy (Prototype Model): 0.8952
Std Test Accuracy (Regular Model): 0.0643
Std Test Accuracy (Prototype Model): 0.0638
tobetrained:
[9, 6, 4, 2, 1]
Edge 9 begin training
Edge 6 begin training
Edge 4 begin training
Edge 2 begin training
Edge 1 begin training
readyList:
[7, 5, 0, 8, 3, 1, 6, 9, 2, 4]
aggregation_buffer:
[7, 5, 0, 8, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.0096, 11.0651,  3.8892,  7.5678,  5.3726,  9.8789,  3.8892, 10.0360,
         9.5099, 11.5628])
Server loss: 6.2138237953186035
train global classifier
train glclassifier time: 4.2289502860512584
global classifier accuracy: 99.94
end Update
server_global_time: 48.90158123476431
only_train_time: 1170.5120110337157

-------------Global Round number: 12-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9122
Averaged Test Accuracy (Prototype Model): 0.8971
Std Test Accuracy (Regular Model): 0.0623
Std Test Accuracy (Prototype Model): 0.0608
tobetrained:
[7, 5, 0, 8, 3]
Edge 7 begin training
Edge 5 begin training
Edge 0 begin training
Edge 8 begin training
Edge 3 begin training
readyList:
[1, 6, 9, 2, 4, 7, 5, 0, 8, 3]
aggregation_buffer:
[1, 6, 9, 2, 4]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.3907, 11.6105,  4.3531,  8.2041,  6.1481, 10.7470,  4.3531, 10.7470,
        10.1870, 12.0461])
Server loss: 6.1562323570251465
train global classifier
train glclassifier time: 3.93340462888591
global classifier accuracy: 99.945
end Update
server_global_time: 51.743278852663934
only_train_time: 1258.0310935766902

-------------Global Round number: 13-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9127
Averaged Test Accuracy (Prototype Model): 0.8989
Std Test Accuracy (Regular Model): 0.0603
Std Test Accuracy (Prototype Model): 0.0612
tobetrained:
[1, 6, 9, 2, 4]
Edge 1 begin training
Edge 6 begin training
Edge 9 begin training
Edge 2 begin training
Edge 4 begin training
readyList:
[7, 5, 0, 8, 1, 9, 6, 2, 4, 3]
aggregation_buffer:
[7, 5, 0, 8, 1]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.9651, 12.4169,  4.8735,  8.9450,  6.8975, 11.3771,  4.8735, 11.8163,
        10.9560, 12.9078])
Server loss: 6.458838939666748
train global classifier
train glclassifier time: 4.1247759100515395
global classifier accuracy: 99.95
end Update
server_global_time: 55.89975874661468
only_train_time: 1340.825777878752

-------------Global Round number: 14-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9144
Averaged Test Accuracy (Prototype Model): 0.9000
Std Test Accuracy (Regular Model): 0.0576
Std Test Accuracy (Prototype Model): 0.0609
tobetrained:
[7, 5, 0, 8, 1]
Edge 7 begin training
Edge 5 begin training
Edge 0 begin training
Edge 8 begin training
Edge 1 begin training
readyList:
[9, 6, 2, 4, 7, 1, 5, 0, 8, 3]
aggregation_buffer:
[9, 6, 2, 4, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.4892, 12.9837,  5.3254,  9.4804,  7.7663, 12.0925,  5.3254, 12.4116,
        11.6141, 13.4594])
Server loss: 6.4512553215026855
train global classifier
train glclassifier time: 3.886249938979745
global classifier accuracy: 99.94
end Update
server_global_time: 60.19900290877558
only_train_time: 1417.3907170060556

-------------Global Round number: 15-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9150
Averaged Test Accuracy (Prototype Model): 0.9001
Std Test Accuracy (Regular Model): 0.0582
Std Test Accuracy (Prototype Model): 0.0612
tobetrained:
[9, 6, 2, 4, 7]
Edge 9 begin training
Edge 6 begin training
Edge 2 begin training
Edge 4 begin training
Edge 7 begin training
readyList:
[1, 5, 0, 8, 3, 7, 9, 6, 2, 4]
aggregation_buffer:
[1, 5, 0, 8, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.9762, 13.6377,  5.7103,  9.8080,  8.2565, 12.5249,  5.7103, 12.8082,
        12.0970, 13.9645])
Server loss: 6.465601444244385
train global classifier
train glclassifier time: 3.72788157989271
global classifier accuracy: 99.9575
end Update
server_global_time: 62.06000172975473
only_train_time: 1496.8900677522179

-------------Global Round number: 16-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9148
Averaged Test Accuracy (Prototype Model): 0.9016
Std Test Accuracy (Regular Model): 0.0580
Std Test Accuracy (Prototype Model): 0.0618
tobetrained:
[1, 5, 0, 8, 3]
Edge 1 begin training
Edge 5 begin training
Edge 0 begin training
Edge 8 begin training
Edge 3 begin training
readyList:
[7, 9, 6, 2, 5, 4, 1, 8, 0, 3]
aggregation_buffer:
[7, 9, 6, 2, 5]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.4844, 14.2003,  6.3583, 10.4325,  9.1209, 13.3896,  6.3583, 13.5015,
        12.8439, 14.7920])
Server loss: 6.660149574279785
train global classifier
train glclassifier time: 3.780202940106392
global classifier accuracy: 99.9575
end Update
server_global_time: 66.27938845893368
only_train_time: 1583.3715532941278

-------------Global Round number: 17-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9148
Averaged Test Accuracy (Prototype Model): 0.9018
Std Test Accuracy (Regular Model): 0.0594
Std Test Accuracy (Prototype Model): 0.0626
tobetrained:
[7, 9, 6, 2, 5]
Edge 7 begin training
Edge 9 begin training
Edge 6 begin training
Edge 2 begin training
Edge 5 begin training
readyList:
[4, 1, 8, 0, 5, 7, 9, 6, 2, 3]
aggregation_buffer:
[4, 1, 8, 0, 5]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.9937, 14.9171,  7.0367, 11.1751,  9.8453, 13.8747,  7.0367, 14.5470,
        13.4068, 15.4412])
Server loss: 6.793875694274902
train global classifier
train glclassifier time: 3.756786818150431
global classifier accuracy: 99.9425
end Update
server_global_time: 70.55661880108528
only_train_time: 1661.0020749298856

-------------Global Round number: 18-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9162
Averaged Test Accuracy (Prototype Model): 0.9042
Std Test Accuracy (Regular Model): 0.0583
Std Test Accuracy (Prototype Model): 0.0610
tobetrained:
[4, 1, 8, 0, 5]
Edge 4 begin training
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
readyList:
[7, 9, 6, 2, 3, 5, 1, 0, 8, 4]
aggregation_buffer:
[7, 9, 6, 2, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.4091, 15.3264,  7.5233, 11.5798, 10.4165, 14.5028,  7.5233, 15.0382,
        13.8603, 15.8118])
Server loss: 6.6336188316345215
train global classifier
train glclassifier time: 3.8806315090041608
global classifier accuracy: 99.965
end Update
server_global_time: 73.96951025375165
only_train_time: 1740.6963066437747

-------------Global Round number: 19-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9185
Averaged Test Accuracy (Prototype Model): 0.9058
Std Test Accuracy (Regular Model): 0.0538
Std Test Accuracy (Prototype Model): 0.0602
tobetrained:
[7, 9, 6, 2, 3]
Edge 7 begin training
Edge 9 begin training
Edge 6 begin training
Edge 2 begin training
Edge 3 begin training
readyList:
[5, 1, 0, 8, 4, 7, 9, 6, 2, 3]
aggregation_buffer:
[5, 1, 0, 8, 4]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.9982, 16.0361,  8.0777, 12.0927, 11.1011, 15.0462,  8.0777, 15.4605,
        14.5689, 16.4492])
Server loss: 6.742025852203369
train global classifier
train glclassifier time: 4.069206479936838
global classifier accuracy: 99.955
Number of samples: 324
end Update
server_global_time: 76.43373336503282
only_train_time: 1828.308009722503

-------------Global Round number: 20-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9197
Averaged Test Accuracy (Prototype Model): 0.9072
Std Test Accuracy (Regular Model): 0.0515
Std Test Accuracy (Prototype Model): 0.0597
tobetrained:
[5, 1, 0, 8, 4]
Edge 5 begin training
Edge 1 begin training
Edge 0 begin training
Edge 8 begin training
Edge 4 begin training
readyList:
[7, 9, 6, 2, 5, 1, 8, 0, 4, 3]
aggregation_buffer:
[7, 9, 6, 2, 5]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.4197, 16.4851,  8.8909, 12.8405, 11.7924, 15.7843,  8.8909, 16.5461,
        15.1701, 17.2123])
Server loss: 6.96682071685791
train global classifier
train glclassifier time: 3.827829091111198
global classifier accuracy: 99.96
end Update
server_global_time: 80.63696293113753
only_train_time: 1907.9777939987835

-------------Global Round number: 21-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9206
Averaged Test Accuracy (Prototype Model): 0.9070
Std Test Accuracy (Regular Model): 0.0511
Std Test Accuracy (Prototype Model): 0.0581
tobetrained:
[7, 9, 6, 2, 5]
Edge 7 begin training
Edge 9 begin training
Edge 6 begin training
Edge 2 begin training
Edge 5 begin training
readyList:
[1, 8, 0, 4, 7, 5, 9, 6, 3, 2]
aggregation_buffer:
[1, 8, 0, 4, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([12.0358, 17.1499,  9.4265, 13.3233, 12.4334, 16.2774,  9.4265, 16.8994,
        15.9081, 17.7902])
Server loss: 7.028498649597168
train global classifier
train glclassifier time: 3.9546786139253527
global classifier accuracy: 99.975
end Update
server_global_time: 84.50522151915357
only_train_time: 1984.024729313096

-------------Global Round number: 22-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9213
Averaged Test Accuracy (Prototype Model): 0.9081
Std Test Accuracy (Regular Model): 0.0517
Std Test Accuracy (Prototype Model): 0.0595
tobetrained:
[1, 8, 0, 4, 7]
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 4 begin training
Edge 7 begin training
readyList:
[5, 9, 6, 3, 2, 7, 1, 0, 8, 4]
aggregation_buffer:
[5, 9, 6, 3, 2]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([12.4162, 17.4734, 10.0679, 13.7711, 12.9941, 16.9223, 10.0679, 17.3286,
        16.2885, 18.2235])
Server loss: 7.067404270172119
train global classifier
train glclassifier time: 4.001063668867573
global classifier accuracy: 99.9625
end Update
server_global_time: 86.55523405503482
only_train_time: 2063.9777044469956

-------------Global Round number: 23-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9185
Averaged Test Accuracy (Prototype Model): 0.9106
Std Test Accuracy (Regular Model): 0.0596
Std Test Accuracy (Prototype Model): 0.0565
tobetrained:
[5, 9, 6, 3, 2]
Edge 5 begin training
Edge 9 begin training
Edge 6 begin training
Edge 3 begin training
Edge 2 begin training
readyList:
[7, 1, 0, 8, 4, 5, 9, 6, 2, 3]
aggregation_buffer:
[7, 1, 0, 8, 4]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([12.8550, 18.0430, 10.4089, 14.0406, 13.4525, 17.2522, 10.4089, 17.6072,
        16.7155, 18.5467])
Server loss: 6.9106597900390625
train global classifier
train glclassifier time: 3.861582917161286
global classifier accuracy: 99.96
end Update
server_global_time: 90.432536682114
only_train_time: 2153.5599395465106

-------------Global Round number: 24-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9205
Averaged Test Accuracy (Prototype Model): 0.9114
Std Test Accuracy (Regular Model): 0.0576
Std Test Accuracy (Prototype Model): 0.0563
tobetrained:
[7, 1, 0, 8, 4]
Edge 7 begin training
Edge 1 begin training
Edge 0 begin training
Edge 8 begin training
Edge 4 begin training
readyList:
[5, 9, 6, 2, 7, 1, 8, 0, 4, 3]
aggregation_buffer:
[5, 9, 6, 2, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([13.1800, 18.4688, 10.9168, 14.5853, 13.9033, 17.7975, 10.9168, 18.6487,
        17.1142, 19.1676])
Server loss: 7.050899028778076
train global classifier
train glclassifier time: 3.8177666848059744
global classifier accuracy: 99.9675
end Update
server_global_time: 94.58545144391246
only_train_time: 2233.449124146253

-------------Global Round number: 25-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9219
Averaged Test Accuracy (Prototype Model): 0.9105
Std Test Accuracy (Regular Model): 0.0505
Std Test Accuracy (Prototype Model): 0.0576
tobetrained:
[5, 9, 6, 2, 7]
Edge 5 begin training
Edge 9 begin training
Edge 6 begin training
Edge 2 begin training
Edge 7 begin training
readyList:
[1, 8, 0, 4, 3, 7, 9, 5, 6, 2]
aggregation_buffer:
[1, 8, 0, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([13.7122, 18.9300, 11.4184, 15.1373, 14.4278, 18.2831, 11.4184, 18.8951,
        17.7389, 19.6169])
Server loss: 7.027167320251465
train global classifier
train glclassifier time: 4.0533413959201425
global classifier accuracy: 99.9875
end Update
server_global_time: 98.21894555306062
only_train_time: 2313.2176953607704

-------------Global Round number: 26-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9217
Averaged Test Accuracy (Prototype Model): 0.9102
Std Test Accuracy (Regular Model): 0.0512
Std Test Accuracy (Prototype Model): 0.0577
tobetrained:
[1, 8, 0, 4, 3]
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 9, 5, 6, 2, 1, 8, 0, 4, 3]
aggregation_buffer:
[7, 9, 5, 6, 2]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([14.1482, 19.2752, 12.1308, 15.6235, 15.0320, 18.9417, 12.1308, 19.3183,
        18.2304, 20.2122])
Server loss: 7.29148006439209
train global classifier
train glclassifier time: 4.2159013310447335
global classifier accuracy: 99.9775
end Update
server_global_time: 100.73089131782763
only_train_time: 2406.383674918674

-------------Global Round number: 27-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9232
Averaged Test Accuracy (Prototype Model): 0.9125
Std Test Accuracy (Regular Model): 0.0500
Std Test Accuracy (Prototype Model): 0.0566
tobetrained:
[7, 9, 5, 6, 2]
Edge 7 begin training
Edge 9 begin training
Edge 5 begin training
Edge 6 begin training
Edge 2 begin training
readyList:
[1, 8, 0, 4, 7, 5, 9, 6, 2, 3]
aggregation_buffer:
[1, 8, 0, 4, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([14.7061, 19.8640, 12.7367, 16.2412, 15.6009, 19.1161, 12.7367, 19.5600,
        18.8682, 20.4355])
Server loss: 7.092997074127197
train global classifier
train glclassifier time: 4.025944223161787
global classifier accuracy: 99.995
end Update
server_global_time: 104.98809541971423
only_train_time: 2484.817217996577

-------------Global Round number: 28-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9243
Averaged Test Accuracy (Prototype Model): 0.9144
Std Test Accuracy (Regular Model): 0.0488
Std Test Accuracy (Prototype Model): 0.0553
tobetrained:
[1, 8, 0, 4, 7]
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 4 begin training
Edge 7 begin training
readyList:
[5, 9, 6, 2, 7, 1, 8, 0, 3, 4]
aggregation_buffer:
[5, 9, 6, 2, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([15.1353, 20.1842, 13.3708, 16.6968, 16.1052, 19.6829, 13.3708, 19.9516,
        19.3248, 20.9260])
Server loss: 7.0731520652771
train global classifier
train glclassifier time: 3.728025926044211
global classifier accuracy: 99.9925
end Update
server_global_time: 109.13557792664506
only_train_time: 2562.795722767012

-------------Global Round number: 29-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9245
Averaged Test Accuracy (Prototype Model): 0.9148
Std Test Accuracy (Regular Model): 0.0497
Std Test Accuracy (Prototype Model): 0.0554
tobetrained:
[5, 9, 6, 2, 7]
Edge 5 begin training
Edge 9 begin training
Edge 6 begin training
Edge 2 begin training
Edge 7 begin training
readyList:
[1, 8, 0, 3, 4, 7, 5, 9, 6, 2]
aggregation_buffer:
[1, 8, 0, 3, 4]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([15.5988, 20.6160, 13.8084, 17.1000, 16.5416, 20.2988, 13.8084, 20.4033,
        19.8031, 21.3066])
Server loss: 7.086822986602783
train global classifier
train glclassifier time: 3.818177925888449
global classifier accuracy: 99.9975
end Update
server_global_time: 110.85128003079444
only_train_time: 2640.441985564539

-------------Global Round number: 30-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9251
Averaged Test Accuracy (Prototype Model): 0.9163
Std Test Accuracy (Regular Model): 0.0493
Std Test Accuracy (Prototype Model): 0.0537
tobetrained:
[1, 8, 0, 3, 4]
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 3 begin training
Edge 4 begin training
readyList:
[7, 5, 9, 6, 2, 1, 8, 0, 4, 3]
aggregation_buffer:
[7, 5, 9, 6, 2]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([15.9686, 20.8996, 14.2888, 17.4725, 16.9628, 20.7593, 14.2888, 20.7593,
        20.1660, 21.7739])
Server loss: 7.107857704162598
train global classifier
train glclassifier time: 3.824314092984423
global classifier accuracy: 99.995
end Update
server_global_time: 115.14068634877913
only_train_time: 2745.1821616315283

-------------Global Round number: 31-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9222
Averaged Test Accuracy (Prototype Model): 0.9145
Std Test Accuracy (Regular Model): 0.0524
Std Test Accuracy (Prototype Model): 0.0557
tobetrained:
[7, 5, 9, 6, 2]
Edge 7 begin training
Edge 5 begin training
Edge 9 begin training
Edge 6 begin training
Edge 2 begin training
readyList:
[1, 8, 0, 4, 7, 5, 9, 6, 2, 3]
aggregation_buffer:
[1, 8, 0, 4, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([16.4654, 21.3722, 14.8113, 18.0514, 17.4178, 21.3297, 14.8113, 21.4523,
        20.7200, 22.1745])
Server loss: 7.228524208068848
train global classifier
train glclassifier time: 3.7481253400910646
global classifier accuracy: 99.9875
end Update
server_global_time: 119.10448373667896
only_train_time: 2820.983823886141

-------------Global Round number: 32-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9218
Averaged Test Accuracy (Prototype Model): 0.9151
Std Test Accuracy (Regular Model): 0.0535
Std Test Accuracy (Prototype Model): 0.0548
tobetrained:
[1, 8, 0, 4, 7]
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 4 begin training
Edge 7 begin training
readyList:
[5, 9, 6, 2, 7, 1, 0, 3, 8, 4]
aggregation_buffer:
[5, 9, 6, 2, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([16.4739, 21.6009, 14.6939, 18.0270, 17.4317, 21.4480, 14.6939, 21.8061,
        20.6901, 22.6182])
Server loss: 7.357173442840576
train global classifier
train glclassifier time: 3.736043574055657
global classifier accuracy: 99.9925
end Update
server_global_time: 123.04557992960326
only_train_time: 2899.0428308311384

-------------Global Round number: 33-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9247
Averaged Test Accuracy (Prototype Model): 0.9184
Std Test Accuracy (Regular Model): 0.0506
Std Test Accuracy (Prototype Model): 0.0518
tobetrained:
[5, 9, 6, 2, 7]
Edge 5 begin training
Edge 9 begin training
Edge 6 begin training
Edge 2 begin training
Edge 7 begin training
readyList:
[1, 0, 3, 8, 4, 7, 5, 9, 6, 2]
aggregation_buffer:
[1, 0, 3, 8, 4]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([16.8176, 21.8805, 14.9683, 18.2795, 17.6776, 21.7352, 14.9683, 22.0033,
        21.0266, 22.8117])
Server loss: 7.197634220123291
train global classifier
train glclassifier time: 3.8072994430549443
global classifier accuracy: 100.0
end Update
server_global_time: 125.0030091186054
only_train_time: 2975.336556729628

-------------Global Round number: 34-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9266
Averaged Test Accuracy (Prototype Model): 0.9188
Std Test Accuracy (Regular Model): 0.0494
Std Test Accuracy (Prototype Model): 0.0519
tobetrained:
[1, 0, 3, 8, 4]
Edge 1 begin training
Edge 0 begin training
Edge 3 begin training
Edge 8 begin training
Edge 4 begin training
readyList:
[7, 5, 9, 6, 1, 2, 0, 8, 4, 3]
aggregation_buffer:
[7, 5, 9, 6, 1]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([17.5358, 22.1716, 16.0612, 19.0137, 18.3350, 22.3787, 16.0612, 22.3787,
        21.7627, 23.2575])
Server loss: 7.265542984008789
train global classifier
train glclassifier time: 3.82001107907854
global classifier accuracy: 99.9975
end Update
server_global_time: 129.1881050404627
only_train_time: 3065.184981498169

-------------Global Round number: 35-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9261
Averaged Test Accuracy (Prototype Model): 0.9199
Std Test Accuracy (Regular Model): 0.0501
Std Test Accuracy (Prototype Model): 0.0507
tobetrained:
[7, 5, 9, 6, 1]
Edge 7 begin training
Edge 5 begin training
Edge 9 begin training
Edge 6 begin training
Edge 1 begin training
readyList:
[2, 0, 8, 4, 7, 5, 1, 9, 6, 3]
aggregation_buffer:
[2, 0, 8, 4, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([17.8880, 22.5680, 16.4263, 19.4341, 18.7662, 22.8433, 16.4263, 22.8433,
        22.1283, 23.4967])
Server loss: 7.230820178985596
train global classifier
train glclassifier time: 3.852358964039013
global classifier accuracy: 100.0
end Update
server_global_time: 133.21951307542622
only_train_time: 3138.377224483993

-------------Global Round number: 36-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9263
Averaged Test Accuracy (Prototype Model): 0.9196
Std Test Accuracy (Regular Model): 0.0500
Std Test Accuracy (Prototype Model): 0.0517
tobetrained:
[2, 0, 8, 4, 7]
Edge 2 begin training
Edge 0 begin training
Edge 8 begin training
Edge 4 begin training
Edge 7 begin training
readyList:
[5, 1, 9, 6, 7, 3, 8, 0, 2, 4]
aggregation_buffer:
[5, 1, 9, 6, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([18.2100, 22.7785, 16.8117, 19.7310, 19.0519, 23.0180, 16.8117, 23.0180,
        22.3758, 23.7668])
Server loss: 7.187790870666504
train global classifier
train glclassifier time: 3.992869426961988
global classifier accuracy: 100.0
end Update
server_global_time: 137.12919604149647
only_train_time: 3218.6251469282433

-------------Global Round number: 37-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9263
Averaged Test Accuracy (Prototype Model): 0.9203
Std Test Accuracy (Regular Model): 0.0507
Std Test Accuracy (Prototype Model): 0.0516
tobetrained:
[5, 1, 9, 6, 7]
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 6 begin training
Edge 7 begin training
readyList:
[3, 8, 0, 2, 4, 7, 5, 1, 9, 6]
aggregation_buffer:
[3, 8, 0, 2, 4]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([18.5458, 23.0743, 17.1767, 20.0145, 19.3399, 23.3043, 17.1767, 23.3043,
        22.7260, 23.9829])
Server loss: 7.190341472625732
train global classifier
train glclassifier time: 4.195680047851056
global classifier accuracy: 100.0
end Update
server_global_time: 139.08210443146527
only_train_time: 3294.170987687772

-------------Global Round number: 38-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9266
Averaged Test Accuracy (Prototype Model): 0.9202
Std Test Accuracy (Regular Model): 0.0508
Std Test Accuracy (Prototype Model): 0.0519
tobetrained:
[3, 8, 0, 2, 4]
Edge 3 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 4 begin training
readyList:
[7, 5, 1, 9, 6, 4, 8, 2, 0, 3]
aggregation_buffer:
[7, 5, 1, 9, 6]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([18.5977, 23.2573, 17.2541, 20.1265, 19.4580, 23.4708, 17.2541, 23.4708,
        22.8731, 24.2386])
Server loss: 7.028913974761963
train global classifier
train glclassifier time: 3.714443953940645
global classifier accuracy: 100.0
end Update
server_global_time: 142.37995555764064
only_train_time: 3390.6070409561507

-------------Global Round number: 39-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9271
Averaged Test Accuracy (Prototype Model): 0.9211
Std Test Accuracy (Regular Model): 0.0489
Std Test Accuracy (Prototype Model): 0.0509
tobetrained:
[7, 5, 1, 9, 6]
Edge 7 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 6 begin training
readyList:
[4, 8, 2, 0, 7, 5, 1, 9, 6, 3]
aggregation_buffer:
[4, 8, 2, 0, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([19.0413, 23.6214, 17.7438, 20.6270, 20.0489, 23.9996, 17.7438, 23.9996,
        23.3434, 24.5443])
Server loss: 7.027602672576904
train global classifier
train glclassifier time: 3.8464228911325336
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 146.39579580863938
only_train_time: 3463.6505932928994

-------------Global Round number: 40-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9262
Averaged Test Accuracy (Prototype Model): 0.9220
Std Test Accuracy (Regular Model): 0.0507
Std Test Accuracy (Prototype Model): 0.0499
tobetrained:
[4, 8, 2, 0, 7]
Edge 4 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 7 begin training
readyList:
[5, 1, 9, 6, 7, 3, 8, 0, 2, 4]
aggregation_buffer:
[5, 1, 9, 6, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([19.5473, 23.8187, 18.3656, 21.0448, 20.4521, 24.1826, 18.3656, 24.1826,
        23.7497, 24.8075])
Server loss: 6.9890360832214355
train global classifier
train glclassifier time: 3.7990117338486016
global classifier accuracy: 100.0
end Update
server_global_time: 150.418032720685
only_train_time: 3546.2092577721924

-------------Global Round number: 41-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9262
Averaged Test Accuracy (Prototype Model): 0.9222
Std Test Accuracy (Regular Model): 0.0513
Std Test Accuracy (Prototype Model): 0.0500
tobetrained:
[5, 1, 9, 6, 7]
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 6 begin training
Edge 7 begin training
readyList:
[3, 8, 0, 2, 4, 7, 5, 1, 9, 6]
aggregation_buffer:
[3, 8, 0, 2, 4]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([19.9594, 24.0921, 18.7069, 21.3767, 20.8222, 24.4020, 18.7069, 24.4020,
        24.1778, 24.9776])
Server loss: 6.914966106414795
train global classifier
train glclassifier time: 3.8139561018906534
global classifier accuracy: 100.0
end Update
server_global_time: 152.72911209170707
only_train_time: 3619.261864446802

-------------Global Round number: 42-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9269
Averaged Test Accuracy (Prototype Model): 0.9233
Std Test Accuracy (Regular Model): 0.0499
Std Test Accuracy (Prototype Model): 0.0494
tobetrained:
[3, 8, 0, 2, 4]
Edge 3 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 4 begin training
readyList:
[7, 5, 1, 9, 6, 0, 8, 4, 2, 3]
aggregation_buffer:
[7, 5, 1, 9, 6]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([20.3271, 24.2562, 19.1038, 21.7232, 21.1391, 24.5837, 19.1038, 24.5837,
        24.5118, 25.2164])
Server loss: 6.849522590637207
train global classifier
train glclassifier time: 3.851455686846748
global classifier accuracy: 100.0
end Update
server_global_time: 155.54548307484947
only_train_time: 3711.5908946718555

-------------Global Round number: 43-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9272
Averaged Test Accuracy (Prototype Model): 0.9229
Std Test Accuracy (Regular Model): 0.0484
Std Test Accuracy (Prototype Model): 0.0486
tobetrained:
[7, 5, 1, 9, 6]
Edge 7 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 6 begin training
readyList:
[0, 8, 4, 2, 7, 1, 5, 9, 6, 3]
aggregation_buffer:
[0, 8, 4, 2, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([20.6782, 24.5652, 19.4286, 22.1194, 21.4782, 25.0258, 19.4286, 25.0258,
        24.7923, 25.4768])
Server loss: 6.851260185241699
train global classifier
train glclassifier time: 3.872915742918849
global classifier accuracy: 100.0
end Update
server_global_time: 159.68932805792429
only_train_time: 3786.937799644191

-------------Global Round number: 44-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9273
Averaged Test Accuracy (Prototype Model): 0.9231
Std Test Accuracy (Regular Model): 0.0488
Std Test Accuracy (Prototype Model): 0.0491
tobetrained:
[0, 8, 4, 2, 7]
Edge 0 begin training
Edge 8 begin training
Edge 4 begin training
Edge 2 begin training
Edge 7 begin training
readyList:
[1, 5, 9, 6, 7, 3, 0, 8, 2, 4]
aggregation_buffer:
[1, 5, 9, 6, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([20.9879, 24.7056, 19.8058, 22.4080, 21.7711, 24.4029, 19.8058, 24.4029,
        24.9129, 25.0976])
Server loss: 6.554018974304199
train global classifier
train glclassifier time: 3.756276421016082
global classifier accuracy: 100.0
end Update
server_global_time: 163.74340675212443
only_train_time: 3875.398784897523

-------------Global Round number: 45-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9274
Averaged Test Accuracy (Prototype Model): 0.9175
Std Test Accuracy (Regular Model): 0.0480
Std Test Accuracy (Prototype Model): 0.0741
tobetrained:
[1, 5, 9, 6, 7]
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 6 begin training
Edge 7 begin training
readyList:
[3, 0, 8, 2, 4, 7, 1, 5, 9, 6]
aggregation_buffer:
[3, 0, 8, 2, 4]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([21.3053, 24.9330, 20.0914, 22.6658, 22.0840, 24.5820, 20.0914, 24.5820,
        25.0943, 25.2070])
Server loss: 6.528088569641113
train global classifier
train glclassifier time: 3.930724914185703
global classifier accuracy: 100.0
end Update
server_global_time: 167.03034764295444
only_train_time: 3952.2040323368274

-------------Global Round number: 46-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9276
Averaged Test Accuracy (Prototype Model): 0.9213
Std Test Accuracy (Regular Model): 0.0481
Std Test Accuracy (Prototype Model): 0.0547
tobetrained:
[3, 0, 8, 2, 4]
Edge 3 begin training
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 4 begin training
readyList:
[7, 1, 5, 9, 6, 8, 0, 4, 2, 3]
aggregation_buffer:
[7, 1, 5, 9, 6]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([21.2796, 25.0342, 19.7409, 22.6428, 22.0352, 24.6876, 19.7409, 24.6876,
        25.2613, 25.3791])
Server loss: 6.611940383911133
train global classifier
train glclassifier time: 3.888977589085698
global classifier accuracy: 100.0
end Update
server_global_time: 169.00797485909425
only_train_time: 4045.1881334467325

-------------Global Round number: 47-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9271
Averaged Test Accuracy (Prototype Model): 0.9213
Std Test Accuracy (Regular Model): 0.0491
Std Test Accuracy (Prototype Model): 0.0533
tobetrained:
[7, 1, 5, 9, 6]
Edge 7 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 6 begin training
readyList:
[8, 0, 4, 2, 7, 5, 1, 9, 6, 3]
aggregation_buffer:
[8, 0, 4, 2, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([21.3074, 25.1339, 19.7499, 22.6844, 21.8838, 24.8964, 19.7499, 24.8964,
        25.4580, 25.6190])
Server loss: 6.638916015625
train global classifier
train glclassifier time: 3.9610183669719845
global classifier accuracy: 100.0
end Update
server_global_time: 173.18996741599403
only_train_time: 4120.49141875538

-------------Global Round number: 48-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9274
Averaged Test Accuracy (Prototype Model): 0.9232
Std Test Accuracy (Regular Model): 0.0487
Std Test Accuracy (Prototype Model): 0.0482
tobetrained:
[8, 0, 4, 2, 7]
Edge 8 begin training
Edge 0 begin training
Edge 4 begin training
Edge 2 begin training
Edge 7 begin training
readyList:
[5, 1, 9, 6, 7, 0, 8, 2, 3, 4]
aggregation_buffer:
[5, 1, 9, 6, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([21.6746, 25.2330, 20.3998, 23.0194, 22.2099, 25.0227, 20.3998, 25.0227,
        25.6062, 25.7575])
Server loss: 6.429504871368408
train global classifier
train glclassifier time: 4.005909100873396
global classifier accuracy: 100.0
end Update
server_global_time: 177.2379802649375
only_train_time: 4205.624577526934

-------------Global Round number: 49-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9277
Averaged Test Accuracy (Prototype Model): 0.9239
Std Test Accuracy (Regular Model): 0.0478
Std Test Accuracy (Prototype Model): 0.0473
tobetrained:
[5, 1, 9, 6, 7]
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 6 begin training
Edge 7 begin training
readyList:
[0, 8, 2, 3, 4, 1, 5, 7, 6, 9]
aggregation_buffer:
[0, 8, 2, 3, 4]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([22.0643, 25.5061, 20.8111, 23.3361, 22.7990, 25.1536, 20.8111, 25.1536,
        25.7876, 25.8416])
Server loss: 6.279272079467773
train global classifier
train glclassifier time: 3.8142962348647416
global classifier accuracy: 100.0
end Update
server_global_time: 180.6939496791456
only_train_time: 4281.105406085495

-------------Global Round number: 50-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9279
Averaged Test Accuracy (Prototype Model): 0.9243
Std Test Accuracy (Regular Model): 0.0476
Std Test Accuracy (Prototype Model): 0.0472
tobetrained:
[0, 8, 2, 3, 4]
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 3 begin training
Edge 4 begin training
readyList:
[1, 5, 7, 6, 9, 8, 0, 4, 2, 3]
aggregation_buffer:
[1, 5, 7, 6, 9]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([22.4209, 25.6128, 21.3493, 23.4871, 23.0864, 25.2539, 21.3493, 25.2539,
        25.9836, 25.9663])
Server loss: 6.465157508850098
train global classifier
train glclassifier time: 3.7937982578296214
global classifier accuracy: 100.0
end Update
server_global_time: 183.22919185599312
only_train_time: 4374.6118783429265

-------------Global Round number: 51-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9279
Averaged Test Accuracy (Prototype Model): 0.9227
Std Test Accuracy (Regular Model): 0.0479
Std Test Accuracy (Prototype Model): 0.0555
tobetrained:
[1, 5, 7, 6, 9]
Edge 1 begin training
Edge 5 begin training
Edge 7 begin training
Edge 6 begin training
Edge 9 begin training
readyList:
[8, 0, 4, 2, 7, 1, 5, 9, 6, 3]
aggregation_buffer:
[8, 0, 4, 2, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([22.5925, 25.8148, 21.5051, 23.6080, 23.2355, 24.6780, 21.5051, 24.6780,
        25.9074, 25.4975])
Server loss: 6.2549591064453125
train global classifier
train glclassifier time: 4.169222848024219
global classifier accuracy: 100.0
end Update
server_global_time: 187.2420821969863
only_train_time: 4447.279115879908

-------------Global Round number: 52-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9277
Averaged Test Accuracy (Prototype Model): 0.9223
Std Test Accuracy (Regular Model): 0.0485
Std Test Accuracy (Prototype Model): 0.0554
tobetrained:
[8, 0, 4, 2, 7]
Edge 8 begin training
Edge 0 begin training
Edge 4 begin training
Edge 2 begin training
Edge 7 begin training
readyList:
[1, 5, 9, 6, 7, 0, 8, 3, 2, 4]
aggregation_buffer:
[1, 5, 9, 6, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([22.8315, 25.9234, 21.8287, 23.7809, 23.4155, 24.8150, 21.8287, 24.8150,
        25.9588, 25.6491])
Server loss: 5.944750785827637
train global classifier
train glclassifier time: 3.7582733288872987
global classifier accuracy: 100.0
end Update
server_global_time: 191.10786636988632
only_train_time: 4526.4733398521785

-------------Global Round number: 53-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9280
Averaged Test Accuracy (Prototype Model): 0.9243
Std Test Accuracy (Regular Model): 0.0480
Std Test Accuracy (Prototype Model): 0.0478
tobetrained:
[1, 5, 9, 6, 7]
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 6 begin training
Edge 7 begin training
readyList:
[0, 8, 3, 2, 4, 7, 1, 5, 9, 6]
aggregation_buffer:
[0, 8, 3, 2, 4]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([23.0554, 26.0499, 21.9774, 23.9369, 23.5017, 25.5704, 21.9774, 25.5704,
        26.3664, 26.2817])
Server loss: 7.004287242889404
train global classifier
train glclassifier time: 3.852837204001844
global classifier accuracy: 100.0
end Update
server_global_time: 193.0901441478636
only_train_time: 4601.552415314363

-------------Global Round number: 54-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9245
Averaged Test Accuracy (Prototype Model): 0.9203
Std Test Accuracy (Regular Model): 0.0498
Std Test Accuracy (Prototype Model): 0.0543
tobetrained:
[0, 8, 3, 2, 4]
Edge 0 begin training
Edge 8 begin training
Edge 3 begin training
Edge 2 begin training
Edge 4 begin training
readyList:
[7, 1, 5, 9, 6, 8, 2, 0, 4, 3]
aggregation_buffer:
[7, 1, 5, 9, 6]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([22.6298, 26.0017, 21.2485, 23.5831, 22.9864, 25.5291, 21.2485, 25.5291,
        25.9457, 26.3117])
Server loss: 6.724263668060303
train global classifier
train glclassifier time: 3.8803541290108114
global classifier accuracy: 100.0
end Update
server_global_time: 196.33042323985137
only_train_time: 4695.9502078027

-------------Global Round number: 55-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9249
Averaged Test Accuracy (Prototype Model): 0.9207
Std Test Accuracy (Regular Model): 0.0494
Std Test Accuracy (Prototype Model): 0.0542
tobetrained:
[7, 1, 5, 9, 6]
Edge 7 begin training
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 6 begin training
readyList:
[8, 2, 0, 4, 5, 6, 9, 1, 7, 3]
aggregation_buffer:
[8, 2, 0, 4, 5]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([22.8342, 26.1922, 21.5045, 23.7932, 23.2413, 25.8832, 21.5045, 25.8832,
        26.0823, 26.6340])
Server loss: 6.643933296203613
train global classifier
train glclassifier time: 3.804350280901417
global classifier accuracy: 100.0
end Update
server_global_time: 200.72060226788744
only_train_time: 4777.387261779513

-------------Global Round number: 56-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9282
Averaged Test Accuracy (Prototype Model): 0.9224
Std Test Accuracy (Regular Model): 0.0489
Std Test Accuracy (Prototype Model): 0.0533
tobetrained:
[8, 2, 0, 4, 5]
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 4 begin training
Edge 5 begin training
readyList:
[6, 9, 1, 7, 3, 5, 0, 8, 2, 4]
aggregation_buffer:
[6, 9, 1, 7, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([23.3705, 26.2414, 22.3246, 23.9244, 23.5920, 25.9764, 22.3246, 25.9764,
        26.5319, 26.7136])
Server loss: 6.569072246551514
train global classifier
train glclassifier time: 4.393542197998613
global classifier accuracy: 100.0
end Update
server_global_time: 204.55321180983447
only_train_time: 4859.297884705709

-------------Global Round number: 57-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9285
Averaged Test Accuracy (Prototype Model): 0.9231
Std Test Accuracy (Regular Model): 0.0493
Std Test Accuracy (Prototype Model): 0.0534
tobetrained:
[6, 9, 1, 7, 3]
Edge 6 begin training
Edge 9 begin training
Edge 1 begin training
Edge 7 begin training
Edge 3 begin training
readyList:
[5, 0, 8, 2, 4, 7, 1, 9, 6, 3]
aggregation_buffer:
[5, 0, 8, 2, 4]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([23.5539, 26.3556, 22.5043, 24.0002, 23.6821, 26.1416, 22.5043, 26.1416,
        26.6040, 26.8296])
Server loss: 6.240318298339844
train global classifier
train glclassifier time: 3.6752261428628117
global classifier accuracy: 100.0
end Update
server_global_time: 206.64644713397138
only_train_time: 4943.449414808303

-------------Global Round number: 58-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9302
Averaged Test Accuracy (Prototype Model): 0.9246
Std Test Accuracy (Regular Model): 0.0467
Std Test Accuracy (Prototype Model): 0.0491
tobetrained:
[5, 0, 8, 2, 4]
Edge 5 begin training
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 4 begin training
readyList:
[7, 1, 9, 6, 5, 8, 0, 4, 2, 3]
aggregation_buffer:
[7, 1, 9, 6, 5]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([23.8638, 26.5934, 22.9886, 24.2623, 24.0776, 26.3785, 22.9886, 26.3785,
        26.8564, 27.0524])
Server loss: 6.297630310058594
train global classifier
train glclassifier time: 4.091672460082918
global classifier accuracy: 100.0
end Update
server_global_time: 211.15430278680287
only_train_time: 5024.893229509471

-------------Global Round number: 59-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9303
Averaged Test Accuracy (Prototype Model): 0.9247
Std Test Accuracy (Regular Model): 0.0468
Std Test Accuracy (Prototype Model): 0.0492
tobetrained:
[7, 1, 9, 6, 5]
Edge 7 begin training
Edge 1 begin training
Edge 9 begin training
Edge 6 begin training
Edge 5 begin training
readyList:
[8, 0, 4, 2, 7, 1, 5, 9, 6, 3]
aggregation_buffer:
[8, 0, 4, 2, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([24.0936, 26.6828, 23.1375, 24.4049, 24.1670, 26.5236, 23.1375, 26.5236,
        27.0188, 27.1591])
Server loss: 6.239592552185059
train global classifier
train glclassifier time: 3.78390822513029
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 215.0651391649153
only_train_time: 5098.451070800889

-------------Global Round number: 60-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9301
Averaged Test Accuracy (Prototype Model): 0.9250
Std Test Accuracy (Regular Model): 0.0471
Std Test Accuracy (Prototype Model): 0.0488
tobetrained:
[8, 0, 4, 2, 7]
Edge 8 begin training
Edge 0 begin training
Edge 4 begin training
Edge 2 begin training
Edge 7 begin training
readyList:
[1, 5, 9, 6, 3, 7, 0, 8, 2, 4]
aggregation_buffer:
[1, 5, 9, 6, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([24.2421, 26.7218, 23.3657, 24.5255, 24.2819, 26.6002, 23.3657, 26.6002,
        27.1046, 27.1989])
Server loss: 6.112855434417725
train global classifier
train glclassifier time: 4.094674943946302
global classifier accuracy: 100.0
end Update
server_global_time: 216.5414531857241
only_train_time: 5182.262215535855

-------------Global Round number: 61-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9301
Averaged Test Accuracy (Prototype Model): 0.9258
Std Test Accuracy (Regular Model): 0.0476
Std Test Accuracy (Prototype Model): 0.0478
tobetrained:
[1, 5, 9, 6, 3]
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 6 begin training
Edge 3 begin training
readyList:
[7, 0, 8, 1, 5, 2, 4, 9, 6, 3]
aggregation_buffer:
[7, 0, 8, 1, 5]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([24.4794, 26.8720, 23.6104, 24.7049, 24.4934, 26.7693, 23.6104, 26.7693,
        27.2465, 27.3130])
Server loss: 6.0626540184021
train global classifier
train glclassifier time: 3.8446701960638165
global classifier accuracy: 100.0
end Update
server_global_time: 220.96368639473803
only_train_time: 5269.9618941685185

-------------Global Round number: 62-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9300
Averaged Test Accuracy (Prototype Model): 0.9261
Std Test Accuracy (Regular Model): 0.0479
Std Test Accuracy (Prototype Model): 0.0478
tobetrained:
[7, 0, 8, 1, 5]
Edge 7 begin training
Edge 0 begin training
Edge 8 begin training
Edge 1 begin training
Edge 5 begin training
readyList:
[2, 4, 9, 6, 7, 5, 1, 0, 8, 3]
aggregation_buffer:
[2, 4, 9, 6, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([24.6025, 26.9603, 23.7809, 24.8484, 24.6542, 26.8755, 23.7809, 26.8755,
        27.3560, 27.4468])
Server loss: 6.065574645996094
train global classifier
train glclassifier time: 3.6970209679566324
global classifier accuracy: 100.0
end Update
server_global_time: 225.05778299365193
only_train_time: 5344.834030772559

-------------Global Round number: 63-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9299
Averaged Test Accuracy (Prototype Model): 0.9259
Std Test Accuracy (Regular Model): 0.0477
Std Test Accuracy (Prototype Model): 0.0480
tobetrained:
[2, 4, 9, 6, 7]
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 6 begin training
Edge 7 begin training
readyList:
[5, 1, 0, 8, 3, 7, 9, 6, 2, 4]
aggregation_buffer:
[5, 1, 0, 8, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([24.7537, 27.0443, 23.9118, 24.9522, 24.7467, 26.9315, 23.9118, 26.9315,
        27.3955, 27.4913])
Server loss: 6.142919540405273
train global classifier
train glclassifier time: 3.9235451598651707
global classifier accuracy: 100.0
end Update
server_global_time: 228.2885021455586
only_train_time: 5424.303907853551

-------------Global Round number: 64-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9299
Averaged Test Accuracy (Prototype Model): 0.9266
Std Test Accuracy (Regular Model): 0.0476
Std Test Accuracy (Prototype Model): 0.0476
tobetrained:
[5, 1, 0, 8, 3]
Edge 5 begin training
Edge 1 begin training
Edge 0 begin training
Edge 8 begin training
Edge 3 begin training
readyList:
[7, 9, 6, 2, 4, 1, 5, 8, 0, 3]
aggregation_buffer:
[7, 9, 6, 2, 4]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([24.3626, 27.0447, 23.3437, 25.0497, 24.7077, 27.0737, 23.3437, 27.0737,
        27.4208, 27.5685])
Server loss: 6.073329925537109
train global classifier
train glclassifier time: 3.9101309559773654
global classifier accuracy: 100.0
end Update
server_global_time: 231.06970271351747
only_train_time: 5512.094143044902

-------------Global Round number: 65-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9298
Averaged Test Accuracy (Prototype Model): 0.9267
Std Test Accuracy (Regular Model): 0.0481
Std Test Accuracy (Prototype Model): 0.0475
tobetrained:
[7, 9, 6, 2, 4]
Edge 7 begin training
Edge 9 begin training
Edge 6 begin training
Edge 2 begin training
Edge 4 begin training
readyList:
[1, 5, 8, 0, 7, 9, 6, 2, 4, 3]
aggregation_buffer:
[1, 5, 8, 0, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([24.5381, 27.1784, 23.5097, 25.2241, 24.8726, 27.2135, 23.5097, 27.2135,
        27.5610, 27.7279])
Server loss: 5.978141784667969
train global classifier
train glclassifier time: 4.636085614096373
global classifier accuracy: 100.0
end Update
server_global_time: 235.15131976851262
only_train_time: 5590.859239824815

-------------Global Round number: 66-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9229
Averaged Test Accuracy (Prototype Model): 0.9209
Std Test Accuracy (Regular Model): 0.0635
Std Test Accuracy (Prototype Model): 0.0595
tobetrained:
[1, 5, 8, 0, 7]
Edge 1 begin training
Edge 5 begin training
Edge 8 begin training
Edge 0 begin training
Edge 7 begin training
readyList:
[9, 6, 2, 4, 7, 1, 5, 0, 8, 3]
aggregation_buffer:
[9, 6, 2, 4, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([24.9902, 27.3761, 23.9222, 25.3501, 25.0574, 27.2942, 23.9222, 27.2942,
        27.7399, 27.8043])
Server loss: 5.952311038970947
train global classifier
train glclassifier time: 3.8720275410450995
global classifier accuracy: 100.0
end Update
server_global_time: 239.1536580035463
only_train_time: 5665.57784329704

-------------Global Round number: 67-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9227
Averaged Test Accuracy (Prototype Model): 0.9211
Std Test Accuracy (Regular Model): 0.0635
Std Test Accuracy (Prototype Model): 0.0592
tobetrained:
[9, 6, 2, 4, 7]
Edge 9 begin training
Edge 6 begin training
Edge 2 begin training
Edge 4 begin training
Edge 7 begin training
readyList:
[1, 5, 0, 8, 3, 7, 9, 6, 4, 2]
aggregation_buffer:
[1, 5, 0, 8, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([25.0351, 27.4676, 24.0074, 25.4034, 25.1152, 27.3654, 24.0074, 27.3654,
        27.7889, 27.8689])
Server loss: 5.870914459228516
train global classifier
train glclassifier time: 3.9368067199829966
global classifier accuracy: 100.0
end Update
server_global_time: 240.66657070838846
only_train_time: 5743.976365930168

-------------Global Round number: 68-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9299
Averaged Test Accuracy (Prototype Model): 0.9273
Std Test Accuracy (Regular Model): 0.0479
Std Test Accuracy (Prototype Model): 0.0471
tobetrained:
[1, 5, 0, 8, 3]
Edge 1 begin training
Edge 5 begin training
Edge 0 begin training
Edge 8 begin training
Edge 3 begin training
readyList:
[7, 9, 6, 4, 1, 2, 0, 8, 5, 3]
aggregation_buffer:
[7, 9, 6, 4, 1]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([25.4178, 27.5808, 24.5253, 25.5858, 25.3202, 27.5292, 24.5253, 27.5292,
        27.9341, 27.8480])
Server loss: 5.847206115722656
train global classifier
train glclassifier time: 3.7195805278606713
global classifier accuracy: 100.0
end Update
server_global_time: 244.92255188850686
only_train_time: 5833.631891597528

-------------Global Round number: 69-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9301
Averaged Test Accuracy (Prototype Model): 0.9271
Std Test Accuracy (Regular Model): 0.0467
Std Test Accuracy (Prototype Model): 0.0471
tobetrained:
[7, 9, 6, 4, 1]
Edge 7 begin training
Edge 9 begin training
Edge 6 begin training
Edge 4 begin training
Edge 1 begin training
readyList:
[2, 0, 8, 5, 7, 1, 9, 6, 4, 3]
aggregation_buffer:
[2, 0, 8, 5, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([25.4559, 27.6704, 24.6387, 25.6909, 25.4097, 27.6129, 24.6387, 27.6129,
        28.0118, 27.9843])
Server loss: 5.791615009307861
train global classifier
train glclassifier time: 3.822053242009133
global classifier accuracy: 100.0
end Update
server_global_time: 248.96655967342667
only_train_time: 5908.902177344076

-------------Global Round number: 70-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9272
Averaged Test Accuracy (Prototype Model): 0.9264
Std Test Accuracy (Regular Model): 0.0483
Std Test Accuracy (Prototype Model): 0.0461
tobetrained:
[2, 0, 8, 5, 7]
Edge 2 begin training
Edge 0 begin training
Edge 8 begin training
Edge 5 begin training
Edge 7 begin training
readyList:
[1, 9, 6, 4, 3, 7, 5, 8, 0, 2]
aggregation_buffer:
[1, 9, 6, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([25.6339, 27.7601, 24.8983, 25.7838, 25.5474, 27.6708, 24.8983, 27.6708,
        28.0542, 28.0243])
Server loss: 5.683295249938965
train global classifier
train glclassifier time: 3.829858937067911
global classifier accuracy: 100.0
end Update
server_global_time: 252.3183082633186
only_train_time: 5985.112081646919

-------------Global Round number: 71-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9273
Averaged Test Accuracy (Prototype Model): 0.9268
Std Test Accuracy (Regular Model): 0.0487
Std Test Accuracy (Prototype Model): 0.0463
tobetrained:
[1, 9, 6, 4, 3]
Edge 1 begin training
Edge 9 begin training
Edge 6 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 5, 8, 0, 2, 1, 9, 6, 4, 3]
aggregation_buffer:
[7, 5, 8, 0, 2]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([25.7605, 27.8803, 24.9767, 25.9022, 25.6720, 27.8501, 24.9767, 27.8501,
        28.1437, 28.1891])
Server loss: 5.996579170227051
train global classifier
train glclassifier time: 3.8139069909229875
global classifier accuracy: 100.0
end Update
server_global_time: 254.81926139141433
only_train_time: 6073.3269325620495

-------------Global Round number: 72-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9303
Averaged Test Accuracy (Prototype Model): 0.9258
Std Test Accuracy (Regular Model): 0.0470
Std Test Accuracy (Prototype Model): 0.0487
tobetrained:
[7, 5, 8, 0, 2]
Edge 7 begin training
Edge 5 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
readyList:
[1, 9, 6, 4, 7, 5, 0, 8, 2, 3]
aggregation_buffer:
[1, 9, 6, 4, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([25.1274, 27.5196, 25.0601, 25.1274, 25.7043, 27.9633, 25.0601, 27.7053,
        27.8014, 28.3465])
Server loss: 6.00602912902832
train global classifier
train glclassifier time: 3.797879213001579
global classifier accuracy: 100.0
end Update
server_global_time: 258.8365329413209
only_train_time: 6150.676830755547

-------------Global Round number: 73-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9302
Averaged Test Accuracy (Prototype Model): 0.9258
Std Test Accuracy (Regular Model): 0.0474
Std Test Accuracy (Prototype Model): 0.0489
tobetrained:
[1, 9, 6, 4, 7]
Edge 1 begin training
Edge 9 begin training
Edge 6 begin training
Edge 4 begin training
Edge 7 begin training
readyList:
[5, 0, 8, 2, 7, 1, 9, 6, 3, 4]
aggregation_buffer:
[5, 0, 8, 2, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([25.1780, 27.6066, 25.1153, 25.1780, 25.7932, 28.1034, 25.1153, 27.7684,
        27.8614, 28.4603])
Server loss: 5.822730541229248
train global classifier
train glclassifier time: 3.7527990678790957
global classifier accuracy: 100.0
end Update
server_global_time: 262.82553038629703
only_train_time: 6226.087125444785

-------------Global Round number: 74-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9303
Averaged Test Accuracy (Prototype Model): 0.9267
Std Test Accuracy (Regular Model): 0.0473
Std Test Accuracy (Prototype Model): 0.0473
tobetrained:
[5, 0, 8, 2, 7]
Edge 5 begin training
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 7 begin training
readyList:
[1, 9, 6, 3, 4, 7, 5, 8, 0, 2]
aggregation_buffer:
[1, 9, 6, 3, 4]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([25.7544, 28.1727, 25.4138, 25.7544, 25.9710, 28.1854, 25.4138, 27.7977,
        28.0958, 28.5192])
Server loss: 5.766152858734131
train global classifier
train glclassifier time: 3.8039372849743813
global classifier accuracy: 100.0
end Update
server_global_time: 264.8209294753615
only_train_time: 6303.375083609251

-------------Global Round number: 75-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9302
Averaged Test Accuracy (Prototype Model): 0.9269
Std Test Accuracy (Regular Model): 0.0473
Std Test Accuracy (Prototype Model): 0.0472
tobetrained:
[1, 9, 6, 3, 4]
Edge 1 begin training
Edge 9 begin training
Edge 6 begin training
Edge 3 begin training
Edge 4 begin training
readyList:
[7, 5, 8, 0, 2, 1, 9, 6, 4, 3]
aggregation_buffer:
[7, 5, 8, 0, 2]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([25.8837, 28.2629, 25.5631, 25.8837, 26.0763, 28.2760, 25.5631, 27.8471,
        28.1367, 28.5753])
Server loss: 5.575973987579346
train global classifier
train glclassifier time: 3.9003840279765427
global classifier accuracy: 100.0
end Update
server_global_time: 268.85966368438676
only_train_time: 6390.392562437803

-------------Global Round number: 76-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9303
Averaged Test Accuracy (Prototype Model): 0.9281
Std Test Accuracy (Regular Model): 0.0472
Std Test Accuracy (Prototype Model): 0.0468
tobetrained:
[7, 5, 8, 0, 2]
Edge 7 begin training
Edge 5 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
readyList:
[1, 9, 6, 4, 7, 5, 8, 2, 0, 3]
aggregation_buffer:
[1, 9, 6, 4, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([26.3663, 28.3625, 25.7800, 26.3663, 26.2178, 28.4436, 25.7800, 28.2883,
        28.5469, 28.7386])
Server loss: 5.608547210693359
train global classifier
train glclassifier time: 4.161128072068095
global classifier accuracy: 100.0
end Update
server_global_time: 272.7674622654449
only_train_time: 6468.633396887453

-------------Global Round number: 77-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9299
Averaged Test Accuracy (Prototype Model): 0.9280
Std Test Accuracy (Regular Model): 0.0474
Std Test Accuracy (Prototype Model): 0.0469
tobetrained:
[1, 9, 6, 4, 7]
Edge 1 begin training
Edge 9 begin training
Edge 6 begin training
Edge 4 begin training
Edge 7 begin training
readyList:
[5, 8, 2, 0, 3, 7, 1, 9, 6, 4]
aggregation_buffer:
[5, 8, 2, 0, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([26.4268, 28.4589, 25.8875, 26.4268, 26.2915, 28.5920, 25.8875, 28.3487,
        28.6067, 28.7988])
Server loss: 5.554175853729248
train global classifier
train glclassifier time: 3.8368745548650622
global classifier accuracy: 100.0
end Update
server_global_time: 276.3112452533096
only_train_time: 6545.213765252149

-------------Global Round number: 78-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9300
Averaged Test Accuracy (Prototype Model): 0.9277
Std Test Accuracy (Regular Model): 0.0473
Std Test Accuracy (Prototype Model): 0.0473
tobetrained:
[5, 8, 2, 0, 3]
Edge 5 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 3 begin training
readyList:
[7, 1, 9, 6, 4, 5, 0, 8, 2, 3]
aggregation_buffer:
[7, 1, 9, 6, 4]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([26.4325, 28.5603, 26.0183, 26.4325, 26.4007, 28.6627, 26.0183, 28.3491,
        28.6096, 28.8527])
Server loss: 5.512874603271484
train global classifier
train glclassifier time: 4.178885350935161
global classifier accuracy: 100.0
end Update
server_global_time: 278.67949952953495
only_train_time: 6633.722903562244

-------------Global Round number: 79-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9298
Averaged Test Accuracy (Prototype Model): 0.9277
Std Test Accuracy (Regular Model): 0.0478
Std Test Accuracy (Prototype Model): 0.0470
tobetrained:
[7, 1, 9, 6, 4]
Edge 7 begin training
Edge 1 begin training
Edge 9 begin training
Edge 6 begin training
Edge 4 begin training
readyList:
[5, 0, 8, 2, 1, 7, 9, 6, 4, 3]
aggregation_buffer:
[5, 0, 8, 2, 1]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([26.6347, 28.6530, 26.1089, 26.6347, 26.4890, 28.8203, 26.1089, 28.5301,
        28.7774, 28.9982])
Server loss: 5.503551006317139
train global classifier
train glclassifier time: 3.8555164020508528
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 282.80425367946737
only_train_time: 6710.329067175044

-------------Global Round number: 80-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9299
Averaged Test Accuracy (Prototype Model): 0.9285
Std Test Accuracy (Regular Model): 0.0475
Std Test Accuracy (Prototype Model): 0.0462
tobetrained:
[5, 0, 8, 2, 1]
Edge 5 begin training
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
readyList:
[7, 9, 6, 4, 1, 5, 0, 8, 3, 2]
aggregation_buffer:
[7, 9, 6, 4, 1]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([26.8964, 28.7330, 26.2807, 26.8964, 26.6326, 28.8823, 26.2807, 28.6710,
        28.9084, 29.0458])
Server loss: 5.420907020568848
train global classifier
train glclassifier time: 4.276683982927352
global classifier accuracy: 100.0
end Update
server_global_time: 287.1239224204328
only_train_time: 6789.012023753254

-------------Global Round number: 81-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9303
Averaged Test Accuracy (Prototype Model): 0.9280
Std Test Accuracy (Regular Model): 0.0475
Std Test Accuracy (Prototype Model): 0.0468
tobetrained:
[7, 9, 6, 4, 1]
Edge 7 begin training
Edge 9 begin training
Edge 6 begin training
Edge 4 begin training
Edge 1 begin training
readyList:
[5, 0, 8, 3, 2, 7, 1, 6, 9, 4]
aggregation_buffer:
[5, 0, 8, 3, 2]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([26.9625, 28.8331, 26.4270, 26.9625, 26.7627, 29.0047, 26.4270, 28.7189,
        28.9643, 29.1052])
Server loss: 5.405115604400635
train global classifier
train glclassifier time: 3.7751477919518948
global classifier accuracy: 100.0
end Update
server_global_time: 288.76763863442466
only_train_time: 6864.939976895228

-------------Global Round number: 82-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9299
Averaged Test Accuracy (Prototype Model): 0.9283
Std Test Accuracy (Regular Model): 0.0475
Std Test Accuracy (Prototype Model): 0.0469
tobetrained:
[5, 0, 8, 3, 2]
Edge 5 begin training
Edge 0 begin training
Edge 8 begin training
Edge 3 begin training
Edge 2 begin training
readyList:
[7, 1, 6, 9, 4, 5, 0, 8, 2, 3]
aggregation_buffer:
[7, 1, 6, 9, 4]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([27.0658, 28.8769, 26.2625, 27.0658, 26.7433, 29.0546, 26.2625, 28.7792,
        29.0981, 29.1510])
Server loss: 5.319054126739502
train global classifier
train glclassifier time: 3.8138103019446135
global classifier accuracy: 100.0
end Update
server_global_time: 292.8563836934045
only_train_time: 6955.204596402356

-------------Global Round number: 83-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9298
Averaged Test Accuracy (Prototype Model): 0.9284
Std Test Accuracy (Regular Model): 0.0472
Std Test Accuracy (Prototype Model): 0.0473
tobetrained:
[7, 1, 6, 9, 4]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 9 begin training
Edge 4 begin training
readyList:
[5, 0, 8, 2, 7, 1, 9, 4, 6, 3]
aggregation_buffer:
[5, 0, 8, 2, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([27.2175, 28.9837, 26.3981, 27.2175, 26.8334, 29.1985, 26.3981, 28.9309,
        29.2290, 29.2858])
Server loss: 5.3193535804748535
train global classifier
train glclassifier time: 3.907198744127527
global classifier accuracy: 100.0
end Update
server_global_time: 296.90978822042234
only_train_time: 7033.372663861606

-------------Global Round number: 84-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9298
Averaged Test Accuracy (Prototype Model): 0.9283
Std Test Accuracy (Regular Model): 0.0471
Std Test Accuracy (Prototype Model): 0.0469
tobetrained:
[5, 0, 8, 2, 7]
Edge 5 begin training
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 7 begin training
readyList:
[1, 9, 4, 6, 3, 7, 5, 0, 8, 2]
aggregation_buffer:
[1, 9, 4, 6, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([27.3364, 29.0644, 26.7367, 27.3364, 27.0343, 29.2497, 26.7367, 28.9831,
        29.2610, 29.3265])
Server loss: 5.331512928009033
train global classifier
train glclassifier time: 4.012976186117157
global classifier accuracy: 100.0
end Update
server_global_time: 300.4364651546348
only_train_time: 7110.696514012525

-------------Global Round number: 85-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9301
Averaged Test Accuracy (Prototype Model): 0.9284
Std Test Accuracy (Regular Model): 0.0473
Std Test Accuracy (Prototype Model): 0.0463
tobetrained:
[1, 9, 4, 6, 3]
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
readyList:
[7, 5, 0, 8, 2, 1, 9, 6, 4, 3]
aggregation_buffer:
[7, 5, 0, 8, 2]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([27.3573, 29.0436, 26.7667, 27.3573, 27.1032, 29.3656, 26.7667, 29.0292,
        29.2724, 29.3909])
Server loss: 5.258748531341553
train global classifier
train glclassifier time: 3.867652235785499
global classifier accuracy: 100.0
end Update
server_global_time: 302.835999525385
only_train_time: 7198.203399749473

-------------Global Round number: 86-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9305
Averaged Test Accuracy (Prototype Model): 0.9290
Std Test Accuracy (Regular Model): 0.0466
Std Test Accuracy (Prototype Model): 0.0457
tobetrained:
[7, 5, 0, 8, 2]
Edge 7 begin training
Edge 5 begin training
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
readyList:
[1, 9, 6, 4, 7, 5, 0, 8, 2, 3]
aggregation_buffer:
[1, 9, 6, 4, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([27.5132, 29.1715, 26.9608, 27.5132, 27.2740, 29.5078, 26.9608, 29.1825,
        29.4524, 29.5015])
Server loss: 5.2572455406188965
train global classifier
train glclassifier time: 3.7568209420423955
global classifier accuracy: 100.0
end Update
server_global_time: 306.8640192253515
only_train_time: 7275.602721033618

-------------Global Round number: 87-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9306
Averaged Test Accuracy (Prototype Model): 0.9284
Std Test Accuracy (Regular Model): 0.0468
Std Test Accuracy (Prototype Model): 0.0462
tobetrained:
[1, 9, 6, 4, 7]
Edge 1 begin training
Edge 9 begin training
Edge 6 begin training
Edge 4 begin training
Edge 7 begin training
readyList:
[5, 0, 8, 2, 7, 1, 6, 3, 9, 4]
aggregation_buffer:
[5, 0, 8, 2, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([27.6327, 29.2752, 27.0374, 27.6327, 27.3816, 29.5898, 27.0374, 29.2413,
        29.5238, 29.5750])
Server loss: 5.642205715179443
train global classifier
train glclassifier time: 3.7017876259051263
global classifier accuracy: 100.0
end Update
server_global_time: 310.91349394246936
only_train_time: 7351.273806558223

-------------Global Round number: 88-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9299
Averaged Test Accuracy (Prototype Model): 0.9281
Std Test Accuracy (Regular Model): 0.0480
Std Test Accuracy (Prototype Model): 0.0471
tobetrained:
[5, 0, 8, 2, 7]
Edge 5 begin training
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 7 begin training
readyList:
[1, 6, 3, 9, 4, 7, 5, 0, 8, 2]
aggregation_buffer:
[1, 6, 3, 9, 4]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([27.4796, 29.2366, 26.7617, 27.6394, 27.3575, 29.5849, 26.7617, 28.4696,
        28.1193, 28.9280])
Server loss: 5.570263862609863
train global classifier
train glclassifier time: 3.72797879204154
global classifier accuracy: 100.0
end Update
server_global_time: 312.7025636474136
only_train_time: 7427.821235964308

-------------Global Round number: 89-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9300
Averaged Test Accuracy (Prototype Model): 0.9284
Std Test Accuracy (Regular Model): 0.0477
Std Test Accuracy (Prototype Model): 0.0466
tobetrained:
[1, 6, 3, 9, 4]
Edge 1 begin training
Edge 6 begin training
Edge 3 begin training
Edge 9 begin training
Edge 4 begin training
readyList:
[7, 5, 0, 8, 2, 1, 9, 6, 4, 3]
aggregation_buffer:
[7, 5, 0, 8, 2]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([27.5994, 29.3024, 26.8372, 27.7218, 27.4005, 29.6748, 26.8372, 28.4647,
        28.1246, 28.9162])
Server loss: 5.194704532623291
train global classifier
train glclassifier time: 3.928027553949505
global classifier accuracy: 100.0
end Update
server_global_time: 316.78084724768996
only_train_time: 7514.535566237755

-------------Global Round number: 90-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9307
Averaged Test Accuracy (Prototype Model): 0.9290
Std Test Accuracy (Regular Model): 0.0470
Std Test Accuracy (Prototype Model): 0.0460
tobetrained:
[7, 5, 0, 8, 2]
Edge 7 begin training
Edge 5 begin training
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
readyList:
[1, 9, 6, 4, 7, 5, 0, 8, 2, 3]
aggregation_buffer:
[1, 9, 6, 4, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([27.9413, 29.4480, 27.3301, 27.9413, 27.5959, 29.7948, 27.3301, 29.4496,
        29.6174, 29.6812])
Server loss: 5.324705123901367
train global classifier
train glclassifier time: 3.918385434895754
global classifier accuracy: 100.0
end Update
server_global_time: 320.5704438968096
only_train_time: 7590.616231772816

-------------Global Round number: 91-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9308
Averaged Test Accuracy (Prototype Model): 0.9294
Std Test Accuracy (Regular Model): 0.0471
Std Test Accuracy (Prototype Model): 0.0463
tobetrained:
[1, 9, 6, 4, 7]
Edge 1 begin training
Edge 9 begin training
Edge 6 begin training
Edge 4 begin training
Edge 7 begin training
readyList:
[5, 0, 8, 2, 3, 7, 1, 9, 6, 4]
aggregation_buffer:
[5, 0, 8, 2, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([27.6423, 29.5110, 27.3939, 27.6423, 27.6658, 29.8045, 27.3939, 29.1563,
        29.3518, 29.7238])
Server loss: 5.224116325378418
train global classifier
train glclassifier time: 4.183088808087632
global classifier accuracy: 100.0
end Update
server_global_time: 324.19760655029677
only_train_time: 7666.3684580677655

-------------Global Round number: 92-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9306
Averaged Test Accuracy (Prototype Model): 0.9286
Std Test Accuracy (Regular Model): 0.0477
Std Test Accuracy (Prototype Model): 0.0475
tobetrained:
[5, 0, 8, 2, 3]
Edge 5 begin training
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 3 begin training
readyList:
[7, 1, 9, 6, 4, 5, 8, 0, 2, 3]
aggregation_buffer:
[7, 1, 9, 6, 4]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([27.7506, 29.5988, 27.5230, 27.7506, 27.7848, 29.8522, 27.5230, 29.2040,
        29.4614, 29.7997])
Server loss: 5.175029277801514
train global classifier
train glclassifier time: 3.9420298649929464
global classifier accuracy: 100.0
end Update
server_global_time: 326.29704771074466
only_train_time: 7754.054562004982

-------------Global Round number: 93-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9303
Averaged Test Accuracy (Prototype Model): 0.9284
Std Test Accuracy (Regular Model): 0.0468
Std Test Accuracy (Prototype Model): 0.0469
tobetrained:
[7, 1, 9, 6, 4]
Edge 7 begin training
Edge 1 begin training
Edge 9 begin training
Edge 6 begin training
Edge 4 begin training
readyList:
[5, 8, 0, 2, 1, 7, 9, 6, 4, 3]
aggregation_buffer:
[5, 8, 0, 2, 1]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([27.6146, 29.7532, 27.5210, 27.6146, 27.8096, 30.0774, 27.5210, 29.3318,
        29.4980, 29.9764])
Server loss: 5.344793319702148
train global classifier
train glclassifier time: 3.847419753903523
global classifier accuracy: 100.0
end Update
server_global_time: 330.3383149257861
only_train_time: 7829.40329597122

-------------Global Round number: 94-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9306
Averaged Test Accuracy (Prototype Model): 0.9288
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0460
tobetrained:
[5, 8, 0, 2, 1]
Edge 5 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 1 begin training
readyList:
[7, 9, 6, 4, 5, 1, 8, 3, 0, 2]
aggregation_buffer:
[7, 9, 6, 4, 5]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([27.6788, 29.8246, 27.5541, 27.6788, 27.9304, 30.1571, 27.5541, 29.3861,
        29.5904, 30.1000])
Server loss: 5.20307731628418
train global classifier
train glclassifier time: 3.9064810799900442
global classifier accuracy: 100.0
end Update
server_global_time: 334.56010698666796
only_train_time: 7907.161392499227

-------------Global Round number: 95-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9305
Averaged Test Accuracy (Prototype Model): 0.9292
Std Test Accuracy (Regular Model): 0.0475
Std Test Accuracy (Prototype Model): 0.0465
tobetrained:
[7, 9, 6, 4, 5]
Edge 7 begin training
Edge 9 begin training
Edge 6 begin training
Edge 4 begin training
Edge 5 begin training
readyList:
[1, 8, 3, 0, 2, 7, 5, 6, 9, 4]
aggregation_buffer:
[1, 8, 3, 0, 2]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([28.1185, 30.0224, 27.7491, 28.1185, 28.1504, 30.1828, 27.7491, 29.5361,
        29.7867, 30.1031])
Server loss: 5.104182243347168
train global classifier
train glclassifier time: 3.749220916070044
global classifier accuracy: 100.0
end Update
server_global_time: 336.08435314381495
only_train_time: 7982.208164144773

-------------Global Round number: 96-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9304
Averaged Test Accuracy (Prototype Model): 0.9287
Std Test Accuracy (Regular Model): 0.0480
Std Test Accuracy (Prototype Model): 0.0473
tobetrained:
[1, 8, 3, 0, 2]
Edge 1 begin training
Edge 8 begin training
Edge 3 begin training
Edge 0 begin training
Edge 2 begin training
readyList:
[7, 5, 6, 9, 1, 4, 8, 0, 2, 3]
aggregation_buffer:
[7, 5, 6, 9, 1]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([28.2459, 30.1450, 27.9134, 28.2459, 28.3466, 30.2687, 27.9134, 29.6203,
        29.9220, 30.1781])
Server loss: 5.298984527587891
train global classifier
train glclassifier time: 3.7282993469852954
global classifier accuracy: 100.0
end Update
server_global_time: 340.23064217879437
only_train_time: 8070.3757517081685

-------------Global Round number: 97-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9306
Averaged Test Accuracy (Prototype Model): 0.9289
Std Test Accuracy (Regular Model): 0.0474
Std Test Accuracy (Prototype Model): 0.0469
tobetrained:
[7, 5, 6, 9, 1]
Edge 7 begin training
Edge 5 begin training
Edge 6 begin training
Edge 9 begin training
Edge 1 begin training
readyList:
[4, 8, 0, 2, 7, 1, 5, 9, 6, 3]
aggregation_buffer:
[4, 8, 0, 2, 7]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([28.3227, 30.2274, 27.5272, 28.3227, 28.0791, 30.2238, 27.5272, 29.6331,
        29.9381, 30.2294])
Server loss: 5.3108954429626465
train global classifier
train glclassifier time: 3.9582100780680776
global classifier accuracy: 100.0
end Update
server_global_time: 344.3017596467398
only_train_time: 8143.795578421559

-------------Global Round number: 98-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9305
Averaged Test Accuracy (Prototype Model): 0.9287
Std Test Accuracy (Regular Model): 0.0475
Std Test Accuracy (Prototype Model): 0.0471
tobetrained:
[4, 8, 0, 2, 7]
Edge 4 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 7 begin training
readyList:
[1, 5, 9, 6, 3, 7, 0, 8, 4, 2]
aggregation_buffer:
[1, 5, 9, 6, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([28.0183, 30.1956, 27.5560, 28.0183, 28.1374, 30.1955, 27.5560, 29.6047,
        29.9556, 30.2518])
Server loss: 5.013375759124756
train global classifier
train glclassifier time: 3.9841223370749503
global classifier accuracy: 100.0
end Update
server_global_time: 347.6578647089191
only_train_time: 8222.34287172649

-------------Global Round number: 99-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9302
Averaged Test Accuracy (Prototype Model): 0.9288
Std Test Accuracy (Regular Model): 0.0472
Std Test Accuracy (Prototype Model): 0.0470
tobetrained:
[1, 5, 9, 6, 3]
Edge 1 begin training
Edge 5 begin training
Edge 9 begin training
Edge 6 begin training
Edge 3 begin training
readyList:
[7, 0, 8, 4, 2, 1, 5, 9, 6, 3]
aggregation_buffer:
[7, 0, 8, 4, 2]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([28.1702, 30.3033, 28.0359, 28.1702, 28.6312, 30.2975, 28.0359, 29.7644,
        30.1621, 30.3426])
Server loss: 4.924386024475098
train global classifier
train glclassifier time: 3.8828266728669405
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 350.1561606787145
only_train_time: 8306.710828051204

-------------Global Round number: 100-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9304
Averaged Test Accuracy (Prototype Model): 0.9297
Std Test Accuracy (Regular Model): 0.0470
Std Test Accuracy (Prototype Model): 0.0463

Best accuracy.
0.9307982185680027
File path: ../results/FashionMNIST_dir_0.3_imbalance_40_FedSAE_test_0.h5
Deleted.

Average time cost: 10197.68s.
Length:  101
std for best accurancy: 0.0
mean for best accurancy: 0.9307982185680027
All done!

Storage on cpu
-------------------------------------------------------------------------------
Total Tensors: 176170 	Used Memory: 14.37M
-------------------------------------------------------------------------------
