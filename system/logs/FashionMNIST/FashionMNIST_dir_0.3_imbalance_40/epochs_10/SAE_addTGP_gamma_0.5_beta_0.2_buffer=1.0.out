==================================================
goal = test
device = cuda
device_id = 0
dataset = FashionMNIST_dir_0.3_imbalance_40
num_classes = 10
model_family = HCNNs8
batch_size = 256
local_learning_rate = 0.06
use_decay_scheduler = False
learning_rate_decay = False
learning_rate_decay_gamma = 0.99
global_rounds = 200
edge_epochs = 1
local_epochs = 10
algorithm = FedSAE
join_ratio = 1.0
random_join_ratio = False
num_clients = 40
num_edges = 10
prev = 0
times = 1
eval_gap = 1
save_folder_name = temp
auto_break = False
feature_dim = 512
vocab_size = 98635
max_len = 200
client_drop_rate = 0.0
train_slow_rate = 0.0
send_slow_rate = 0.0
time_select = False
time_threthold = 10000
lamda = 2
trans_delay_simulate = False
agg_type = 0
buffersize = 10
test_useglclassifier = 0
gamma = 0.5
use_beta = True
SAEbeta = 0.2
addTGP = True
drawtsne = True
drawround = 10
noise_dim = 512
generator_learning_rate = 0.005
hidden_dim = 512
server_epochs = 100
alpha = 1.0
beta = 1.0
mentee_learning_rate = 0.005
T_start = 0.95
T_end = 0.98
server_learning_rate = 0.01
margin_threthold = 100.0
generator_path = stylegan/stylegan-xl-models/imagenet64.pkl
stable_diffusion_prompt = a cat
server_batch_size = 100
gen_batch_size = 4
mu = 50.0
==================================================
Random seed set as 42

============= Running time: 0th =============
Creating server and clients ...
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 0
label_counts: defaultdict(<class 'int'>, {5: 106, 1: 338, 0: 287, 3: 26, 9: 545, 6: 3, 2: 98, 4: 1})
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 1
label_counts: defaultdict(<class 'int'>, {4: 630, 7: 199, 1: 507, 2: 18, 5: 47, 0: 18, 3: 3, 6: 2})
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 2
label_counts: defaultdict(<class 'int'>, {0: 190, 5: 157, 7: 312, 9: 99, 6: 67, 8: 6, 2: 3, 3: 30, 4: 11})
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 3
label_counts: defaultdict(<class 'int'>, {6: 100, 3: 171, 8: 190, 9: 19, 4: 51, 2: 395, 0: 3, 5: 4})
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 4
label_counts: defaultdict(<class 'int'>, {5: 553, 0: 327, 1: 428, 2: 202, 4: 5})
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 5
label_counts: defaultdict(<class 'int'>, {4: 421, 6: 633, 2: 58, 3: 41, 8: 45, 1: 100, 7: 11, 5: 13, 0: 1})
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 6
label_counts: defaultdict(<class 'int'>, {4: 260, 9: 425, 8: 384, 3: 24, 1: 12, 2: 6, 6: 31, 7: 1})
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 7
label_counts: defaultdict(<class 'int'>, {9: 477, 8: 645, 6: 335, 7: 16, 3: 38, 5: 13, 4: 53, 0: 36, 1: 11, 2: 7})
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 8
label_counts: defaultdict(<class 'int'>, {4: 502, 9: 102, 0: 124, 6: 63, 2: 81, 8: 26, 5: 17, 3: 9, 1: 3})
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 9
label_counts: defaultdict(<class 'int'>, {3: 943, 2: 177, 1: 139, 0: 75})
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 10
label_counts: defaultdict(<class 'int'>, {8: 445, 4: 883, 2: 57, 0: 32, 3: 12, 5: 19, 7: 1, 6: 1, 1: 1})
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 11
label_counts: defaultdict(<class 'int'>, {6: 147, 4: 230, 8: 220, 9: 88, 3: 44, 1: 58, 5: 54, 2: 13, 7: 8})
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 12
label_counts: defaultdict(<class 'int'>, {6: 248, 3: 165, 1: 263, 9: 14, 0: 206, 5: 101, 7: 1, 4: 1})
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 13
label_counts: defaultdict(<class 'int'>, {3: 402, 2: 795, 4: 7, 7: 197, 0: 11, 5: 3, 1: 7})
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 14
label_counts: defaultdict(<class 'int'>, {9: 218, 0: 312, 3: 131, 4: 21, 5: 65, 1: 57, 2: 44, 8: 3})
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 15
label_counts: defaultdict(<class 'int'>, {6: 980, 5: 215, 3: 12, 1: 39, 0: 83, 4: 2})
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 16
label_counts: defaultdict(<class 'int'>, {4: 58, 3: 83, 0: 140, 1: 860, 5: 68, 8: 280, 6: 18, 7: 1})
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 17
label_counts: defaultdict(<class 'int'>, {8: 642, 5: 490, 0: 104, 4: 28, 3: 30, 2: 16, 7: 1, 6: 21, 1: 2})
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 18
label_counts: defaultdict(<class 'int'>, {8: 391, 1: 105, 2: 1, 4: 108, 7: 229, 3: 33, 5: 27, 6: 2, 0: 1})
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 19
label_counts: defaultdict(<class 'int'>, {1: 364, 0: 1204})
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 20
label_counts: defaultdict(<class 'int'>, {9: 858, 0: 37, 1: 290, 6: 44, 4: 216, 5: 157, 7: 131, 2: 19, 3: 1, 8: 1})
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 21
label_counts: defaultdict(<class 'int'>, {6: 225, 0: 136, 1: 383, 3: 62, 4: 288, 7: 16, 8: 4, 9: 1, 5: 1})
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 22
label_counts: defaultdict(<class 'int'>, {5: 243, 7: 387, 1: 102, 2: 9, 6: 68, 0: 12, 4: 1, 8: 15, 3: 1})
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 23
label_counts: defaultdict(<class 'int'>, {0: 232, 9: 256, 5: 40, 8: 141, 1: 32, 7: 1, 3: 2, 6: 1})
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 24
label_counts: defaultdict(<class 'int'>, {4: 309, 9: 235, 3: 447, 5: 120, 0: 62, 8: 15, 1: 2})
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 25
label_counts: defaultdict(<class 'int'>, {7: 222, 3: 388, 5: 505, 2: 154, 0: 81, 4: 7, 1: 34})
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 26
label_counts: defaultdict(<class 'int'>, {8: 568, 7: 172, 4: 139, 0: 443, 3: 26, 2: 116, 1: 10, 5: 5})
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 27
label_counts: defaultdict(<class 'int'>, {2: 186, 5: 530, 6: 253, 3: 75, 0: 88, 7: 1, 4: 5})
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 28
label_counts: defaultdict(<class 'int'>, {1: 63, 9: 281, 5: 14, 7: 176, 2: 50, 8: 93, 3: 24, 0: 22, 6: 2, 4: 1})
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 29
label_counts: defaultdict(<class 'int'>, {7: 363, 5: 337, 8: 138, 3: 170, 9: 164, 2: 27, 1: 20, 4: 2, 6: 3})
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 30
label_counts: defaultdict(<class 'int'>, {8: 229, 7: 302, 0: 243, 9: 43, 5: 24, 2: 1, 3: 2, 1: 2})
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 31
label_counts: defaultdict(<class 'int'>, {2: 510, 4: 583, 0: 98, 1: 223})
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 32
label_counts: defaultdict(<class 'int'>, {9: 1142, 7: 49, 2: 276, 5: 146, 1: 20, 3: 51, 6: 75, 8: 12, 0: 31, 4: 1})
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 33
label_counts: defaultdict(<class 'int'>, {2: 405, 6: 254, 7: 122, 1: 76, 3: 276, 0: 151, 4: 83})
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 34
label_counts: defaultdict(<class 'int'>, {0: 172, 2: 880, 6: 870, 3: 12, 1: 42, 4: 9})
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 35
label_counts: defaultdict(<class 'int'>, {4: 312, 9: 70, 0: 300, 6: 18, 7: 36, 5: 70, 2: 90, 3: 121, 1: 25, 8: 1})
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 36
label_counts: defaultdict(<class 'int'>, {6: 412, 2: 127, 8: 221, 3: 364, 1: 41, 9: 158, 7: 124, 0: 3, 4: 5})
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 37
label_counts: defaultdict(<class 'int'>, {7: 2178, 3: 1002, 6: 142, 4: 3, 2: 20, 5: 11, 0: 1})
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 38
label_counts: defaultdict(<class 'int'>, {5: 1124, 1: 545, 2: 23, 0: 14, 3: 21, 4: 1})
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 39
label_counts: defaultdict(<class 'int'>, {2: 387, 6: 233, 8: 501, 1: 41, 0: 13, 9: 3, 3: 2, 5: 12, 4: 1, 7: 2})

Join ratio / total clients: 1.0 / 40
Finished creating server and clients.
Trainable_prototypes(
  (embedings): Embedding(10, 512)
  (middle): Sequential(
    (0): Sequential(
      (0): Linear(in_features=512, out_features=512, bias=True)
      (1): ReLU()
    )
  )
  (fc): Linear(in_features=512, out_features=512, bias=True)
)
tobetrained:
[9, 8, 7, 6, 5, 4, 3, 2, 1, 0]
Edge 9 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_10 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_34 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_14 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_27 protos Not Found
Client_14 prev_protos Not Found
Client_10 prev_protos Not Found
Client_34 prev_protos Not Found
Client_27 prev_protos Not Found
Edge 8 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_3 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_31 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_22 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_21 protos Not Found
Client_22 prev_protos Not Found
Client_3 prev_protos Not Found
Client_21 prev_protos Not Found
Client_31 prev_protos Not Found
Edge 7 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_23 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_35 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_6 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_30 protos Not Found
Client_6 prev_protos Not Found
Client_35 prev_protos Not Found
Client_23 prev_protos Not Found
Client_30 prev_protos Not Found
Edge 6 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_4 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_39 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_9 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_8 protos Not Found
Client_4 prev_protos Not Found
Client_39 prev_protos Not Found
Client_9 prev_protos Not Found
Client_8 prev_protos Not Found
Edge 5 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_11 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_32 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_29 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_0 protos Not Found
Client_0 prev_protos Not Found
Client_32 prev_protos Not Found
Client_29 prev_protos Not Found
Client_11 prev_protos Not Found
Edge 4 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_36 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_7 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_1 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_28 protos Not Found
Client_1 prev_protos Not Found
Client_36 prev_protos Not Found
Client_7 prev_protos Not Found
Client_28 prev_protos Not Found
Edge 3 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_37 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_13 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_20 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_18 protos Not Found
Client_20 prev_protos Not Found
Client_13 prev_protos Not Found
Client_18 prev_protos Not Found
Client_37 prev_protos Not Found
Edge 2 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_5 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_25 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_2 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_38 protos Not Found
Client_38 prev_protos Not Found
Client_5 prev_protos Not Found
Client_2 prev_protos Not Found
Client_25 prev_protos Not Found
Edge 1 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_12 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_17 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_33 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_24 protos Not Found
Client_17 prev_protos Not Found
Client_24 prev_protos Not Found
Client_12 prev_protos Not Found
Client_33 prev_protos Not Found
Edge 0 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_26 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_15 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_19 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_16 protos Not Found
Client_19 prev_protos Not Found
Client_16 prev_protos Not Found
Client_15 prev_protos Not Found
Client_26 prev_protos Not Found
readyList:
[7, 8, 1, 5, 6, 2, 0, 4, 9, 3]
aggregation_buffer:
[7, 8, 1, 5, 6, 2, 0, 4, 9, 3]
Edge_0 prev_protos Not Found
Edge_1 prev_protos Not Found
Edge_2 prev_protos Not Found
Edge_3 prev_protos Not Found
Edge_4 prev_protos Not Found
Edge_5 prev_protos Not Found
Edge_6 prev_protos Not Found
Edge_7 prev_protos Not Found
Edge_8 prev_protos Not Found
Edge_9 prev_protos Not Found
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([3.1837, 4.7707, 2.1037, 4.6248, 2.8281, 4.2130, 2.1037, 6.8910, 3.5712,
        6.9715], device='cuda:0')
Server loss: 8.284708976745605
train global classifier
train glclassifier time: 3.831729017198086
global classifier accuracy: 99.0125
Number of samples: 324
end Update
server_global_time: 1.3736924231052399
only_train_time: 20.829100720584393

-------------Global Round number: 0-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.7979
Averaged Test Accuracy (Prototype Model): 0.6246
Std Test Accuracy (Regular Model): 0.1609
Std Test Accuracy (Prototype Model): 0.2276
tobetrained:
[7, 8, 1, 5, 6, 2, 0, 4, 9, 3]
Edge 7 begin training
Edge 8 begin training
Edge 1 begin training
Edge 5 begin training
Edge 6 begin training
Edge 2 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([2.8164, 4.1818, 1.7862, 3.5807, 2.2017, 4.1074, 1.7862, 4.7614, 3.5544,
        5.6538], device='cuda:0')
Server loss: 5.515292644500732
train global classifier
train glclassifier time: 3.7300028204917908
global classifier accuracy: 99.6575
end Update
server_global_time: 4.336777545511723
only_train_time: 65.58634970337152

-------------Global Round number: 1-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.8596
Averaged Test Accuracy (Prototype Model): 0.8229
Std Test Accuracy (Regular Model): 0.0932
Std Test Accuracy (Prototype Model): 0.1199
tobetrained:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([2.9287, 4.5720, 1.7840, 3.5215, 2.1634, 4.4656, 1.7840, 4.5066, 3.9198,
        5.7958], device='cuda:0')
Server loss: 5.093921661376953
train global classifier
train glclassifier time: 3.685116872191429
global classifier accuracy: 99.8225
end Update
server_global_time: 7.313377805054188
only_train_time: 110.24455112963915

-------------Global Round number: 2-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.8819
Averaged Test Accuracy (Prototype Model): 0.8629
Std Test Accuracy (Regular Model): 0.0760
Std Test Accuracy (Prototype Model): 0.0948
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([3.1551, 4.9816, 1.8975, 3.6676, 2.2831, 4.6865, 1.8975, 4.6865, 4.3333,
        6.1376], device='cuda:0')
Server loss: 5.021637439727783
train global classifier
train glclassifier time: 3.6683769673109055
global classifier accuracy: 99.9025
end Update
server_global_time: 10.303273968398571
only_train_time: 154.80578497052193

-------------Global Round number: 3-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.8929
Averaged Test Accuracy (Prototype Model): 0.8796
Std Test Accuracy (Regular Model): 0.0694
Std Test Accuracy (Prototype Model): 0.0868
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([3.4085, 5.4038, 2.0334, 3.8491, 2.4460, 4.9740, 2.0334, 4.9740, 4.7370,
        6.5028], device='cuda:0')
Server loss: 5.027370452880859
train global classifier
train glclassifier time: 3.992148518562317
global classifier accuracy: 99.9675
end Update
server_global_time: 13.27161630988121
only_train_time: 199.38987436890602

-------------Global Round number: 4-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.8999
Averaged Test Accuracy (Prototype Model): 0.8853
Std Test Accuracy (Regular Model): 0.0666
Std Test Accuracy (Prototype Model): 0.0826
tobetrained:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([3.6428, 5.7904, 2.1690, 4.0537, 2.6145, 5.2895, 2.1690, 5.2895, 5.1064,
        6.8475], device='cuda:0')
Server loss: 5.0513763427734375
train global classifier
train glclassifier time: 3.5806991532444954
global classifier accuracy: 99.97
end Update
server_global_time: 16.294399335980415
only_train_time: 244.1583318337798

-------------Global Round number: 5-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9055
Averaged Test Accuracy (Prototype Model): 0.8972
Std Test Accuracy (Regular Model): 0.0621
Std Test Accuracy (Prototype Model): 0.0702
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([3.8615, 6.1277, 2.3247, 4.2624, 2.8120, 5.6097, 2.3247, 5.6097, 5.4560,
        7.1532], device='cuda:0')
Server loss: 5.060558795928955
train global classifier
train glclassifier time: 3.7565830126404762
global classifier accuracy: 99.99
end Update
server_global_time: 19.32089936733246
only_train_time: 289.2358281239867

-------------Global Round number: 6-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9096
Averaged Test Accuracy (Prototype Model): 0.9025
Std Test Accuracy (Regular Model): 0.0600
Std Test Accuracy (Prototype Model): 0.0662
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([4.0632, 6.4371, 2.4882, 4.4765, 3.0320, 5.9030, 2.4882, 5.9030, 5.7862,
        7.4241], device='cuda:0')
Server loss: 5.056948184967041
train global classifier
train glclassifier time: 3.909305304288864
global classifier accuracy: 100.0
end Update
server_global_time: 22.297610454261303
only_train_time: 334.04788982123137

-------------Global Round number: 7-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9137
Averaged Test Accuracy (Prototype Model): 0.9058
Std Test Accuracy (Regular Model): 0.0576
Std Test Accuracy (Prototype Model): 0.0605
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([4.2469, 6.6889, 2.6268, 4.6364, 3.2227, 6.1692, 2.6268, 6.1692, 6.0435,
        7.6355], device='cuda:0')
Server loss: 5.038211822509766
train global classifier
train glclassifier time: 3.609154388308525
global classifier accuracy: 99.995
end Update
server_global_time: 25.07124998420477
only_train_time: 378.8043464869261

-------------Global Round number: 8-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9172
Averaged Test Accuracy (Prototype Model): 0.9090
Std Test Accuracy (Regular Model): 0.0536
Std Test Accuracy (Prototype Model): 0.0572
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 2, 4, 5, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 2, 4, 5, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([4.3861, 6.8831, 2.7505, 4.8171, 3.3801, 6.4139, 2.7505, 6.4139, 6.3120,
        7.8484], device='cuda:0')
Server loss: 5.038259983062744
train global classifier
train glclassifier time: 3.614400766789913
global classifier accuracy: 100.0
end Update
server_global_time: 28.069728277623653
only_train_time: 423.33727555722

-------------Global Round number: 9-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9176
Averaged Test Accuracy (Prototype Model): 0.9120
Std Test Accuracy (Regular Model): 0.0560
Std Test Accuracy (Prototype Model): 0.0553
tobetrained:
[7, 1, 6, 8, 0, 2, 4, 5, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 5, 0, 2, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 5, 0, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([4.5229, 7.0593, 2.9064, 4.9907, 3.5391, 6.6544, 2.9064, 6.6544, 6.5650,
        8.0316], device='cuda:0')
Server loss: 5.017240047454834
train global classifier
train glclassifier time: 3.4865458384156227
global classifier accuracy: 99.995
Number of samples: 324
end Update
server_global_time: 31.06949169933796
only_train_time: 467.80656506866217

-------------Global Round number: 10-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9199
Averaged Test Accuracy (Prototype Model): 0.9135
Std Test Accuracy (Regular Model): 0.0527
Std Test Accuracy (Prototype Model): 0.0552
tobetrained:
[7, 1, 6, 8, 5, 0, 2, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 5 begin training
Edge 0 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([4.6456, 7.2225, 2.9976, 5.1445, 3.7133, 6.8654, 2.9976, 6.8654, 6.7620,
        8.1931], device='cuda:0')
Server loss: 4.993082523345947
train global classifier
train glclassifier time: 3.6283469945192337
global classifier accuracy: 100.0
end Update
server_global_time: 34.07682237774134
only_train_time: 512.0357653349638

-------------Global Round number: 11-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9202
Averaged Test Accuracy (Prototype Model): 0.9151
Std Test Accuracy (Regular Model): 0.0534
Std Test Accuracy (Prototype Model): 0.0543
tobetrained:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([4.7924, 7.3829, 3.1959, 5.3283, 3.8896, 7.0527, 3.1959, 7.0527, 7.0008,
        8.3490], device='cuda:0')
Server loss: 4.9615349769592285
train global classifier
train glclassifier time: 3.717975750565529
global classifier accuracy: 100.0
end Update
server_global_time: 37.01936988532543
only_train_time: 556.6754766702652

-------------Global Round number: 12-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9227
Averaged Test Accuracy (Prototype Model): 0.9168
Std Test Accuracy (Regular Model): 0.0503
Std Test Accuracy (Prototype Model): 0.0535
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 0, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([4.8665, 7.4907, 3.3521, 5.4672, 3.9615, 7.1852, 3.3521, 7.1852, 7.1542,
        8.4441], device='cuda:0')
Server loss: 4.949505805969238
train global classifier
train glclassifier time: 3.710313558578491
global classifier accuracy: 100.0
end Update
server_global_time: 40.04491689056158
only_train_time: 601.622738391161

-------------Global Round number: 13-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9239
Averaged Test Accuracy (Prototype Model): 0.9175
Std Test Accuracy (Regular Model): 0.0490
Std Test Accuracy (Prototype Model): 0.0524
tobetrained:
[7, 6, 1, 8, 0, 5, 2, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([5.0106, 7.6242, 3.5304, 5.6324, 4.1739, 7.3675, 3.5304, 7.3675, 7.3222,
        8.5868], device='cuda:0')
Server loss: 4.905116558074951
train global classifier
train glclassifier time: 3.7231375128030777
global classifier accuracy: 100.0
end Update
server_global_time: 42.987950541079044
only_train_time: 646.2718229219317

-------------Global Round number: 14-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9251
Averaged Test Accuracy (Prototype Model): 0.9205
Std Test Accuracy (Regular Model): 0.0496
Std Test Accuracy (Prototype Model): 0.0514
tobetrained:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([5.1284, 7.7160, 3.7012, 5.7805, 4.3488, 7.5301, 3.7012, 7.5301, 7.4771,
        8.7192], device='cuda:0')
Server loss: 4.8772759437561035
train global classifier
train glclassifier time: 4.038616992533207
global classifier accuracy: 100.0
end Update
server_global_time: 45.92608295381069
only_train_time: 690.8077360987663

-------------Global Round number: 15-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9226
Averaged Test Accuracy (Prototype Model): 0.9192
Std Test Accuracy (Regular Model): 0.0512
Std Test Accuracy (Prototype Model): 0.0526
tobetrained:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 8, 2, 5, 4, 0, 1, 9, 3]
aggregation_buffer:
[7, 6, 8, 2, 5, 4, 0, 1, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([5.2600, 7.8310, 3.8949, 5.9584, 4.5238, 7.6702, 3.8949, 7.6702, 7.6554,
        8.8365], device='cuda:0')
Server loss: 4.843840599060059
train global classifier
train glclassifier time: 3.705786854028702
global classifier accuracy: 100.0
end Update
server_global_time: 48.925663001835346
only_train_time: 736.7461187914014

-------------Global Round number: 16-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9215
Averaged Test Accuracy (Prototype Model): 0.9190
Std Test Accuracy (Regular Model): 0.0545
Std Test Accuracy (Prototype Model): 0.0538
tobetrained:
[7, 6, 8, 2, 5, 4, 0, 1, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 0 begin training
Edge 1 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 5, 0, 2, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 5, 0, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([5.3917, 7.9170, 4.0479, 6.0941, 4.6761, 7.7931, 4.0479, 7.7931, 7.8058,
        8.9414], device='cuda:0')
Server loss: 4.812777519226074
train global classifier
train glclassifier time: 3.6120346635580063
global classifier accuracy: 100.0
end Update
server_global_time: 51.880750864744186
only_train_time: 781.0862851291895

-------------Global Round number: 17-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9232
Averaged Test Accuracy (Prototype Model): 0.9223
Std Test Accuracy (Regular Model): 0.0539
Std Test Accuracy (Prototype Model): 0.0510
tobetrained:
[7, 1, 6, 8, 5, 0, 2, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 5 begin training
Edge 0 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 5, 2, 0, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 5, 2, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([5.5181, 8.0312, 4.1898, 6.2453, 4.8494, 7.9185, 4.1898, 7.9185, 7.9554,
        9.0394], device='cuda:0')
Server loss: 4.774869441986084
train global classifier
train glclassifier time: 3.6433412730693817
global classifier accuracy: 100.0
end Update
server_global_time: 54.89367428421974
only_train_time: 825.5163262188435

-------------Global Round number: 18-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9255
Averaged Test Accuracy (Prototype Model): 0.9243
Std Test Accuracy (Regular Model): 0.0477
Std Test Accuracy (Prototype Model): 0.0466
tobetrained:
[7, 6, 1, 8, 5, 2, 0, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 5 begin training
Edge 2 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([5.6388, 8.1213, 4.3329, 6.3456, 5.0150, 8.0247, 4.3329, 8.0247, 8.0783,
        9.1275], device='cuda:0')
Server loss: 4.744442939758301
train global classifier
train glclassifier time: 3.640463247895241
global classifier accuracy: 100.0
end Update
server_global_time: 57.905306935310364
only_train_time: 870.1228884607553

-------------Global Round number: 19-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9258
Averaged Test Accuracy (Prototype Model): 0.9243
Std Test Accuracy (Regular Model): 0.0484
Std Test Accuracy (Prototype Model): 0.0481
tobetrained:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([5.7557, 8.2119, 4.4663, 6.4425, 5.1548, 8.1267, 4.4663, 8.1267, 8.2163,
        9.2126], device='cuda:0')
Server loss: 4.704798698425293
train global classifier
train glclassifier time: 3.492104783654213
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 60.84432228654623
only_train_time: 914.6500555127859

-------------Global Round number: 20-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9266
Averaged Test Accuracy (Prototype Model): 0.9253
Std Test Accuracy (Regular Model): 0.0473
Std Test Accuracy (Prototype Model): 0.0466
tobetrained:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([5.8436, 8.2929, 4.5319, 6.5267, 5.2740, 8.2274, 4.5319, 8.2274, 8.2924,
        9.2832], device='cuda:0')
Server loss: 4.69291877746582
train global classifier
train glclassifier time: 3.878945380449295
global classifier accuracy: 100.0
end Update
server_global_time: 63.769714035093784
only_train_time: 959.0772782415152

-------------Global Round number: 21-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9250
Averaged Test Accuracy (Prototype Model): 0.9253
Std Test Accuracy (Regular Model): 0.0523
Std Test Accuracy (Prototype Model): 0.0484
tobetrained:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([5.9499, 8.3740, 4.7169, 6.6135, 5.4177, 8.3121, 4.7169, 8.3121, 8.4205,
        9.3475], device='cuda:0')
Server loss: 4.633171081542969
train global classifier
train glclassifier time: 3.853802591562271
global classifier accuracy: 100.0
end Update
server_global_time: 66.76512148976326
only_train_time: 1003.392307035625

-------------Global Round number: 22-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9269
Averaged Test Accuracy (Prototype Model): 0.9270
Std Test Accuracy (Regular Model): 0.0471
Std Test Accuracy (Prototype Model): 0.0456
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([6.0706, 8.4601, 4.8601, 6.7001, 5.5636, 8.3961, 4.8601, 8.3961, 8.5563,
        9.4253], device='cuda:0')
Server loss: 4.5984392166137695
train global classifier
train glclassifier time: 3.576357513666153
global classifier accuracy: 100.0
end Update
server_global_time: 69.71218919754028
only_train_time: 1048.1237084940076

-------------Global Round number: 23-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9267
Averaged Test Accuracy (Prototype Model): 0.9267
Std Test Accuracy (Regular Model): 0.0473
Std Test Accuracy (Prototype Model): 0.0463
tobetrained:
[7, 6, 1, 8, 0, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 8, 1, 6, 2, 0, 9, 5, 4, 3]
aggregation_buffer:
[7, 8, 1, 6, 2, 0, 9, 5, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([6.1755, 8.5468, 5.0006, 6.7812, 5.7040, 8.4785, 5.0006, 8.4785, 8.6777,
        9.4999], device='cuda:0')
Server loss: 4.564791679382324
train global classifier
train glclassifier time: 3.6744041591882706
global classifier accuracy: 100.0
end Update
server_global_time: 72.73394807428122
only_train_time: 1092.140970826149

-------------Global Round number: 24-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9262
Averaged Test Accuracy (Prototype Model): 0.9274
Std Test Accuracy (Regular Model): 0.0484
Std Test Accuracy (Prototype Model): 0.0456
tobetrained:
[7, 8, 1, 6, 2, 0, 9, 5, 4, 3]
Edge 7 begin training
Edge 8 begin training
Edge 1 begin training
Edge 6 begin training
Edge 2 begin training
Edge 0 begin training
Edge 9 begin training
Edge 5 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([6.2863, 8.6266, 5.1263, 6.8661, 5.8354, 8.5570, 5.1263, 8.5570, 8.7887,
        9.5692], device='cuda:0')
Server loss: 4.5335588455200195
train global classifier
train glclassifier time: 3.961156167089939
global classifier accuracy: 100.0
end Update
server_global_time: 75.67106429487467
only_train_time: 1136.7697710990906

-------------Global Round number: 25-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9272
Averaged Test Accuracy (Prototype Model): 0.9279
Std Test Accuracy (Regular Model): 0.0466
Std Test Accuracy (Prototype Model): 0.0451
tobetrained:
[7, 6, 1, 8, 0, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([6.3834, 8.6970, 5.2527, 6.9337, 5.9690, 8.6327, 5.2527, 8.6327, 8.8891,
        9.6359], device='cuda:0')
Server loss: 4.506634712219238
train global classifier
train glclassifier time: 3.8913916423916817
global classifier accuracy: 100.0
end Update
server_global_time: 78.70833588391542
only_train_time: 1181.4262303486466

-------------Global Round number: 26-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9275
Averaged Test Accuracy (Prototype Model): 0.9287
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0450
tobetrained:
[7, 6, 1, 8, 0, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 8, 1, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 6, 8, 1, 0, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([6.4749, 8.7675, 5.3627, 7.0049, 6.0920, 8.7049, 5.3627, 8.7049, 8.9714,
        9.6919], device='cuda:0')
Server loss: 4.473510265350342
train global classifier
train glclassifier time: 3.7803929671645164
global classifier accuracy: 100.0
end Update
server_global_time: 81.69792473316193
only_train_time: 1225.6569872424006

-------------Global Round number: 27-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9277
Averaged Test Accuracy (Prototype Model): 0.9289
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0453
tobetrained:
[7, 6, 8, 1, 0, 5, 2, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 8 begin training
Edge 1 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([6.5700, 8.8368, 5.4750, 7.0737, 6.2103, 8.7715, 5.4750, 8.7715, 9.0403,
        9.7519], device='cuda:0')
Server loss: 4.44649600982666
train global classifier
train glclassifier time: 3.6605156660079956
global classifier accuracy: 100.0
end Update
server_global_time: 84.63735771924257
only_train_time: 1270.1880854219198

-------------Global Round number: 28-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9282
Averaged Test Accuracy (Prototype Model): 0.9293
Std Test Accuracy (Regular Model): 0.0458
Std Test Accuracy (Prototype Model): 0.0450
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([6.6546, 8.9022, 5.5773, 7.1378, 6.3167, 8.8379, 5.5773, 8.8379, 9.1064,
        9.8072], device='cuda:0')
Server loss: 4.422492980957031
train global classifier
train glclassifier time: 3.7163678109645844
global classifier accuracy: 100.0
end Update
server_global_time: 87.6294638440013
only_train_time: 1314.3587891459465

-------------Global Round number: 29-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9281
Averaged Test Accuracy (Prototype Model): 0.9295
Std Test Accuracy (Regular Model): 0.0465
Std Test Accuracy (Prototype Model): 0.0451
tobetrained:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([6.7350, 8.9632, 5.6735, 7.1994, 6.4067, 8.9051, 5.6735, 8.9051, 9.1715,
        9.8605], device='cuda:0')
Server loss: 4.398505210876465
train global classifier
train glclassifier time: 3.680064022541046
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 90.65026580542326
only_train_time: 1358.754575483501

-------------Global Round number: 30-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9286
Averaged Test Accuracy (Prototype Model): 0.9297
Std Test Accuracy (Regular Model): 0.0460
Std Test Accuracy (Prototype Model): 0.0452
tobetrained:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([6.8101, 9.0224, 5.7625, 7.2612, 6.4832, 8.9676, 5.7625, 8.9676, 9.2350,
        9.9127], device='cuda:0')
Server loss: 4.375164985656738
train global classifier
train glclassifier time: 3.5737056583166122
global classifier accuracy: 100.0
end Update
server_global_time: 93.59762214124203
only_train_time: 1403.3297192007303

-------------Global Round number: 31-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9285
Averaged Test Accuracy (Prototype Model): 0.9295
Std Test Accuracy (Regular Model): 0.0468
Std Test Accuracy (Prototype Model): 0.0451
tobetrained:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 0, 8, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 0, 8, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([6.8820, 9.0779, 5.8448, 7.3193, 6.5562, 9.0241, 5.8448, 9.0241, 9.2996,
        9.9655], device='cuda:0')
Server loss: 4.3569016456604
train global classifier
train glclassifier time: 3.5142174288630486
global classifier accuracy: 100.0
end Update
server_global_time: 96.57502866536379
only_train_time: 1447.6061374172568

-------------Global Round number: 32-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9289
Averaged Test Accuracy (Prototype Model): 0.9295
Std Test Accuracy (Regular Model): 0.0466
Std Test Accuracy (Prototype Model): 0.0452
tobetrained:
[7, 1, 6, 0, 8, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 4, 5, 2, 0, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 4, 5, 2, 0, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 6.9479,  9.1299,  5.9260,  7.3748,  6.6269,  9.0829,  5.9260,  9.0829,
         9.3622, 10.0149], device='cuda:0')
Server loss: 4.3375654220581055
train global classifier
train glclassifier time: 4.112241640686989
global classifier accuracy: 100.0
end Update
server_global_time: 99.48347719758749
only_train_time: 1491.3317945227027

-------------Global Round number: 33-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9291
Averaged Test Accuracy (Prototype Model): 0.9297
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0451
tobetrained:
[7, 6, 1, 8, 4, 5, 2, 0, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 4 begin training
Edge 5 begin training
Edge 2 begin training
Edge 0 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.0110,  9.1802,  6.0033,  7.4281,  6.6925,  9.1399,  6.0033,  9.1399,
         9.4172, 10.0617], device='cuda:0')
Server loss: 4.319425582885742
train global classifier
train glclassifier time: 3.7174608632922173
global classifier accuracy: 100.0
end Update
server_global_time: 102.5068703815341
only_train_time: 1535.885112196207

-------------Global Round number: 34-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9291
Averaged Test Accuracy (Prototype Model): 0.9298
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0450
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.0755,  9.2246,  6.0806,  7.4761,  6.7559,  9.1912,  6.0806,  9.1912,
         9.4740, 10.1082], device='cuda:0')
Server loss: 4.302011013031006
train global classifier
train glclassifier time: 3.68478162586689
global classifier accuracy: 100.0
end Update
server_global_time: 105.45497888326645
only_train_time: 1580.384260006249

-------------Global Round number: 35-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9291
Averaged Test Accuracy (Prototype Model): 0.9299
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0453
tobetrained:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.1357,  9.2711,  6.1506,  7.5253,  6.8151,  9.2393,  6.1506,  9.2393,
         9.5277, 10.1522], device='cuda:0')
Server loss: 4.283952713012695
train global classifier
train glclassifier time: 4.006923243403435
global classifier accuracy: 100.0
end Update
server_global_time: 108.38676761835814
only_train_time: 1625.0091316848993

-------------Global Round number: 36-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9292
Averaged Test Accuracy (Prototype Model): 0.9301
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0452
tobetrained:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.1928,  9.3141,  6.2163,  7.5692,  6.8679,  9.2862,  6.2163,  9.2862,
         9.5821, 10.1978], device='cuda:0')
Server loss: 4.2710280418396
train global classifier
train glclassifier time: 3.667142830789089
global classifier accuracy: 100.0
end Update
server_global_time: 111.41382373869419
only_train_time: 1669.5505975782871

-------------Global Round number: 37-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9292
Averaged Test Accuracy (Prototype Model): 0.9302
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0450
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 5, 2, 0, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 5, 2, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.2494,  9.3557,  6.2805,  7.6133,  6.9224,  9.3335,  6.2805,  9.3335,
         9.6340, 10.2403], device='cuda:0')
Server loss: 4.255581855773926
train global classifier
train glclassifier time: 3.691674403846264
global classifier accuracy: 100.0
end Update
server_global_time: 114.37636109441519
only_train_time: 1713.8291901275516

-------------Global Round number: 38-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9294
Averaged Test Accuracy (Prototype Model): 0.9302
Std Test Accuracy (Regular Model): 0.0459
Std Test Accuracy (Prototype Model): 0.0453
tobetrained:
[7, 6, 1, 8, 5, 2, 0, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 5 begin training
Edge 2 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.3050,  9.3958,  6.3460,  7.6526,  6.9775,  9.3761,  6.3460,  9.3761,
         9.6833, 10.2793], device='cuda:0')
Server loss: 4.239503860473633
train global classifier
train glclassifier time: 4.600511893630028
global classifier accuracy: 100.0
end Update
server_global_time: 117.15639937669039
only_train_time: 1758.2250176295638

-------------Global Round number: 39-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9295
Averaged Test Accuracy (Prototype Model): 0.9304
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0453
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.3551,  9.4372,  6.4066,  7.6924,  7.0253,  9.4185,  6.4066,  9.4185,
         9.7298, 10.3204], device='cuda:0')
Server loss: 4.228787422180176
train global classifier
train glclassifier time: 3.800072528421879
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 120.11836367845535
only_train_time: 1802.9000110700727

-------------Global Round number: 40-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9293
Averaged Test Accuracy (Prototype Model): 0.9303
Std Test Accuracy (Regular Model): 0.0465
Std Test Accuracy (Prototype Model): 0.0453
tobetrained:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.4052,  9.4747,  6.4662,  7.7348,  7.0747,  9.4614,  6.4662,  9.4614,
         9.7727, 10.3637], device='cuda:0')
Server loss: 4.220269680023193
train global classifier
train glclassifier time: 4.129955254495144
global classifier accuracy: 100.0
end Update
server_global_time: 123.14548101276159
only_train_time: 1847.4103692993522

-------------Global Round number: 41-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9292
Averaged Test Accuracy (Prototype Model): 0.9302
Std Test Accuracy (Regular Model): 0.0465
Std Test Accuracy (Prototype Model): 0.0456
tobetrained:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.4543,  9.5128,  6.5208,  7.7744,  7.1190,  9.5008,  6.5208,  9.5008,
         9.8186, 10.4039], device='cuda:0')
Server loss: 4.21071720123291
train global classifier
train glclassifier time: 3.838714525103569
global classifier accuracy: 100.0
end Update
server_global_time: 126.09131799638271
only_train_time: 1891.7962843477726

-------------Global Round number: 42-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9294
Averaged Test Accuracy (Prototype Model): 0.9305
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0454
tobetrained:
[7, 6, 1, 8, 0, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 5, 9, 4, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 5, 9, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.5004,  9.5475,  6.5742,  7.8104,  7.1648,  9.5426,  6.5742,  9.5426,
         9.8620, 10.4451], device='cuda:0')
Server loss: 4.202140808105469
train global classifier
train glclassifier time: 3.6317690536379814
global classifier accuracy: 100.0
end Update
server_global_time: 128.80830769985914
only_train_time: 1935.7755246832967

-------------Global Round number: 43-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9293
Averaged Test Accuracy (Prototype Model): 0.9303
Std Test Accuracy (Regular Model): 0.0465
Std Test Accuracy (Prototype Model): 0.0458
tobetrained:
[7, 6, 1, 8, 2, 0, 5, 9, 4, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.5464,  9.5798,  6.6260,  7.8490,  7.2103,  9.5846,  6.6260,  9.5846,
         9.9026, 10.4868], device='cuda:0')
Server loss: 4.195303916931152
train global classifier
train glclassifier time: 3.8660297989845276
global classifier accuracy: 100.0
end Update
server_global_time: 131.74531444907188
only_train_time: 1980.0893782228231

-------------Global Round number: 44-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9293
Averaged Test Accuracy (Prototype Model): 0.9306
Std Test Accuracy (Regular Model): 0.0465
Std Test Accuracy (Prototype Model): 0.0455
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.5919,  9.6125,  6.6758,  7.8854,  7.2558,  9.6259,  6.6758,  9.6259,
         9.9460, 10.5239], device='cuda:0')
Server loss: 4.185991287231445
train global classifier
train glclassifier time: 4.028020225465298
global classifier accuracy: 100.0
end Update
server_global_time: 134.6868774369359
only_train_time: 2024.4839697554708

-------------Global Round number: 45-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9293
Averaged Test Accuracy (Prototype Model): 0.9306
Std Test Accuracy (Regular Model): 0.0467
Std Test Accuracy (Prototype Model): 0.0455
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 4, 2, 0, 5, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 4, 2, 0, 5, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.6361,  9.6453,  6.7249,  7.9221,  7.2991,  9.6644,  6.7249,  9.6644,
         9.9829, 10.5634], device='cuda:0')
Server loss: 4.180309772491455
train global classifier
train glclassifier time: 3.969961166381836
global classifier accuracy: 100.0
end Update
server_global_time: 137.6330225765705
only_train_time: 2068.3260431289673

-------------Global Round number: 46-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9292
Averaged Test Accuracy (Prototype Model): 0.9305
Std Test Accuracy (Regular Model): 0.0469
Std Test Accuracy (Prototype Model): 0.0456
tobetrained:
[7, 1, 6, 8, 4, 2, 0, 5, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 4 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 5, 2, 9, 4, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 5, 2, 9, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.6787,  9.6771,  6.7730,  7.9583,  7.3416,  9.7034,  6.7730,  9.7034,
        10.0241, 10.5991], device='cuda:0')
Server loss: 4.170800685882568
train global classifier
train glclassifier time: 3.6303843781352043
global classifier accuracy: 100.0
end Update
server_global_time: 140.58586801588535
only_train_time: 2112.9346459135413

-------------Global Round number: 47-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9296
Averaged Test Accuracy (Prototype Model): 0.9304
Std Test Accuracy (Regular Model): 0.0468
Std Test Accuracy (Prototype Model): 0.0455
tobetrained:
[7, 1, 6, 8, 0, 5, 2, 9, 4, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.7211,  9.7081,  6.8205,  7.9934,  7.3832,  9.7418,  6.8205,  9.7418,
        10.0630, 10.6380], device='cuda:0')
Server loss: 4.165770053863525
train global classifier
train glclassifier time: 3.6315769255161285
global classifier accuracy: 100.0
end Update
server_global_time: 143.58696764707565
only_train_time: 2157.430105380714

-------------Global Round number: 48-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9294
Averaged Test Accuracy (Prototype Model): 0.9299
Std Test Accuracy (Regular Model): 0.0468
Std Test Accuracy (Prototype Model): 0.0458
tobetrained:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.7636,  9.7396,  6.8686,  8.0284,  7.4238,  9.7788,  6.8686,  9.7788,
        10.1024, 10.6765], device='cuda:0')
Server loss: 4.160747051239014
train global classifier
train glclassifier time: 4.384861744940281
global classifier accuracy: 100.0
end Update
server_global_time: 146.58409855514765
only_train_time: 2201.779870197177

-------------Global Round number: 49-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9296
Averaged Test Accuracy (Prototype Model): 0.9300
Std Test Accuracy (Regular Model): 0.0469
Std Test Accuracy (Prototype Model): 0.0458
tobetrained:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.8036,  9.7734,  6.9137,  8.0659,  7.4607,  9.8149,  6.9137,  9.8149,
        10.1406, 10.7175], device='cuda:0')
Server loss: 4.15872859954834
train global classifier
train glclassifier time: 3.84296103566885
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 149.52380426228046
only_train_time: 2246.074401281774

-------------Global Round number: 50-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9296
Averaged Test Accuracy (Prototype Model): 0.9300
Std Test Accuracy (Regular Model): 0.0468
Std Test Accuracy (Prototype Model): 0.0456
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.8435,  9.8026,  6.9581,  8.1000,  7.4998,  9.8533,  6.9581,  9.8533,
        10.1795, 10.7559], device='cuda:0')
Server loss: 4.153971195220947
train global classifier
train glclassifier time: 3.731345660984516
global classifier accuracy: 100.0
end Update
server_global_time: 152.5084207728505
only_train_time: 2290.6003917604685

-------------Global Round number: 51-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9296
Averaged Test Accuracy (Prototype Model): 0.9301
Std Test Accuracy (Regular Model): 0.0465
Std Test Accuracy (Prototype Model): 0.0455
tobetrained:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 0, 8, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 0, 8, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.8819,  9.8341,  6.9995,  8.1353,  7.5347,  9.8925,  6.9995,  9.8925,
        10.2160, 10.7920], device='cuda:0')
Server loss: 4.148369789123535
train global classifier
train glclassifier time: 3.8382229432463646
global classifier accuracy: 100.0
end Update
server_global_time: 155.45292136073112
only_train_time: 2334.485203869641

-------------Global Round number: 52-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9298
Averaged Test Accuracy (Prototype Model): 0.9301
Std Test Accuracy (Regular Model): 0.0467
Std Test Accuracy (Prototype Model): 0.0455
tobetrained:
[7, 6, 1, 0, 8, 5, 2, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 0 begin training
Edge 8 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.9191,  9.8604,  7.0422,  8.1651,  7.5710,  9.9301,  7.0422,  9.9301,
        10.2529, 10.8280], device='cuda:0')
Server loss: 4.145602703094482
train global classifier
train glclassifier time: 3.5831061750650406
global classifier accuracy: 100.0
end Update
server_global_time: 158.3992681875825
only_train_time: 2378.956489369273

-------------Global Round number: 53-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9298
Averaged Test Accuracy (Prototype Model): 0.9301
Std Test Accuracy (Regular Model): 0.0465
Std Test Accuracy (Prototype Model): 0.0455
tobetrained:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.9575,  9.8886,  7.0849,  8.1968,  7.6085,  9.9648,  7.0849,  9.9648,
        10.2878, 10.8639], device='cuda:0')
Server loss: 4.14171028137207
train global classifier
train glclassifier time: 4.140713058412075
global classifier accuracy: 100.0
end Update
server_global_time: 161.3335876390338
only_train_time: 2423.3782649710774

-------------Global Round number: 54-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9298
Averaged Test Accuracy (Prototype Model): 0.9303
Std Test Accuracy (Regular Model): 0.0466
Std Test Accuracy (Prototype Model): 0.0456
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.9922,  9.9194,  7.1210,  8.2300,  7.6435, 10.0015,  7.1210, 10.0015,
        10.3275, 10.8986], device='cuda:0')
Server loss: 4.135812759399414
train global classifier
train glclassifier time: 4.745995968580246
global classifier accuracy: 100.0
end Update
server_global_time: 164.35035084187984
only_train_time: 2467.509161785245

-------------Global Round number: 55-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9299
Averaged Test Accuracy (Prototype Model): 0.9302
Std Test Accuracy (Regular Model): 0.0467
Std Test Accuracy (Prototype Model): 0.0457
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.0268,  9.9516,  7.1614,  8.2634,  7.6805, 10.0355,  7.1614, 10.0355,
        10.3657, 10.9335], device='cuda:0')
Server loss: 4.131971836090088
train global classifier
train glclassifier time: 3.81300700455904
global classifier accuracy: 100.0
end Update
server_global_time: 167.25642742961645
only_train_time: 2511.725583024323

-------------Global Round number: 56-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9301
Averaged Test Accuracy (Prototype Model): 0.9303
Std Test Accuracy (Regular Model): 0.0466
Std Test Accuracy (Prototype Model): 0.0457
tobetrained:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.0644,  9.9771,  7.2041,  8.2918,  7.7149, 10.0732,  7.2041, 10.0732,
        10.4028, 10.9714], device='cuda:0')
Server loss: 4.129635334014893
train global classifier
train glclassifier time: 3.615080051124096
global classifier accuracy: 100.0
end Update
server_global_time: 170.19959400594234
only_train_time: 2556.2565257921815

-------------Global Round number: 57-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9299
Averaged Test Accuracy (Prototype Model): 0.9305
Std Test Accuracy (Regular Model): 0.0467
Std Test Accuracy (Prototype Model): 0.0456
tobetrained:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.0996, 10.0025,  7.2466,  8.3207,  7.7538, 10.1082,  7.2466, 10.1082,
        10.4402, 11.0079], device='cuda:0')
Server loss: 4.125814914703369
train global classifier
train glclassifier time: 3.661582939326763
global classifier accuracy: 100.0
end Update
server_global_time: 173.1298571974039
only_train_time: 2600.715441122651

-------------Global Round number: 58-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9301
Averaged Test Accuracy (Prototype Model): 0.9306
Std Test Accuracy (Regular Model): 0.0467
Std Test Accuracy (Prototype Model): 0.0455
tobetrained:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.1327, 10.0317,  7.2844,  8.3524,  7.7860, 10.1471,  7.2844, 10.1471,
        10.4768, 11.0400], device='cuda:0')
Server loss: 4.12069034576416
train global classifier
train glclassifier time: 4.8722581416368484
global classifier accuracy: 100.0
end Update
server_global_time: 176.1298886910081
only_train_time: 2645.3599591329694

-------------Global Round number: 59-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9303
Averaged Test Accuracy (Prototype Model): 0.9307
Std Test Accuracy (Regular Model): 0.0465
Std Test Accuracy (Prototype Model): 0.0455
tobetrained:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 0, 2, 4, 5, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 0, 2, 4, 5, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.1658, 10.0590,  7.3228,  8.3830,  7.8246, 10.1803,  7.3228, 10.1803,
        10.5165, 11.0709], device='cuda:0')
Server loss: 4.115514755249023
train global classifier
train glclassifier time: 4.109763562679291
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 179.12010153383017
only_train_time: 2689.9403512477875

-------------Global Round number: 60-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9304
Averaged Test Accuracy (Prototype Model): 0.9307
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0454
tobetrained:
[7, 6, 1, 8, 0, 2, 4, 5, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 8, 6, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 8, 6, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.1984, 10.0853,  7.3599,  8.4131,  7.8602, 10.2159,  7.3599, 10.2159,
        10.5535, 11.1061], device='cuda:0')
Server loss: 4.112791538238525
train global classifier
train glclassifier time: 3.7223335281014442
global classifier accuracy: 100.0
end Update
server_global_time: 182.073093123734
only_train_time: 2734.788800738752

-------------Global Round number: 61-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9302
Averaged Test Accuracy (Prototype Model): 0.9308
Std Test Accuracy (Regular Model): 0.0465
Std Test Accuracy (Prototype Model): 0.0456
tobetrained:
[7, 1, 8, 6, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 8 begin training
Edge 6 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.2329, 10.1110,  7.3996,  8.4419,  7.8937, 10.2520,  7.3996, 10.2520,
        10.5870, 11.1386], device='cuda:0')
Server loss: 4.107699394226074
train global classifier
train glclassifier time: 3.8822604566812515
global classifier accuracy: 100.0
end Update
server_global_time: 185.02736036479473
only_train_time: 2779.5004118084908

-------------Global Round number: 62-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9303
Averaged Test Accuracy (Prototype Model): 0.9307
Std Test Accuracy (Regular Model): 0.0467
Std Test Accuracy (Prototype Model): 0.0458
tobetrained:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.2680, 10.1349,  7.4392,  8.4723,  7.9288, 10.2858,  7.4392, 10.2858,
        10.6233, 11.1714], device='cuda:0')
Server loss: 4.103955268859863
train global classifier
train glclassifier time: 3.625448487699032
global classifier accuracy: 100.0
end Update
server_global_time: 187.97143395990133
only_train_time: 2823.970192231238

-------------Global Round number: 63-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9303
Averaged Test Accuracy (Prototype Model): 0.9307
Std Test Accuracy (Regular Model): 0.0467
Std Test Accuracy (Prototype Model): 0.0457
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.3016, 10.1594,  7.4752,  8.5025,  7.9606, 10.3188,  7.4752, 10.3188,
        10.6568, 11.2056], device='cuda:0')
Server loss: 4.102447986602783
train global classifier
train glclassifier time: 3.7945305481553078
global classifier accuracy: 100.0
end Update
server_global_time: 190.92551330477
only_train_time: 2868.0708197951317

-------------Global Round number: 64-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9303
Averaged Test Accuracy (Prototype Model): 0.9309
Std Test Accuracy (Regular Model): 0.0465
Std Test Accuracy (Prototype Model): 0.0457
tobetrained:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.3356, 10.1869,  7.5114,  8.5352,  7.9926, 10.3510,  7.5114, 10.3510,
        10.6893, 11.2384], device='cuda:0')
Server loss: 4.101382732391357
train global classifier
train glclassifier time: 3.5853472724556923
global classifier accuracy: 100.0
end Update
server_global_time: 193.881468847394
only_train_time: 2912.660363331437

-------------Global Round number: 65-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9303
Averaged Test Accuracy (Prototype Model): 0.9310
Std Test Accuracy (Regular Model): 0.0466
Std Test Accuracy (Prototype Model): 0.0455
tobetrained:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 5, 2, 0, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 5, 2, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.3712, 10.2130,  7.5520,  8.5626,  8.0256, 10.3815,  7.5520, 10.3815,
        10.7209, 11.2695], device='cuda:0')
Server loss: 4.096421718597412
train global classifier
train glclassifier time: 3.8974293917417526
global classifier accuracy: 100.0
end Update
server_global_time: 196.85008712112904
only_train_time: 2957.3437390103936

-------------Global Round number: 66-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9303
Averaged Test Accuracy (Prototype Model): 0.9313
Std Test Accuracy (Regular Model): 0.0466
Std Test Accuracy (Prototype Model): 0.0450
tobetrained:
[7, 6, 1, 8, 5, 2, 0, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 5 begin training
Edge 2 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 4, 5, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 4, 5, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.4050, 10.2390,  7.5893,  8.5885,  8.0583, 10.4138,  7.5893, 10.4138,
        10.7558, 11.2988], device='cuda:0')
Server loss: 4.093532562255859
train global classifier
train glclassifier time: 4.636602655053139
global classifier accuracy: 100.0
end Update
server_global_time: 199.79664964973927
only_train_time: 3001.7486115843058

-------------Global Round number: 67-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9303
Averaged Test Accuracy (Prototype Model): 0.9313
Std Test Accuracy (Regular Model): 0.0467
Std Test Accuracy (Prototype Model): 0.0451
tobetrained:
[7, 6, 1, 8, 2, 0, 4, 5, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.4387, 10.2622,  7.6242,  8.6179,  8.0894, 10.4480,  7.6242, 10.4480,
        10.7897, 11.3310], device='cuda:0')
Server loss: 4.088517189025879
train global classifier
train glclassifier time: 3.6729806065559387
global classifier accuracy: 100.0
end Update
server_global_time: 202.80560286343098
only_train_time: 3046.480931982398

-------------Global Round number: 68-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9303
Averaged Test Accuracy (Prototype Model): 0.9313
Std Test Accuracy (Regular Model): 0.0466
Std Test Accuracy (Prototype Model): 0.0451
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 9, 4, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 9, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.4722, 10.2861,  7.6608,  8.6467,  8.1220, 10.4779,  7.6608, 10.4779,
        10.8250, 11.3594], device='cuda:0')
Server loss: 4.083743095397949
train global classifier
train glclassifier time: 3.540243551135063
global classifier accuracy: 100.0
end Update
server_global_time: 205.75290567427874
only_train_time: 3091.147537395358

-------------Global Round number: 69-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9304
Averaged Test Accuracy (Prototype Model): 0.9313
Std Test Accuracy (Regular Model): 0.0467
Std Test Accuracy (Prototype Model): 0.0450
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 9, 4, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.5086, 10.3107,  7.6985,  8.6771,  8.1531, 10.5098,  7.6985, 10.5098,
        10.8565, 11.3881], device='cuda:0')
Server loss: 4.078926086425781
train global classifier
train glclassifier time: 3.5446590930223465
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 208.7422751635313
only_train_time: 3135.449716798961

-------------Global Round number: 70-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9303
Averaged Test Accuracy (Prototype Model): 0.9313
Std Test Accuracy (Regular Model): 0.0467
Std Test Accuracy (Prototype Model): 0.0451
tobetrained:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 8, 6, 1, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 8, 6, 1, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.5415, 10.3345,  7.7324,  8.7038,  8.1818, 10.5433,  7.7324, 10.5433,
        10.8903, 11.4193], device='cuda:0')
Server loss: 4.076923370361328
train global classifier
train glclassifier time: 3.6266195997595787
global classifier accuracy: 100.0
end Update
server_global_time: 211.748835131526
only_train_time: 3179.763633914292

-------------Global Round number: 71-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9302
Averaged Test Accuracy (Prototype Model): 0.9312
Std Test Accuracy (Regular Model): 0.0468
Std Test Accuracy (Prototype Model): 0.0452
tobetrained:
[7, 8, 6, 1, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 8 begin training
Edge 6 begin training
Edge 1 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 5, 0, 4, 9, 2, 3]
aggregation_buffer:
[7, 6, 1, 8, 5, 0, 4, 9, 2, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.5749, 10.3595,  7.7676,  8.7317,  8.2114, 10.5754,  7.7676, 10.5754,
        10.9185, 11.4508], device='cuda:0')
Server loss: 4.075808048248291
train global classifier
train glclassifier time: 3.7840020656585693
global classifier accuracy: 100.0
end Update
server_global_time: 214.4296921044588
only_train_time: 3224.9363407343626

-------------Global Round number: 72-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9301
Averaged Test Accuracy (Prototype Model): 0.9314
Std Test Accuracy (Regular Model): 0.0468
Std Test Accuracy (Prototype Model): 0.0449
tobetrained:
[7, 6, 1, 8, 5, 0, 4, 9, 2, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 2 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.6092, 10.3843,  7.8031,  8.7612,  8.2416, 10.6071,  7.8031, 10.6071,
        10.9527, 11.4794], device='cuda:0')
Server loss: 4.07105827331543
train global classifier
train glclassifier time: 3.569239780306816
global classifier accuracy: 100.0
end Update
server_global_time: 217.3667010590434
only_train_time: 3269.5005223304033

-------------Global Round number: 73-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9301
Averaged Test Accuracy (Prototype Model): 0.9314
Std Test Accuracy (Regular Model): 0.0468
Std Test Accuracy (Prototype Model): 0.0450
tobetrained:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.6411, 10.4102,  7.8380,  8.7907,  8.2700, 10.6377,  7.8380, 10.6377,
        10.9854, 11.5075], device='cuda:0')
Server loss: 4.067824363708496
train global classifier
train glclassifier time: 4.061417117714882
global classifier accuracy: 100.0
end Update
server_global_time: 220.36495193094015
only_train_time: 3313.707089230418

-------------Global Round number: 74-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9301
Averaged Test Accuracy (Prototype Model): 0.9314
Std Test Accuracy (Regular Model): 0.0468
Std Test Accuracy (Prototype Model): 0.0448
tobetrained:
[7, 6, 1, 8, 0, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.6742, 10.4353,  7.8720,  8.8218,  8.2971, 10.6679,  7.8720, 10.6679,
        11.0181, 11.5349], device='cuda:0')
Server loss: 4.062137603759766
train global classifier
train glclassifier time: 3.701316885650158
global classifier accuracy: 100.0
end Update
server_global_time: 223.3758536428213
only_train_time: 3358.487859144807

-------------Global Round number: 75-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9302
Averaged Test Accuracy (Prototype Model): 0.9315
Std Test Accuracy (Regular Model): 0.0467
Std Test Accuracy (Prototype Model): 0.0448
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.7034, 10.4550,  7.9048,  8.8488,  8.3263, 10.6996,  7.9048, 10.6996,
        11.0496, 11.5646], device='cuda:0')
Server loss: 4.057900905609131
train global classifier
train glclassifier time: 3.6350774988532066
global classifier accuracy: 100.0
end Update
server_global_time: 226.12635456770658
only_train_time: 3402.732373379171

-------------Global Round number: 76-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9301
Averaged Test Accuracy (Prototype Model): 0.9314
Std Test Accuracy (Regular Model): 0.0468
Std Test Accuracy (Prototype Model): 0.0451
tobetrained:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 5, 2, 0, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 5, 2, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.7353, 10.4764,  7.9375,  8.8783,  8.3566, 10.7289,  7.9375, 10.7289,
        11.0819, 11.5889], device='cuda:0')
Server loss: 4.0521697998046875
train global classifier
train glclassifier time: 3.6389237716794014
global classifier accuracy: 100.0
end Update
server_global_time: 229.10327264666557
only_train_time: 3447.3983536437154

-------------Global Round number: 77-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9300
Averaged Test Accuracy (Prototype Model): 0.9314
Std Test Accuracy (Regular Model): 0.0468
Std Test Accuracy (Prototype Model): 0.0450
tobetrained:
[7, 6, 1, 8, 5, 2, 0, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 5 begin training
Edge 2 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.7697, 10.4970,  7.9722,  8.9056,  8.3855, 10.7574,  7.9722, 10.7574,
        11.1127, 11.6156], device='cuda:0')
Server loss: 4.047281265258789
train global classifier
train glclassifier time: 3.583777889609337
global classifier accuracy: 100.0
end Update
server_global_time: 232.17155870050192
only_train_time: 3492.0996171832085

-------------Global Round number: 78-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9302
Averaged Test Accuracy (Prototype Model): 0.9314
Std Test Accuracy (Regular Model): 0.0468
Std Test Accuracy (Prototype Model): 0.0451
tobetrained:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.7997, 10.5167,  8.0036,  8.9310,  8.4136, 10.7846,  8.0036, 10.7846,
        11.1463, 11.6450], device='cuda:0')
Server loss: 4.0456719398498535
train global classifier
train glclassifier time: 3.6922342777252197
global classifier accuracy: 100.0
end Update
server_global_time: 235.1186177507043
only_train_time: 3536.9283005446196

-------------Global Round number: 79-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9302
Averaged Test Accuracy (Prototype Model): 0.9315
Std Test Accuracy (Regular Model): 0.0468
Std Test Accuracy (Prototype Model): 0.0450
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.8330, 10.5384,  8.0368,  8.9561,  8.4432, 10.8121,  8.0368, 10.8121,
        11.1824, 11.6748], device='cuda:0')
Server loss: 4.043266773223877
train global classifier
train glclassifier time: 3.6597755178809166
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 238.06218154728413
only_train_time: 3581.417088262737

-------------Global Round number: 80-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9302
Averaged Test Accuracy (Prototype Model): 0.9315
Std Test Accuracy (Regular Model): 0.0469
Std Test Accuracy (Prototype Model): 0.0449
tobetrained:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 5, 2, 0, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 5, 2, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.8649, 10.5590,  8.0704,  8.9830,  8.4713, 10.8401,  8.0704, 10.8401,
        11.2117, 11.7013], device='cuda:0')
Server loss: 4.039168834686279
train global classifier
train glclassifier time: 3.5435209572315216
global classifier accuracy: 100.0
end Update
server_global_time: 241.06571672856808
only_train_time: 3626.098065458238

-------------Global Round number: 81-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9303
Averaged Test Accuracy (Prototype Model): 0.9317
Std Test Accuracy (Regular Model): 0.0469
Std Test Accuracy (Prototype Model): 0.0449
tobetrained:
[7, 1, 6, 8, 5, 2, 0, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 5 begin training
Edge 2 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.8957, 10.5808,  8.1031,  9.0104,  8.4976, 10.8648,  8.1031, 10.8648,
        11.2386, 11.7288], device='cuda:0')
Server loss: 4.035912990570068
train global classifier
train glclassifier time: 3.661610320210457
global classifier accuracy: 100.0
end Update
server_global_time: 244.04507283121347
only_train_time: 3670.540602758527

-------------Global Round number: 82-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9303
Averaged Test Accuracy (Prototype Model): 0.9316
Std Test Accuracy (Regular Model): 0.0469
Std Test Accuracy (Prototype Model): 0.0450
tobetrained:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 0, 4, 2, 5, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 0, 4, 2, 5, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.9243, 10.6023,  8.1342,  9.0378,  8.5280, 10.8934,  8.1342, 10.8934,
        11.2610, 11.7557], device='cuda:0')
Server loss: 4.032706260681152
train global classifier
train glclassifier time: 3.6783122569322586
global classifier accuracy: 100.0
end Update
server_global_time: 247.04829934239388
only_train_time: 3715.3061706498265

-------------Global Round number: 83-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9303
Averaged Test Accuracy (Prototype Model): 0.9317
Std Test Accuracy (Regular Model): 0.0469
Std Test Accuracy (Prototype Model): 0.0450
tobetrained:
[7, 6, 1, 8, 0, 4, 2, 5, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 4 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 5, 0, 2, 9, 4, 3]
aggregation_buffer:
[7, 1, 6, 8, 5, 0, 2, 9, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.9591, 10.6224,  8.1670,  9.0667,  8.5544, 10.9212,  8.1670, 10.9212,
        11.2884, 11.7811], device='cuda:0')
Server loss: 4.027401447296143
train global classifier
train glclassifier time: 4.091319307684898
global classifier accuracy: 100.0
end Update
server_global_time: 249.99550635367632
only_train_time: 3759.775828309357

-------------Global Round number: 84-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9304
Averaged Test Accuracy (Prototype Model): 0.9317
Std Test Accuracy (Regular Model): 0.0469
Std Test Accuracy (Prototype Model): 0.0450
tobetrained:
[7, 1, 6, 8, 5, 0, 2, 9, 4, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 5 begin training
Edge 0 begin training
Edge 2 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.9882, 10.6380,  8.1977,  9.0945,  8.5818, 10.9517,  8.1977, 10.9517,
        11.3167, 11.8097], device='cuda:0')
Server loss: 4.027212619781494
train global classifier
train glclassifier time: 3.8323836475610733
global classifier accuracy: 100.0
end Update
server_global_time: 252.68111531436443
only_train_time: 3804.16186837852

-------------Global Round number: 85-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9303
Averaged Test Accuracy (Prototype Model): 0.9317
Std Test Accuracy (Regular Model): 0.0469
Std Test Accuracy (Prototype Model): 0.0450
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.0170, 10.6563,  8.2285,  9.1199,  8.6117, 10.9823,  8.2285, 10.9823,
        11.3412, 11.8368], device='cuda:0')
Server loss: 4.023146629333496
train global classifier
train glclassifier time: 4.0260371416807175
global classifier accuracy: 100.0
end Update
server_global_time: 255.69942031800747
only_train_time: 3848.9563847333193

-------------Global Round number: 86-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9306
Averaged Test Accuracy (Prototype Model): 0.9318
Std Test Accuracy (Regular Model): 0.0465
Std Test Accuracy (Prototype Model): 0.0449
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 4, 2, 5, 0, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 4, 2, 5, 0, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.0463, 10.6755,  8.2570,  9.1470,  8.6372, 11.0077,  8.2570, 11.0077,
        11.3707, 11.8642], device='cuda:0')
Server loss: 4.021000385284424
train global classifier
train glclassifier time: 4.103805564343929
global classifier accuracy: 100.0
end Update
server_global_time: 258.6484893709421
only_train_time: 3893.5059985369444

-------------Global Round number: 87-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9306
Averaged Test Accuracy (Prototype Model): 0.9319
Std Test Accuracy (Regular Model): 0.0465
Std Test Accuracy (Prototype Model): 0.0449
tobetrained:
[7, 1, 6, 8, 4, 2, 5, 0, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 4 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.0745, 10.6930,  8.2883,  9.1728,  8.6664, 11.0346,  8.2883, 11.0346,
        11.3966, 11.8921], device='cuda:0')
Server loss: 4.017478942871094
train global classifier
train glclassifier time: 3.895470581948757
global classifier accuracy: 100.0
end Update
server_global_time: 261.61876602470875
only_train_time: 3938.374862410128

-------------Global Round number: 88-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9306
Averaged Test Accuracy (Prototype Model): 0.9319
Std Test Accuracy (Regular Model): 0.0466
Std Test Accuracy (Prototype Model): 0.0449
tobetrained:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.1058, 10.7153,  8.3188,  9.1977,  8.6920, 11.0614,  8.3188, 11.0614,
        11.4253, 11.9195], device='cuda:0')
Server loss: 4.015671730041504
train global classifier
train glclassifier time: 3.924226827919483
global classifier accuracy: 100.0
end Update
server_global_time: 264.5850709155202
only_train_time: 3983.0906431153417

-------------Global Round number: 89-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9306
Averaged Test Accuracy (Prototype Model): 0.9319
Std Test Accuracy (Regular Model): 0.0465
Std Test Accuracy (Prototype Model): 0.0449
tobetrained:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 5, 2, 0, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 5, 2, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.1373, 10.7377,  8.3506,  9.2235,  8.7202, 11.0895,  8.3506, 11.0895,
        11.4516, 11.9464], device='cuda:0')
Server loss: 4.01352596282959
train global classifier
train glclassifier time: 3.6499151214957237
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 267.6328269392252
only_train_time: 4027.8615081831813

-------------Global Round number: 90-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9307
Averaged Test Accuracy (Prototype Model): 0.9319
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0448
tobetrained:
[7, 1, 6, 8, 5, 2, 0, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 5 begin training
Edge 2 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.1679, 10.7564,  8.3822,  9.2475,  8.7451, 11.1186,  8.3822, 11.1186,
        11.4794, 11.9755], device='cuda:0')
Server loss: 4.013431549072266
train global classifier
train glclassifier time: 4.015195690095425
global classifier accuracy: 100.0
end Update
server_global_time: 270.5940385237336
only_train_time: 4072.4985745102167

-------------Global Round number: 91-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9307
Averaged Test Accuracy (Prototype Model): 0.9320
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0447
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 8, 6, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 1, 8, 6, 2, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.1971, 10.7783,  8.4120,  9.2732,  8.7715, 11.1457,  8.4120, 11.1457,
        11.5056, 12.0051], device='cuda:0')
Server loss: 4.013370513916016
train global classifier
train glclassifier time: 3.633715972304344
global classifier accuracy: 100.0
end Update
server_global_time: 273.56015429645777
only_train_time: 4117.08482927084

-------------Global Round number: 92-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9309
Averaged Test Accuracy (Prototype Model): 0.9320
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0447
tobetrained:
[7, 1, 8, 6, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 8 begin training
Edge 6 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.2263, 10.7972,  8.4443,  9.2994,  8.7992, 11.1726,  8.4443, 11.1726,
        11.5306, 12.0304], device='cuda:0')
Server loss: 4.010643482208252
train global classifier
train glclassifier time: 3.680779404938221
global classifier accuracy: 100.0
end Update
server_global_time: 276.5116893723607
only_train_time: 4161.561243057251

-------------Global Round number: 93-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9308
Averaged Test Accuracy (Prototype Model): 0.9322
Std Test Accuracy (Regular Model): 0.0465
Std Test Accuracy (Prototype Model): 0.0444
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.2566, 10.8189,  8.4758,  9.3270,  8.8277, 11.1998,  8.4758, 11.1998,
        11.5555, 12.0557], device='cuda:0')
Server loss: 4.004491329193115
train global classifier
train glclassifier time: 3.5904282703995705
global classifier accuracy: 100.0
end Update
server_global_time: 279.4783232137561
only_train_time: 4206.254569165409

-------------Global Round number: 94-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9308
Averaged Test Accuracy (Prototype Model): 0.9323
Std Test Accuracy (Regular Model): 0.0465
Std Test Accuracy (Prototype Model): 0.0441
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.2851, 10.8382,  8.5075,  9.3502,  8.8546, 11.2259,  8.5075, 11.2259,
        11.5790, 12.0818], device='cuda:0')
Server loss: 4.002070426940918
train global classifier
train glclassifier time: 4.104526229202747
global classifier accuracy: 100.0
end Update
server_global_time: 282.4656689092517
only_train_time: 4250.932538032532

-------------Global Round number: 95-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9309
Averaged Test Accuracy (Prototype Model): 0.9322
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0443
tobetrained:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 2, 4, 5, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 2, 4, 5, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.3129, 10.8597,  8.5377,  9.3765,  8.8815, 11.2524,  8.5377, 11.2524,
        11.6031, 12.1058], device='cuda:0')
Server loss: 3.9977424144744873
train global classifier
train glclassifier time: 3.72012160718441
global classifier accuracy: 100.0
end Update
server_global_time: 285.4224395900965
only_train_time: 4295.597175166011

-------------Global Round number: 96-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9309
Averaged Test Accuracy (Prototype Model): 0.9322
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0442
tobetrained:
[7, 1, 6, 8, 0, 2, 4, 5, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 4, 0, 5, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 4, 0, 5, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.3430, 10.8813,  8.5665,  9.4035,  8.9094, 11.2793,  8.5665, 11.2793,
        11.6283, 12.1295], device='cuda:0')
Server loss: 3.993124008178711
train global classifier
train glclassifier time: 3.627344027161598
global classifier accuracy: 100.0
end Update
server_global_time: 288.36569245904684
only_train_time: 4340.132123090327

-------------Global Round number: 97-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9310
Averaged Test Accuracy (Prototype Model): 0.9322
Std Test Accuracy (Regular Model): 0.0462
Std Test Accuracy (Prototype Model): 0.0443
tobetrained:
[7, 6, 1, 8, 2, 4, 0, 5, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 4 begin training
Edge 0 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 0, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.3713, 10.9009,  8.5937,  9.4291,  8.9339, 11.3090,  8.5937, 11.3090,
        11.6539, 12.1584], device='cuda:0')
Server loss: 3.9917991161346436
train global classifier
train glclassifier time: 4.222858861088753
global classifier accuracy: 100.0
end Update
server_global_time: 291.2969915419817
only_train_time: 4384.372762016952

-------------Global Round number: 98-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9310
Averaged Test Accuracy (Prototype Model): 0.9323
Std Test Accuracy (Regular Model): 0.0461
Std Test Accuracy (Prototype Model): 0.0442
tobetrained:
[7, 6, 1, 8, 0, 5, 2, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 5, 2, 0, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 5, 2, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.4000, 10.9223,  8.6224,  9.4547,  8.9593, 11.3364,  8.6224, 11.3364,
        11.6772, 12.1830], device='cuda:0')
Server loss: 3.9902732372283936
train global classifier
train glclassifier time: 3.6732814386487007
global classifier accuracy: 100.0
end Update
server_global_time: 294.31728476285934
only_train_time: 4428.823110125959

-------------Global Round number: 99-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9310
Averaged Test Accuracy (Prototype Model): 0.9322
Std Test Accuracy (Regular Model): 0.0460
Std Test Accuracy (Prototype Model): 0.0443
tobetrained:
[7, 6, 1, 8, 5, 2, 0, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 5 begin training
Edge 2 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.4292, 10.9443,  8.6525,  9.4798,  8.9874, 11.3628,  8.6525, 11.3628,
        11.7004, 12.2096], device='cuda:0')
Server loss: 3.985548257827759
train global classifier
train glclassifier time: 3.9688486978411674
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 297.0251862704754
only_train_time: 4473.158108726144

-------------Global Round number: 100-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9310
Averaged Test Accuracy (Prototype Model): 0.9322
Std Test Accuracy (Regular Model): 0.0460
Std Test Accuracy (Prototype Model): 0.0443
tobetrained:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.4571, 10.9630,  8.6806,  9.5085,  9.0146, 11.3902,  8.6806, 11.3902,
        11.7231, 12.2361], device='cuda:0')
Server loss: 3.9837708473205566
train global classifier
train glclassifier time: 4.010135121643543
global classifier accuracy: 100.0
end Update
server_global_time: 299.96603670716286
only_train_time: 4517.977976351976

-------------Global Round number: 101-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9310
Averaged Test Accuracy (Prototype Model): 0.9323
Std Test Accuracy (Regular Model): 0.0460
Std Test Accuracy (Prototype Model): 0.0441
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 9, 4, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 9, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.4826, 10.9834,  8.7106,  9.5318,  9.0417, 11.4161,  8.7106, 11.4161,
        11.7460, 12.2586], device='cuda:0')
Server loss: 3.978891134262085
train global classifier
train glclassifier time: 3.6405671536922455
global classifier accuracy: 100.0
end Update
server_global_time: 302.99405555427074
only_train_time: 4562.497682273388

-------------Global Round number: 102-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9311
Averaged Test Accuracy (Prototype Model): 0.9324
Std Test Accuracy (Regular Model): 0.0460
Std Test Accuracy (Prototype Model): 0.0440
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 9, 4, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 0, 8, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 0, 8, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.5058, 11.0030,  8.7376,  9.5563,  9.0640, 11.4433,  8.7376, 11.4433,
        11.7705, 12.2873], device='cuda:0')
Server loss: 3.9801204204559326
train global classifier
train glclassifier time: 3.979974940419197
global classifier accuracy: 100.0
end Update
server_global_time: 305.9556996449828
only_train_time: 4606.461604848504

-------------Global Round number: 103-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9310
Averaged Test Accuracy (Prototype Model): 0.9324
Std Test Accuracy (Regular Model): 0.0461
Std Test Accuracy (Prototype Model): 0.0440
tobetrained:
[7, 6, 1, 0, 8, 5, 2, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 0 begin training
Edge 8 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.5270, 11.0189,  8.7665,  9.5785,  9.0893, 11.4681,  8.7665, 11.4681,
        11.7969, 12.3104], device='cuda:0')
Server loss: 3.9757332801818848
train global classifier
train glclassifier time: 3.6716954857110977
global classifier accuracy: 100.0
end Update
server_global_time: 308.9271892607212
only_train_time: 4651.00119882077

-------------Global Round number: 104-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9311
Averaged Test Accuracy (Prototype Model): 0.9323
Std Test Accuracy (Regular Model): 0.0461
Std Test Accuracy (Prototype Model): 0.0441
tobetrained:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.5509, 11.0386,  8.7964,  9.6013,  9.1160, 11.4932,  8.7964, 11.4932,
        11.8198, 12.3332], device='cuda:0')
Server loss: 3.970824956893921
train global classifier
train glclassifier time: 3.618454687297344
global classifier accuracy: 100.0
end Update
server_global_time: 311.88354428112507
only_train_time: 4695.456603169441

-------------Global Round number: 105-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9311
Averaged Test Accuracy (Prototype Model): 0.9324
Std Test Accuracy (Regular Model): 0.0461
Std Test Accuracy (Prototype Model): 0.0440
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 4, 8, 2, 0, 5, 9, 3]
aggregation_buffer:
[7, 1, 6, 4, 8, 2, 0, 5, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.5742, 11.0585,  8.8218,  9.6291,  9.1417, 11.5181,  8.8218, 11.5181,
        11.8446, 12.3569], device='cuda:0')
Server loss: 3.967374801635742
train global classifier
train glclassifier time: 3.6100480556488037
global classifier accuracy: 100.0
end Update
server_global_time: 314.6799804866314
only_train_time: 4739.499104268849

-------------Global Round number: 106-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9312
Averaged Test Accuracy (Prototype Model): 0.9324
Std Test Accuracy (Regular Model): 0.0458
Std Test Accuracy (Prototype Model): 0.0440
tobetrained:
[7, 1, 6, 4, 8, 2, 0, 5, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 4 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 0, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.5998, 11.0784,  8.8511,  9.6541,  9.1694, 11.5406,  8.8511, 11.5406,
        11.8673, 12.3827], device='cuda:0')
Server loss: 3.96601939201355
train global classifier
train glclassifier time: 4.024071492254734
global classifier accuracy: 100.0
end Update
server_global_time: 317.68481009453535
only_train_time: 4784.061286382377

-------------Global Round number: 107-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9311
Averaged Test Accuracy (Prototype Model): 0.9323
Std Test Accuracy (Regular Model): 0.0457
Std Test Accuracy (Prototype Model): 0.0441
tobetrained:
[7, 6, 1, 8, 0, 5, 2, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.6242, 11.0977,  8.8804,  9.6777,  9.1927, 11.5646,  8.8804, 11.5646,
        11.8921, 12.4077], device='cuda:0')
Server loss: 3.963301181793213
train global classifier
train glclassifier time: 3.6399864554405212
global classifier accuracy: 100.0
end Update
server_global_time: 320.7477505579591
only_train_time: 4828.416947871447

-------------Global Round number: 108-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9311
Averaged Test Accuracy (Prototype Model): 0.9322
Std Test Accuracy (Regular Model): 0.0457
Std Test Accuracy (Prototype Model): 0.0441
tobetrained:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.6474, 11.1183,  8.9063,  9.7010,  9.2159, 11.5921,  8.9063, 11.5921,
        11.9158, 12.4336], device='cuda:0')
Server loss: 3.9643561840057373
train global classifier
train glclassifier time: 4.5112369582057
global classifier accuracy: 100.0
end Update
server_global_time: 323.6818656027317
only_train_time: 4872.868871413171

-------------Global Round number: 109-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9312
Averaged Test Accuracy (Prototype Model): 0.9322
Std Test Accuracy (Regular Model): 0.0456
Std Test Accuracy (Prototype Model): 0.0442
tobetrained:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 5, 0, 2, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 5, 0, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.6704, 11.1373,  8.9350,  9.7251,  9.2410, 11.6159,  8.9350, 11.6159,
        11.9381, 12.4596], device='cuda:0')
Server loss: 3.962200164794922
train global classifier
train glclassifier time: 4.305027849972248
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 326.6334915459156
only_train_time: 4917.556893736124

-------------Global Round number: 110-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9313
Averaged Test Accuracy (Prototype Model): 0.9322
Std Test Accuracy (Regular Model): 0.0458
Std Test Accuracy (Prototype Model): 0.0440
tobetrained:
[7, 1, 6, 8, 5, 0, 2, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 5 begin training
Edge 0 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 9, 4, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 9, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.6957, 11.1599,  8.9593,  9.7518,  9.2643, 11.6426,  8.9593, 11.6426,
        11.9597, 12.4867], device='cuda:0')
Server loss: 3.9610111713409424
train global classifier
train glclassifier time: 4.732391491532326
global classifier accuracy: 100.0
end Update
server_global_time: 329.59350717812777
only_train_time: 4962.359912015498

-------------Global Round number: 111-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9312
Averaged Test Accuracy (Prototype Model): 0.9322
Std Test Accuracy (Regular Model): 0.0458
Std Test Accuracy (Prototype Model): 0.0441
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 9, 4, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.7180, 11.1738,  8.9868,  9.7783,  9.2912, 11.6657,  8.9868, 11.6657,
        11.9802, 12.5103], device='cuda:0')
Server loss: 3.9594027996063232
train global classifier
train glclassifier time: 5.106105916202068
global classifier accuracy: 100.0
end Update
server_global_time: 332.5538876205683
only_train_time: 5007.088650248945

-------------Global Round number: 112-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9311
Averaged Test Accuracy (Prototype Model): 0.9322
Std Test Accuracy (Regular Model): 0.0458
Std Test Accuracy (Prototype Model): 0.0441
tobetrained:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.7419, 11.1943,  9.0139,  9.8043,  9.3136, 11.6901,  9.0139, 11.6901,
        12.0024, 12.5372], device='cuda:0')
Server loss: 3.9594740867614746
train global classifier
train glclassifier time: 3.854466900229454
global classifier accuracy: 100.0
end Update
server_global_time: 335.52153488248587
only_train_time: 5051.780051335692

-------------Global Round number: 113-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9312
Averaged Test Accuracy (Prototype Model): 0.9321
Std Test Accuracy (Regular Model): 0.0457
Std Test Accuracy (Prototype Model): 0.0441
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 5, 0, 2, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 5, 0, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.7638, 11.2126,  9.0420,  9.8250,  9.3390, 11.7163,  9.0420, 11.7163,
        12.0236, 12.5620], device='cuda:0')
Server loss: 3.958561420440674
train global classifier
train glclassifier time: 3.941284917294979
global classifier accuracy: 100.0
end Update
server_global_time: 338.49400170892477
only_train_time: 5096.722119495273

-------------Global Round number: 114-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9311
Averaged Test Accuracy (Prototype Model): 0.9322
Std Test Accuracy (Regular Model): 0.0458
Std Test Accuracy (Prototype Model): 0.0440
tobetrained:
[7, 1, 6, 8, 5, 0, 2, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 5 begin training
Edge 0 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 4, 5, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 4, 5, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.7883, 11.2317,  9.0695,  9.8467,  9.3658, 11.7402,  9.0695, 11.7402,
        12.0472, 12.5871], device='cuda:0')
Server loss: 3.9567501544952393
train global classifier
train glclassifier time: 3.9523752257227898
global classifier accuracy: 100.0
end Update
server_global_time: 341.44425528496504
only_train_time: 5141.6068663448095

-------------Global Round number: 115-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9310
Averaged Test Accuracy (Prototype Model): 0.9322
Std Test Accuracy (Regular Model): 0.0459
Std Test Accuracy (Prototype Model): 0.0439
tobetrained:
[7, 1, 6, 8, 2, 0, 4, 5, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 0, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.8112, 11.2512,  9.0972,  9.8676,  9.3896, 11.7638,  9.0972, 11.7638,
        12.0713, 12.6117], device='cuda:0')
Server loss: 3.954988718032837
train global classifier
train glclassifier time: 3.623775951564312
global classifier accuracy: 100.0
end Update
server_global_time: 344.4214757606387
only_train_time: 5186.388595506549

-------------Global Round number: 116-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9309
Averaged Test Accuracy (Prototype Model): 0.9323
Std Test Accuracy (Regular Model): 0.0461
Std Test Accuracy (Prototype Model): 0.0438
tobetrained:
[7, 6, 1, 8, 0, 5, 2, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 4, 2, 0, 5, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 4, 2, 0, 5, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.8350, 11.2705,  9.1235,  9.8926,  9.4147, 11.7882,  9.1235, 11.7882,
        12.0933, 12.6324], device='cuda:0')
Server loss: 3.950700521469116
train global classifier
train glclassifier time: 4.024133883416653
global classifier accuracy: 100.0
end Update
server_global_time: 347.42315834760666
only_train_time: 5230.53674710542

-------------Global Round number: 117-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9310
Averaged Test Accuracy (Prototype Model): 0.9322
Std Test Accuracy (Regular Model): 0.0460
Std Test Accuracy (Prototype Model): 0.0439
tobetrained:
[7, 6, 1, 8, 4, 2, 0, 5, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 4 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.8566, 11.2900,  9.1492,  9.9183,  9.4378, 11.8134,  9.1492, 11.8134,
        12.1153, 12.6555], device='cuda:0')
Server loss: 3.9481594562530518
train global classifier
train glclassifier time: 4.0447393879294395
global classifier accuracy: 100.0
end Update
server_global_time: 350.4325658157468
only_train_time: 5275.284570984542

-------------Global Round number: 118-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9311
Averaged Test Accuracy (Prototype Model): 0.9322
Std Test Accuracy (Regular Model): 0.0459
Std Test Accuracy (Prototype Model): 0.0439
tobetrained:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 8, 6, 1, 0, 2, 5, 9, 4, 3]
aggregation_buffer:
[7, 8, 6, 1, 0, 2, 5, 9, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.8788, 11.3084,  9.1774,  9.9406,  9.4614, 11.8380,  9.1774, 11.8380,
        12.1357, 12.6792], device='cuda:0')
Server loss: 3.945375919342041
train global classifier
train glclassifier time: 4.342866495251656
global classifier accuracy: 100.0
end Update
server_global_time: 353.39285408705473
only_train_time: 5319.893216080964

-------------Global Round number: 119-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9310
Averaged Test Accuracy (Prototype Model): 0.9322
Std Test Accuracy (Regular Model): 0.0462
Std Test Accuracy (Prototype Model): 0.0440
tobetrained:
[7, 8, 6, 1, 0, 2, 5, 9, 4, 3]
Edge 7 begin training
Edge 8 begin training
Edge 6 begin training
Edge 1 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 4, 5, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 4, 5, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.8990, 11.3294,  9.2035,  9.9642,  9.4838, 11.8625,  9.2035, 11.8625,
        12.1577, 12.7032], device='cuda:0')
Server loss: 3.94356632232666
train global classifier
train glclassifier time: 3.67107854783535
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 356.37074979394674
only_train_time: 5364.535574756563

-------------Global Round number: 120-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9310
Averaged Test Accuracy (Prototype Model): 0.9322
Std Test Accuracy (Regular Model): 0.0461
Std Test Accuracy (Prototype Model): 0.0440
tobetrained:
[7, 1, 6, 8, 2, 0, 4, 5, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.9222, 11.3491,  9.2320,  9.9872,  9.5094, 11.8886,  9.2320, 11.8886,
        12.1771, 12.7264], device='cuda:0')
Server loss: 3.941150665283203
train global classifier
train glclassifier time: 3.6836631298065186
global classifier accuracy: 100.0
end Update
server_global_time: 359.34288185834885
only_train_time: 5409.347740404308

-------------Global Round number: 121-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9310
Averaged Test Accuracy (Prototype Model): 0.9322
Std Test Accuracy (Regular Model): 0.0462
Std Test Accuracy (Prototype Model): 0.0440
tobetrained:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 8, 1, 0, 5, 4, 2, 9, 3]
aggregation_buffer:
[7, 6, 8, 1, 0, 5, 4, 2, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.9463, 11.3724,  9.2584, 10.0113,  9.5353, 11.9123,  9.2584, 11.9123,
        12.1984, 12.7516], device='cuda:0')
Server loss: 3.9401490688323975
train global classifier
train glclassifier time: 3.695730797946453
global classifier accuracy: 100.0
end Update
server_global_time: 362.3430778309703
only_train_time: 5454.334307797253

-------------Global Round number: 122-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9312
Averaged Test Accuracy (Prototype Model): 0.9323
Std Test Accuracy (Regular Model): 0.0461
Std Test Accuracy (Prototype Model): 0.0440
tobetrained:
[7, 6, 8, 1, 0, 5, 4, 2, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 8 begin training
Edge 1 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 2 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 5, 2, 0, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 5, 2, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.9699, 11.3946,  9.2864, 10.0353,  9.5602, 11.9338,  9.2864, 11.9338,
        12.2232, 12.7738], device='cuda:0')
Server loss: 3.9338135719299316
train global classifier
train glclassifier time: 3.6968294456601143
global classifier accuracy: 100.0
end Update
server_global_time: 365.267740085721
only_train_time: 5498.703840531409

-------------Global Round number: 123-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9313
Averaged Test Accuracy (Prototype Model): 0.9323
Std Test Accuracy (Regular Model): 0.0460
Std Test Accuracy (Prototype Model): 0.0440
tobetrained:
[7, 1, 6, 8, 5, 2, 0, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 5 begin training
Edge 2 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 2, 4, 5, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 2, 4, 5, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.9937, 11.4171,  9.3134, 10.0585,  9.5857, 11.9569,  9.3134, 11.9569,
        12.2464, 12.7974], device='cuda:0')
Server loss: 3.931474208831787
train global classifier
train glclassifier time: 4.502096526324749
global classifier accuracy: 100.0
end Update
server_global_time: 368.2241005599499
only_train_time: 5543.179995507002

-------------Global Round number: 124-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9312
Averaged Test Accuracy (Prototype Model): 0.9324
Std Test Accuracy (Regular Model): 0.0461
Std Test Accuracy (Prototype Model): 0.0440
tobetrained:
[7, 1, 6, 8, 0, 2, 4, 5, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.0156, 11.4383,  9.3389, 10.0838,  9.6086, 11.9812,  9.3389, 11.9812,
        12.2690, 12.8225], device='cuda:0')
Server loss: 3.9310872554779053
train global classifier
train glclassifier time: 3.5688504800200462
global classifier accuracy: 100.0
end Update
server_global_time: 371.19252368062735
only_train_time: 5587.902418412268

-------------Global Round number: 125-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9311
Averaged Test Accuracy (Prototype Model): 0.9324
Std Test Accuracy (Regular Model): 0.0461
Std Test Accuracy (Prototype Model): 0.0440
tobetrained:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 5, 4, 9, 0, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 5, 4, 9, 0, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.0373, 11.4594,  9.3667, 10.1075,  9.6333, 12.0049,  9.3667, 12.0049,
        12.2906, 12.8458], device='cuda:0')
Server loss: 3.926017999649048
train global classifier
train glclassifier time: 4.24268152564764
global classifier accuracy: 100.0
end Update
server_global_time: 374.17131861299276
only_train_time: 5633.26077926904

-------------Global Round number: 126-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9311
Averaged Test Accuracy (Prototype Model): 0.9325
Std Test Accuracy (Regular Model): 0.0461
Std Test Accuracy (Prototype Model): 0.0440
tobetrained:
[7, 6, 1, 8, 2, 5, 4, 9, 0, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 0 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 4, 8, 0, 2, 5, 9, 3]
aggregation_buffer:
[7, 1, 6, 4, 8, 0, 2, 5, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.0586, 11.4780,  9.3934, 10.1305,  9.6595, 12.0289,  9.3934, 12.0289,
        12.3122, 12.8672], device='cuda:0')
Server loss: 3.923464298248291
train global classifier
train glclassifier time: 4.714422754943371
global classifier accuracy: 100.0
end Update
server_global_time: 377.1904007792473
only_train_time: 5677.903021045029

-------------Global Round number: 127-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9311
Averaged Test Accuracy (Prototype Model): 0.9323
Std Test Accuracy (Regular Model): 0.0462
Std Test Accuracy (Prototype Model): 0.0441
tobetrained:
[7, 1, 6, 4, 8, 0, 2, 5, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 4 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.0830, 11.4979,  9.4192, 10.1549,  9.6845, 12.0550,  9.4192, 12.0550,
        12.3352, 12.8928], device='cuda:0')
Server loss: 3.9232184886932373
train global classifier
train glclassifier time: 4.129276312887669
global classifier accuracy: 100.0
end Update
server_global_time: 380.1578023210168
only_train_time: 5723.169491678476

-------------Global Round number: 128-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9311
Averaged Test Accuracy (Prototype Model): 0.9323
Std Test Accuracy (Regular Model): 0.0462
Std Test Accuracy (Prototype Model): 0.0441
tobetrained:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 0, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.1047, 11.5183,  9.4454, 10.1784,  9.7087, 12.0803,  9.4454, 12.0803,
        12.3574, 12.9158], device='cuda:0')
Server loss: 3.920217275619507
train global classifier
train glclassifier time: 4.687852591276169
global classifier accuracy: 100.0
end Update
server_global_time: 383.1871268823743
only_train_time: 5768.03650033474

-------------Global Round number: 129-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9311
Averaged Test Accuracy (Prototype Model): 0.9323
Std Test Accuracy (Regular Model): 0.0462
Std Test Accuracy (Prototype Model): 0.0442
tobetrained:
[7, 6, 1, 8, 0, 5, 2, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.1285, 11.5410,  9.4705, 10.2046,  9.7318, 12.1058,  9.4705, 12.1058,
        12.3810, 12.9401], device='cuda:0')
Server loss: 3.919664144515991
train global classifier
train glclassifier time: 3.579050287604332
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 386.1698438078165
only_train_time: 5812.610597230494

-------------Global Round number: 130-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9311
Averaged Test Accuracy (Prototype Model): 0.9323
Std Test Accuracy (Regular Model): 0.0461
Std Test Accuracy (Prototype Model): 0.0442
tobetrained:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 0, 5, 4, 2, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 0, 5, 4, 2, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.1490, 11.5609,  9.4964, 10.2262,  9.7555, 12.1307,  9.4964, 12.1307,
        12.4028, 12.9640], device='cuda:0')
Server loss: 3.9169704914093018
train global classifier
train glclassifier time: 3.6981661543250084
global classifier accuracy: 100.0
end Update
server_global_time: 389.1929851695895
only_train_time: 5857.608381867409

-------------Global Round number: 131-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9310
Averaged Test Accuracy (Prototype Model): 0.9323
Std Test Accuracy (Regular Model): 0.0461
Std Test Accuracy (Prototype Model): 0.0441
tobetrained:
[7, 6, 1, 8, 0, 5, 4, 2, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 2 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 8, 1, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 8, 1, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.1724, 11.5826,  9.5208, 10.2509,  9.7767, 12.1546,  9.5208, 12.1546,
        12.4278, 12.9911], device='cuda:0')
Server loss: 3.919872522354126
train global classifier
train glclassifier time: 3.998282067477703
global classifier accuracy: 100.0
end Update
server_global_time: 392.2711347416043
only_train_time: 5903.378769822419

-------------Global Round number: 132-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9309
Averaged Test Accuracy (Prototype Model): 0.9323
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0441
tobetrained:
[7, 6, 8, 1, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 8 begin training
Edge 1 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.1952, 11.6029,  9.5466, 10.2768,  9.8002, 12.1806,  9.5466, 12.1806,
        12.4526, 13.0160], device='cuda:0')
Server loss: 3.918149709701538
train global classifier
train glclassifier time: 4.140169069170952
global classifier accuracy: 100.0
end Update
server_global_time: 396.2778669074178
only_train_time: 5951.300711728632

-------------Global Round number: 133-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9310
Averaged Test Accuracy (Prototype Model): 0.9323
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0441
tobetrained:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 8, 5, 0, 2, 4, 6, 9, 1, 3]
aggregation_buffer:
[7, 8, 5, 0, 2, 4, 6, 9, 1, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.2158, 11.6225,  9.5740, 10.2987,  9.8255, 12.2025,  9.5740, 12.2025,
        12.4726, 13.0421], device='cuda:0')
Server loss: 3.918832778930664
train global classifier
train glclassifier time: 3.7172685861587524
global classifier accuracy: 100.0
end Update
server_global_time: 399.2399040982127
only_train_time: 5999.104023940861

-------------Global Round number: 134-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9309
Averaged Test Accuracy (Prototype Model): 0.9323
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0441
tobetrained:
[7, 8, 5, 0, 2, 4, 6, 9, 1, 3]
Edge 7 begin training
Edge 8 begin training
Edge 5 begin training
Edge 0 begin training
Edge 2 begin training
Edge 4 begin training
Edge 6 begin training
Edge 9 begin training
Edge 1 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 5, 4, 9, 0, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 5, 4, 9, 0, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.2375, 11.6432,  9.5987, 10.3205,  9.8496, 12.2248,  9.5987, 12.2248,
        12.4961, 13.0648], device='cuda:0')
Server loss: 3.9175124168395996
train global classifier
train glclassifier time: 4.042110405862331
global classifier accuracy: 100.0
end Update
server_global_time: 402.20322861522436
only_train_time: 6044.342197597027

-------------Global Round number: 135-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9310
Averaged Test Accuracy (Prototype Model): 0.9323
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0444
tobetrained:
[7, 1, 6, 8, 2, 5, 4, 9, 0, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 0 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 4, 2, 0, 5, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 4, 2, 0, 5, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.2586, 11.6647,  9.6239, 10.3449,  9.8707, 12.2515,  9.6239, 12.2515,
        12.5178, 13.0927], device='cuda:0')
Server loss: 3.9138028621673584
train global classifier
train glclassifier time: 4.081150606274605
global classifier accuracy: 100.0
end Update
server_global_time: 405.2365499585867
only_train_time: 6088.858016483486

-------------Global Round number: 136-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9309
Averaged Test Accuracy (Prototype Model): 0.9323
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0444
tobetrained:
[7, 1, 6, 8, 4, 2, 0, 5, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 4 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 5, 2, 9, 0, 4, 3]
aggregation_buffer:
[7, 1, 6, 8, 5, 2, 9, 0, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.2787, 11.6838,  9.6490, 10.3667,  9.8920, 12.2759,  9.6490, 12.2759,
        12.5397, 13.1159], device='cuda:0')
Server loss: 3.9142906665802
train global classifier
train glclassifier time: 3.925610974431038
global classifier accuracy: 100.0
end Update
server_global_time: 408.2019967585802
only_train_time: 6134.6131783127785

-------------Global Round number: 137-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9309
Averaged Test Accuracy (Prototype Model): 0.9323
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0442
tobetrained:
[7, 1, 6, 8, 5, 2, 9, 0, 4, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 5 begin training
Edge 2 begin training
Edge 9 begin training
Edge 0 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 9, 4, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 9, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.3011, 11.7049,  9.6763, 10.3899,  9.9155, 12.3007,  9.6763, 12.3007,
        12.5621, 13.1385], device='cuda:0')
Server loss: 3.914738416671753
train global classifier
train glclassifier time: 3.7328358218073845
global classifier accuracy: 100.0
end Update
server_global_time: 411.2007390856743
only_train_time: 6179.3666386678815

-------------Global Round number: 138-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9310
Averaged Test Accuracy (Prototype Model): 0.9324
Std Test Accuracy (Regular Model): 0.0462
Std Test Accuracy (Prototype Model): 0.0442
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 9, 4, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 4, 5, 2, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 4, 5, 2, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.3237, 11.7259,  9.7042, 10.4124,  9.9389, 12.3261,  9.7042, 12.3261,
        12.5826, 13.1645], device='cuda:0')
Server loss: 3.914003372192383
train global classifier
train glclassifier time: 4.020364940166473
global classifier accuracy: 100.0
end Update
server_global_time: 414.1286898776889
only_train_time: 6224.61876232177

-------------Global Round number: 139-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9310
Averaged Test Accuracy (Prototype Model): 0.9324
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0442
tobetrained:
[7, 1, 6, 8, 0, 4, 5, 2, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 4 begin training
Edge 5 begin training
Edge 2 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.3485, 11.7470,  9.7316, 10.4367,  9.9625, 12.3509,  9.7316, 12.3509,
        12.6078, 13.1897], device='cuda:0')
Server loss: 3.915156126022339
train global classifier
train glclassifier time: 3.6341337114572525
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 417.1312170997262
only_train_time: 6269.0882966816425

-------------Global Round number: 140-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9310
Averaged Test Accuracy (Prototype Model): 0.9323
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0443
tobetrained:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 2, 8, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 2, 8, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.3697, 11.7654,  9.7560, 10.4573,  9.9883, 12.3735,  9.7560, 12.3735,
        12.6302, 13.2139], device='cuda:0')
Server loss: 3.9130094051361084
train global classifier
train glclassifier time: 4.296276740729809
global classifier accuracy: 100.0
end Update
server_global_time: 420.0836306065321
only_train_time: 6314.058305233717

-------------Global Round number: 141-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9311
Averaged Test Accuracy (Prototype Model): 0.9322
Std Test Accuracy (Regular Model): 0.0465
Std Test Accuracy (Prototype Model): 0.0444
tobetrained:
[7, 1, 6, 2, 8, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.3921, 11.7838,  9.7827, 10.4816, 10.0120, 12.3966,  9.7827, 12.3966,
        12.6533, 13.2379], device='cuda:0')
Server loss: 3.910146713256836
train global classifier
train glclassifier time: 4.123289987444878
global classifier accuracy: 100.0
end Update
server_global_time: 423.06928714364767
only_train_time: 6358.73309238255

-------------Global Round number: 142-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9309
Averaged Test Accuracy (Prototype Model): 0.9323
Std Test Accuracy (Regular Model): 0.0467
Std Test Accuracy (Prototype Model): 0.0445
tobetrained:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 5, 9, 4, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 5, 9, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.4134, 11.8034,  9.8091, 10.5022, 10.0352, 12.4198,  9.8091, 12.4198,
        12.6772, 13.2592], device='cuda:0')
Server loss: 3.9060373306274414
train global classifier
train glclassifier time: 4.072286568582058
global classifier accuracy: 100.0
end Update
server_global_time: 426.0715116709471
only_train_time: 6403.796229697764

-------------Global Round number: 143-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9310
Averaged Test Accuracy (Prototype Model): 0.9323
Std Test Accuracy (Regular Model): 0.0466
Std Test Accuracy (Prototype Model): 0.0444
tobetrained:
[7, 6, 1, 8, 2, 0, 5, 9, 4, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.4340, 11.8237,  9.8319, 10.5254, 10.0585, 12.4423,  9.8319, 12.4423,
        12.6996, 13.2832], device='cuda:0')
Server loss: 3.9098806381225586
train global classifier
train glclassifier time: 4.103424824774265
global classifier accuracy: 100.0
end Update
server_global_time: 429.11556159704924
only_train_time: 6449.608069680631

-------------Global Round number: 144-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9311
Averaged Test Accuracy (Prototype Model): 0.9323
Std Test Accuracy (Regular Model): 0.0467
Std Test Accuracy (Prototype Model): 0.0442
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 5, 4, 0, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 5, 4, 0, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.4565, 11.8442,  9.8589, 10.5492, 10.0811, 12.4644,  9.8589, 12.4644,
        12.7227, 13.3080], device='cuda:0')
Server loss: 3.9079675674438477
train global classifier
train glclassifier time: 4.0491276159882545
global classifier accuracy: 100.0
end Update
server_global_time: 432.20558063685894
only_train_time: 6495.657128021121

-------------Global Round number: 145-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9310
Averaged Test Accuracy (Prototype Model): 0.9323
Std Test Accuracy (Regular Model): 0.0467
Std Test Accuracy (Prototype Model): 0.0444
tobetrained:
[7, 6, 1, 8, 2, 5, 4, 0, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 0 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.4778, 11.8638,  9.8837, 10.5708, 10.1052, 12.4915,  9.8837, 12.4915,
        12.7446, 13.3335], device='cuda:0')
Server loss: 3.906829833984375
train global classifier
train glclassifier time: 4.410788156092167
global classifier accuracy: 100.0
end Update
server_global_time: 435.24942583590746
only_train_time: 6541.504006192088

-------------Global Round number: 146-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9312
Averaged Test Accuracy (Prototype Model): 0.9323
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0444
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 4, 8, 2, 0, 5, 9, 3]
aggregation_buffer:
[7, 6, 1, 4, 8, 2, 0, 5, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.5026, 11.8864,  9.9078, 10.5947, 10.1305, 12.5144,  9.9078, 12.5144,
        12.7698, 13.3566], device='cuda:0')
Server loss: 3.907449960708618
train global classifier
train glclassifier time: 3.824092775583267
global classifier accuracy: 100.0
end Update
server_global_time: 438.3075883984566
only_train_time: 6588.065409474075

-------------Global Round number: 147-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9311
Averaged Test Accuracy (Prototype Model): 0.9323
Std Test Accuracy (Regular Model): 0.0466
Std Test Accuracy (Prototype Model): 0.0442
tobetrained:
[7, 6, 1, 4, 8, 2, 0, 5, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 4 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 4, 5, 9, 2, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 4, 5, 9, 2, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.5225, 11.9077,  9.9327, 10.6188, 10.1524, 12.5347,  9.9327, 12.5347,
        12.7935, 13.3791], device='cuda:0')
Server loss: 3.904477834701538
train global classifier
train glclassifier time: 4.743329860270023
global classifier accuracy: 100.0
end Update
server_global_time: 442.0731150582433
only_train_time: 6635.313300929964

-------------Global Round number: 148-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9312
Averaged Test Accuracy (Prototype Model): 0.9323
Std Test Accuracy (Regular Model): 0.0465
Std Test Accuracy (Prototype Model): 0.0444
tobetrained:
[7, 1, 6, 8, 0, 4, 5, 9, 2, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 2 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.5444, 11.9271,  9.9573, 10.6409, 10.1756, 12.5591,  9.9573, 12.5591,
        12.8187, 13.4025], device='cuda:0')
Server loss: 3.9022841453552246
train global classifier
train glclassifier time: 3.8437986969947815
global classifier accuracy: 100.0
end Update
server_global_time: 445.17684856802225
only_train_time: 6681.882660761476

-------------Global Round number: 149-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9312
Averaged Test Accuracy (Prototype Model): 0.9323
Std Test Accuracy (Regular Model): 0.0465
Std Test Accuracy (Prototype Model): 0.0444
tobetrained:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[1, 7, 8, 2, 5, 0, 4, 6, 9, 3]
aggregation_buffer:
[1, 7, 8, 2, 5, 0, 4, 6, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.5675, 11.9477,  9.9848, 10.6642, 10.1977, 12.5815,  9.9848, 12.5815,
        12.8401, 13.4261], device='cuda:0')
Server loss: 3.8992257118225098
train global classifier
train glclassifier time: 3.837498463690281
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 448.130806453526
only_train_time: 6729.194828674197

-------------Global Round number: 150-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9311
Averaged Test Accuracy (Prototype Model): 0.9322
Std Test Accuracy (Regular Model): 0.0466
Std Test Accuracy (Prototype Model): 0.0445
tobetrained:
[1, 7, 8, 2, 5, 0, 4, 6, 9, 3]
Edge 1 begin training
Edge 7 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 6 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[6, 7, 1, 8, 2, 5, 4, 0, 9, 3]
aggregation_buffer:
[6, 7, 1, 8, 2, 5, 4, 0, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.5894, 11.9693, 10.0120, 10.6855, 10.2224, 12.6021, 10.0120, 12.6021,
        12.8624, 13.4480], device='cuda:0')
Server loss: 3.8948745727539062
train global classifier
train glclassifier time: 3.705668553709984
global classifier accuracy: 100.0
end Update
server_global_time: 451.9347199946642
only_train_time: 6779.395031534135

-------------Global Round number: 151-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9311
Averaged Test Accuracy (Prototype Model): 0.9323
Std Test Accuracy (Regular Model): 0.0466
Std Test Accuracy (Prototype Model): 0.0445
tobetrained:
[6, 7, 1, 8, 2, 5, 4, 0, 9, 3]
Edge 6 begin training
Edge 7 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 0 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.6103, 11.9850, 10.0383, 10.7049, 10.2469, 12.6262, 10.0383, 12.6262,
        12.8831, 13.4689], device='cuda:0')
Server loss: 3.897212505340576
train global classifier
train glclassifier time: 3.8788070306181908
global classifier accuracy: 100.0
end Update
server_global_time: 454.9233075901866
only_train_time: 6824.93651727587

-------------Global Round number: 152-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9311
Averaged Test Accuracy (Prototype Model): 0.9322
Std Test Accuracy (Regular Model): 0.0465
Std Test Accuracy (Prototype Model): 0.0446
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 0, 5, 8, 1, 6, 2, 4, 9, 3]
aggregation_buffer:
[7, 0, 5, 8, 1, 6, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.6324, 12.0046, 10.0633, 10.7279, 10.2706, 12.6519, 10.0633, 12.6519,
        12.9075, 13.4923], device='cuda:0')
Server loss: 3.8915963172912598
train global classifier
train glclassifier time: 3.7975687384605408
global classifier accuracy: 100.0
end Update
server_global_time: 458.0842289850116
only_train_time: 6874.6119426861405

-------------Global Round number: 153-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9310
Averaged Test Accuracy (Prototype Model): 0.9323
Std Test Accuracy (Regular Model): 0.0466
Std Test Accuracy (Prototype Model): 0.0446
tobetrained:
[7, 0, 5, 8, 1, 6, 2, 4, 9, 3]
Edge 7 begin training
Edge 0 begin training
Edge 5 begin training
Edge 8 begin training
Edge 1 begin training
Edge 6 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.6553, 12.0262, 10.0879, 10.7520, 10.2915, 12.6733, 10.0879, 12.6733,
        12.9331, 13.5154], device='cuda:0')
Server loss: 3.8943593502044678
train global classifier
train glclassifier time: 4.10052615404129
global classifier accuracy: 100.0
end Update
server_global_time: 461.1154425740242
only_train_time: 6920.364733122289

-------------Global Round number: 154-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9311
Averaged Test Accuracy (Prototype Model): 0.9323
Std Test Accuracy (Regular Model): 0.0465
Std Test Accuracy (Prototype Model): 0.0446
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 5, 4, 9, 0, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 5, 4, 9, 0, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.6780, 12.0477, 10.1144, 10.7760, 10.3140, 12.6980, 10.1144, 12.6980,
        12.9576, 13.5388], device='cuda:0')
Server loss: 3.887385129928589
train global classifier
train glclassifier time: 3.8662390038371086
global classifier accuracy: 100.0
end Update
server_global_time: 464.256746917963
only_train_time: 6968.69850102067

-------------Global Round number: 155-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9311
Averaged Test Accuracy (Prototype Model): 0.9323
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0448
tobetrained:
[7, 1, 6, 8, 2, 5, 4, 9, 0, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 0 begin training
Edge 3 begin training
readyList:
[1, 6, 7, 4, 2, 9, 0, 5, 8, 3]
aggregation_buffer:
[1, 6, 7, 4, 2, 9, 0, 5, 8, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.6992, 12.0685, 10.1382, 10.7978, 10.3362, 12.7207, 10.1382, 12.7207,
        12.9807, 13.5600], device='cuda:0')
Server loss: 3.8895034790039062
train global classifier
train glclassifier time: 4.3955564349889755
global classifier accuracy: 100.0
end Update
server_global_time: 469.9948638677597
only_train_time: 7065.934426136315

-------------Global Round number: 156-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9311
Averaged Test Accuracy (Prototype Model): 0.9323
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0448
tobetrained:
[1, 6, 7, 4, 2, 9, 0, 5, 8, 3]
Edge 1 begin training
Edge 6 begin training
Edge 7 begin training
Edge 4 begin training
Edge 2 begin training
Edge 9 begin training
Edge 0 begin training
Edge 5 begin training
Edge 8 begin training
Edge 3 begin training
readyList:
[7, 6, 8, 9, 2, 0, 5, 1, 4, 3]
aggregation_buffer:
[7, 6, 8, 9, 2, 0, 5, 1, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.7217, 12.0906, 10.1642, 10.8206, 10.3595, 12.7446, 10.1642, 12.7446,
        13.0020, 13.5842], device='cuda:0')
Server loss: 3.8866755962371826
train global classifier
train glclassifier time: 3.737834967672825
global classifier accuracy: 100.0
end Update
server_global_time: 476.62086882442236
only_train_time: 7166.036647669971

-------------Global Round number: 157-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9312
Averaged Test Accuracy (Prototype Model): 0.9324
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0449
tobetrained:
[7, 6, 8, 9, 2, 0, 5, 1, 4, 3]
Edge 7 begin training
Edge 6 begin training
Edge 8 begin training
Edge 9 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 1 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 5, 9, 0, 4, 2, 3]
aggregation_buffer:
[7, 6, 1, 8, 5, 9, 0, 4, 2, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.7445, 12.1114, 10.1887, 10.8448, 10.3819, 12.7679, 10.1887, 12.7679,
        13.0269, 13.6085], device='cuda:0')
Server loss: 3.8846805095672607
train global classifier
train glclassifier time: 3.906315080821514
global classifier accuracy: 100.0
end Update
server_global_time: 483.87190029770136
only_train_time: 7279.247682340443

-------------Global Round number: 158-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9311
Averaged Test Accuracy (Prototype Model): 0.9326
Std Test Accuracy (Regular Model): 0.0466
Std Test Accuracy (Prototype Model): 0.0447
tobetrained:
[7, 6, 1, 8, 5, 9, 0, 4, 2, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 5 begin training
Edge 9 begin training
Edge 0 begin training
Edge 4 begin training
Edge 2 begin training
Edge 3 begin training
readyList:
[8, 7, 6, 4, 5, 1, 2, 9, 0, 3]
aggregation_buffer:
[8, 7, 6, 4, 5, 1, 2, 9, 0, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.7665, 12.1322, 10.2154, 10.8690, 10.4053, 12.7877, 10.2154, 12.7877,
        13.0492, 13.6282], device='cuda:0')
Server loss: 3.8798482418060303
train global classifier
train glclassifier time: 4.056908659636974
global classifier accuracy: 100.0
end Update
server_global_time: 491.27570667117834
only_train_time: 7391.730475537479

-------------Global Round number: 159-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9310
Averaged Test Accuracy (Prototype Model): 0.9325
Std Test Accuracy (Regular Model): 0.0468
Std Test Accuracy (Prototype Model): 0.0449
tobetrained:
[8, 7, 6, 4, 5, 1, 2, 9, 0, 3]
Edge 8 begin training
Edge 7 begin training
Edge 6 begin training
Edge 4 begin training
Edge 5 begin training
Edge 1 begin training
Edge 2 begin training
Edge 9 begin training
Edge 0 begin training
Edge 3 begin training
readyList:
[8, 7, 4, 1, 9, 6, 2, 0, 5, 3]
aggregation_buffer:
[8, 7, 4, 1, 9, 6, 2, 0, 5, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.7886, 12.1496, 10.2415, 10.8896, 10.4293, 12.8112, 10.2415, 12.8112,
        13.0712, 13.6532], device='cuda:0')
Server loss: 3.881739377975464
train global classifier
train glclassifier time: 3.9908772110939026
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 498.87202886492014
only_train_time: 7504.718967542052

-------------Global Round number: 160-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9310
Averaged Test Accuracy (Prototype Model): 0.9326
Std Test Accuracy (Regular Model): 0.0469
Std Test Accuracy (Prototype Model): 0.0450
tobetrained:
[8, 7, 4, 1, 9, 6, 2, 0, 5, 3]
Edge 8 begin training
Edge 7 begin training
Edge 4 begin training
Edge 1 begin training
Edge 9 begin training
Edge 6 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 3 begin training
readyList:
[7, 1, 2, 4, 9, 6, 8, 0, 5, 3]
aggregation_buffer:
[7, 1, 2, 4, 9, 6, 8, 0, 5, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.8123, 12.1705, 10.2671, 10.9114, 10.4521, 12.8353, 10.2671, 12.8353,
        13.0923, 13.6784], device='cuda:0')
Server loss: 3.880340337753296
train global classifier
train glclassifier time: 3.740732304751873
global classifier accuracy: 100.0
end Update
server_global_time: 506.5637688934803
only_train_time: 7613.464109010994

-------------Global Round number: 161-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9310
Averaged Test Accuracy (Prototype Model): 0.9326
Std Test Accuracy (Regular Model): 0.0467
Std Test Accuracy (Prototype Model): 0.0449
tobetrained:
[7, 1, 2, 4, 9, 6, 8, 0, 5, 3]
Edge 7 begin training
Edge 1 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 3 begin training
readyList:
[7, 4, 6, 0, 2, 9, 8, 1, 5, 3]
aggregation_buffer:
[7, 4, 6, 0, 2, 9, 8, 1, 5, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.8334, 12.1891, 10.2911, 10.9339, 10.4746, 12.8563, 10.2911, 12.8563,
        13.1141, 13.7017], device='cuda:0')
Server loss: 3.8795464038848877
train global classifier
train glclassifier time: 3.6926827877759933
global classifier accuracy: 100.0
end Update
server_global_time: 515.874721698463
only_train_time: 7729.9545286893845

-------------Global Round number: 162-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9310
Averaged Test Accuracy (Prototype Model): 0.9326
Std Test Accuracy (Regular Model): 0.0466
Std Test Accuracy (Prototype Model): 0.0449
tobetrained:
[7, 4, 6, 0, 2, 9, 8, 1, 5, 3]
Edge 7 begin training
Edge 4 begin training
Edge 6 begin training
Edge 0 begin training
Edge 2 begin training
Edge 9 begin training
Edge 8 begin training
Edge 1 begin training
Edge 5 begin training
Edge 3 begin training
readyList:
[7, 2, 1, 6, 4, 8, 0, 5, 9, 3]
aggregation_buffer:
[7, 2, 1, 6, 4, 8, 0, 5, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.8553, 12.2098, 10.3155, 10.9579, 10.4981, 12.8800, 10.3155, 12.8800,
        13.1336, 13.7214], device='cuda:0')
Server loss: 3.874399185180664
train global classifier
train glclassifier time: 4.253381446003914
global classifier accuracy: 100.0
end Update
server_global_time: 523.2769535109401
only_train_time: 7837.770724512637

-------------Global Round number: 163-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9310
Averaged Test Accuracy (Prototype Model): 0.9326
Std Test Accuracy (Regular Model): 0.0467
Std Test Accuracy (Prototype Model): 0.0451
tobetrained:
[7, 2, 1, 6, 4, 8, 0, 5, 9, 3]
Edge 7 begin training
Edge 2 begin training
Edge 1 begin training
Edge 6 begin training
Edge 4 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 2, 0, 6, 8, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 2, 0, 6, 8, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.8777, 12.2300, 10.3401, 10.9784, 10.5208, 12.9029, 10.3401, 12.9029,
        13.1567, 13.7438], device='cuda:0')
Server loss: 3.875354528427124
train global classifier
train glclassifier time: 3.789522886276245
global classifier accuracy: 100.0
end Update
server_global_time: 529.8776170611382
only_train_time: 7952.880591452122

-------------Global Round number: 164-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9311
Averaged Test Accuracy (Prototype Model): 0.9327
Std Test Accuracy (Regular Model): 0.0466
Std Test Accuracy (Prototype Model): 0.0451
tobetrained:
[7, 1, 2, 0, 6, 8, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 2 begin training
Edge 0 begin training
Edge 6 begin training
Edge 8 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 2, 8, 5, 6, 4, 9, 0, 3]
aggregation_buffer:
[7, 1, 2, 8, 5, 6, 4, 9, 0, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.8996, 12.2494, 10.3647, 10.9996, 10.5439, 12.9245, 10.3647, 12.9245,
        13.1772, 13.7651], device='cuda:0')
Server loss: 3.8703794479370117
train global classifier
train glclassifier time: 4.805434115231037
global classifier accuracy: 100.0
end Update
server_global_time: 538.2040923386812
only_train_time: 8063.122383393347

-------------Global Round number: 165-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9311
Averaged Test Accuracy (Prototype Model): 0.9326
Std Test Accuracy (Regular Model): 0.0466
Std Test Accuracy (Prototype Model): 0.0452
tobetrained:
[7, 1, 2, 8, 5, 6, 4, 9, 0, 3]
Edge 7 begin training
Edge 1 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 6 begin training
Edge 4 begin training
Edge 9 begin training
Edge 0 begin training
Edge 3 begin training
readyList:
[9, 6, 5, 0, 1, 7, 2, 8, 4, 3]
aggregation_buffer:
[9, 6, 5, 0, 1, 7, 2, 8, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.9211, 12.2682, 10.3890, 11.0217, 10.5650, 12.9506, 10.3890, 12.9506,
        13.1991, 13.7888], device='cuda:0')
Server loss: 3.8736586570739746
train global classifier
train glclassifier time: 3.7066967263817787
global classifier accuracy: 100.0
end Update
server_global_time: 544.9615244045854
only_train_time: 8178.950382590294

-------------Global Round number: 166-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9311
Averaged Test Accuracy (Prototype Model): 0.9326
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0453
tobetrained:
[9, 6, 5, 0, 1, 7, 2, 8, 4, 3]
Edge 9 begin training
Edge 6 begin training
Edge 5 begin training
Edge 0 begin training
Edge 1 begin training
Edge 7 begin training
Edge 2 begin training
Edge 8 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 1, 5, 0, 4, 2, 6, 9, 8, 3]
aggregation_buffer:
[7, 1, 5, 0, 4, 2, 6, 9, 8, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.9422, 12.2892, 10.4112, 11.0455, 10.5850, 12.9742, 10.4112, 12.9742,
        13.2210, 13.8156], device='cuda:0')
Server loss: 3.871584415435791
train global classifier
train glclassifier time: 3.8528420254588127
global classifier accuracy: 100.0
end Update
server_global_time: 551.6914085894823
only_train_time: 8292.397012762725

-------------Global Round number: 167-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9314
Averaged Test Accuracy (Prototype Model): 0.9326
Std Test Accuracy (Regular Model): 0.0462
Std Test Accuracy (Prototype Model): 0.0452
tobetrained:
[7, 1, 5, 0, 4, 2, 6, 9, 8, 3]
Edge 7 begin training
Edge 1 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 2 begin training
Edge 6 begin training
Edge 9 begin training
Edge 8 begin training
Edge 3 begin training
readyList:
[8, 7, 6, 1, 9, 2, 0, 4, 5, 3]
aggregation_buffer:
[8, 7, 6, 1, 9, 2, 0, 4, 5, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.9642, 12.3103, 10.4349, 11.0669, 10.6062, 12.9958, 10.4349, 12.9958,
        13.2451, 13.8374], device='cuda:0')
Server loss: 3.8705992698669434
train global classifier
train glclassifier time: 3.7073351442813873
global classifier accuracy: 100.0
end Update
server_global_time: 558.5246743932366
only_train_time: 8405.863027378917

-------------Global Round number: 168-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9313
Averaged Test Accuracy (Prototype Model): 0.9326
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0452
tobetrained:
[8, 7, 6, 1, 9, 2, 0, 4, 5, 3]
Edge 8 begin training
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 9 begin training
Edge 2 begin training
Edge 0 begin training
Edge 4 begin training
Edge 5 begin training
Edge 3 begin training
readyList:
[6, 7, 8, 9, 1, 0, 5, 2, 4, 3]
aggregation_buffer:
[6, 7, 8, 9, 1, 0, 5, 2, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.9864, 12.3294, 10.4604, 11.0894, 10.6297, 13.0209, 10.4604, 13.0209,
        13.2637, 13.8591], device='cuda:0')
Server loss: 3.8692660331726074
train global classifier
train glclassifier time: 3.6665319576859474
global classifier accuracy: 100.0
end Update
server_global_time: 568.1486086249352
only_train_time: 8521.030015744269

-------------Global Round number: 169-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9314
Averaged Test Accuracy (Prototype Model): 0.9327
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0453
tobetrained:
[6, 7, 8, 9, 1, 0, 5, 2, 4, 3]
Edge 6 begin training
Edge 7 begin training
Edge 8 begin training
Edge 9 begin training
Edge 1 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[1, 7, 2, 4, 5, 6, 0, 9, 8, 3]
aggregation_buffer:
[1, 7, 2, 4, 5, 6, 0, 9, 8, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.0082, 12.3486, 10.4858, 11.1093, 10.6521, 13.0426, 10.4858, 13.0426,
        13.2860, 13.8837], device='cuda:0')
Server loss: 3.8691353797912598
train global classifier
train glclassifier time: 3.6293563917279243
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 575.1236250847578
only_train_time: 8634.469647452235

-------------Global Round number: 170-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9315
Averaged Test Accuracy (Prototype Model): 0.9326
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0453
tobetrained:
[1, 7, 2, 4, 5, 6, 0, 9, 8, 3]
Edge 1 begin training
Edge 7 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 6 begin training
Edge 0 begin training
Edge 9 begin training
Edge 8 begin training
Edge 3 begin training
readyList:
[1, 7, 5, 8, 2, 4, 6, 0, 9, 3]
aggregation_buffer:
[1, 7, 5, 8, 2, 4, 6, 0, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.0326, 12.3710, 10.5102, 11.1344, 10.6737, 13.0654, 10.5102, 13.0654,
        13.3098, 13.9081], device='cuda:0')
Server loss: 3.869171142578125
train global classifier
train glclassifier time: 4.144068636000156
global classifier accuracy: 100.0
end Update
server_global_time: 581.424263805151
only_train_time: 8751.584541402757

-------------Global Round number: 171-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9314
Averaged Test Accuracy (Prototype Model): 0.9327
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0453
tobetrained:
[1, 7, 5, 8, 2, 4, 6, 0, 9, 3]
Edge 1 begin training
Edge 7 begin training
Edge 5 begin training
Edge 8 begin training
Edge 2 begin training
Edge 4 begin training
Edge 6 begin training
Edge 0 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 8, 1, 2, 4, 6, 9, 0, 5, 3]
aggregation_buffer:
[7, 8, 1, 2, 4, 6, 9, 0, 5, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.0552, 12.3925, 10.5345, 11.1590, 10.6954, 13.0886, 10.5345, 13.0886,
        13.3276, 13.9300], device='cuda:0')
Server loss: 3.8680260181427
train global classifier
train glclassifier time: 4.597285218536854
global classifier accuracy: 100.0
end Update
server_global_time: 588.4718636199832
only_train_time: 8861.706194974482

-------------Global Round number: 172-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9312
Averaged Test Accuracy (Prototype Model): 0.9327
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0453
tobetrained:
[7, 8, 1, 2, 4, 6, 9, 0, 5, 3]
Edge 7 begin training
Edge 8 begin training
Edge 1 begin training
Edge 2 begin training
Edge 4 begin training
Edge 6 begin training
Edge 9 begin training
Edge 0 begin training
Edge 5 begin training
Edge 3 begin training
readyList:
[7, 6, 8, 2, 1, 0, 4, 5, 9, 3]
aggregation_buffer:
[7, 6, 8, 2, 1, 0, 4, 5, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.0783, 12.4109, 10.5590, 11.1790, 10.7196, 13.1111, 10.5590, 13.1111,
        13.3528, 13.9534], device='cuda:0')
Server loss: 3.8678293228149414
train global classifier
train glclassifier time: 4.2935085371136665
global classifier accuracy: 100.0
end Update
server_global_time: 595.7621233686805
only_train_time: 8981.385756343603

-------------Global Round number: 173-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9313
Averaged Test Accuracy (Prototype Model): 0.9328
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0452
tobetrained:
[7, 6, 8, 2, 1, 0, 4, 5, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 1 begin training
Edge 0 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 8, 1, 2, 0, 9, 4, 5, 3]
aggregation_buffer:
[7, 6, 8, 1, 2, 0, 9, 4, 5, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.1001, 12.4306, 10.5816, 11.2005, 10.7421, 13.1344, 10.5816, 13.1344,
        13.3754, 13.9737], device='cuda:0')
Server loss: 3.866159677505493
train global classifier
train glclassifier time: 4.101441830396652
global classifier accuracy: 100.0
end Update
server_global_time: 602.3053168952465
only_train_time: 9090.579844936728

-------------Global Round number: 174-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9313
Averaged Test Accuracy (Prototype Model): 0.9327
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0452
tobetrained:
[7, 6, 8, 1, 2, 0, 9, 4, 5, 3]
Edge 7 begin training
Edge 6 begin training
Edge 8 begin training
Edge 1 begin training
Edge 2 begin training
Edge 0 begin training
Edge 9 begin training
Edge 4 begin training
Edge 5 begin training
Edge 3 begin training
readyList:
[7, 6, 5, 4, 9, 1, 8, 2, 0, 3]
aggregation_buffer:
[7, 6, 5, 4, 9, 1, 8, 2, 0, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.1217, 12.4512, 10.6042, 11.2222, 10.7654, 13.1587, 10.6042, 13.1587,
        13.3964, 13.9956], device='cuda:0')
Server loss: 3.863499164581299
train global classifier
train glclassifier time: 3.848034530878067
global classifier accuracy: 100.0
end Update
server_global_time: 610.3297649621964
only_train_time: 9209.921777822077

-------------Global Round number: 175-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9313
Averaged Test Accuracy (Prototype Model): 0.9328
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0452
tobetrained:
[7, 6, 5, 4, 9, 1, 8, 2, 0, 3]
Edge 7 begin training
Edge 6 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 3 begin training
readyList:
[7, 8, 1, 6, 9, 5, 4, 2, 0, 3]
aggregation_buffer:
[7, 8, 1, 6, 9, 5, 4, 2, 0, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.1438, 12.4705, 10.6291, 11.2436, 10.7875, 13.1800, 10.6291, 13.1800,
        13.4221, 14.0212], device='cuda:0')
Server loss: 3.8664958477020264
train global classifier
train glclassifier time: 4.780050382018089
global classifier accuracy: 100.0
end Update
server_global_time: 617.228536747396
only_train_time: 9324.761098131537

-------------Global Round number: 176-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9313
Averaged Test Accuracy (Prototype Model): 0.9329
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0453
tobetrained:
[7, 8, 1, 6, 9, 5, 4, 2, 0, 3]
Edge 7 begin training
Edge 8 begin training
Edge 1 begin training
Edge 6 begin training
Edge 9 begin training
Edge 5 begin training
Edge 4 begin training
Edge 2 begin training
Edge 0 begin training
Edge 3 begin training
readyList:
[0, 2, 7, 4, 5, 1, 9, 6, 8, 3]
aggregation_buffer:
[0, 2, 7, 4, 5, 1, 9, 6, 8, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.1677, 12.4918, 10.6530, 11.2661, 10.8105, 13.2018, 10.6530, 13.2018,
        13.4429, 14.0437], device='cuda:0')
Server loss: 3.865654468536377
train global classifier
train glclassifier time: 3.6504673585295677
global classifier accuracy: 100.0
end Update
server_global_time: 624.5972643494606
only_train_time: 9436.344441518188

-------------Global Round number: 177-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9313
Averaged Test Accuracy (Prototype Model): 0.9329
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0452
tobetrained:
[0, 2, 7, 4, 5, 1, 9, 6, 8, 3]
Edge 0 begin training
Edge 2 begin training
Edge 7 begin training
Edge 4 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 6 begin training
Edge 8 begin training
Edge 3 begin training
readyList:
[7, 2, 1, 8, 0, 4, 6, 9, 5, 3]
aggregation_buffer:
[7, 2, 1, 8, 0, 4, 6, 9, 5, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.1890, 12.5109, 10.6769, 11.2880, 10.8334, 13.2260, 10.6769, 13.2260,
        13.4661, 14.0686], device='cuda:0')
Server loss: 3.8630056381225586
train global classifier
train glclassifier time: 4.197606980800629
global classifier accuracy: 100.0
end Update
server_global_time: 631.407825037837
only_train_time: 9549.978369660676

-------------Global Round number: 178-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9313
Averaged Test Accuracy (Prototype Model): 0.9330
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0450
tobetrained:
[7, 2, 1, 8, 0, 4, 6, 9, 5, 3]
Edge 7 begin training
Edge 2 begin training
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 4 begin training
Edge 6 begin training
Edge 9 begin training
Edge 5 begin training
Edge 3 begin training
readyList:
[8, 5, 6, 0, 7, 9, 1, 4, 2, 3]
aggregation_buffer:
[8, 5, 6, 0, 7, 9, 1, 4, 2, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.2102, 12.5304, 10.7004, 11.3099, 10.8555, 13.2463, 10.7004, 13.2463,
        13.4898, 14.0932], device='cuda:0')
Server loss: 3.8630423545837402
train global classifier
train glclassifier time: 4.025812588632107
global classifier accuracy: 100.0
end Update
server_global_time: 638.420155249536
only_train_time: 9660.394848637283

-------------Global Round number: 179-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9313
Averaged Test Accuracy (Prototype Model): 0.9330
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0451
tobetrained:
[8, 5, 6, 0, 7, 9, 1, 4, 2, 3]
Edge 8 begin training
Edge 5 begin training
Edge 6 begin training
Edge 0 begin training
Edge 7 begin training
Edge 9 begin training
Edge 1 begin training
Edge 4 begin training
Edge 2 begin training
Edge 3 begin training
readyList:
[7, 8, 1, 0, 4, 6, 5, 2, 9, 3]
aggregation_buffer:
[7, 8, 1, 0, 4, 6, 5, 2, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.2324, 12.5548, 10.7225, 11.3335, 10.8771, 13.2660, 10.7225, 13.2660,
        13.5112, 14.1127], device='cuda:0')
Server loss: 3.858286142349243
train global classifier
train glclassifier time: 4.101059630513191
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 646.6339321956038
only_train_time: 9774.555588260293

-------------Global Round number: 180-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9313
Averaged Test Accuracy (Prototype Model): 0.9330
Std Test Accuracy (Regular Model): 0.0462
Std Test Accuracy (Prototype Model): 0.0452
tobetrained:
[7, 8, 1, 0, 4, 6, 5, 2, 9, 3]
Edge 7 begin training
Edge 8 begin training
Edge 1 begin training
Edge 0 begin training
Edge 4 begin training
Edge 6 begin training
Edge 5 begin training
Edge 2 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[8, 5, 6, 7, 1, 2, 0, 4, 9, 3]
aggregation_buffer:
[8, 5, 6, 7, 1, 2, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.2530, 12.5733, 10.7455, 11.3541, 10.8996, 13.2869, 10.7455, 13.2869,
        13.5369, 14.1363], device='cuda:0')
Server loss: 3.859109878540039
train global classifier
train glclassifier time: 3.7681516855955124
global classifier accuracy: 100.0
end Update
server_global_time: 654.72141058743
only_train_time: 9882.027252785861

-------------Global Round number: 181-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9313
Averaged Test Accuracy (Prototype Model): 0.9330
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0452
tobetrained:
[8, 5, 6, 7, 1, 2, 0, 4, 9, 3]
Edge 8 begin training
Edge 5 begin training
Edge 6 begin training
Edge 7 begin training
Edge 1 begin training
Edge 2 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[8, 7, 2, 4, 6, 0, 9, 5, 1, 3]
aggregation_buffer:
[8, 7, 2, 4, 6, 0, 9, 5, 1, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.2768, 12.5955, 10.7704, 11.3778, 10.9218, 13.3106, 10.7704, 13.3106,
        13.5623, 14.1579], device='cuda:0')
Server loss: 3.859251022338867
train global classifier
train glclassifier time: 3.7399400249123573
global classifier accuracy: 100.0
end Update
server_global_time: 664.3701081424952
only_train_time: 9999.434908673167

-------------Global Round number: 182-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9313
Averaged Test Accuracy (Prototype Model): 0.9330
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0452
tobetrained:
[8, 7, 2, 4, 6, 0, 9, 5, 1, 3]
Edge 8 begin training
Edge 7 begin training
Edge 2 begin training
Edge 4 begin training
Edge 6 begin training
Edge 0 begin training
Edge 9 begin training
Edge 5 begin training
Edge 1 begin training
Edge 3 begin training
readyList:
[7, 6, 8, 9, 1, 2, 4, 0, 5, 3]
aggregation_buffer:
[7, 6, 8, 9, 1, 2, 4, 0, 5, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.2983, 12.6135, 10.7939, 11.3977, 10.9456, 13.3344, 10.7939, 13.3344,
        13.5812, 14.1819], device='cuda:0')
Server loss: 3.8580448627471924
train global classifier
train glclassifier time: 3.974144361913204
global classifier accuracy: 100.0
end Update
server_global_time: 672.8937314078212
only_train_time: 10108.15307919681

-------------Global Round number: 183-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9313
Averaged Test Accuracy (Prototype Model): 0.9329
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0454
tobetrained:
[7, 6, 8, 9, 1, 2, 4, 0, 5, 3]
Edge 7 begin training
Edge 6 begin training
Edge 8 begin training
Edge 9 begin training
Edge 1 begin training
Edge 2 begin training
Edge 4 begin training
Edge 0 begin training
Edge 5 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 2, 5, 8, 0, 9, 4, 3]
aggregation_buffer:
[7, 6, 1, 2, 5, 8, 0, 9, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.3207, 12.6326, 10.8191, 11.4226, 10.9693, 13.3564, 10.8191, 13.3564,
        13.6061, 14.2028], device='cuda:0')
Server loss: 3.8585312366485596
train global classifier
train glclassifier time: 3.6793681755661964
global classifier accuracy: 100.0
end Update
server_global_time: 678.4996649175882
only_train_time: 10220.10064329952

-------------Global Round number: 184-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9313
Averaged Test Accuracy (Prototype Model): 0.9329
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0453
tobetrained:
[7, 6, 1, 2, 5, 8, 0, 9, 4, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 2 begin training
Edge 5 begin training
Edge 8 begin training
Edge 0 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[1, 7, 9, 8, 6, 2, 4, 5, 0, 3]
aggregation_buffer:
[1, 7, 9, 8, 6, 2, 4, 5, 0, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.3459, 12.6551, 10.8442, 11.4462, 10.9944, 13.3794, 10.8442, 13.3794,
        13.6256, 14.2268], device='cuda:0')
Server loss: 3.8581504821777344
train global classifier
train glclassifier time: 3.7214675843715668
global classifier accuracy: 100.0
end Update
server_global_time: 685.7991569638252
only_train_time: 10327.899461068213

-------------Global Round number: 185-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9313
Averaged Test Accuracy (Prototype Model): 0.9329
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0453
tobetrained:
[1, 7, 9, 8, 6, 2, 4, 5, 0, 3]
Edge 1 begin training
Edge 7 begin training
Edge 9 begin training
Edge 8 begin training
Edge 6 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 0 begin training
Edge 3 begin training
readyList:
[5, 7, 0, 1, 6, 8, 4, 2, 9, 3]
aggregation_buffer:
[5, 7, 0, 1, 6, 8, 4, 2, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.3701, 12.6760, 10.8677, 11.4686, 11.0184, 13.4029, 10.8677, 13.4029,
        13.6495, 14.2500], device='cuda:0')
Server loss: 3.8543975353240967
train global classifier
train glclassifier time: 3.7323170974850655
global classifier accuracy: 100.0
end Update
server_global_time: 693.3781395331025
only_train_time: 10445.904812298715

-------------Global Round number: 186-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9314
Averaged Test Accuracy (Prototype Model): 0.9329
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0453
tobetrained:
[5, 7, 0, 1, 6, 8, 4, 2, 9, 3]
Edge 5 begin training
Edge 7 begin training
Edge 0 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 4 begin training
Edge 2 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 2, 8, 5, 0, 9, 4, 3]
aggregation_buffer:
[7, 6, 1, 2, 8, 5, 0, 9, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.3918, 12.6974, 10.8882, 11.4930, 11.0385, 13.4259, 10.8882, 13.4259,
        13.6778, 14.2738], device='cuda:0')
Server loss: 3.8560924530029297
train global classifier
train glclassifier time: 3.7146230414509773
global classifier accuracy: 100.0
end Update
server_global_time: 701.2128474414349
only_train_time: 10553.933510892093

-------------Global Round number: 187-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9314
Averaged Test Accuracy (Prototype Model): 0.9330
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0453
tobetrained:
[7, 6, 1, 2, 8, 5, 0, 9, 4, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 0 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 0, 1, 9, 4, 6, 8, 5, 2, 3]
aggregation_buffer:
[7, 0, 1, 9, 4, 6, 8, 5, 2, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.4125, 12.7171, 10.9122, 11.5149, 11.0610, 13.4511, 10.9122, 13.4511,
        13.6951, 14.2978], device='cuda:0')
Server loss: 3.8537068367004395
train global classifier
train glclassifier time: 3.718100130558014
global classifier accuracy: 100.0
end Update
server_global_time: 707.4843583032489
only_train_time: 10671.275731794536

-------------Global Round number: 188-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9313
Averaged Test Accuracy (Prototype Model): 0.9330
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0452
tobetrained:
[7, 0, 1, 9, 4, 6, 8, 5, 2, 3]
Edge 7 begin training
Edge 0 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 6 begin training
Edge 8 begin training
Edge 5 begin training
Edge 2 begin training
Edge 3 begin training
readyList:
[7, 8, 0, 9, 1, 6, 5, 2, 4, 3]
aggregation_buffer:
[7, 8, 0, 9, 1, 6, 5, 2, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.4342, 12.7383, 10.9353, 11.5374, 11.0821, 13.4750, 10.9353, 13.4750,
        13.7176, 14.3190], device='cuda:0')
Server loss: 3.8505661487579346
train global classifier
train glclassifier time: 3.9876430556178093
global classifier accuracy: 100.0
end Update
server_global_time: 713.8711491376162
only_train_time: 10780.351045899093

-------------Global Round number: 189-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9313
Averaged Test Accuracy (Prototype Model): 0.9331
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0453
tobetrained:
[7, 8, 0, 9, 1, 6, 5, 2, 4, 3]
Edge 7 begin training
Edge 8 begin training
Edge 0 begin training
Edge 9 begin training
Edge 1 begin training
Edge 6 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[6, 5, 7, 1, 8, 2, 4, 0, 9, 3]
aggregation_buffer:
[6, 5, 7, 1, 8, 2, 4, 0, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.4539, 12.7594, 10.9592, 11.5570, 11.1044, 13.4971, 10.9592, 13.4971,
        13.7400, 14.3398], device='cuda:0')
Server loss: 3.849597692489624
train global classifier
train glclassifier time: 3.7529720067977905
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 720.4554468467832
only_train_time: 10894.792567655444

-------------Global Round number: 190-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9314
Averaged Test Accuracy (Prototype Model): 0.9332
Std Test Accuracy (Regular Model): 0.0465
Std Test Accuracy (Prototype Model): 0.0451
tobetrained:
[6, 5, 7, 1, 8, 2, 4, 0, 9, 3]
Edge 6 begin training
Edge 5 begin training
Edge 7 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 4 begin training
Edge 0 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 8, 1, 4, 9, 6, 5, 0, 2, 3]
aggregation_buffer:
[7, 8, 1, 4, 9, 6, 5, 0, 2, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.4778, 12.7792, 10.9845, 11.5818, 11.1270, 13.5173, 10.9845, 13.5173,
        13.7599, 14.3608], device='cuda:0')
Server loss: 3.8473668098449707
train global classifier
train glclassifier time: 3.6985810324549675
global classifier accuracy: 100.0
end Update
server_global_time: 727.7249112427235
only_train_time: 11008.864502049983

-------------Global Round number: 191-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9314
Averaged Test Accuracy (Prototype Model): 0.9332
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0451
tobetrained:
[7, 8, 1, 4, 9, 6, 5, 0, 2, 3]
Edge 7 begin training
Edge 8 begin training
Edge 1 begin training
Edge 4 begin training
Edge 9 begin training
Edge 6 begin training
Edge 5 begin training
Edge 0 begin training
Edge 2 begin training
Edge 3 begin training
readyList:
[7, 1, 0, 6, 4, 5, 2, 8, 9, 3]
aggregation_buffer:
[7, 1, 0, 6, 4, 5, 2, 8, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.5016, 12.7992, 11.0084, 11.6048, 11.1516, 13.5390, 11.0084, 13.5390,
        13.7854, 14.3825], device='cuda:0')
Server loss: 3.8490073680877686
train global classifier
train glclassifier time: 3.669753573834896
global classifier accuracy: 100.0
end Update
server_global_time: 734.5295606553555
only_train_time: 11120.114985242486

-------------Global Round number: 192-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9314
Averaged Test Accuracy (Prototype Model): 0.9333
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0451
tobetrained:
[7, 1, 0, 6, 4, 5, 2, 8, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 0 begin training
Edge 6 begin training
Edge 4 begin training
Edge 5 begin training
Edge 2 begin training
Edge 8 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 9, 6, 4, 8, 0, 2, 5, 3]
aggregation_buffer:
[7, 1, 9, 6, 4, 8, 0, 2, 5, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.5260, 12.8200, 11.0325, 11.6271, 11.1761, 13.5634, 11.0325, 13.5634,
        13.8096, 14.4095], device='cuda:0')
Server loss: 3.8487656116485596
train global classifier
train glclassifier time: 3.730429232120514
global classifier accuracy: 100.0
end Update
server_global_time: 741.8209862336516
only_train_time: 11237.75602517277

-------------Global Round number: 193-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9314
Averaged Test Accuracy (Prototype Model): 0.9333
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0451
tobetrained:
[7, 1, 9, 6, 4, 8, 0, 2, 5, 3]
Edge 7 begin training
Edge 1 begin training
Edge 9 begin training
Edge 6 begin training
Edge 4 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 3 begin training
readyList:
[7, 8, 1, 5, 2, 9, 0, 4, 6, 3]
aggregation_buffer:
[7, 8, 1, 5, 2, 9, 0, 4, 6, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.5474, 12.8394, 11.0568, 11.6486, 11.1996, 13.5866, 11.0568, 13.5866,
        13.8284, 14.4367], device='cuda:0')
Server loss: 3.8515536785125732
train global classifier
train glclassifier time: 3.6840057000517845
global classifier accuracy: 100.0
end Update
server_global_time: 750.0638677999377
only_train_time: 11349.508229702711

-------------Global Round number: 194-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9314
Averaged Test Accuracy (Prototype Model): 0.9333
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0451
tobetrained:
[7, 8, 1, 5, 2, 9, 0, 4, 6, 3]
Edge 7 begin training
Edge 8 begin training
Edge 1 begin training
Edge 5 begin training
Edge 2 begin training
Edge 9 begin training
Edge 0 begin training
Edge 4 begin training
Edge 6 begin training
Edge 3 begin training
readyList:
[1, 7, 6, 2, 8, 5, 4, 0, 9, 3]
aggregation_buffer:
[1, 7, 6, 2, 8, 5, 4, 0, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.5684, 12.8595, 11.0801, 11.6711, 11.2224, 13.6094, 11.0801, 13.6094,
        13.8544, 14.4564], device='cuda:0')
Server loss: 3.84816837310791
train global classifier
train glclassifier time: 3.7384766563773155
global classifier accuracy: 100.0
end Update
server_global_time: 758.361031666398
only_train_time: 11472.688570171595

-------------Global Round number: 195-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9313
Averaged Test Accuracy (Prototype Model): 0.9333
Std Test Accuracy (Regular Model): 0.0462
Std Test Accuracy (Prototype Model): 0.0450
tobetrained:
[1, 7, 6, 2, 8, 5, 4, 0, 9, 3]
Edge 1 begin training
Edge 7 begin training
Edge 6 begin training
Edge 2 begin training
Edge 8 begin training
Edge 5 begin training
Edge 4 begin training
Edge 0 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 8, 2, 6, 0, 5, 9, 4, 3]
aggregation_buffer:
[7, 1, 8, 2, 6, 0, 5, 9, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.5925, 12.8802, 11.1044, 11.6934, 11.2460, 13.6323, 11.1044, 13.6323,
        13.8763, 14.4804], device='cuda:0')
Server loss: 3.8497955799102783
train global classifier
train glclassifier time: 3.7590759992599487
global classifier accuracy: 100.0
end Update
server_global_time: 765.4210043922067
only_train_time: 11581.683907493949

-------------Global Round number: 196-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9314
Averaged Test Accuracy (Prototype Model): 0.9333
Std Test Accuracy (Regular Model): 0.0461
Std Test Accuracy (Prototype Model): 0.0451
tobetrained:
[7, 1, 8, 2, 6, 0, 5, 9, 4, 3]
Edge 7 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 6 begin training
Edge 0 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 4, 1, 6, 0, 2, 8, 9, 5, 3]
aggregation_buffer:
[7, 4, 1, 6, 0, 2, 8, 9, 5, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.6136, 12.8999, 11.1275, 11.7162, 11.2680, 13.6568, 11.1275, 13.6568,
        13.8989, 14.5051], device='cuda:0')
Server loss: 3.849601984024048
train global classifier
train glclassifier time: 3.7611313834786415
global classifier accuracy: 100.0
end Update
server_global_time: 774.354762904346
only_train_time: 11701.527130581439

-------------Global Round number: 197-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9317
Averaged Test Accuracy (Prototype Model): 0.9333
Std Test Accuracy (Regular Model): 0.0460
Std Test Accuracy (Prototype Model): 0.0451
tobetrained:
[7, 4, 1, 6, 0, 2, 8, 9, 5, 3]
Edge 7 begin training
Edge 4 begin training
Edge 1 begin training
Edge 6 begin training
Edge 0 begin training
Edge 2 begin training
Edge 8 begin training
Edge 9 begin training
Edge 5 begin training
Edge 3 begin training
readyList:
[7, 6, 2, 9, 1, 5, 4, 8, 0, 3]
aggregation_buffer:
[7, 6, 2, 9, 1, 5, 4, 8, 0, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.6360, 12.9209, 11.1526, 11.7391, 11.2916, 13.6815, 11.1526, 13.6815,
        13.9248, 14.5283], device='cuda:0')
Server loss: 3.848355293273926
train global classifier
train glclassifier time: 3.6651413962244987
global classifier accuracy: 100.0
end Update
server_global_time: 781.1517906337976
only_train_time: 11812.08893891424

-------------Global Round number: 198-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9315
Averaged Test Accuracy (Prototype Model): 0.9333
Std Test Accuracy (Regular Model): 0.0459
Std Test Accuracy (Prototype Model): 0.0451
tobetrained:
[7, 6, 2, 9, 1, 5, 4, 8, 0, 3]
Edge 7 begin training
Edge 6 begin training
Edge 2 begin training
Edge 9 begin training
Edge 1 begin training
Edge 5 begin training
Edge 4 begin training
Edge 8 begin training
Edge 0 begin training
Edge 3 begin training
readyList:
[7, 8, 1, 0, 6, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 8, 1, 0, 6, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.6580, 12.9408, 11.1748, 11.7641, 11.3146, 13.7024, 11.1748, 13.7024,
        13.9447, 14.5467], device='cuda:0')
Server loss: 3.8415894508361816
train global classifier
train glclassifier time: 3.7336015701293945
global classifier accuracy: 100.0
end Update
server_global_time: 789.2306696027517
only_train_time: 11926.232625201344

-------------Global Round number: 199-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9314
Averaged Test Accuracy (Prototype Model): 0.9333
Std Test Accuracy (Regular Model): 0.0459
Std Test Accuracy (Prototype Model): 0.0450
tobetrained:
[7, 8, 1, 0, 6, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 8 begin training
Edge 1 begin training
Edge 0 begin training
Edge 6 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 8, 1, 2, 6, 4, 0, 5, 9, 3]
aggregation_buffer:
[7, 8, 1, 2, 6, 4, 0, 5, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.6791, 12.9629, 11.1964, 11.7869, 11.3357, 13.7252, 11.1964, 13.7252,
        13.9677, 14.5696], device='cuda:0')
Server loss: 3.841909646987915
train global classifier
train glclassifier time: 3.7223163843154907
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 798.0130268633366
only_train_time: 12041.702383443713

-------------Global Round number: 200-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9315
Averaged Test Accuracy (Prototype Model): 0.9333
Std Test Accuracy (Regular Model): 0.0459
Std Test Accuracy (Prototype Model): 0.0450

Best accuracy.
0.9316546762589928
File path: ../results/FashionMNIST_dir_0.3_imbalance_40_FedSAE_test_0.h5
Deleted.

Average time cost: 16002.77s.
Length:  201
std for best accurancy: 0.0
mean for best accurancy: 0.9316546762589928
All done!

Storage on cpu
-------------------------------------------------------------------------------
Total Tensors: 5130 	Used Memory: 20.50K
-------------------------------------------------------------------------------

Storage on cuda:0
-------------------------------------------------------------------------------
Total Tensors: 171040 	Used Memory: 14.35M
The allocated memory on cuda:0: 14.35M
-------------------------------------------------------------------------------
