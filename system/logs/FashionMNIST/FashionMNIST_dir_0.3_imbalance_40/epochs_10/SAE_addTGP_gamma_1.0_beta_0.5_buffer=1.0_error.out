==================================================
goal = test
device = cuda
device_id = 0
dataset = FashionMNIST_dir_0.3_imbalance_40
num_classes = 10
model_family = HCNNs8
batch_size = 256
local_learning_rate = 0.06
use_decay_scheduler = False
learning_rate_decay = False
learning_rate_decay_gamma = 0.99
global_rounds = 150
edge_epochs = 1
local_epochs = 10
algorithm = FedSAE
join_ratio = 1.0
random_join_ratio = False
num_clients = 40
num_edges = 10
prev = 0
times = 1
eval_gap = 1
save_folder_name = temp
auto_break = False
feature_dim = 512
vocab_size = 98635
max_len = 200
client_drop_rate = 0.0
train_slow_rate = 0.0
send_slow_rate = 0.0
time_select = False
time_threthold = 10000
lamda = 2
trans_delay_simulate = False
agg_type = 0
buffersize = 10
test_useglclassifier = 1
gamma = 1.0
use_beta = True
SAEbeta = 0.5
addTGP = True
drawtsne = True
drawround = 10
noise_dim = 512
generator_learning_rate = 0.005
hidden_dim = 512
server_epochs = 100
alpha = 1.0
beta = 1.0
mentee_learning_rate = 0.005
T_start = 0.95
T_end = 0.98
server_learning_rate = 0.01
margin_threthold = 100.0
generator_path = stylegan/stylegan-xl-models/imagenet64.pkl
stable_diffusion_prompt = a cat
server_batch_size = 100
gen_batch_size = 4
mu = 50.0
==================================================
Random seed set as 42

============= Running time: 0th =============
Creating server and clients ...
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 0
label_counts: defaultdict(<class 'int'>, {5: 106, 1: 338, 0: 287, 3: 26, 9: 545, 6: 3, 2: 98, 4: 1})
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 1
label_counts: defaultdict(<class 'int'>, {4: 630, 7: 199, 1: 507, 2: 18, 5: 47, 0: 18, 3: 3, 6: 2})
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 2
label_counts: defaultdict(<class 'int'>, {0: 190, 5: 157, 7: 312, 9: 99, 6: 67, 8: 6, 2: 3, 3: 30, 4: 11})
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 3
label_counts: defaultdict(<class 'int'>, {6: 100, 3: 171, 8: 190, 9: 19, 4: 51, 2: 395, 0: 3, 5: 4})
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 4
label_counts: defaultdict(<class 'int'>, {5: 553, 0: 327, 1: 428, 2: 202, 4: 5})
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 5
label_counts: defaultdict(<class 'int'>, {4: 421, 6: 633, 2: 58, 3: 41, 8: 45, 1: 100, 7: 11, 5: 13, 0: 1})
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 6
label_counts: defaultdict(<class 'int'>, {4: 260, 9: 425, 8: 384, 3: 24, 1: 12, 2: 6, 6: 31, 7: 1})
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 7
label_counts: defaultdict(<class 'int'>, {9: 477, 8: 645, 6: 335, 7: 16, 3: 38, 5: 13, 4: 53, 0: 36, 1: 11, 2: 7})
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 8
label_counts: defaultdict(<class 'int'>, {4: 502, 9: 102, 0: 124, 6: 63, 2: 81, 8: 26, 5: 17, 3: 9, 1: 3})
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 9
label_counts: defaultdict(<class 'int'>, {3: 943, 2: 177, 1: 139, 0: 75})
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 10
label_counts: defaultdict(<class 'int'>, {8: 445, 4: 883, 2: 57, 0: 32, 3: 12, 5: 19, 7: 1, 6: 1, 1: 1})
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 11
label_counts: defaultdict(<class 'int'>, {6: 147, 4: 230, 8: 220, 9: 88, 3: 44, 1: 58, 5: 54, 2: 13, 7: 8})
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 12
label_counts: defaultdict(<class 'int'>, {6: 248, 3: 165, 1: 263, 9: 14, 0: 206, 5: 101, 7: 1, 4: 1})
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 13
label_counts: defaultdict(<class 'int'>, {3: 402, 2: 795, 4: 7, 7: 197, 0: 11, 5: 3, 1: 7})
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 14
label_counts: defaultdict(<class 'int'>, {9: 218, 0: 312, 3: 131, 4: 21, 5: 65, 1: 57, 2: 44, 8: 3})
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 15
label_counts: defaultdict(<class 'int'>, {6: 980, 5: 215, 3: 12, 1: 39, 0: 83, 4: 2})
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 16
label_counts: defaultdict(<class 'int'>, {4: 58, 3: 83, 0: 140, 1: 860, 5: 68, 8: 280, 6: 18, 7: 1})
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 17
label_counts: defaultdict(<class 'int'>, {8: 642, 5: 490, 0: 104, 4: 28, 3: 30, 2: 16, 7: 1, 6: 21, 1: 2})
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 18
label_counts: defaultdict(<class 'int'>, {8: 391, 1: 105, 2: 1, 4: 108, 7: 229, 3: 33, 5: 27, 6: 2, 0: 1})
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 19
label_counts: defaultdict(<class 'int'>, {1: 364, 0: 1204})
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 20
label_counts: defaultdict(<class 'int'>, {9: 858, 0: 37, 1: 290, 6: 44, 4: 216, 5: 157, 7: 131, 2: 19, 3: 1, 8: 1})
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 21
label_counts: defaultdict(<class 'int'>, {6: 225, 0: 136, 1: 383, 3: 62, 4: 288, 7: 16, 8: 4, 9: 1, 5: 1})
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 22
label_counts: defaultdict(<class 'int'>, {5: 243, 7: 387, 1: 102, 2: 9, 6: 68, 0: 12, 4: 1, 8: 15, 3: 1})
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 23
label_counts: defaultdict(<class 'int'>, {0: 232, 9: 256, 5: 40, 8: 141, 1: 32, 7: 1, 3: 2, 6: 1})
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 24
label_counts: defaultdict(<class 'int'>, {4: 309, 9: 235, 3: 447, 5: 120, 0: 62, 8: 15, 1: 2})
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 25
label_counts: defaultdict(<class 'int'>, {7: 222, 3: 388, 5: 505, 2: 154, 0: 81, 4: 7, 1: 34})
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 26
label_counts: defaultdict(<class 'int'>, {8: 568, 7: 172, 4: 139, 0: 443, 3: 26, 2: 116, 1: 10, 5: 5})
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 27
label_counts: defaultdict(<class 'int'>, {2: 186, 5: 530, 6: 253, 3: 75, 0: 88, 7: 1, 4: 5})
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 28
label_counts: defaultdict(<class 'int'>, {1: 63, 9: 281, 5: 14, 7: 176, 2: 50, 8: 93, 3: 24, 0: 22, 6: 2, 4: 1})
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 29
label_counts: defaultdict(<class 'int'>, {7: 363, 5: 337, 8: 138, 3: 170, 9: 164, 2: 27, 1: 20, 4: 2, 6: 3})
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 30
label_counts: defaultdict(<class 'int'>, {8: 229, 7: 302, 0: 243, 9: 43, 5: 24, 2: 1, 3: 2, 1: 2})
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 31
label_counts: defaultdict(<class 'int'>, {2: 510, 4: 583, 0: 98, 1: 223})
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 32
label_counts: defaultdict(<class 'int'>, {9: 1142, 7: 49, 2: 276, 5: 146, 1: 20, 3: 51, 6: 75, 8: 12, 0: 31, 4: 1})
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 33
label_counts: defaultdict(<class 'int'>, {2: 405, 6: 254, 7: 122, 1: 76, 3: 276, 0: 151, 4: 83})
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 34
label_counts: defaultdict(<class 'int'>, {0: 172, 2: 880, 6: 870, 3: 12, 1: 42, 4: 9})
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 35
label_counts: defaultdict(<class 'int'>, {4: 312, 9: 70, 0: 300, 6: 18, 7: 36, 5: 70, 2: 90, 3: 121, 1: 25, 8: 1})
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 36
label_counts: defaultdict(<class 'int'>, {6: 412, 2: 127, 8: 221, 3: 364, 1: 41, 9: 158, 7: 124, 0: 3, 4: 5})
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 37
label_counts: defaultdict(<class 'int'>, {7: 2178, 3: 1002, 6: 142, 4: 3, 2: 20, 5: 11, 0: 1})
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 38
label_counts: defaultdict(<class 'int'>, {5: 1124, 1: 545, 2: 23, 0: 14, 3: 21, 4: 1})
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 39
label_counts: defaultdict(<class 'int'>, {2: 387, 6: 233, 8: 501, 1: 41, 0: 13, 9: 3, 3: 2, 5: 12, 4: 1, 7: 2})

Join ratio / total clients: 1.0 / 40
Finished creating server and clients.
Trainable_prototypes(
  (embedings): Embedding(10, 512)
  (middle): Sequential(
    (0): Sequential(
      (0): Linear(in_features=512, out_features=512, bias=True)
      (1): ReLU()
    )
  )
  (fc): Linear(in_features=512, out_features=512, bias=True)
)
tobetrained:
[9, 8, 7, 6, 5, 4, 3, 2, 1, 0]
Edge 9 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_10 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_34 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_14 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_27 protos Not Found
Client_14 prev_protos Not Found
Client_10 prev_protos Not Found
Client_34 prev_protos Not Found
Client_27 prev_protos Not Found
Edge 8 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_3 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_31 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_22 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_21 protos Not Found
Client_22 prev_protos Not Found
Client_3 prev_protos Not Found
Client_21 prev_protos Not Found
Client_31 prev_protos Not Found
Edge 7 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_23 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_35 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_6 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_30 protos Not Found
Client_6 prev_protos Not Found
Client_35 prev_protos Not Found
Client_23 prev_protos Not Found
Client_30 prev_protos Not Found
Edge 6 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_4 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_39 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_9 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_8 protos Not Found
Client_4 prev_protos Not Found
Client_39 prev_protos Not Found
Client_9 prev_protos Not Found
Client_8 prev_protos Not Found
Edge 5 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_11 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_32 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_29 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_0 protos Not Found
Client_0 prev_protos Not Found
Client_32 prev_protos Not Found
Client_29 prev_protos Not Found
Client_11 prev_protos Not Found
Edge 4 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_36 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_7 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_1 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_28 protos Not Found
Client_1 prev_protos Not Found
Client_36 prev_protos Not Found
Client_7 prev_protos Not Found
Client_28 prev_protos Not Found
Edge 3 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_37 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_13 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_20 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_18 protos Not Found
Client_20 prev_protos Not Found
Client_13 prev_protos Not Found
Client_18 prev_protos Not Found
Client_37 prev_protos Not Found
Edge 2 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_5 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_25 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_2 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_38 protos Not Found
Client_38 prev_protos Not Found
Client_5 prev_protos Not Found
Client_2 prev_protos Not Found
Client_25 prev_protos Not Found
Edge 1 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_12 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_17 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_33 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_24 protos Not Found
Client_17 prev_protos Not Found
Client_24 prev_protos Not Found
Client_12 prev_protos Not Found
Client_33 prev_protos Not Found
Edge 0 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_26 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_15 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_19 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_16 protos Not Found
Client_19 prev_protos Not Found
Client_16 prev_protos Not Found
Client_15 prev_protos Not Found
Client_26 prev_protos Not Found
readyList:
[7, 6, 0, 1, 8, 4, 2, 5, 9, 3]
aggregation_buffer:
[7, 6, 0, 1, 8, 4, 2, 5, 9, 3]
Edge_0 prev_protos Not Found
Edge_1 prev_protos Not Found
Edge_2 prev_protos Not Found
Edge_3 prev_protos Not Found
Edge_4 prev_protos Not Found
Edge_5 prev_protos Not Found
Edge_6 prev_protos Not Found
Edge_7 prev_protos Not Found
Edge_8 prev_protos Not Found
Edge_9 prev_protos Not Found
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([3.1837, 4.7707, 2.1037, 4.6248, 2.8281, 4.2130, 2.1037, 6.8910, 3.5712,
        6.9715], device='cuda:0')
Server loss: 8.284708976745605
train global classifier
train glclassifier time: 3.653068631887436
global classifier accuracy: 99.0125
Number of samples: 324
end Update
server_global_time: 1.3258913308382034
only_train_time: 20.4121263474226

-------------Global Round number: 0-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.7592
Averaged Test Accuracy (Prototype Model): 0.6246
Std Test Accuracy (Regular Model): 0.1677
Std Test Accuracy (Prototype Model): 0.2276
tobetrained:
[7, 6, 0, 1, 8, 4, 2, 5, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 0 begin training
Edge 1 begin training
Edge 8 begin training
Edge 4 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([2.5904, 3.9670, 1.7253, 3.1160, 2.0712, 3.7870, 1.7253, 4.1256, 3.2586,
        5.1143], device='cuda:0')
Server loss: 5.096587657928467
train global classifier
train glclassifier time: 3.7604639679193497
global classifier accuracy: 99.5225
end Update
server_global_time: 5.105469226837158
only_train_time: 67.34959030896425

-------------Global Round number: 1-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.8772
Averaged Test Accuracy (Prototype Model): 0.8546
Std Test Accuracy (Regular Model): 0.0850
Std Test Accuracy (Prototype Model): 0.0914
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 0, 5, 4, 2, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 0, 5, 4, 2, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([2.7527, 4.3491, 1.7157, 3.1513, 2.0479, 4.0790, 1.7157, 4.0790, 3.6059,
        5.4549], device='cuda:0')
Server loss: 4.87499475479126
train global classifier
train glclassifier time: 3.829234726727009
global classifier accuracy: 99.64
end Update
server_global_time: 8.149277858436108
only_train_time: 112.89601265639067

-------------Global Round number: 2-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.8888
Averaged Test Accuracy (Prototype Model): 0.8803
Std Test Accuracy (Regular Model): 0.0818
Std Test Accuracy (Prototype Model): 0.0781
tobetrained:
[7, 6, 1, 8, 0, 5, 4, 2, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 2 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 4, 0, 2, 9, 5, 3]
aggregation_buffer:
[7, 6, 1, 8, 4, 0, 2, 9, 5, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([3.0172, 4.8823, 1.8453, 3.3906, 2.2349, 4.4409, 1.8453, 4.4409, 4.0379,
        5.9508], device='cuda:0')
Server loss: 4.920918941497803
train global classifier
train glclassifier time: 3.955374702811241
global classifier accuracy: 99.845
end Update
server_global_time: 11.12686101347208
only_train_time: 158.0707493647933

-------------Global Round number: 3-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9053
Averaged Test Accuracy (Prototype Model): 0.8921
Std Test Accuracy (Regular Model): 0.0657
Std Test Accuracy (Prototype Model): 0.0738
tobetrained:
[7, 6, 1, 8, 4, 0, 2, 9, 5, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 4 begin training
Edge 0 begin training
Edge 2 begin training
Edge 9 begin training
Edge 5 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([3.3286, 5.4084, 2.0138, 3.6760, 2.4623, 4.8610, 2.0138, 4.8610, 4.5550,
        6.4205], device='cuda:0')
Server loss: 4.980552673339844
train global classifier
train glclassifier time: 4.040244199335575
global classifier accuracy: 99.9225
end Update
server_global_time: 14.181711420416832
only_train_time: 203.68692172318697

-------------Global Round number: 4-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9037
Averaged Test Accuracy (Prototype Model): 0.8963
Std Test Accuracy (Regular Model): 0.0712
Std Test Accuracy (Prototype Model): 0.0704
tobetrained:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([3.6490, 5.8805, 2.2120, 3.9929, 2.7338, 5.3419, 2.2120, 5.3419, 5.0656,
        6.8657], device='cuda:0')
Server loss: 5.031325340270996
train global classifier
train glclassifier time: 4.05752008408308
global classifier accuracy: 99.95
end Update
server_global_time: 17.192105770111084
only_train_time: 249.78789042681456

-------------Global Round number: 5-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9135
Averaged Test Accuracy (Prototype Model): 0.9045
Std Test Accuracy (Regular Model): 0.0579
Std Test Accuracy (Prototype Model): 0.0590
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 4, 9, 0, 5, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 4, 9, 0, 5, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([3.9658, 6.3294, 2.4203, 4.3394, 3.0128, 5.8171, 2.4203, 5.8171, 5.5442,
        7.2910], device='cuda:0')
Server loss: 5.0832133293151855
train global classifier
train glclassifier time: 3.748423293232918
global classifier accuracy: 99.9925
end Update
server_global_time: 20.141648955643177
only_train_time: 296.786753103137

-------------Global Round number: 6-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9147
Averaged Test Accuracy (Prototype Model): 0.9053
Std Test Accuracy (Regular Model): 0.0602
Std Test Accuracy (Prototype Model): 0.0594
tobetrained:
[7, 1, 6, 8, 2, 4, 9, 0, 5, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 0 begin training
Edge 5 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([4.2610, 6.7304, 2.6234, 4.6908, 3.3072, 6.2601, 2.6234, 6.2601, 6.0087,
        7.6920], device='cuda:0')
Server loss: 5.158140182495117
train global classifier
train glclassifier time: 3.708084352314472
global classifier accuracy: 99.9975
end Update
server_global_time: 23.06760959327221
only_train_time: 341.37844397872686

-------------Global Round number: 7-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9197
Averaged Test Accuracy (Prototype Model): 0.9085
Std Test Accuracy (Regular Model): 0.0534
Std Test Accuracy (Prototype Model): 0.0583
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([4.5941, 7.1326, 2.8788, 5.0534, 3.6525, 6.6825, 2.8788, 6.6825, 6.4401,
        8.0905], device='cuda:0')
Server loss: 5.191975116729736
train global classifier
train glclassifier time: 3.6773477122187614
global classifier accuracy: 100.0
end Update
server_global_time: 26.07995492219925
only_train_time: 385.99600870907307

-------------Global Round number: 8-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9215
Averaged Test Accuracy (Prototype Model): 0.9117
Std Test Accuracy (Regular Model): 0.0519
Std Test Accuracy (Prototype Model): 0.0556
tobetrained:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 4, 5, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 4, 5, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([4.8878, 7.4898, 3.1565, 5.4155, 3.9811, 7.0813, 3.1565, 7.0813, 6.8448,
        8.4705], device='cuda:0')
Server loss: 5.24581241607666
train global classifier
train glclassifier time: 3.633331313729286
global classifier accuracy: 100.0
end Update
server_global_time: 29.06917228549719
only_train_time: 430.31231467425823

-------------Global Round number: 9-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9218
Averaged Test Accuracy (Prototype Model): 0.9130
Std Test Accuracy (Regular Model): 0.0514
Std Test Accuracy (Prototype Model): 0.0538
tobetrained:
[7, 6, 1, 8, 2, 0, 4, 5, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([5.1936, 7.8476, 3.4238, 5.7779, 4.3463, 7.4685, 3.4238, 7.4685, 7.2459,
        8.8368], device='cuda:0')
Server loss: 5.279543876647949
train global classifier
train glclassifier time: 3.7040323615074158
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 32.1270956620574
only_train_time: 474.7638518959284

-------------Global Round number: 10-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9229
Averaged Test Accuracy (Prototype Model): 0.9149
Std Test Accuracy (Regular Model): 0.0515
Std Test Accuracy (Prototype Model): 0.0541
tobetrained:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[8, 6, 1, 7, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[8, 6, 1, 7, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([5.4768, 8.1699, 3.7216, 6.1174, 4.6925, 7.8113, 3.7216, 7.8113, 7.6015,
        9.1780], device='cuda:0')
Server loss: 5.321398735046387
train global classifier
train glclassifier time: 3.590203434228897
global classifier accuracy: 99.9975
end Update
server_global_time: 35.065580137073994
only_train_time: 520.9047678411007

-------------Global Round number: 11-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9207
Averaged Test Accuracy (Prototype Model): 0.9144
Std Test Accuracy (Regular Model): 0.0524
Std Test Accuracy (Prototype Model): 0.0546
tobetrained:
[8, 6, 1, 7, 2, 0, 5, 4, 9, 3]
Edge 8 begin training
Edge 6 begin training
Edge 1 begin training
Edge 7 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 5, 0, 9, 4, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 5, 0, 9, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([5.7437, 8.4461, 3.9349, 6.4301, 4.9084, 8.0972, 3.9349, 8.0972, 7.9328,
        9.4892], device='cuda:0')
Server loss: 5.375801086425781
train global classifier
train glclassifier time: 4.427678622305393
global classifier accuracy: 100.0
end Update
server_global_time: 38.08122381567955
only_train_time: 566.495763078332

-------------Global Round number: 12-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9253
Averaged Test Accuracy (Prototype Model): 0.9185
Std Test Accuracy (Regular Model): 0.0487
Std Test Accuracy (Prototype Model): 0.0520
tobetrained:
[7, 1, 6, 8, 2, 5, 0, 9, 4, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([6.0142, 8.7400, 4.2759, 6.7716, 5.2961, 8.4226, 4.2759, 8.4226, 8.3104,
        9.8051], device='cuda:0')
Server loss: 5.379947662353516
train global classifier
train glclassifier time: 3.977447174489498
global classifier accuracy: 100.0
end Update
server_global_time: 41.097131945192814
only_train_time: 612.0359945371747

-------------Global Round number: 13-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9247
Averaged Test Accuracy (Prototype Model): 0.9203
Std Test Accuracy (Regular Model): 0.0506
Std Test Accuracy (Prototype Model): 0.0507
tobetrained:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 8, 2, 5, 0, 1, 6, 4, 9, 3]
aggregation_buffer:
[7, 8, 2, 5, 0, 1, 6, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 6.2935,  9.0317,  4.6014,  7.1139,  5.6476,  8.7361,  4.6014,  8.7361,
         8.6646, 10.0930], device='cuda:0')
Server loss: 5.366867542266846
train global classifier
train glclassifier time: 3.695926070213318
global classifier accuracy: 100.0
end Update
server_global_time: 44.13211038708687
only_train_time: 659.7616300955415

-------------Global Round number: 14-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9240
Averaged Test Accuracy (Prototype Model): 0.9205
Std Test Accuracy (Regular Model): 0.0536
Std Test Accuracy (Prototype Model): 0.0520
tobetrained:
[7, 8, 2, 5, 0, 1, 6, 4, 9, 3]
Edge 7 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 1 begin training
Edge 6 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 6.5378,  9.2812,  4.9091,  7.4273,  5.9921,  9.0469,  4.9091,  9.0469,
         8.9589, 10.3890], device='cuda:0')
Server loss: 5.392425060272217
train global classifier
train glclassifier time: 3.6140103563666344
global classifier accuracy: 100.0
end Update
server_global_time: 47.110655061900616
only_train_time: 704.0799418613315

-------------Global Round number: 15-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9273
Averaged Test Accuracy (Prototype Model): 0.9224
Std Test Accuracy (Regular Model): 0.0467
Std Test Accuracy (Prototype Model): 0.0499
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 6.7843,  9.5240,  5.1772,  7.6836,  6.2718,  9.3372,  5.1772,  9.3372,
         9.2472, 10.6802], device='cuda:0')
Server loss: 5.425579071044922
train global classifier
train glclassifier time: 3.538500428199768
global classifier accuracy: 100.0
end Update
server_global_time: 50.122428476810455
only_train_time: 748.544156037271

-------------Global Round number: 16-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9270
Averaged Test Accuracy (Prototype Model): 0.9228
Std Test Accuracy (Regular Model): 0.0477
Std Test Accuracy (Prototype Model): 0.0507
tobetrained:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.0450,  9.7647,  5.5013,  7.9286,  6.6296,  9.5915,  5.5013,  9.5915,
         9.5835, 10.9449], device='cuda:0')
Server loss: 5.4121880531311035
train global classifier
train glclassifier time: 3.667573042213917
global classifier accuracy: 100.0
end Update
server_global_time: 53.12914603203535
only_train_time: 793.008900038898

-------------Global Round number: 17-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9277
Averaged Test Accuracy (Prototype Model): 0.9244
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0478
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 4, 5, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 4, 5, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.2919,  9.9786,  5.7615,  8.1303,  6.9499,  9.8218,  5.7615,  9.8218,
         9.8671, 11.1918], device='cuda:0')
Server loss: 5.427480220794678
train global classifier
train glclassifier time: 3.603063017129898
global classifier accuracy: 100.0
end Update
server_global_time: 56.126988396048546
only_train_time: 837.2729318886995

-------------Global Round number: 18-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9277
Averaged Test Accuracy (Prototype Model): 0.9253
Std Test Accuracy (Regular Model): 0.0471
Std Test Accuracy (Prototype Model): 0.0472
tobetrained:
[7, 6, 1, 8, 2, 0, 4, 5, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.5371, 10.1839,  6.0858,  8.3662,  7.2482, 10.0764,  6.0858, 10.0764,
        10.1284, 11.4223], device='cuda:0')
Server loss: 5.417259693145752
train global classifier
train glclassifier time: 3.7236471697688103
global classifier accuracy: 100.0
end Update
server_global_time: 59.14174231141806
only_train_time: 881.6643336340785

-------------Global Round number: 19-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9273
Averaged Test Accuracy (Prototype Model): 0.9260
Std Test Accuracy (Regular Model): 0.0479
Std Test Accuracy (Prototype Model): 0.0472
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.7403, 10.3671,  6.2977,  8.5760,  7.5179, 10.3158,  6.2977, 10.3158,
        10.2832, 11.6448], device='cuda:0')
Server loss: 5.440131187438965
train global classifier
train glclassifier time: 3.6244265288114548
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 62.10421981662512
only_train_time: 925.9433163404465

-------------Global Round number: 20-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9269
Averaged Test Accuracy (Prototype Model): 0.9253
Std Test Accuracy (Regular Model): 0.0491
Std Test Accuracy (Prototype Model): 0.0495
tobetrained:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 7.9834, 10.5521,  6.6165,  8.7801,  7.8135, 10.5414,  6.6165, 10.5414,
        10.5973, 11.8501], device='cuda:0')
Server loss: 5.399108409881592
train global classifier
train glclassifier time: 3.5820012241601944
global classifier accuracy: 100.0
end Update
server_global_time: 65.04620753228664
only_train_time: 970.5733206048608

-------------Global Round number: 21-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9289
Averaged Test Accuracy (Prototype Model): 0.9270
Std Test Accuracy (Regular Model): 0.0462
Std Test Accuracy (Prototype Model): 0.0467
tobetrained:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.2138, 10.7253,  6.9060,  8.9703,  8.0800, 10.7505,  6.9060, 10.7505,
        10.8434, 12.0469], device='cuda:0')
Server loss: 5.3805251121521
train global classifier
train glclassifier time: 3.6354101672768593
global classifier accuracy: 100.0
end Update
server_global_time: 68.06047098338604
only_train_time: 1014.7486188188195

-------------Global Round number: 22-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9291
Averaged Test Accuracy (Prototype Model): 0.9270
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0469
tobetrained:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 8, 1, 6, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 8, 1, 6, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.4071, 10.8862,  7.1614,  9.1590,  8.3323, 10.9476,  7.1614, 10.9476,
        11.0391, 12.2166], device='cuda:0')
Server loss: 5.353122711181641
train global classifier
train glclassifier time: 3.7161789759993553
global classifier accuracy: 100.0
end Update
server_global_time: 70.78545926511288
only_train_time: 1058.5458854585886

-------------Global Round number: 23-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9287
Averaged Test Accuracy (Prototype Model): 0.9271
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0468
tobetrained:
[7, 8, 1, 6, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 8 begin training
Edge 1 begin training
Edge 6 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.6244, 11.0428,  7.4357,  9.3323,  8.5880, 11.1384,  7.4357, 11.1384,
        11.2512, 12.4156], device='cuda:0')
Server loss: 5.34654426574707
train global classifier
train glclassifier time: 3.7439757138490677
global classifier accuracy: 100.0
end Update
server_global_time: 73.79811482876539
only_train_time: 1103.044220097363

-------------Global Round number: 24-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9294
Averaged Test Accuracy (Prototype Model): 0.9277
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0460
tobetrained:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 8.8348, 11.2016,  7.6933,  9.5025,  8.8383, 11.3204,  7.6933, 11.3204,
        11.4456, 12.6011], device='cuda:0')
Server loss: 5.339404106140137
train global classifier
train glclassifier time: 3.7202596962451935
global classifier accuracy: 100.0
end Update
server_global_time: 76.78570263832808
only_train_time: 1147.658819526434

-------------Global Round number: 25-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9295
Averaged Test Accuracy (Prototype Model): 0.9277
Std Test Accuracy (Regular Model): 0.0461
Std Test Accuracy (Prototype Model): 0.0462
tobetrained:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.0299, 11.3587,  7.9339,  9.6642,  9.0730, 11.5000,  7.9339, 11.5000,
        11.6257, 12.7799], device='cuda:0')
Server loss: 5.3367462158203125
train global classifier
train glclassifier time: 3.585394099354744
global classifier accuracy: 100.0
end Update
server_global_time: 79.73373682796955
only_train_time: 1192.0524137169123

-------------Global Round number: 26-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9293
Averaged Test Accuracy (Prototype Model): 0.9278
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0462
tobetrained:
[7, 6, 1, 8, 0, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.2177, 11.5100,  8.1633,  9.8271,  9.2918, 11.6693,  8.1633, 11.6693,
        11.8004, 12.9447], device='cuda:0')
Server loss: 5.3252787590026855
train global classifier
train glclassifier time: 3.723543167114258
global classifier accuracy: 100.0
end Update
server_global_time: 82.68452999740839
only_train_time: 1236.4463528171182

-------------Global Round number: 27-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9294
Averaged Test Accuracy (Prototype Model): 0.9279
Std Test Accuracy (Regular Model): 0.0467
Std Test Accuracy (Prototype Model): 0.0458
tobetrained:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 5, 4, 0, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 5, 4, 0, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.3956, 11.6563,  8.3818,  9.9808,  9.5027, 11.8327,  8.3818, 11.8327,
        11.9604, 13.1115], device='cuda:0')
Server loss: 5.32345724105835
train global classifier
train glclassifier time: 3.6396106630563736
global classifier accuracy: 100.0
end Update
server_global_time: 85.64025166630745
only_train_time: 1281.0728912502527

-------------Global Round number: 28-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9290
Averaged Test Accuracy (Prototype Model): 0.9281
Std Test Accuracy (Regular Model): 0.0465
Std Test Accuracy (Prototype Model): 0.0457
tobetrained:
[7, 1, 6, 8, 2, 5, 4, 0, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 0 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.5684, 11.7962,  8.5840, 10.1288,  9.7025, 11.9962,  8.5840, 11.9962,
        12.1234, 13.2712], device='cuda:0')
Server loss: 5.320289611816406
train global classifier
train glclassifier time: 3.760322317481041
global classifier accuracy: 100.0
end Update
server_global_time: 88.69687142968178
only_train_time: 1325.8584877476096

-------------Global Round number: 29-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9295
Averaged Test Accuracy (Prototype Model): 0.9283
Std Test Accuracy (Regular Model): 0.0470
Std Test Accuracy (Prototype Model): 0.0457
tobetrained:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 2, 5, 9, 4, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 2, 5, 9, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.7365, 11.9341,  8.7856, 10.2688,  9.9002, 12.1598,  8.7856, 12.1598,
        12.2804, 13.4244], device='cuda:0')
Server loss: 5.312009334564209
train global classifier
train glclassifier time: 4.558220624923706
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 91.65379501134157
only_train_time: 1370.3512802496552

-------------Global Round number: 30-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9295
Averaged Test Accuracy (Prototype Model): 0.9287
Std Test Accuracy (Regular Model): 0.0469
Std Test Accuracy (Prototype Model): 0.0456
tobetrained:
[7, 1, 6, 8, 0, 2, 5, 9, 4, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[8, 6, 2, 7, 0, 5, 4, 1, 9, 3]
aggregation_buffer:
[8, 6, 2, 7, 0, 5, 4, 1, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([ 9.9014, 12.0699,  8.9758, 10.4064, 10.0876, 12.3132,  8.9758, 12.3132,
        12.4212, 13.5678], device='cuda:0')
Server loss: 5.301141262054443
train global classifier
train glclassifier time: 3.6055028438568115
global classifier accuracy: 100.0
end Update
server_global_time: 94.65586288273335
only_train_time: 1417.3141430616379

-------------Global Round number: 31-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9299
Averaged Test Accuracy (Prototype Model): 0.9293
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0460
tobetrained:
[8, 6, 2, 7, 0, 5, 4, 1, 9, 3]
Edge 8 begin training
Edge 6 begin training
Edge 2 begin training
Edge 7 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 1 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.0593, 12.2144,  9.1566, 10.5406, 10.2605, 12.4570,  9.1566, 12.4570,
        12.5594, 13.7143], device='cuda:0')
Server loss: 5.29918098449707
train global classifier
train glclassifier time: 3.704042747616768
global classifier accuracy: 100.0
end Update
server_global_time: 97.65731044113636
only_train_time: 1461.8961804956198

-------------Global Round number: 32-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9297
Averaged Test Accuracy (Prototype Model): 0.9293
Std Test Accuracy (Regular Model): 0.0467
Std Test Accuracy (Prototype Model): 0.0461
tobetrained:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.2100, 12.3458,  9.3303, 10.6732, 10.4296, 12.6012,  9.3303, 12.6012,
        12.6914, 13.8531], device='cuda:0')
Server loss: 5.2908244132995605
train global classifier
train glclassifier time: 3.708687834441662
global classifier accuracy: 100.0
end Update
server_global_time: 100.70119009166956
only_train_time: 1506.4742777496576

-------------Global Round number: 33-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9297
Averaged Test Accuracy (Prototype Model): 0.9295
Std Test Accuracy (Regular Model): 0.0468
Std Test Accuracy (Prototype Model): 0.0459
tobetrained:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 4, 5, 0, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 4, 5, 0, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.3598, 12.4753,  9.4973, 10.8036, 10.5917, 12.7401,  9.4973, 12.7401,
        12.8217, 13.9837], device='cuda:0')
Server loss: 5.278929233551025
train global classifier
train glclassifier time: 3.624064490199089
global classifier accuracy: 100.0
end Update
server_global_time: 103.7884191274643
only_train_time: 1551.5660260766745

-------------Global Round number: 34-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9299
Averaged Test Accuracy (Prototype Model): 0.9295
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0461
tobetrained:
[7, 1, 6, 8, 2, 4, 5, 0, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 0 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 8, 1, 0, 2, 4, 5, 9, 3]
aggregation_buffer:
[7, 6, 8, 1, 0, 2, 4, 5, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.5027, 12.5958,  9.6632, 10.9270, 10.7521, 12.8553,  9.6632, 12.8682,
        12.9505, 14.1040], device='cuda:0')
Server loss: 5.258683204650879
train global classifier
train glclassifier time: 3.678457774221897
global classifier accuracy: 100.0
end Update
server_global_time: 106.73277855664492
only_train_time: 1595.9307061210275

-------------Global Round number: 35-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9303
Averaged Test Accuracy (Prototype Model): 0.9295
Std Test Accuracy (Regular Model): 0.0462
Std Test Accuracy (Prototype Model): 0.0462
tobetrained:
[7, 6, 8, 1, 0, 2, 4, 5, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 8 begin training
Edge 1 begin training
Edge 0 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 5, 0, 2, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 5, 0, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.6408, 12.7128,  9.8198, 11.0497, 10.8966, 12.9646,  9.8198, 12.9954,
        13.0663, 14.2108], device='cuda:0')
Server loss: 5.234591484069824
train global classifier
train glclassifier time: 3.599262110888958
global classifier accuracy: 100.0
end Update
server_global_time: 109.63932748883963
only_train_time: 1640.4711528792977

-------------Global Round number: 36-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9307
Averaged Test Accuracy (Prototype Model): 0.9299
Std Test Accuracy (Regular Model): 0.0459
Std Test Accuracy (Prototype Model): 0.0461
tobetrained:
[7, 1, 6, 8, 5, 0, 2, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 5 begin training
Edge 0 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.7762, 12.8222,  9.9703, 11.1659, 11.0357, 13.0737,  9.9703, 13.1181,
        13.1877, 14.3281], device='cuda:0')
Server loss: 5.2236833572387695
train global classifier
train glclassifier time: 3.674706883728504
global classifier accuracy: 100.0
end Update
server_global_time: 112.65198835730553
only_train_time: 1684.877033688128

-------------Global Round number: 37-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9304
Averaged Test Accuracy (Prototype Model): 0.9299
Std Test Accuracy (Regular Model): 0.0459
Std Test Accuracy (Prototype Model): 0.0461
tobetrained:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([10.9090, 12.9306, 10.1175, 11.2788, 11.1775, 13.1803, 10.1175, 13.2429,
        13.3085, 14.4424], device='cuda:0')
Server loss: 5.211130619049072
train global classifier
train glclassifier time: 3.59051151573658
global classifier accuracy: 100.0
end Update
server_global_time: 115.60904483497143
only_train_time: 1729.3685219958425

-------------Global Round number: 38-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9309
Averaged Test Accuracy (Prototype Model): 0.9299
Std Test Accuracy (Regular Model): 0.0459
Std Test Accuracy (Prototype Model): 0.0463
tobetrained:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.0439, 13.0410, 10.2664, 11.3875, 11.3144, 13.2856, 10.2664, 13.3615,
        13.4191, 14.5460], device='cuda:0')
Server loss: 5.191943645477295
train global classifier
train glclassifier time: 3.618662305176258
global classifier accuracy: 100.0
end Update
server_global_time: 118.60290298610926
only_train_time: 1773.862237535417

-------------Global Round number: 39-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9306
Averaged Test Accuracy (Prototype Model): 0.9300
Std Test Accuracy (Regular Model): 0.0458
Std Test Accuracy (Prototype Model): 0.0459
tobetrained:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.1680, 13.1485, 10.4104, 11.4945, 11.4427, 13.3852, 10.4104, 13.4774,
        13.5335, 14.6556], device='cuda:0')
Server loss: 5.1825737953186035
train global classifier
train glclassifier time: 3.622836373746395
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 121.63004260510206
only_train_time: 1818.3502632007003

-------------Global Round number: 40-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9306
Averaged Test Accuracy (Prototype Model): 0.9302
Std Test Accuracy (Regular Model): 0.0462
Std Test Accuracy (Prototype Model): 0.0459
tobetrained:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.2966, 13.2461, 10.5521, 11.6088, 11.5751, 13.4877, 10.5521, 13.5922,
        13.6429, 14.7594], device='cuda:0')
Server loss: 5.165963649749756
train global classifier
train glclassifier time: 3.6546384766697884
global classifier accuracy: 100.0
end Update
server_global_time: 124.60041680186987
only_train_time: 1863.1095069944859

-------------Global Round number: 41-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9309
Averaged Test Accuracy (Prototype Model): 0.9303
Std Test Accuracy (Regular Model): 0.0456
Std Test Accuracy (Prototype Model): 0.0457
tobetrained:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 8, 6, 1, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 8, 6, 1, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.4263, 13.3455, 10.6888, 11.7207, 11.6966, 13.5876, 10.6888, 13.7026,
        13.7513, 14.8636], device='cuda:0')
Server loss: 5.15390157699585
train global classifier
train glclassifier time: 3.686599262058735
global classifier accuracy: 100.0
end Update
server_global_time: 127.59299979358912
only_train_time: 1907.4073898643255

-------------Global Round number: 42-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9307
Averaged Test Accuracy (Prototype Model): 0.9300
Std Test Accuracy (Regular Model): 0.0458
Std Test Accuracy (Prototype Model): 0.0457
tobetrained:
[7, 8, 6, 1, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 8 begin training
Edge 6 begin training
Edge 1 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.5489, 13.4417, 10.8228, 11.8201, 11.8237, 13.6867, 10.8228, 13.8155,
        13.8650, 14.9725], device='cuda:0')
Server loss: 5.147464752197266
train global classifier
train glclassifier time: 4.0223966762423515
global classifier accuracy: 100.0
end Update
server_global_time: 130.65888335555792
only_train_time: 1952.1760825812817

-------------Global Round number: 43-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9309
Averaged Test Accuracy (Prototype Model): 0.9302
Std Test Accuracy (Regular Model): 0.0457
Std Test Accuracy (Prototype Model): 0.0457
tobetrained:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.6737, 13.5361, 10.9553, 11.9259, 11.9466, 13.7894, 10.9553, 13.9304,
        13.9660, 15.0724], device='cuda:0')
Server loss: 5.132545471191406
train global classifier
train glclassifier time: 3.6355521231889725
global classifier accuracy: 100.0
end Update
server_global_time: 133.62188117951155
only_train_time: 1997.0338986217976

-------------Global Round number: 44-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9310
Averaged Test Accuracy (Prototype Model): 0.9302
Std Test Accuracy (Regular Model): 0.0457
Std Test Accuracy (Prototype Model): 0.0456
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.7992, 13.6293, 11.0844, 12.0292, 12.0640, 13.8885, 11.0844, 14.0402,
        14.0800, 15.1742], device='cuda:0')
Server loss: 5.1223626136779785
train global classifier
train glclassifier time: 3.563488721847534
global classifier accuracy: 100.0
end Update
server_global_time: 136.62598015367985
only_train_time: 2041.5089895874262

-------------Global Round number: 45-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9309
Averaged Test Accuracy (Prototype Model): 0.9305
Std Test Accuracy (Regular Model): 0.0460
Std Test Accuracy (Prototype Model): 0.0452
tobetrained:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 8, 1, 5, 0, 4, 2, 9, 3]
aggregation_buffer:
[7, 6, 8, 1, 5, 0, 4, 2, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([11.9191, 13.7245, 11.2101, 12.1294, 12.1827, 13.9845, 11.2101, 14.1465,
        14.1792, 15.2706], device='cuda:0')
Server loss: 5.108565330505371
train global classifier
train glclassifier time: 3.778929479420185
global classifier accuracy: 100.0
end Update
server_global_time: 139.71094960719347
only_train_time: 2088.094459615648

-------------Global Round number: 46-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9308
Averaged Test Accuracy (Prototype Model): 0.9302
Std Test Accuracy (Regular Model): 0.0461
Std Test Accuracy (Prototype Model): 0.0451
tobetrained:
[7, 6, 8, 1, 5, 0, 4, 2, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 8 begin training
Edge 1 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 2 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([12.0385, 13.8140, 11.3342, 12.2286, 12.3007, 14.0774, 11.3342, 14.2507,
        14.2853, 15.3681], device='cuda:0')
Server loss: 5.098049163818359
train global classifier
train glclassifier time: 3.6234103739261627
global classifier accuracy: 100.0
end Update
server_global_time: 142.71440722048283
only_train_time: 2132.8320252895355

-------------Global Round number: 47-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9307
Averaged Test Accuracy (Prototype Model): 0.9302
Std Test Accuracy (Regular Model): 0.0460
Std Test Accuracy (Prototype Model): 0.0454
tobetrained:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([12.1582, 13.9043, 11.4543, 12.3235, 12.4128, 14.1699, 11.4543, 14.3525,
        14.3913, 15.4648], device='cuda:0')
Server loss: 5.087836742401123
train global classifier
train glclassifier time: 3.5562581419944763
global classifier accuracy: 100.0
end Update
server_global_time: 145.67565761506557
only_train_time: 2176.9836010336876

-------------Global Round number: 48-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9310
Averaged Test Accuracy (Prototype Model): 0.9303
Std Test Accuracy (Regular Model): 0.0459
Std Test Accuracy (Prototype Model): 0.0454
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([12.2716, 13.9922, 11.5753, 12.4173, 12.5279, 14.2630, 11.5753, 14.4570,
        14.4842, 15.5499], device='cuda:0')
Server loss: 5.069579601287842
train global classifier
train glclassifier time: 3.6168047934770584
global classifier accuracy: 100.0
end Update
server_global_time: 148.71254811435938
only_train_time: 2221.6218001767993

-------------Global Round number: 49-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9307
Averaged Test Accuracy (Prototype Model): 0.9301
Std Test Accuracy (Regular Model): 0.0460
Std Test Accuracy (Prototype Model): 0.0454
tobetrained:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([12.3868, 14.0843, 11.6941, 12.5139, 12.6392, 14.3565, 11.6941, 14.5569,
        14.5922, 15.6508], device='cuda:0')
Server loss: 5.061550617218018
train global classifier
train glclassifier time: 3.592556446790695
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 151.68932732194662
only_train_time: 2265.7687421292067

-------------Global Round number: 50-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9308
Averaged Test Accuracy (Prototype Model): 0.9303
Std Test Accuracy (Regular Model): 0.0460
Std Test Accuracy (Prototype Model): 0.0455
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([12.4936, 14.1735, 11.8086, 12.6057, 12.7506, 14.4475, 11.8086, 14.6589,
        14.6880, 15.7392], device='cuda:0')
Server loss: 5.045005798339844
train global classifier
train glclassifier time: 3.6055836528539658
global classifier accuracy: 100.0
end Update
server_global_time: 154.67860870808363
only_train_time: 2310.5145408585668

-------------Global Round number: 51-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9308
Averaged Test Accuracy (Prototype Model): 0.9303
Std Test Accuracy (Regular Model): 0.0458
Std Test Accuracy (Prototype Model): 0.0454
tobetrained:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([12.6044, 14.2631, 11.9191, 12.7039, 12.8516, 14.5353, 11.9191, 14.7618,
        14.7891, 15.8306], device='cuda:0')
Server loss: 5.032788276672363
train global classifier
train glclassifier time: 3.570429876446724
global classifier accuracy: 100.0
end Update
server_global_time: 157.60887465626
only_train_time: 2354.591947413981

-------------Global Round number: 52-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9312
Averaged Test Accuracy (Prototype Model): 0.9306
Std Test Accuracy (Regular Model): 0.0455
Std Test Accuracy (Prototype Model): 0.0455
tobetrained:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([12.7139, 14.3466, 12.0362, 12.7921, 12.9596, 14.6218, 12.0362, 14.8610,
        14.8813, 15.9176], device='cuda:0')
Server loss: 5.017452239990234
train global classifier
train glclassifier time: 3.5658707842230797
global classifier accuracy: 100.0
end Update
server_global_time: 160.5657450929284
only_train_time: 2399.2033502981067

-------------Global Round number: 53-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9313
Averaged Test Accuracy (Prototype Model): 0.9303
Std Test Accuracy (Regular Model): 0.0456
Std Test Accuracy (Prototype Model): 0.0455
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 2, 4, 5, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 2, 4, 5, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([12.8171, 14.4329, 12.1507, 12.8837, 13.0632, 14.7109, 12.1507, 14.9570,
        14.9770, 16.0054], device='cuda:0')
Server loss: 5.004284381866455
train global classifier
train glclassifier time: 3.752145752310753
global classifier accuracy: 100.0
end Update
server_global_time: 163.50581584870815
only_train_time: 2443.5351171195507

-------------Global Round number: 54-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9317
Averaged Test Accuracy (Prototype Model): 0.9306
Std Test Accuracy (Regular Model): 0.0452
Std Test Accuracy (Prototype Model): 0.0457
tobetrained:
[7, 1, 6, 8, 0, 2, 4, 5, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([12.9074, 14.5154, 12.2481, 12.9499, 13.1568, 14.5173, 12.2481, 14.5173,
        15.0326, 15.9208], device='cuda:0')
Server loss: 4.992510795593262
train global classifier
train glclassifier time: 4.10716786980629
global classifier accuracy: 100.0
end Update
server_global_time: 166.53226827830076
only_train_time: 2487.41275498271

-------------Global Round number: 55-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9307
Averaged Test Accuracy (Prototype Model): 0.9298
Std Test Accuracy (Regular Model): 0.0452
Std Test Accuracy (Prototype Model): 0.0453
tobetrained:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([12.9976, 14.6008, 12.3512, 13.0288, 13.2548, 14.6062, 12.3512, 14.6116,
        15.1115, 16.0201], device='cuda:0')
Server loss: 4.9608941078186035
train global classifier
train glclassifier time: 3.7355824410915375
global classifier accuracy: 100.0
end Update
server_global_time: 169.57735877484083
only_train_time: 2532.1288801953197

-------------Global Round number: 56-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9311
Averaged Test Accuracy (Prototype Model): 0.9299
Std Test Accuracy (Regular Model): 0.0455
Std Test Accuracy (Prototype Model): 0.0454
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 8, 5, 4, 2, 9, 0, 1, 3]
aggregation_buffer:
[7, 6, 8, 5, 4, 2, 9, 0, 1, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([13.0706, 14.6602, 12.4443, 13.0985, 13.3314, 14.7572, 12.4443, 14.7919,
        15.2024, 16.1453], device='cuda:0')
Server loss: 4.963260650634766
train global classifier
train glclassifier time: 3.62124115973711
global classifier accuracy: 100.0
end Update
server_global_time: 172.55055078864098
only_train_time: 2579.266027621925

-------------Global Round number: 57-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9312
Averaged Test Accuracy (Prototype Model): 0.9302
Std Test Accuracy (Regular Model): 0.0459
Std Test Accuracy (Prototype Model): 0.0456
tobetrained:
[7, 6, 8, 5, 4, 2, 9, 0, 1, 3]
Edge 7 begin training
Edge 6 begin training
Edge 8 begin training
Edge 5 begin training
Edge 4 begin training
Edge 2 begin training
Edge 9 begin training
Edge 0 begin training
Edge 1 begin training
Edge 3 begin training
readyList:
[1, 6, 7, 5, 4, 8, 0, 9, 2, 3]
aggregation_buffer:
[1, 6, 7, 5, 4, 8, 0, 9, 2, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([13.1467, 14.7193, 12.5364, 13.1683, 13.4132, 14.8687, 12.5364, 14.9481,
        15.2771, 16.2589], device='cuda:0')
Server loss: 4.978179454803467
train global classifier
train glclassifier time: 4.036935806274414
global classifier accuracy: 100.0
end Update
server_global_time: 175.39894906431437
only_train_time: 2626.4063367396593

-------------Global Round number: 58-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9309
Averaged Test Accuracy (Prototype Model): 0.9301
Std Test Accuracy (Regular Model): 0.0461
Std Test Accuracy (Prototype Model): 0.0457
tobetrained:
[1, 6, 7, 5, 4, 8, 0, 9, 2, 3]
Edge 1 begin training
Edge 6 begin training
Edge 7 begin training
Edge 5 begin training
Edge 4 begin training
Edge 8 begin training
Edge 0 begin training
Edge 9 begin training
Edge 2 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 2, 8, 0, 5, 9, 4, 3]
aggregation_buffer:
[7, 1, 6, 2, 8, 0, 5, 9, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([13.2284, 14.7878, 12.6336, 13.2477, 13.4982, 14.9706, 12.6336, 15.0946,
        15.3607, 16.3372], device='cuda:0')
Server loss: 4.959591865539551
train global classifier
train glclassifier time: 3.59557144343853
global classifier accuracy: 100.0
end Update
server_global_time: 178.3625019043684
only_train_time: 2674.1558794528246

-------------Global Round number: 59-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9309
Averaged Test Accuracy (Prototype Model): 0.9304
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0459
tobetrained:
[7, 1, 6, 2, 8, 0, 5, 9, 4, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 2 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([13.3201, 14.8645, 12.7322, 13.3334, 13.5936, 15.0720, 12.7322, 15.2229,
        15.4503, 16.4185], device='cuda:0')
Server loss: 4.9405341148376465
train global classifier
train glclassifier time: 3.598323665559292
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 181.29718579351902
only_train_time: 2718.5841829031706

-------------Global Round number: 60-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9311
Averaged Test Accuracy (Prototype Model): 0.9305
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0456
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 0, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([13.4059, 14.9390, 12.8306, 13.4183, 13.6838, 15.1675, 12.8306, 15.3452,
        15.5375, 16.5025], device='cuda:0')
Server loss: 4.9287590980529785
train global classifier
train glclassifier time: 3.5743912160396576
global classifier accuracy: 100.0
end Update
server_global_time: 184.30082624405622
only_train_time: 2763.2253740504384

-------------Global Round number: 61-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9312
Averaged Test Accuracy (Prototype Model): 0.9306
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0459
tobetrained:
[7, 6, 1, 8, 0, 5, 2, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 4, 5, 2, 0, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 4, 5, 2, 0, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([13.4943, 15.0172, 12.9331, 13.5034, 13.7770, 15.2613, 12.9331, 15.4633,
        15.6252, 16.5862], device='cuda:0')
Server loss: 4.915757179260254
train global classifier
train glclassifier time: 3.7067709863185883
global classifier accuracy: 100.0
end Update
server_global_time: 187.29314835369587
only_train_time: 2808.1011166498065

-------------Global Round number: 62-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9314
Averaged Test Accuracy (Prototype Model): 0.9307
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0458
tobetrained:
[7, 1, 6, 8, 4, 5, 2, 0, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 4 begin training
Edge 5 begin training
Edge 2 begin training
Edge 0 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 5, 2, 0, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 5, 2, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([13.5899, 15.0958, 13.0359, 13.5905, 13.8747, 15.3567, 13.0359, 15.5751,
        15.7180, 16.6720], device='cuda:0')
Server loss: 4.908411026000977
train global classifier
train glclassifier time: 3.6886172145605087
global classifier accuracy: 100.0
end Update
server_global_time: 190.28993574529886
only_train_time: 2851.921800941229

-------------Global Round number: 63-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9314
Averaged Test Accuracy (Prototype Model): 0.9306
Std Test Accuracy (Regular Model): 0.0462
Std Test Accuracy (Prototype Model): 0.0459
tobetrained:
[7, 1, 6, 8, 5, 2, 0, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 5 begin training
Edge 2 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([13.6783, 15.1806, 13.1337, 13.6783, 13.9738, 15.4498, 13.1337, 15.6849,
        15.8128, 16.7628], device='cuda:0')
Server loss: 4.895216941833496
train global classifier
train glclassifier time: 3.619808681309223
global classifier accuracy: 100.0
end Update
server_global_time: 193.24327532947063
only_train_time: 2896.1336900293827

-------------Global Round number: 64-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9315
Averaged Test Accuracy (Prototype Model): 0.9306
Std Test Accuracy (Regular Model): 0.0460
Std Test Accuracy (Prototype Model): 0.0459
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 5, 2, 9, 4, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 5, 2, 9, 4, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([13.6995, 15.2060, 13.2244, 13.6995, 14.0535, 14.8542, 13.2244, 15.2560,
        15.6146, 16.3330], device='cuda:0')
Server loss: 4.571573734283447
train global classifier
train glclassifier time: 3.689336895942688
global classifier accuracy: 100.0
end Update
server_global_time: 196.18904304504395
only_train_time: 2940.2938128858805

-------------Global Round number: 65-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9309
Averaged Test Accuracy (Prototype Model): 0.9217
Std Test Accuracy (Regular Model): 0.0456
Std Test Accuracy (Prototype Model): 0.0678
tobetrained:
[7, 1, 6, 8, 0, 5, 2, 9, 4, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 6, 0, 1, 8, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 0, 1, 8, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([13.7694, 15.2781, 13.3250, 13.7694, 14.1442, 14.7446, 13.3250, 15.1763,
        15.7297, 16.2014], device='cuda:0')
Server loss: 4.382676124572754
train global classifier
train glclassifier time: 3.5369999408721924
global classifier accuracy: 100.0
end Update
server_global_time: 199.21665584295988
only_train_time: 2984.724624186754

-------------Global Round number: 66-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9309
Averaged Test Accuracy (Prototype Model): 0.9275
Std Test Accuracy (Regular Model): 0.0461
Std Test Accuracy (Prototype Model): 0.0481
tobetrained:
[7, 6, 0, 1, 8, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 0 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([13.8147, 15.3288, 13.3975, 13.8147, 14.2089, 14.6875, 13.3975, 15.1449,
        15.7355, 16.1326], device='cuda:0')
Server loss: 4.265481472015381
train global classifier
train glclassifier time: 3.7897939905524254
global classifier accuracy: 100.0
end Update
server_global_time: 202.2054505199194
only_train_time: 3029.0623456165195

-------------Global Round number: 67-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9311
Averaged Test Accuracy (Prototype Model): 0.9289
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0464
tobetrained:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([13.8551, 15.3708, 13.4610, 13.8551, 14.2669, 14.6709, 13.4610, 15.1443,
        15.7051, 16.1042], device='cuda:0')
Server loss: 4.192261219024658
train global classifier
train glclassifier time: 3.588907651603222
global classifier accuracy: 100.0
end Update
server_global_time: 205.21442335098982
only_train_time: 3073.7429346442223

-------------Global Round number: 68-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9312
Averaged Test Accuracy (Prototype Model): 0.9297
Std Test Accuracy (Regular Model): 0.0461
Std Test Accuracy (Prototype Model): 0.0460
tobetrained:
[7, 6, 1, 8, 0, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 2, 4, 5, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 2, 4, 5, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([13.9059, 15.4139, 13.5293, 13.9059, 14.3291, 14.6816, 13.5293, 15.1663,
        15.7038, 16.1042], device='cuda:0')
Server loss: 4.1362175941467285
train global classifier
train glclassifier time: 3.5130019411444664
global classifier accuracy: 100.0
end Update
server_global_time: 208.14272312819958
only_train_time: 3118.046916410327

-------------Global Round number: 69-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9313
Averaged Test Accuracy (Prototype Model): 0.9303
Std Test Accuracy (Regular Model): 0.0459
Std Test Accuracy (Prototype Model): 0.0459
tobetrained:
[7, 1, 6, 8, 0, 2, 4, 5, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([13.9554, 15.4575, 13.5961, 13.9554, 14.3847, 14.7111, 13.5961, 15.2029,
        15.7124, 16.1128], device='cuda:0')
Server loss: 4.092518329620361
train global classifier
train glclassifier time: 3.5957240760326385
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 211.0806764215231
only_train_time: 3162.8118401393294

-------------Global Round number: 70-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9311
Averaged Test Accuracy (Prototype Model): 0.9303
Std Test Accuracy (Regular Model): 0.0457
Std Test Accuracy (Prototype Model): 0.0461
tobetrained:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([14.0062, 15.5072, 13.6645, 14.0062, 14.4444, 14.7554, 13.6645, 15.2536,
        15.7395, 16.1414], device='cuda:0')
Server loss: 4.060083866119385
train global classifier
train glclassifier time: 3.683232143521309
global classifier accuracy: 100.0
end Update
server_global_time: 214.05379988998175
only_train_time: 3207.562751546502

-------------Global Round number: 71-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9313
Averaged Test Accuracy (Prototype Model): 0.9305
Std Test Accuracy (Regular Model): 0.0460
Std Test Accuracy (Prototype Model): 0.0460
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([14.0605, 15.5566, 13.7373, 14.0605, 14.5054, 14.8061, 13.7373, 15.3076,
        15.7658, 16.1793], device='cuda:0')
Server loss: 4.036318778991699
train global classifier
train glclassifier time: 3.6395589783787727
global classifier accuracy: 100.0
end Update
server_global_time: 216.98566561937332
only_train_time: 3252.092854820192

-------------Global Round number: 72-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9313
Averaged Test Accuracy (Prototype Model): 0.9305
Std Test Accuracy (Regular Model): 0.0459
Std Test Accuracy (Prototype Model): 0.0462
tobetrained:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 4, 2, 5, 0, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 4, 2, 5, 0, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([14.1220, 15.6067, 13.8110, 14.1220, 14.5718, 14.8673, 13.8110, 15.3693,
        15.8056, 16.2213], device='cuda:0')
Server loss: 4.013465881347656
train global classifier
train glclassifier time: 3.6566553935408592
global classifier accuracy: 100.0
end Update
server_global_time: 219.92033132910728
only_train_time: 3296.4541007578373

-------------Global Round number: 73-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9311
Averaged Test Accuracy (Prototype Model): 0.9307
Std Test Accuracy (Regular Model): 0.0458
Std Test Accuracy (Prototype Model): 0.0459
tobetrained:
[7, 1, 6, 8, 4, 2, 5, 0, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 4 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 4, 5, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 4, 5, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([14.1802, 15.6565, 13.8809, 14.1802, 14.6380, 14.9318, 13.8809, 15.4344,
        15.8509, 16.2702], device='cuda:0')
Server loss: 3.995572566986084
train global classifier
train glclassifier time: 3.5528345853090286
global classifier accuracy: 100.0
end Update
server_global_time: 222.87037977576256
only_train_time: 3341.100174970925

-------------Global Round number: 74-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9313
Averaged Test Accuracy (Prototype Model): 0.9307
Std Test Accuracy (Regular Model): 0.0458
Std Test Accuracy (Prototype Model): 0.0459
tobetrained:
[7, 1, 6, 8, 2, 0, 4, 5, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([14.2434, 15.7101, 13.9533, 14.2434, 14.7019, 15.0001, 13.9533, 15.5002,
        15.8940, 16.3141], device='cuda:0')
Server loss: 3.9770853519439697
train global classifier
train glclassifier time: 3.6729899868369102
global classifier accuracy: 100.0
end Update
server_global_time: 225.89809557050467
only_train_time: 3385.637149617076

-------------Global Round number: 75-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9313
Averaged Test Accuracy (Prototype Model): 0.9307
Std Test Accuracy (Regular Model): 0.0459
Std Test Accuracy (Prototype Model): 0.0458
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([14.3062, 15.7666, 14.0230, 14.3062, 14.7699, 15.0738, 14.0230, 15.5737,
        15.9390, 16.3670], device='cuda:0')
Server loss: 3.9636385440826416
train global classifier
train glclassifier time: 3.627967819571495
global classifier accuracy: 100.0
end Update
server_global_time: 228.8918398320675
only_train_time: 3430.319456845522

-------------Global Round number: 76-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9312
Averaged Test Accuracy (Prototype Model): 0.9310
Std Test Accuracy (Regular Model): 0.0461
Std Test Accuracy (Prototype Model): 0.0459
tobetrained:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([14.3748, 15.8263, 14.0967, 14.3748, 14.8402, 15.1490, 14.0967, 15.6479,
        15.9899, 16.4156], device='cuda:0')
Server loss: 3.94175124168396
train global classifier
train glclassifier time: 3.5974643602967262
global classifier accuracy: 100.0
end Update
server_global_time: 231.8841129988432
only_train_time: 3474.7959754019976

-------------Global Round number: 77-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9314
Averaged Test Accuracy (Prototype Model): 0.9311
Std Test Accuracy (Regular Model): 0.0461
Std Test Accuracy (Prototype Model): 0.0457
tobetrained:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([14.4389, 15.8831, 14.1743, 14.4389, 14.9094, 15.2212, 14.1743, 15.7154,
        16.0372, 16.4727], device='cuda:0')
Server loss: 3.932206630706787
train global classifier
train glclassifier time: 3.5957759991288185
global classifier accuracy: 100.0
end Update
server_global_time: 234.86658629775047
only_train_time: 3519.045775845647

-------------Global Round number: 78-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9313
Averaged Test Accuracy (Prototype Model): 0.9307
Std Test Accuracy (Regular Model): 0.0461
Std Test Accuracy (Prototype Model): 0.0457
tobetrained:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 8, 1, 6, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 8, 1, 6, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([14.5022, 15.9387, 14.2547, 14.5022, 14.9821, 15.2969, 14.2547, 15.7876,
        16.0933, 16.5357], device='cuda:0')
Server loss: 3.9211151599884033
train global classifier
train glclassifier time: 3.6133997589349747
global classifier accuracy: 100.0
end Update
server_global_time: 237.81804081052542
only_train_time: 3562.9776968955994

-------------Global Round number: 79-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9313
Averaged Test Accuracy (Prototype Model): 0.9309
Std Test Accuracy (Regular Model): 0.0460
Std Test Accuracy (Prototype Model): 0.0458
tobetrained:
[7, 8, 1, 6, 0, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 8 begin training
Edge 1 begin training
Edge 6 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([14.3172, 15.9418, 13.9334, 14.4867, 14.7786, 15.0291, 13.9334, 15.8297,
        15.0291, 15.8568], device='cuda:0')
Server loss: 3.710222005844116
train global classifier
train glclassifier time: 3.6752002462744713
global classifier accuracy: 99.9975
Number of samples: 324
end Update
server_global_time: 240.78569850325584
only_train_time: 3607.5142931342125

-------------Global Round number: 80-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9240
Averaged Test Accuracy (Prototype Model): 0.9178
Std Test Accuracy (Regular Model): 0.0578
Std Test Accuracy (Prototype Model): 0.0810
tobetrained:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 5, 4, 2, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 5, 4, 2, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([14.3816, 15.9921, 14.0444, 14.5182, 14.8222, 15.3516, 14.0444, 15.8604,
        15.3836, 16.1404], device='cuda:0')
Server loss: 3.7622740268707275
train global classifier
train glclassifier time: 3.7617587596178055
global classifier accuracy: 100.0
end Update
server_global_time: 243.87413631379604
only_train_time: 3654.1060954779387

-------------Global Round number: 81-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9310
Averaged Test Accuracy (Prototype Model): 0.9305
Std Test Accuracy (Regular Model): 0.0462
Std Test Accuracy (Prototype Model): 0.0460
tobetrained:
[7, 1, 6, 8, 0, 5, 4, 2, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 2 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 4, 5, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 4, 5, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([14.4348, 16.0000, 14.0917, 14.5179, 14.8674, 15.3643, 14.0917, 15.8591,
        15.5537, 16.1987], device='cuda:0')
Server loss: 3.7617132663726807
train global classifier
train glclassifier time: 4.0782680213451385
global classifier accuracy: 100.0
end Update
server_global_time: 246.94281470775604
only_train_time: 3699.6097562387586

-------------Global Round number: 82-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9313
Averaged Test Accuracy (Prototype Model): 0.9311
Std Test Accuracy (Regular Model): 0.0461
Std Test Accuracy (Prototype Model): 0.0456
tobetrained:
[7, 6, 1, 8, 2, 0, 4, 5, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 8, 1, 6, 0, 2, 4, 5, 9, 3]
aggregation_buffer:
[7, 8, 1, 6, 0, 2, 4, 5, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([14.5056, 16.0243, 14.1578, 14.5415, 14.9369, 15.4013, 14.1578, 15.8833,
        15.6921, 16.2745], device='cuda:0')
Server loss: 3.759855031967163
train global classifier
train glclassifier time: 3.652252718806267
global classifier accuracy: 100.0
end Update
server_global_time: 249.89123640209436
only_train_time: 3744.339821703732

-------------Global Round number: 83-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9313
Averaged Test Accuracy (Prototype Model): 0.9315
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0456
tobetrained:
[7, 8, 1, 6, 0, 2, 4, 5, 9, 3]
Edge 7 begin training
Edge 8 begin training
Edge 1 begin training
Edge 6 begin training
Edge 0 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([14.5803, 16.0570, 14.2420, 14.5803, 15.0253, 15.4553, 14.2420, 15.9247,
        15.8071, 16.3532], device='cuda:0')
Server loss: 3.7637741565704346
train global classifier
train glclassifier time: 3.6805277317762375
global classifier accuracy: 100.0
end Update
server_global_time: 252.87482882291079
only_train_time: 3788.8390703201294

-------------Global Round number: 84-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9313
Averaged Test Accuracy (Prototype Model): 0.9313
Std Test Accuracy (Regular Model): 0.0466
Std Test Accuracy (Prototype Model): 0.0456
tobetrained:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([14.6302, 16.0894, 14.3323, 14.6302, 15.1155, 15.5160, 14.3323, 15.9755,
        15.9109, 16.4313], device='cuda:0')
Server loss: 3.7628679275512695
train global classifier
train glclassifier time: 3.5852188989520073
global classifier accuracy: 100.0
end Update
server_global_time: 255.82061982899904
only_train_time: 3833.2413957864046

-------------Global Round number: 85-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9315
Averaged Test Accuracy (Prototype Model): 0.9314
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0456
tobetrained:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([14.6845, 16.1314, 14.4184, 14.6845, 15.1822, 15.5839, 14.4184, 16.0384,
        15.9856, 16.5078], device='cuda:0')
Server loss: 3.771360158920288
train global classifier
train glclassifier time: 3.5589496195316315
global classifier accuracy: 100.0
end Update
server_global_time: 258.75903207063675
only_train_time: 3877.678083911538

-------------Global Round number: 86-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9312
Averaged Test Accuracy (Prototype Model): 0.9313
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0457
tobetrained:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([14.7530, 16.1835, 14.5046, 14.7530, 15.2453, 15.6620, 14.5046, 16.1054,
        16.0870, 16.5926], device='cuda:0')
Server loss: 3.7667934894561768
train global classifier
train glclassifier time: 3.678790107369423
global classifier accuracy: 100.0
end Update
server_global_time: 261.7485577017069
only_train_time: 3922.0865364819765

-------------Global Round number: 87-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9318
Averaged Test Accuracy (Prototype Model): 0.9318
Std Test Accuracy (Regular Model): 0.0462
Std Test Accuracy (Prototype Model): 0.0454
tobetrained:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([14.8215, 16.2359, 14.5836, 14.8215, 15.3175, 15.7427, 14.5836, 16.1771,
        16.1790, 16.6720], device='cuda:0')
Server loss: 3.7637643814086914
train global classifier
train glclassifier time: 3.5583821311593056
global classifier accuracy: 100.0
end Update
server_global_time: 264.71821758151054
only_train_time: 3966.671174764633

-------------Global Round number: 88-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9317
Averaged Test Accuracy (Prototype Model): 0.9313
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0460
tobetrained:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([14.8886, 16.2949, 14.6744, 14.8886, 15.3864, 15.8250, 14.6744, 16.2515,
        16.2648, 16.7509], device='cuda:0')
Server loss: 3.7686808109283447
train global classifier
train glclassifier time: 3.622967042028904
global classifier accuracy: 100.0
end Update
server_global_time: 267.7306040748954
only_train_time: 4011.374637886882

-------------Global Round number: 89-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9317
Averaged Test Accuracy (Prototype Model): 0.9313
Std Test Accuracy (Regular Model): 0.0465
Std Test Accuracy (Prototype Model): 0.0462
tobetrained:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([14.9631, 16.3610, 14.7651, 14.9631, 15.4639, 15.9140, 14.7651, 16.3332,
        16.3466, 16.8312], device='cuda:0')
Server loss: 3.7671663761138916
train global classifier
train glclassifier time: 3.585740841925144
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 270.7331683039665
only_train_time: 4055.914019368589

-------------Global Round number: 90-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9318
Averaged Test Accuracy (Prototype Model): 0.9314
Std Test Accuracy (Regular Model): 0.0464
Std Test Accuracy (Prototype Model): 0.0462
tobetrained:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([15.0380, 16.4231, 14.8432, 15.0380, 15.5337, 16.0059, 14.8432, 16.4185,
        16.4369, 16.9161], device='cuda:0')
Server loss: 3.7672548294067383
train global classifier
train glclassifier time: 3.528327986598015
global classifier accuracy: 100.0
end Update
server_global_time: 273.69417398422956
only_train_time: 4100.583321064711

-------------Global Round number: 91-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9318
Averaged Test Accuracy (Prototype Model): 0.9312
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0462
tobetrained:
[7, 1, 6, 8, 0, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 0, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([14.6267, 16.1344, 14.7800, 14.6267, 15.3454, 15.6849, 14.8701, 16.4113,
        16.4702, 16.8721], device='cuda:0')
Server loss: 4.018016338348389
train global classifier
train glclassifier time: 3.5907751098275185
global classifier accuracy: 100.0
end Update
server_global_time: 276.63603093475103
only_train_time: 4145.35449180007

-------------Global Round number: 92-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9305
Averaged Test Accuracy (Prototype Model): 0.9286
Std Test Accuracy (Regular Model): 0.0485
Std Test Accuracy (Prototype Model): 0.0525
tobetrained:
[7, 6, 1, 8, 0, 5, 2, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([14.6043, 16.1397, 14.7309, 14.6043, 15.4194, 15.6715, 14.9208, 16.4743,
        16.5399, 16.9343], device='cuda:0')
Server loss: 3.943746566772461
train global classifier
train glclassifier time: 3.5830782502889633
global classifier accuracy: 100.0
end Update
server_global_time: 279.5819994881749
only_train_time: 4189.746360346675

-------------Global Round number: 93-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9313
Averaged Test Accuracy (Prototype Model): 0.9306
Std Test Accuracy (Regular Model): 0.0468
Std Test Accuracy (Prototype Model): 0.0470
tobetrained:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([14.7155, 16.2259, 14.8292, 14.7155, 15.5194, 15.7874, 14.9694, 16.5527,
        16.6116, 17.0131], device='cuda:0')
Server loss: 3.8914854526519775
train global classifier
train glclassifier time: 3.6312860921025276
global classifier accuracy: 100.0
end Update
server_global_time: 282.5858628898859
only_train_time: 4234.297975383699

-------------Global Round number: 94-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9317
Averaged Test Accuracy (Prototype Model): 0.9308
Std Test Accuracy (Regular Model): 0.0463
Std Test Accuracy (Prototype Model): 0.0464
tobetrained:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([14.8489, 16.3653, 14.9891, 14.8489, 15.5893, 15.9634, 15.0452, 16.6278,
        16.6854, 17.0924], device='cuda:0')
Server loss: 3.884443759918213
train global classifier
train glclassifier time: 3.583753913640976
global classifier accuracy: 100.0
end Update
server_global_time: 285.5166950151324
only_train_time: 4278.7840623781085

-------------Global Round number: 95-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9319
Averaged Test Accuracy (Prototype Model): 0.9313
Std Test Accuracy (Regular Model): 0.0460
Std Test Accuracy (Prototype Model): 0.0460
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([14.9926, 16.4800, 15.1268, 14.9926, 15.6978, 16.1197, 15.1396, 16.7114,
        16.7648, 17.1749], device='cuda:0')
Server loss: 3.8475184440612793
train global classifier
train glclassifier time: 3.5914617627859116
global classifier accuracy: 100.0
end Update
server_global_time: 288.5052927136421
only_train_time: 4323.259827665985

-------------Global Round number: 96-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9321
Averaged Test Accuracy (Prototype Model): 0.9314
Std Test Accuracy (Regular Model): 0.0459
Std Test Accuracy (Prototype Model): 0.0457
tobetrained:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([15.1119, 16.5745, 15.2261, 15.1119, 15.7906, 16.2554, 15.2261, 16.7951,
        16.8404, 17.2552], device='cuda:0')
Server loss: 3.8269906044006348
train global classifier
train glclassifier time: 3.7086930721998215
global classifier accuracy: 100.0
end Update
server_global_time: 291.4696090146899
only_train_time: 4367.937548071146

-------------Global Round number: 97-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9321
Averaged Test Accuracy (Prototype Model): 0.9314
Std Test Accuracy (Regular Model): 0.0461
Std Test Accuracy (Prototype Model): 0.0457
tobetrained:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 4, 2, 5, 0, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 4, 2, 5, 0, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([15.2225, 16.6565, 15.3185, 15.2225, 15.8788, 16.3766, 15.3185, 16.8783,
        16.9185, 17.3350], device='cuda:0')
Server loss: 3.8088338375091553
train global classifier
train glclassifier time: 3.6319815516471863
global classifier accuracy: 100.0
end Update
server_global_time: 294.4801649451256
only_train_time: 4412.350978419185

-------------Global Round number: 98-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9325
Averaged Test Accuracy (Prototype Model): 0.9320
Std Test Accuracy (Regular Model): 0.0455
Std Test Accuracy (Prototype Model): 0.0452
tobetrained:
[7, 1, 6, 8, 4, 2, 5, 0, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 4 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([15.3155, 16.7325, 15.3943, 15.3155, 15.9682, 16.4883, 15.3943, 16.9604,
        16.9948, 17.4107], device='cuda:0')
Server loss: 3.8001959323883057
train global classifier
train glclassifier time: 3.5840528905391693
global classifier accuracy: 100.0
end Update
server_global_time: 297.4459631368518
only_train_time: 4456.902362436056

-------------Global Round number: 99-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9322
Averaged Test Accuracy (Prototype Model): 0.9317
Std Test Accuracy (Regular Model): 0.0460
Std Test Accuracy (Prototype Model): 0.0457
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([15.4139, 16.8088, 15.4610, 15.4139, 16.0542, 16.5979, 15.4610, 17.0434,
        17.0699, 17.4887], device='cuda:0')
Server loss: 3.7895445823669434
train global classifier
train glclassifier time: 3.5292600616812706
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 300.40313855558634
only_train_time: 4501.284848563373

-------------Global Round number: 100-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9323
Averaged Test Accuracy (Prototype Model): 0.9322
Std Test Accuracy (Regular Model): 0.0461
Std Test Accuracy (Prototype Model): 0.0452
tobetrained:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([15.5024, 16.8780, 15.5532, 15.5024, 16.1469, 16.7061, 15.5532, 17.1278,
        17.1504, 17.5703], device='cuda:0')
Server loss: 3.788658618927002
train global classifier
train glclassifier time: 3.5953784212470055
global classifier accuracy: 100.0
end Update
server_global_time: 303.3736527338624
only_train_time: 4546.011704266071

-------------Global Round number: 101-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9324
Averaged Test Accuracy (Prototype Model): 0.9320
Std Test Accuracy (Regular Model): 0.0457
Std Test Accuracy (Prototype Model): 0.0454
tobetrained:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([15.5605, 16.2867, 15.1167, 15.5605, 15.1167, 16.7730, 15.4130, 17.2005,
        16.9396, 17.6365], device='cuda:0')
Server loss: 3.982891082763672
train global classifier
train glclassifier time: 3.9163136184215546
global classifier accuracy: 100.0
end Update
server_global_time: 306.3176150098443
only_train_time: 4590.517825201154

-------------Global Round number: 102-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9318
Averaged Test Accuracy (Prototype Model): 0.9306
Std Test Accuracy (Regular Model): 0.0455
Std Test Accuracy (Prototype Model): 0.0457
tobetrained:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([15.6439, 16.0238, 14.8393, 15.5134, 14.8393, 16.8839, 15.1590, 17.2913,
        16.7665, 17.7289], device='cuda:0')
Server loss: 4.048948764801025
train global classifier
train glclassifier time: 3.57925733178854
global classifier accuracy: 100.0
end Update
server_global_time: 309.27592208236456
only_train_time: 4634.886652521789

-------------Global Round number: 103-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9327
Averaged Test Accuracy (Prototype Model): 0.9314
Std Test Accuracy (Regular Model): 0.0457
Std Test Accuracy (Prototype Model): 0.0444
tobetrained:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 5, 0, 2, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 5, 0, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([15.7033, 15.8978, 14.7811, 15.4600, 14.7811, 16.9731, 15.0994, 17.3640,
        16.6972, 17.7992], device='cuda:0')
Server loss: 4.080928325653076
train global classifier
train glclassifier time: 4.510801926255226
global classifier accuracy: 100.0
end Update
server_global_time: 312.2075277492404
only_train_time: 4679.171779997647

-------------Global Round number: 104-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9333
Averaged Test Accuracy (Prototype Model): 0.9315
Std Test Accuracy (Regular Model): 0.0453
Std Test Accuracy (Prototype Model): 0.0441
tobetrained:
[7, 6, 1, 8, 5, 0, 2, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 5 begin training
Edge 0 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 8, 6, 1, 0, 2, 4, 5, 9, 3]
aggregation_buffer:
[7, 8, 6, 1, 0, 2, 4, 5, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([15.7563, 15.8544, 14.7845, 15.4723, 14.7845, 17.0611, 15.1288, 17.4371,
        16.7249, 17.8669], device='cuda:0')
Server loss: 4.095932483673096
train global classifier
train glclassifier time: 3.5235630497336388
global classifier accuracy: 100.0
end Update
server_global_time: 315.22223327308893
only_train_time: 4723.361180894077

-------------Global Round number: 105-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9327
Averaged Test Accuracy (Prototype Model): 0.9311
Std Test Accuracy (Regular Model): 0.0455
Std Test Accuracy (Prototype Model): 0.0448
tobetrained:
[7, 8, 6, 1, 0, 2, 4, 5, 9, 3]
Edge 7 begin training
Edge 8 begin training
Edge 6 begin training
Edge 1 begin training
Edge 0 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([15.6814, 15.8696, 14.7177, 15.4043, 14.7177, 17.1358, 15.1917, 17.2556,
        16.7772, 17.9329], device='cuda:0')
Server loss: 4.15681266784668
train global classifier
train glclassifier time: 3.5703663155436516
global classifier accuracy: 100.0
end Update
server_global_time: 318.2150556743145
only_train_time: 4767.87130202353

-------------Global Round number: 106-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9327
Averaged Test Accuracy (Prototype Model): 0.9310
Std Test Accuracy (Regular Model): 0.0447
Std Test Accuracy (Prototype Model): 0.0442
tobetrained:
[7, 6, 1, 8, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([15.7502, 15.9040, 14.7604, 15.4755, 14.7604, 17.2176, 15.2681, 17.2799,
        16.8444, 18.0033], device='cuda:0')
Server loss: 4.169478416442871
train global classifier
train glclassifier time: 3.626506209373474
global classifier accuracy: 100.0
end Update
server_global_time: 321.21019327640533
only_train_time: 4812.094360344112

-------------Global Round number: 107-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9317
Averaged Test Accuracy (Prototype Model): 0.9306
Std Test Accuracy (Regular Model): 0.0450
Std Test Accuracy (Prototype Model): 0.0440
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 5, 2, 0, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 5, 2, 0, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([15.6777, 15.9128, 14.8110, 15.5275, 14.8110, 17.1307, 15.0814, 17.3500,
        16.9125, 18.0185], device='cuda:0')
Server loss: 4.213115215301514
train global classifier
train glclassifier time: 3.5715056359767914
global classifier accuracy: 100.0
end Update
server_global_time: 324.2246404439211
only_train_time: 4856.27907859534

-------------Global Round number: 108-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9328
Averaged Test Accuracy (Prototype Model): 0.9309
Std Test Accuracy (Regular Model): 0.0448
Std Test Accuracy (Prototype Model): 0.0450
tobetrained:
[7, 6, 1, 8, 5, 2, 0, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 5 begin training
Edge 2 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([15.6240, 15.9665, 14.8830, 15.6131, 14.8830, 17.1908, 15.1373, 17.4661,
        16.9752, 18.0868], device='cuda:0')
Server loss: 4.22059440612793
train global classifier
train glclassifier time: 3.5970455706119537
global classifier accuracy: 100.0
end Update
server_global_time: 327.20957040786743
only_train_time: 4900.49585776031

-------------Global Round number: 109-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9326
Averaged Test Accuracy (Prototype Model): 0.9314
Std Test Accuracy (Regular Model): 0.0461
Std Test Accuracy (Prototype Model): 0.0451
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 2, 4, 5, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 2, 4, 5, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([15.6842, 16.1237, 15.0702, 15.7785, 15.0702, 17.2727, 15.3312, 17.5507,
        17.1006, 18.1595], device='cuda:0')
Server loss: 4.20102596282959
train global classifier
train glclassifier time: 3.638372704386711
global classifier accuracy: 100.0
Number of samples: 324
end Update
server_global_time: 330.1936395317316
only_train_time: 4944.97164991498

-------------Global Round number: 110-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9323
Averaged Test Accuracy (Prototype Model): 0.9315
Std Test Accuracy (Regular Model): 0.0453
Std Test Accuracy (Prototype Model): 0.0452
tobetrained:
[7, 1, 6, 8, 0, 2, 4, 5, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([15.7873, 16.2518, 15.2500, 15.8570, 15.2500, 17.3596, 15.5319, 17.6300,
        17.2100, 18.2213], device='cuda:0')
Server loss: 4.180479049682617
train global classifier
train glclassifier time: 3.527624785900116
global classifier accuracy: 100.0
end Update
server_global_time: 333.135619468987
only_train_time: 4989.350190937519

-------------Global Round number: 111-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9323
Averaged Test Accuracy (Prototype Model): 0.9318
Std Test Accuracy (Regular Model): 0.0458
Std Test Accuracy (Prototype Model): 0.0453
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([15.9049, 16.3563, 15.3934, 15.9384, 15.3934, 17.4585, 15.7188, 17.7071,
        17.3155, 18.2882], device='cuda:0')
Server loss: 4.148653507232666
train global classifier
train glclassifier time: 3.597838908433914
global classifier accuracy: 100.0
end Update
server_global_time: 336.1225826367736
only_train_time: 5033.633303441107

-------------Global Round number: 112-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9319
Averaged Test Accuracy (Prototype Model): 0.9318
Std Test Accuracy (Regular Model): 0.0459
Std Test Accuracy (Prototype Model): 0.0450
tobetrained:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 0, 8, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 0, 8, 2, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([16.0227, 16.4541, 15.5298, 16.0227, 15.5298, 17.5609, 15.8917, 17.7918,
        17.4031, 18.3557], device='cuda:0')
Server loss: 4.1256794929504395
train global classifier
train glclassifier time: 3.6650713086128235
global classifier accuracy: 100.0
end Update
server_global_time: 339.126455694437
only_train_time: 5077.96665982157

-------------Global Round number: 113-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9324
Averaged Test Accuracy (Prototype Model): 0.9321
Std Test Accuracy (Regular Model): 0.0462
Std Test Accuracy (Prototype Model): 0.0454
tobetrained:
[7, 6, 1, 0, 8, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 0 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([16.0948, 16.5581, 15.6590, 16.0948, 15.6590, 17.6615, 16.0449, 17.8659,
        17.5000, 18.4214], device='cuda:0')
Server loss: 4.104796886444092
train global classifier
train glclassifier time: 3.659481294453144
global classifier accuracy: 100.0
end Update
server_global_time: 342.1295129582286
only_train_time: 5122.288137346506

-------------Global Round number: 114-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9325
Averaged Test Accuracy (Prototype Model): 0.9322
Std Test Accuracy (Regular Model): 0.0456
Std Test Accuracy (Prototype Model): 0.0448
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([16.1792, 16.6640, 15.7854, 16.1792, 15.7854, 17.7641, 16.1898, 17.9620,
        17.6122, 18.4960], device='cuda:0')
Server loss: 4.0855512619018555
train global classifier
train glclassifier time: 3.6122492253780365
global classifier accuracy: 100.0
end Update
server_global_time: 345.11600682139397
only_train_time: 5166.719443149865

-------------Global Round number: 115-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9327
Averaged Test Accuracy (Prototype Model): 0.9325
Std Test Accuracy (Regular Model): 0.0455
Std Test Accuracy (Prototype Model): 0.0450
tobetrained:
[7, 6, 1, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([16.2507, 16.7676, 15.8974, 16.2507, 15.8974, 17.8565, 16.3103, 18.0292,
        17.7049, 18.5695], device='cuda:0')
Server loss: 4.079188346862793
train global classifier
train glclassifier time: 3.6635148152709007
global classifier accuracy: 100.0
end Update
server_global_time: 348.11965369433165
only_train_time: 5211.306281983852

-------------Global Round number: 116-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9328
Averaged Test Accuracy (Prototype Model): 0.9326
Std Test Accuracy (Regular Model): 0.0451
Std Test Accuracy (Prototype Model): 0.0449
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 5, 4, 2, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 5, 4, 2, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([16.3399, 16.8764, 16.0354, 16.3399, 16.0354, 17.9624, 16.4419, 18.1346,
        17.8163, 18.6404], device='cuda:0')
Server loss: 4.05466365814209
train global classifier
train glclassifier time: 3.549335964024067
global classifier accuracy: 100.0
end Update
server_global_time: 351.0618161857128
only_train_time: 5255.9595128670335

-------------Global Round number: 117-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9330
Averaged Test Accuracy (Prototype Model): 0.9326
Std Test Accuracy (Regular Model): 0.0454
Std Test Accuracy (Prototype Model): 0.0452
tobetrained:
[7, 1, 6, 8, 0, 5, 4, 2, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 2 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 0, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([16.4207, 16.9713, 16.1507, 16.4207, 16.1507, 18.0645, 16.5474, 18.2204,
        17.9101, 18.7233], device='cuda:0')
Server loss: 4.052740097045898
train global classifier
train glclassifier time: 3.6243169233202934
global classifier accuracy: 100.0
end Update
server_global_time: 354.0063559859991
only_train_time: 5300.467927843332

-------------Global Round number: 118-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9326
Averaged Test Accuracy (Prototype Model): 0.9325
Std Test Accuracy (Regular Model): 0.0454
Std Test Accuracy (Prototype Model): 0.0452
tobetrained:
[7, 6, 1, 8, 0, 5, 2, 4, 9, 3]
Edge 7 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 8, 1, 6, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 8, 1, 6, 0, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([16.4973, 17.0606, 16.2588, 16.4973, 16.2588, 18.1681, 16.6496, 18.3101,
        17.9998, 18.8163], device='cuda:0')
Server loss: nan
train global classifier
train glclassifier time: 3.5861961618065834
global classifier accuracy: 100.0
end Update
server_global_time: 357.01060362905264
only_train_time: 5343.941584125161

-------------Global Round number: 119-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9324
Averaged Test Accuracy (Prototype Model): 0.0975
Std Test Accuracy (Regular Model): 0.0458
Std Test Accuracy (Prototype Model): 0.1431
tobetrained:
[7, 8, 1, 6, 0, 5, 2, 4, 9, 3]
Edge 7 begin training
Edge 8 begin training
Edge 1 begin training
Edge 6 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 5, 2, 4, 9, 3]
agg_protos_label dict_keys([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
self.gap tensor([nan, nan, nan, nan, nan, nan, nan, nan, nan, nan], device='cuda:0')
Server loss: nan
Traceback (most recent call last):
  File "main.py", line 498, in <module>
    run(args)
  File "main.py", line 270, in run
    server.train()
  File "/root/autodl-tmp/SAE-FedProto-CEC/system/flcore/servers/serverSAE.py", line 95, in train
    self.cloudUpdate()
  File "/root/autodl-tmp/SAE-FedProto-CEC/system/flcore/servers/serverSAE.py", line 146, in cloudUpdate
    sampled_features = sampler.aggregate_and_sample(self.edges)
  File "/root/autodl-tmp/SAE-FedProto-CEC/system/utils/func_utils.py", line 122, in aggregate_and_sample
    sampled_features[key] = self._gaussian_sampling(mean, cov, num_samples)
  File "/root/autodl-tmp/SAE-FedProto-CEC/system/utils/func_utils.py", line 162, in _gaussian_sampling
    sampled = np.random.multivariate_normal(mean, cov, num_samples)
  File "mtrand.pyx", line 4120, in numpy.random.mtrand.RandomState.multivariate_normal
  File "<__array_function__ internals>", line 5, in svd
  File "/root/miniconda3/lib/python3.8/site-packages/numpy/linalg/linalg.py", line 1660, in svd
    u, s, vh = gufunc(a, signature=signature, extobj=extobj)
  File "/root/miniconda3/lib/python3.8/site-packages/numpy/linalg/linalg.py", line 97, in _raise_linalgerror_svd_nonconvergence
    raise LinAlgError("SVD did not converge")
numpy.linalg.LinAlgError: SVD did not converge
