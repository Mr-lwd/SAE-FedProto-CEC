==================================================
goal = test
device = cuda
device_id = 0
dataset = FashionMNIST_dir_0.3_imbalance_40
num_classes = 10
model_family = HCNNs8
batch_size = 256
local_learning_rate = 0.03
use_decay_scheduler = False
learning_rate_decay = False
learning_rate_decay_gamma = 0.99
global_rounds = 300
edge_epochs = 1
local_epochs = 10
algorithm = FedSAE
join_ratio = 1.0
random_join_ratio = False
num_clients = 40
num_edges = 10
prev = 0
times = 1
eval_gap = 1
save_folder_name = temp
auto_break = False
feature_dim = 512
vocab_size = 98635
max_len = 200
client_drop_rate = 0.0
train_slow_rate = 0.0
send_slow_rate = 0.0
time_select = False
time_threthold = 10000
lamda = 10.0
trans_delay_simulate = False
agg_type = 0
buffersize = 10
mixclassifier = 0
gl_use_clients = 1
test_useglclassifier = 1
tgpaddmse = 0
gamma = 1.0
addTGP = 1
SAEbeta = 1.0
drawtsne = 1
drawround = 10
noise_dim = 512
generator_learning_rate = 0.005
hidden_dim = 512
server_epochs = 100
alpha = 1.0
beta = 1.0
mentee_learning_rate = 0.005
T_start = 0.95
T_end = 0.98
server_learning_rate = 0.01
margin_threthold = 1000.0
generator_path = stylegan/stylegan-xl-models/imagenet64.pkl
stable_diffusion_prompt = a cat
server_batch_size = 100
gen_batch_size = 4
mu = 50.0
==================================================
Random seed set as 42

============= Running time: 0th =============
Creating server and clients ...
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 0
label_counts: defaultdict(<class 'int'>, {5: 106, 1: 338, 0: 287, 3: 26, 9: 545, 6: 3, 2: 98, 4: 1})
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 1
label_counts: defaultdict(<class 'int'>, {4: 630, 7: 199, 1: 507, 2: 18, 5: 47, 0: 18, 3: 3, 6: 2})
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 2
label_counts: defaultdict(<class 'int'>, {0: 190, 5: 157, 7: 312, 9: 99, 6: 67, 8: 6, 2: 3, 3: 30, 4: 11})
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 3
label_counts: defaultdict(<class 'int'>, {6: 100, 3: 171, 8: 190, 9: 19, 4: 51, 2: 395, 0: 3, 5: 4})
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 4
label_counts: defaultdict(<class 'int'>, {5: 553, 0: 327, 1: 428, 2: 202, 4: 5})
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 5
label_counts: defaultdict(<class 'int'>, {4: 421, 6: 633, 2: 58, 3: 41, 8: 45, 1: 100, 7: 11, 5: 13, 0: 1})
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 6
label_counts: defaultdict(<class 'int'>, {4: 260, 9: 425, 8: 384, 3: 24, 1: 12, 2: 6, 6: 31, 7: 1})
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 7
label_counts: defaultdict(<class 'int'>, {9: 477, 8: 645, 6: 335, 7: 16, 3: 38, 5: 13, 4: 53, 0: 36, 1: 11, 2: 7})
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 8
label_counts: defaultdict(<class 'int'>, {4: 502, 9: 102, 0: 124, 6: 63, 2: 81, 8: 26, 5: 17, 3: 9, 1: 3})
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 9
label_counts: defaultdict(<class 'int'>, {3: 943, 2: 177, 1: 139, 0: 75})
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 10
label_counts: defaultdict(<class 'int'>, {8: 445, 4: 883, 2: 57, 0: 32, 3: 12, 5: 19, 7: 1, 6: 1, 1: 1})
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 11
label_counts: defaultdict(<class 'int'>, {6: 147, 4: 230, 8: 220, 9: 88, 3: 44, 1: 58, 5: 54, 2: 13, 7: 8})
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 12
label_counts: defaultdict(<class 'int'>, {6: 248, 3: 165, 1: 263, 9: 14, 0: 206, 5: 101, 7: 1, 4: 1})
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 13
label_counts: defaultdict(<class 'int'>, {3: 402, 2: 795, 4: 7, 7: 197, 0: 11, 5: 3, 1: 7})
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 14
label_counts: defaultdict(<class 'int'>, {9: 218, 0: 312, 3: 131, 4: 21, 5: 65, 1: 57, 2: 44, 8: 3})
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 15
label_counts: defaultdict(<class 'int'>, {6: 980, 5: 215, 3: 12, 1: 39, 0: 83, 4: 2})
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 16
label_counts: defaultdict(<class 'int'>, {4: 58, 3: 83, 0: 140, 1: 860, 5: 68, 8: 280, 6: 18, 7: 1})
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 17
label_counts: defaultdict(<class 'int'>, {8: 642, 5: 490, 0: 104, 4: 28, 3: 30, 2: 16, 7: 1, 6: 21, 1: 2})
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 18
label_counts: defaultdict(<class 'int'>, {8: 391, 1: 105, 2: 1, 4: 108, 7: 229, 3: 33, 5: 27, 6: 2, 0: 1})
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 19
label_counts: defaultdict(<class 'int'>, {1: 364, 0: 1204})
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 20
label_counts: defaultdict(<class 'int'>, {9: 858, 0: 37, 1: 290, 6: 44, 4: 216, 5: 157, 7: 131, 2: 19, 3: 1, 8: 1})
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 21
label_counts: defaultdict(<class 'int'>, {6: 225, 0: 136, 1: 383, 3: 62, 4: 288, 7: 16, 8: 4, 9: 1, 5: 1})
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 22
label_counts: defaultdict(<class 'int'>, {5: 243, 7: 387, 1: 102, 2: 9, 6: 68, 0: 12, 4: 1, 8: 15, 3: 1})
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 23
label_counts: defaultdict(<class 'int'>, {0: 232, 9: 256, 5: 40, 8: 141, 1: 32, 7: 1, 3: 2, 6: 1})
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 24
label_counts: defaultdict(<class 'int'>, {4: 309, 9: 235, 3: 447, 5: 120, 0: 62, 8: 15, 1: 2})
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 25
label_counts: defaultdict(<class 'int'>, {7: 222, 3: 388, 5: 505, 2: 154, 0: 81, 4: 7, 1: 34})
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 26
label_counts: defaultdict(<class 'int'>, {8: 568, 7: 172, 4: 139, 0: 443, 3: 26, 2: 116, 1: 10, 5: 5})
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 27
label_counts: defaultdict(<class 'int'>, {2: 186, 5: 530, 6: 253, 3: 75, 0: 88, 7: 1, 4: 5})
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 28
label_counts: defaultdict(<class 'int'>, {1: 63, 9: 281, 5: 14, 7: 176, 2: 50, 8: 93, 3: 24, 0: 22, 6: 2, 4: 1})
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 29
label_counts: defaultdict(<class 'int'>, {7: 363, 5: 337, 8: 138, 3: 170, 9: 164, 2: 27, 1: 20, 4: 2, 6: 3})
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 30
label_counts: defaultdict(<class 'int'>, {8: 229, 7: 302, 0: 243, 9: 43, 5: 24, 2: 1, 3: 2, 1: 2})
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 31
label_counts: defaultdict(<class 'int'>, {2: 510, 4: 583, 0: 98, 1: 223})
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 32
label_counts: defaultdict(<class 'int'>, {9: 1142, 7: 49, 2: 276, 5: 146, 1: 20, 3: 51, 6: 75, 8: 12, 0: 31, 4: 1})
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 33
label_counts: defaultdict(<class 'int'>, {2: 405, 6: 254, 7: 122, 1: 76, 3: 276, 0: 151, 4: 83})
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 34
label_counts: defaultdict(<class 'int'>, {0: 172, 2: 880, 6: 870, 3: 12, 1: 42, 4: 9})
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 35
label_counts: defaultdict(<class 'int'>, {4: 312, 9: 70, 0: 300, 6: 18, 7: 36, 5: 70, 2: 90, 3: 121, 1: 25, 8: 1})
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 36
label_counts: defaultdict(<class 'int'>, {6: 412, 2: 127, 8: 221, 3: 364, 1: 41, 9: 158, 7: 124, 0: 3, 4: 5})
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 37
label_counts: defaultdict(<class 'int'>, {7: 2178, 3: 1002, 6: 142, 4: 3, 2: 20, 5: 11, 0: 1})
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 38
label_counts: defaultdict(<class 'int'>, {5: 1124, 1: 545, 2: 23, 0: 14, 3: 21, 4: 1})
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 39
label_counts: defaultdict(<class 'int'>, {2: 387, 6: 233, 8: 501, 1: 41, 0: 13, 9: 3, 3: 2, 5: 12, 4: 1, 7: 2})

Join ratio / total clients: 1.0 / 40
Finished creating server and clients.
Trainable_prototypes(
  (embedings): Embedding(10, 512)
  (middle): Sequential(
    (0): Sequential(
      (0): Linear(in_features=512, out_features=512, bias=True)
      (1): ReLU()
    )
  )
  (fc): Linear(in_features=512, out_features=512, bias=True)
)
tobetrained:
[9, 8, 7, 6, 5, 4, 3, 2, 1, 0]
Edge 9 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Edge 8 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Edge 7 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Edge 6 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_4 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_39 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_9 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_8 protos Not Found
Edge 5 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_11 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_32 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_29 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_0 protos Not Found
Edge 4 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_36 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_7 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_1 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_28 protos Not Found
Edge 3 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_37 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_13 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_20 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_18 protos Not Found
Edge 2 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_5 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_25 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_2 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_38 protos Not Found
Edge 1 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_12 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_17 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_33 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_24 protos Not Found
Edge 0 begin training
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_26 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_15 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_19 protos Not Found
Server global_protos Not Found
Server tgp_global_protos Not Found
Server glclassifier Not Found
Client_16 protos Not Found
readyList:
[7, 6, 8, 1, 5, 0, 2, 9, 4, 3]
aggregation_buffer:
[7, 6, 8, 1, 5, 0, 2, 9, 4, 3]
class-wise minimum distance tensor([0.9785, 1.0554, 0.9547, 0.9785, 0.9547, 1.4886, 0.9900, 1.4886, 1.6203,
        2.5567], device='cuda:0')
min_gap tensor(0.9547, device='cuda:0')
max_gap tensor(2.5567, device='cuda:0')
Server loss: 4.371245861053467
train global classifier
train glclassifier time: 3.7670056223869324
global classifier accuracy in train virtual: 88.9
Number of samples: 324
end Update
server_global_time: 1.3590554744005203
only_train_time: 20.818224638700485

-------------Global Round number: 0-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.7404
Averaged Test Accuracy (Prototype Model): 0.3611
Std Test Accuracy (Regular Model): 0.1934
Std Test Accuracy (Prototype Model): 0.2162
tobetrained:
[7, 6, 8, 1, 5, 0, 2, 9, 4, 3]
Edge 7 begin training
Edge 6 begin training
Edge 8 begin training
Edge 1 begin training
Edge 5 begin training
Edge 0 begin training
Edge 2 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 5, 0, 2, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 5, 0, 2, 4, 9, 3]
class-wise minimum distance tensor([0.9084, 1.0874, 0.4765, 0.9084, 0.4765, 1.1420, 0.6127, 1.1420, 1.7308,
        2.3287], device='cuda:0')
min_gap tensor(0.4765, device='cuda:0')
max_gap tensor(2.3287, device='cuda:0')
Server loss: 3.4394352436065674
train global classifier
train glclassifier time: 3.649080403149128
global classifier accuracy in train virtual: 96.0025
end Update
server_global_time: 4.351717062294483
only_train_time: 66.13956955075264

-------------Global Round number: 1-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.8578
Averaged Test Accuracy (Prototype Model): 0.7902
Std Test Accuracy (Regular Model): 0.0948
Std Test Accuracy (Prototype Model): 0.1668
tobetrained:
[7, 1, 6, 8, 5, 0, 2, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 5 begin training
Edge 0 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
class-wise minimum distance tensor([1.2242, 1.6978, 0.5670, 1.2242, 0.5670, 1.4763, 0.7360, 1.4763, 2.3715,
        3.1296], device='cuda:0')
min_gap tensor(0.5670, device='cuda:0')
max_gap tensor(3.1296, device='cuda:0')
Server loss: 3.7035248279571533
train global classifier
train glclassifier time: 3.712336741387844
global classifier accuracy in train virtual: 97.0725
end Update
server_global_time: 7.388246141374111
only_train_time: 113.28349794447422

-------------Global Round number: 2-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.8825
Averaged Test Accuracy (Prototype Model): 0.8541
Std Test Accuracy (Regular Model): 0.0798
Std Test Accuracy (Prototype Model): 0.1128
tobetrained:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 4, 0, 5, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 4, 0, 5, 9, 3]
class-wise minimum distance tensor([1.5491, 2.3392, 0.6928, 1.5491, 0.6928, 1.8984, 0.9382, 1.8984, 3.0936,
        3.9732], device='cuda:0')
min_gap tensor(0.6928, device='cuda:0')
max_gap tensor(3.9732, device='cuda:0')
Server loss: 4.13895845413208
train global classifier
train glclassifier time: 3.7958612740039825
global classifier accuracy in train virtual: 97.9675
end Update
server_global_time: 10.400855667889118
only_train_time: 159.16697216033936

-------------Global Round number: 3-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.8939
Averaged Test Accuracy (Prototype Model): 0.8826
Std Test Accuracy (Regular Model): 0.0729
Std Test Accuracy (Prototype Model): 0.0798
tobetrained:
[7, 1, 6, 8, 2, 4, 0, 5, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 4 begin training
Edge 0 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[1, 7, 8, 6, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[1, 7, 8, 6, 0, 2, 5, 4, 9, 3]
class-wise minimum distance tensor([1.9137, 2.9342, 0.8424, 1.9137, 0.8424, 2.3285, 1.1539, 2.3285, 3.8547,
        4.7357], device='cuda:0')
min_gap tensor(0.8424, device='cuda:0')
max_gap tensor(4.7357, device='cuda:0')
Server loss: 5.000711441040039
train global classifier
train glclassifier time: 3.7775581255555153
global classifier accuracy in train virtual: 98.5125
end Update
server_global_time: 13.34470085054636
only_train_time: 204.61464244127274

-------------Global Round number: 4-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9009
Averaged Test Accuracy (Prototype Model): 0.8865
Std Test Accuracy (Regular Model): 0.0653
Std Test Accuracy (Prototype Model): 0.0740
tobetrained:
[1, 7, 8, 6, 0, 2, 5, 4, 9, 3]
Edge 1 begin training
Edge 7 begin training
Edge 8 begin training
Edge 6 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 8, 6, 2, 5, 0, 1, 4, 9, 3]
aggregation_buffer:
[7, 8, 6, 2, 5, 0, 1, 4, 9, 3]
class-wise minimum distance tensor([2.3473, 3.5806, 1.0362, 2.3473, 1.0362, 2.7681, 1.3479, 2.7681, 4.5858,
        5.4428], device='cuda:0')
min_gap tensor(1.0362, device='cuda:0')
max_gap tensor(5.4428, device='cuda:0')
Server loss: 4.290693283081055
train global classifier
train glclassifier time: 3.789308041334152
global classifier accuracy in train virtual: 98.8975
end Update
server_global_time: 16.35283648222685
only_train_time: 251.20735100656748

-------------Global Round number: 5-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9052
Averaged Test Accuracy (Prototype Model): 0.8739
Std Test Accuracy (Regular Model): 0.0634
Std Test Accuracy (Prototype Model): 0.0915
tobetrained:
[7, 8, 6, 2, 5, 0, 1, 4, 9, 3]
Edge 7 begin training
Edge 8 begin training
Edge 6 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 1 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 4, 9, 8, 6, 0, 2, 5, 3]
aggregation_buffer:
[7, 1, 4, 9, 8, 6, 0, 2, 5, 3]
class-wise minimum distance tensor([2.8202, 4.2188, 1.2619, 2.8202, 1.2619, 3.2855, 1.5530, 3.2855, 5.3794,
        6.2038], device='cuda:0')
min_gap tensor(1.2619, device='cuda:0')
max_gap tensor(6.2038, device='cuda:0')
Server loss: 4.673535346984863
train global classifier
train glclassifier time: 3.804620787501335
global classifier accuracy in train virtual: 99.1075
end Update
server_global_time: 19.29440874606371
only_train_time: 302.44013515114784

-------------Global Round number: 6-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9074
Averaged Test Accuracy (Prototype Model): 0.8960
Std Test Accuracy (Regular Model): 0.0628
Std Test Accuracy (Prototype Model): 0.0700
tobetrained:
[7, 1, 4, 9, 8, 6, 0, 2, 5, 3]
Edge 7 begin training
Edge 1 begin training
Edge 4 begin training
Edge 9 begin training
Edge 8 begin training
Edge 6 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 3 begin training
readyList:
[1, 7, 6, 8, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[1, 7, 6, 8, 0, 5, 2, 4, 9, 3]
class-wise minimum distance tensor([3.3281, 4.8746, 1.5067, 3.3281, 1.5067, 3.8543, 1.8061, 3.8543, 6.1335,
        7.0563], device='cuda:0')
min_gap tensor(1.5067, device='cuda:0')
max_gap tensor(7.0563, device='cuda:0')
Server loss: 5.505801200866699
train global classifier
train glclassifier time: 3.7350608333945274
global classifier accuracy in train virtual: 99.2525
end Update
server_global_time: 22.29702740907669
only_train_time: 348.0439557954669

-------------Global Round number: 7-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9097
Averaged Test Accuracy (Prototype Model): 0.8923
Std Test Accuracy (Regular Model): 0.0629
Std Test Accuracy (Prototype Model): 0.0762
tobetrained:
[1, 7, 6, 8, 0, 5, 2, 4, 9, 3]
Edge 1 begin training
Edge 7 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 2, 4, 5, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 2, 4, 5, 9, 3]
class-wise minimum distance tensor([3.8690, 5.6035, 1.8350, 3.9014, 1.8350, 4.4864, 2.1352, 4.4864, 6.9141,
        7.9069], device='cuda:0')
min_gap tensor(1.8350, device='cuda:0')
max_gap tensor(7.9069, device='cuda:0')
Server loss: 6.223719120025635
train global classifier
train glclassifier time: 3.804106220602989
global classifier accuracy in train virtual: 99.3275
end Update
server_global_time: 25.23936092108488
only_train_time: 393.5003060102463

-------------Global Round number: 8-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9129
Averaged Test Accuracy (Prototype Model): 0.8996
Std Test Accuracy (Regular Model): 0.0591
Std Test Accuracy (Prototype Model): 0.0683
tobetrained:
[7, 1, 6, 8, 0, 2, 4, 5, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 8, 6, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 8, 6, 0, 2, 5, 4, 9, 3]
class-wise minimum distance tensor([4.3894, 6.4358, 2.2095, 4.5668, 2.2095, 5.0598, 2.4990, 5.0598, 7.6849,
        8.7455], device='cuda:0')
min_gap tensor(2.2095, device='cuda:0')
max_gap tensor(8.7455, device='cuda:0')
Server loss: 6.0638628005981445
train global classifier
train glclassifier time: 3.7402492240071297
global classifier accuracy in train virtual: 99.49
end Update
server_global_time: 29.06323003023863
only_train_time: 440.57019271701574

-------------Global Round number: 9-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9151
Averaged Test Accuracy (Prototype Model): 0.9050
Std Test Accuracy (Regular Model): 0.0559
Std Test Accuracy (Prototype Model): 0.0614
tobetrained:
[7, 1, 8, 6, 0, 2, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 8 begin training
Edge 6 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 8, 0, 2, 4, 1, 9, 5, 3]
aggregation_buffer:
[7, 6, 8, 0, 2, 4, 1, 9, 5, 3]
class-wise minimum distance tensor([5.0154, 7.2527, 2.6402, 5.2059, 2.6402, 5.8018, 2.8353, 5.8018, 8.5212,
        9.7710], device='cuda:0')
min_gap tensor(2.6402, device='cuda:0')
max_gap tensor(9.7710, device='cuda:0')
Server loss: 5.662755012512207
train global classifier
train glclassifier time: 3.7696868926286697
global classifier accuracy in train virtual: 99.6225
Number of samples: 324
end Update
server_global_time: 32.06178633868694
only_train_time: 487.94029945135117

-------------Global Round number: 10-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9145
Averaged Test Accuracy (Prototype Model): 0.8958
Std Test Accuracy (Regular Model): 0.0593
Std Test Accuracy (Prototype Model): 0.0722
tobetrained:
[7, 6, 8, 0, 2, 4, 1, 9, 5, 3]
Edge 7 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 4 begin training
Edge 1 begin training
Edge 9 begin training
Edge 5 begin training
Edge 3 begin training
readyList:
[7, 1, 8, 6, 2, 5, 4, 9, 0, 3]
aggregation_buffer:
[7, 1, 8, 6, 2, 5, 4, 9, 0, 3]
class-wise minimum distance tensor([ 5.6734,  8.1777,  3.1432,  6.0049,  3.1432,  6.6189,  3.2908,  6.6189,
         9.6789, 10.9066], device='cuda:0')
min_gap tensor(3.1432, device='cuda:0')
max_gap tensor(10.9066, device='cuda:0')
Server loss: 6.348459243774414
train global classifier
train glclassifier time: 3.7036207020282745
global classifier accuracy in train virtual: 99.7375
end Update
server_global_time: 35.072570614516735
only_train_time: 535.0799499303102

-------------Global Round number: 11-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9170
Averaged Test Accuracy (Prototype Model): 0.9057
Std Test Accuracy (Regular Model): 0.0536
Std Test Accuracy (Prototype Model): 0.0635
tobetrained:
[7, 1, 8, 6, 2, 5, 4, 9, 0, 3]
Edge 7 begin training
Edge 1 begin training
Edge 8 begin training
Edge 6 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 0 begin training
Edge 3 begin training
readyList:
[7, 8, 0, 5, 2, 1, 4, 6, 9, 3]
aggregation_buffer:
[7, 8, 0, 5, 2, 1, 4, 6, 9, 3]
class-wise minimum distance tensor([ 6.4357,  9.2273,  3.7216,  6.8635,  3.7216,  7.4072,  3.8322,  7.4072,
        10.5026, 12.0130], device='cuda:0')
min_gap tensor(3.7216, device='cuda:0')
max_gap tensor(12.0130, device='cuda:0')
Server loss: 8.17526626586914
train global classifier
train glclassifier time: 3.759893797338009
global classifier accuracy in train virtual: 99.7275
end Update
server_global_time: 38.09024043381214
only_train_time: 582.1654369160533

-------------Global Round number: 12-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9165
Averaged Test Accuracy (Prototype Model): 0.9067
Std Test Accuracy (Regular Model): 0.0553
Std Test Accuracy (Prototype Model): 0.0625
tobetrained:
[7, 8, 0, 5, 2, 1, 4, 6, 9, 3]
Edge 7 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 1 begin training
Edge 4 begin training
Edge 6 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 8, 6, 2, 0, 5, 9, 4, 3]
aggregation_buffer:
[7, 1, 8, 6, 2, 0, 5, 9, 4, 3]
class-wise minimum distance tensor([ 7.2757, 10.3527,  4.3763,  7.8822,  4.3273,  8.3552,  4.3273,  8.3552,
        11.4448, 13.2361], device='cuda:0')
min_gap tensor(4.3273, device='cuda:0')
max_gap tensor(13.2361, device='cuda:0')
Server loss: 7.262633323669434
train global classifier
train glclassifier time: 3.73899644613266
global classifier accuracy in train virtual: 99.8075
end Update
server_global_time: 41.09440127015114
only_train_time: 628.4231017008424

-------------Global Round number: 13-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9185
Averaged Test Accuracy (Prototype Model): 0.9048
Std Test Accuracy (Regular Model): 0.0543
Std Test Accuracy (Prototype Model): 0.0667
tobetrained:
[7, 1, 8, 6, 2, 0, 5, 9, 4, 3]
Edge 7 begin training
Edge 1 begin training
Edge 8 begin training
Edge 6 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 4, 0, 5, 2, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 4, 0, 5, 2, 9, 3]
class-wise minimum distance tensor([ 7.8087, 11.7181,  5.0122,  8.7635,  4.8811,  9.3460,  4.8811,  9.3460,
        12.8338, 14.5774], device='cuda:0')
min_gap tensor(4.8811, device='cuda:0')
max_gap tensor(14.5774, device='cuda:0')
Server loss: 8.757566452026367
train global classifier
train glclassifier time: 3.8160450235009193
global classifier accuracy in train virtual: 99.8775
end Update
server_global_time: 44.03727415204048
only_train_time: 673.1488721221685

-------------Global Round number: 14-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9196
Averaged Test Accuracy (Prototype Model): 0.9112
Std Test Accuracy (Regular Model): 0.0535
Std Test Accuracy (Prototype Model): 0.0598
tobetrained:
[7, 1, 6, 8, 4, 0, 5, 2, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 4 begin training
Edge 0 begin training
Edge 5 begin training
Edge 2 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 5, 4, 2, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 5, 4, 2, 9, 3]
class-wise minimum distance tensor([ 8.8596, 12.9970,  5.9324,  9.7852,  5.4534, 10.4351,  5.4534, 10.4351,
        14.1510, 15.7990], device='cuda:0')
min_gap tensor(5.4534, device='cuda:0')
max_gap tensor(15.7990, device='cuda:0')
Server loss: 8.21350383758545
train global classifier
train glclassifier time: 3.7004346176981926
global classifier accuracy in train virtual: 99.8975
end Update
server_global_time: 47.06006822735071
only_train_time: 719.5382356494665

-------------Global Round number: 15-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9178
Averaged Test Accuracy (Prototype Model): 0.9134
Std Test Accuracy (Regular Model): 0.0552
Std Test Accuracy (Prototype Model): 0.0573
tobetrained:
[7, 1, 6, 8, 0, 5, 4, 2, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 2 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 8, 2, 4, 1, 9, 0, 5, 3]
aggregation_buffer:
[7, 6, 8, 2, 4, 1, 9, 0, 5, 3]
class-wise minimum distance tensor([ 9.9954, 14.3785,  6.7445, 11.0229,  6.1797, 11.4532,  6.1797, 11.4532,
        15.7132, 17.3754], device='cuda:0')
min_gap tensor(6.1797, device='cuda:0')
max_gap tensor(17.3754, device='cuda:0')
Server loss: 10.343833923339844
train global classifier
train glclassifier time: 4.292598143219948
global classifier accuracy in train virtual: 99.95
end Update
server_global_time: 50.04531491547823
only_train_time: 767.6243464052677

-------------Global Round number: 16-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9197
Averaged Test Accuracy (Prototype Model): 0.9133
Std Test Accuracy (Regular Model): 0.0539
Std Test Accuracy (Prototype Model): 0.0591
tobetrained:
[7, 6, 8, 2, 4, 1, 9, 0, 5, 3]
Edge 7 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 4 begin training
Edge 1 begin training
Edge 9 begin training
Edge 0 begin training
Edge 5 begin training
Edge 3 begin training
readyList:
[1, 7, 8, 2, 6, 4, 9, 0, 5, 3]
aggregation_buffer:
[1, 7, 8, 2, 6, 4, 9, 0, 5, 3]
class-wise minimum distance tensor([10.9847, 15.9988,  7.6848, 12.2558,  6.9607, 12.6165,  6.9607, 12.6165,
        16.8647, 18.8341], device='cuda:0')
min_gap tensor(6.9607, device='cuda:0')
max_gap tensor(18.8341, device='cuda:0')
Server loss: 11.160210609436035
train global classifier
train glclassifier time: 3.801130473613739
global classifier accuracy in train virtual: 99.9775
end Update
server_global_time: 53.098614543676376
only_train_time: 817.8412617892027

-------------Global Round number: 17-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9230
Averaged Test Accuracy (Prototype Model): 0.9161
Std Test Accuracy (Regular Model): 0.0503
Std Test Accuracy (Prototype Model): 0.0555
tobetrained:
[1, 7, 8, 2, 6, 4, 9, 0, 5, 3]
Edge 1 begin training
Edge 7 begin training
Edge 8 begin training
Edge 2 begin training
Edge 6 begin training
Edge 4 begin training
Edge 9 begin training
Edge 0 begin training
Edge 5 begin training
Edge 3 begin training
readyList:
[7, 1, 8, 6, 2, 4, 9, 0, 5, 3]
aggregation_buffer:
[7, 1, 8, 6, 2, 4, 9, 0, 5, 3]
class-wise minimum distance tensor([12.1501, 17.3622,  8.7095, 13.5565,  7.6258, 13.5754,  7.6258, 13.5754,
        18.1354, 20.1334], device='cuda:0')
min_gap tensor(7.6258, device='cuda:0')
max_gap tensor(20.1334, device='cuda:0')
Server loss: 10.577868461608887
train global classifier
train glclassifier time: 3.940816879272461
global classifier accuracy in train virtual: 99.9675
end Update
server_global_time: 56.08246314525604
only_train_time: 865.084668815136

-------------Global Round number: 18-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9238
Averaged Test Accuracy (Prototype Model): 0.9194
Std Test Accuracy (Regular Model): 0.0478
Std Test Accuracy (Prototype Model): 0.0500
tobetrained:
[7, 1, 8, 6, 2, 4, 9, 0, 5, 3]
Edge 7 begin training
Edge 1 begin training
Edge 8 begin training
Edge 6 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 0 begin training
Edge 5 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 0, 5, 4, 2, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 0, 5, 4, 2, 9, 3]
class-wise minimum distance tensor([13.2949, 19.1354,  9.8254, 14.9300,  8.5346, 15.0508,  8.5346, 15.0508,
        19.7275, 21.9500], device='cuda:0')
min_gap tensor(8.5346, device='cuda:0')
max_gap tensor(21.9500, device='cuda:0')
Server loss: 11.437828063964844
train global classifier
train glclassifier time: 3.8590053766965866
global classifier accuracy in train virtual: 99.975
end Update
server_global_time: 59.20576187223196
only_train_time: 912.4507105797529

-------------Global Round number: 19-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9245
Averaged Test Accuracy (Prototype Model): 0.9216
Std Test Accuracy (Regular Model): 0.0500
Std Test Accuracy (Prototype Model): 0.0496
tobetrained:
[7, 1, 6, 8, 0, 5, 4, 2, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 2 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
class-wise minimum distance tensor([14.4612, 20.8692, 11.0268, 16.4340,  9.4496, 16.3985,  9.4496, 16.3985,
        21.6184, 23.7330], device='cuda:0')
min_gap tensor(9.4496, device='cuda:0')
max_gap tensor(23.7330, device='cuda:0')
Server loss: 15.529715538024902
train global classifier
train glclassifier time: 3.791876256465912
global classifier accuracy in train virtual: 99.995
Number of samples: 324
end Update
server_global_time: 62.32335862517357
only_train_time: 959.6299100220203

-------------Global Round number: 20-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9243
Averaged Test Accuracy (Prototype Model): 0.9201
Std Test Accuracy (Regular Model): 0.0488
Std Test Accuracy (Prototype Model): 0.0507
tobetrained:
[7, 1, 6, 8, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 4, 0, 5, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 4, 0, 5, 9, 3]
class-wise minimum distance tensor([15.8743, 22.6301, 12.1989, 18.1254, 10.4353, 18.0161, 10.4353, 18.0161,
        23.2807, 25.0485], device='cuda:0')
min_gap tensor(10.4353, device='cuda:0')
max_gap tensor(25.0485, device='cuda:0')
Server loss: 11.115155220031738
train global classifier
train glclassifier time: 4.333062171936035
global classifier accuracy in train virtual: 99.9975
end Update
server_global_time: 65.26632060855627
only_train_time: 1005.7150998786092

-------------Global Round number: 21-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9234
Averaged Test Accuracy (Prototype Model): 0.9239
Std Test Accuracy (Regular Model): 0.0507
Std Test Accuracy (Prototype Model): 0.0486
tobetrained:
[7, 1, 6, 8, 2, 4, 0, 5, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 4 begin training
Edge 0 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 4, 5, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 4, 5, 9, 3]
class-wise minimum distance tensor([17.2841, 24.3709, 13.5330, 19.5243, 11.5813, 19.3131, 11.5813, 19.3131,
        24.8947, 26.4070], device='cuda:0')
min_gap tensor(11.5813, device='cuda:0')
max_gap tensor(26.4070, device='cuda:0')
Server loss: 13.725793838500977
train global classifier
train glclassifier time: 3.714340329170227
global classifier accuracy in train virtual: 99.995
end Update
server_global_time: 68.22528693825006
only_train_time: 1051.9489082694054

-------------Global Round number: 22-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9243
Averaged Test Accuracy (Prototype Model): 0.9201
Std Test Accuracy (Regular Model): 0.0483
Std Test Accuracy (Prototype Model): 0.0597
tobetrained:
[7, 1, 6, 8, 2, 0, 4, 5, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 4 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 8, 6, 1, 2, 0, 5, 9, 4, 3]
aggregation_buffer:
[7, 8, 6, 1, 2, 0, 5, 9, 4, 3]
class-wise minimum distance tensor([18.7016, 25.9252, 14.9348, 21.2917, 12.9649, 20.9315, 12.9649, 20.9315,
        26.1728, 27.7248], device='cuda:0')
min_gap tensor(12.9649, device='cuda:0')
max_gap tensor(27.7248, device='cuda:0')
Server loss: 11.037982940673828
train global classifier
train glclassifier time: 3.908035486936569
global classifier accuracy in train virtual: 100.0
end Update
server_global_time: 71.06568646430969
only_train_time: 1098.2908913642168

-------------Global Round number: 23-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9252
Averaged Test Accuracy (Prototype Model): 0.9254
Std Test Accuracy (Regular Model): 0.0498
Std Test Accuracy (Prototype Model): 0.0487
tobetrained:
[7, 8, 6, 1, 2, 0, 5, 9, 4, 3]
Edge 7 begin training
Edge 8 begin training
Edge 6 begin training
Edge 1 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 4, 2, 0, 5, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 4, 2, 0, 5, 9, 3]
class-wise minimum distance tensor([20.1829, 27.5940, 16.1346, 23.0815, 14.4905, 22.5219, 14.4905, 22.5219,
        27.3915, 29.6872], device='cuda:0')
min_gap tensor(14.4905, device='cuda:0')
max_gap tensor(29.6872, device='cuda:0')
Server loss: 11.07936954498291
train global classifier
train glclassifier time: 3.921458922326565
global classifier accuracy in train virtual: 100.0
end Update
server_global_time: 73.90487491339445
only_train_time: 1144.6994018927217

-------------Global Round number: 24-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9271
Averaged Test Accuracy (Prototype Model): 0.9278
Std Test Accuracy (Regular Model): 0.0462
Std Test Accuracy (Prototype Model): 0.0455
tobetrained:
[7, 1, 6, 8, 4, 2, 0, 5, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 4 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
aggregation_buffer:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
class-wise minimum distance tensor([21.9073, 29.4885, 17.3822, 24.4833, 15.8864, 24.1917, 15.8864, 24.1917,
        29.1153, 30.6436], device='cuda:0')
min_gap tensor(15.8864, device='cuda:0')
max_gap tensor(30.6436, device='cuda:0')
Server loss: 12.758745193481445
train global classifier
train glclassifier time: 3.915817551314831
global classifier accuracy in train virtual: 100.0
end Update
server_global_time: 76.98242735862732
only_train_time: 1191.1199846193194

-------------Global Round number: 25-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9266
Averaged Test Accuracy (Prototype Model): 0.9261
Std Test Accuracy (Regular Model): 0.0485
Std Test Accuracy (Prototype Model): 0.0462
tobetrained:
[7, 1, 6, 8, 2, 0, 5, 4, 9, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 1, 6, 8, 5, 2, 4, 9, 0, 3]
aggregation_buffer:
[7, 1, 6, 8, 5, 2, 4, 9, 0, 3]
class-wise minimum distance tensor([24.1077, 31.1842, 18.7287, 25.8075, 17.1521, 26.0131, 17.1521, 26.0131,
        30.9229, 33.1899], device='cuda:0')
min_gap tensor(17.1521, device='cuda:0')
max_gap tensor(33.1899, device='cuda:0')
Server loss: 17.83121681213379
train global classifier
train glclassifier time: 3.819431409239769
global classifier accuracy in train virtual: 100.0
end Update
server_global_time: 79.75574477761984
only_train_time: 1237.7519239261746

-------------Global Round number: 26-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9279
Averaged Test Accuracy (Prototype Model): 0.9259
Std Test Accuracy (Regular Model): 0.0466
Std Test Accuracy (Prototype Model): 0.0473
tobetrained:
[7, 1, 6, 8, 5, 2, 4, 9, 0, 3]
Edge 7 begin training
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 5 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 0 begin training
Edge 3 begin training
readyList:
[7, 6, 8, 0, 4, 1, 2, 9, 5, 3]
aggregation_buffer:
[7, 6, 8, 0, 4, 1, 2, 9, 5, 3]
class-wise minimum distance tensor([26.6924, 32.4300, 20.0012, 27.7083, 18.2182, 26.8107, 18.2182, 26.8107,
        32.2189, 34.2780], device='cuda:0')
min_gap tensor(18.2182, device='cuda:0')
max_gap tensor(34.2780, device='cuda:0')
Server loss: 13.405646324157715
train global classifier
train glclassifier time: 4.28911928832531
global classifier accuracy in train virtual: 100.0
end Update
server_global_time: 82.7955396771431
only_train_time: 1285.9224556982517

-------------Global Round number: 27-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9268
Averaged Test Accuracy (Prototype Model): 0.9239
Std Test Accuracy (Regular Model): 0.0513
Std Test Accuracy (Prototype Model): 0.0582
tobetrained:
[7, 6, 8, 0, 4, 1, 2, 9, 5, 3]
Edge 7 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 4 begin training
Edge 1 begin training
Edge 2 begin training
Edge 9 begin training
Edge 5 begin training
Edge 3 begin training
readyList:
[1, 6, 8, 7, 0, 2, 5, 4, 9, 3]
aggregation_buffer:
[1, 6, 8, 7, 0, 2, 5, 4, 9, 3]
class-wise minimum distance tensor([27.7669, 34.7019, 21.4378, 29.7151, 20.3700, 29.2152, 20.3700, 29.2152,
        33.9645, 36.2250], device='cuda:0')
min_gap tensor(20.3700, device='cuda:0')
max_gap tensor(36.2250, device='cuda:0')
Server loss: 12.563455581665039
train global classifier
train glclassifier time: 3.790308065712452
global classifier accuracy in train virtual: 100.0
end Update
server_global_time: 85.81530047208071
only_train_time: 1332.2324638292193

-------------Global Round number: 28-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9292
Averaged Test Accuracy (Prototype Model): 0.9293
Std Test Accuracy (Regular Model): 0.0486
Std Test Accuracy (Prototype Model): 0.0471
tobetrained:
[1, 6, 8, 7, 0, 2, 5, 4, 9, 3]
Edge 1 begin training
Edge 6 begin training
Edge 8 begin training
Edge 7 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 8, 0, 2, 5, 1, 9, 4, 3]
aggregation_buffer:
[7, 6, 8, 0, 2, 5, 1, 9, 4, 3]
class-wise minimum distance tensor([31.2125, 36.8701, 23.4039, 32.2798, 22.1699, 31.4591, 22.1699, 31.4591,
        35.9514, 38.8936], device='cuda:0')
min_gap tensor(22.1699, device='cuda:0')
max_gap tensor(38.8936, device='cuda:0')
Server loss: 12.310751914978027
train global classifier
train glclassifier time: 4.004040867090225
global classifier accuracy in train virtual: 100.0
end Update
server_global_time: 88.77155232429504
only_train_time: 1380.172426097095

-------------Global Round number: 29-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9294
Averaged Test Accuracy (Prototype Model): 0.9301
Std Test Accuracy (Regular Model): 0.0455
Std Test Accuracy (Prototype Model): 0.0445
tobetrained:
[7, 6, 8, 0, 2, 5, 1, 9, 4, 3]
Edge 7 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 2 begin training
Edge 5 begin training
Edge 1 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 6, 8, 0, 4, 1, 2, 9, 5, 3]
aggregation_buffer:
[7, 6, 8, 0, 4, 1, 2, 9, 5, 3]
class-wise minimum distance tensor([32.6097, 38.4777, 24.7972, 33.4769, 24.1159, 33.5978, 24.1159, 33.5978,
        37.7490, 40.5442], device='cuda:0')
min_gap tensor(24.1159, device='cuda:0')
max_gap tensor(40.5442, device='cuda:0')
Server loss: 16.783632278442383
train global classifier
train glclassifier time: 4.589361272752285
global classifier accuracy in train virtual: 100.0
Number of samples: 324
end Update
server_global_time: 91.71076649427414
only_train_time: 1428.3052235916257

-------------Global Round number: 30-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9244
Averaged Test Accuracy (Prototype Model): 0.9246
Std Test Accuracy (Regular Model): 0.0563
Std Test Accuracy (Prototype Model): 0.0576
tobetrained:
[7, 6, 8, 0, 4, 1, 2, 9, 5, 3]
Edge 7 begin training
Edge 6 begin training
Edge 8 begin training
Edge 0 begin training
Edge 4 begin training
Edge 1 begin training
Edge 2 begin training
Edge 9 begin training
Edge 5 begin training
Edge 3 begin training
readyList:
[7, 8, 1, 6, 2, 5, 0, 4, 9, 3]
aggregation_buffer:
[7, 8, 1, 6, 2, 5, 0, 4, 9, 3]
class-wise minimum distance tensor([34.5952, 40.4487, 26.5727, 34.5952, 25.9244, 35.3704, 25.9244, 35.3704,
        38.5765, 42.4086], device='cuda:0')
min_gap tensor(25.9244, device='cuda:0')
max_gap tensor(42.4086, device='cuda:0')
Server loss: 18.7641658782959
train global classifier
train glclassifier time: 3.722057282924652
global classifier accuracy in train virtual: 100.0
end Update
server_global_time: 94.69770526885986
only_train_time: 1474.1933284178376

-------------Global Round number: 31-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9201
Averaged Test Accuracy (Prototype Model): 0.9158
Std Test Accuracy (Regular Model): 0.1050
Std Test Accuracy (Prototype Model): 0.1469
tobetrained:
[7, 8, 1, 6, 2, 5, 0, 4, 9, 3]
Edge 7 begin training
Edge 8 begin training
Edge 1 begin training
Edge 6 begin training
Edge 2 begin training
Edge 5 begin training
Edge 0 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[1, 6, 7, 8, 2, 5, 4, 0, 9, 3]
aggregation_buffer:
[1, 6, 7, 8, 2, 5, 4, 0, 9, 3]
class-wise minimum distance tensor([35.0922, 41.4241, 26.5107, 36.4933, 26.5107, 37.9595, 27.1570, 37.9595,
        40.8285, 41.6903], device='cuda:0')
min_gap tensor(26.5107, device='cuda:0')
max_gap tensor(41.6903, device='cuda:0')
Server loss: 13.433762550354004
train global classifier
train glclassifier time: 3.781300976872444
global classifier accuracy in train virtual: 99.9775
end Update
server_global_time: 97.71101342886686
only_train_time: 1520.9691547900438

-------------Global Round number: 32-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9100
Averaged Test Accuracy (Prototype Model): 0.9021
Std Test Accuracy (Regular Model): 0.1123
Std Test Accuracy (Prototype Model): 0.1341
tobetrained:
[1, 6, 7, 8, 2, 5, 4, 0, 9, 3]
Edge 1 begin training
Edge 6 begin training
Edge 7 begin training
Edge 8 begin training
Edge 2 begin training
Edge 5 begin training
Edge 4 begin training
Edge 0 begin training
Edge 9 begin training
Edge 3 begin training
readyList:
[7, 6, 1, 8, 0, 5, 2, 4, 9, 3]
aggregation_buffer:
[7, 6, 1, 8, 0, 5, 2, 4, 9, 3]
class-wise minimum distance tensor([nan, nan, nan, nan, nan, nan, nan, nan, nan, nan], device='cuda:0')
min_gap tensor(nan, device='cuda:0')
max_gap tensor(nan, device='cuda:0')
Server loss: nan
Traceback (most recent call last):
  File "main.py", line 504, in <module>
    run(args)
  File "main.py", line 270, in run
    server.train()
  File "/root/autodl-tmp/SAE-FedProto-CEC/system/flcore/servers/serverSAE.py", line 95, in train
    self.cloudUpdate()
  File "/root/autodl-tmp/SAE-FedProto-CEC/system/flcore/servers/serverSAE.py", line 149, in cloudUpdate
    sampled_features = sampler.aggregate_and_sample(self.edges, self.clients)
  File "/root/autodl-tmp/SAE-FedProto-CEC/system/utils/func_utils.py", line 136, in aggregate_and_sample
    sampled_features[key] = self._gaussian_sampling(mean, cov, num_samples)
  File "/root/autodl-tmp/SAE-FedProto-CEC/system/utils/func_utils.py", line 176, in _gaussian_sampling
    sampled = np.random.multivariate_normal(mean, cov, num_samples)
  File "mtrand.pyx", line 4120, in numpy.random.mtrand.RandomState.multivariate_normal
  File "<__array_function__ internals>", line 5, in svd
  File "/root/miniconda3/lib/python3.8/site-packages/numpy/linalg/linalg.py", line 1660, in svd
    u, s, vh = gufunc(a, signature=signature, extobj=extobj)
  File "/root/miniconda3/lib/python3.8/site-packages/numpy/linalg/linalg.py", line 97, in _raise_linalgerror_svd_nonconvergence
    raise LinAlgError("SVD did not converge")
numpy.linalg.LinAlgError: SVD did not converge
