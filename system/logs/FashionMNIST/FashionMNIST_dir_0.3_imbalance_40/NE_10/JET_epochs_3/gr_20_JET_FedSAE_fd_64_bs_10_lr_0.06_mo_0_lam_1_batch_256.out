it is on jetson, train on CPU and no plots

==================================================
goal = test
device = cpu
device_id = 0
dataset = FashionMNIST_dir_0.3_imbalance_40
jetson = 1
DVFS = 0
drawGMM = 0
num_classes = 10
model_family = HCNNs8
batch_size = 256
num_workers = 0
local_learning_rate = 0.06
use_decay_scheduler = False
learning_rate_decay = False
learning_rate_decay_gamma = 0.99
global_rounds = 20
edge_epochs = 1
local_epochs = 3
algorithm = FedSAE
join_ratio = 1.0
edge_join_ratio = 1.0
random_join_ratio = False
num_clients = 40
num_edges = 10
prev = 0
times = 1
eval_gap = 4
save_folder_name = temp
auto_break = False
feature_dim = 64
vocab_size = 98635
max_len = 200
client_drop_rate = 0.0
train_slow_rate = 0.0
send_slow_rate = 0.0
time_select = False
time_threthold = 10000
optimizer = SGD
lamda = 1.0
weight_decay = 0
trans_delay_simulate = True
momentum = 0.0
agg_type = 0
buffersize = 10
gl_use_clients = 1
test_useglclassifier = 1
gamma = 1.0
extra_loss = 0
delta = 1
drawtsne = 0
drawround = 20
noise_dim = 32
generator_learning_rate = 0.0001
hidden_dim = 512
server_epochs = 100
alpha = 1.0
beta = 1.0
mentee_learning_rate = 0.005
T_start = 0.95
T_end = 0.98
server_learning_rate = 0.01
margin_threthold = 100.0
generator_path = stylegan/stylegan-xl-models/imagenet64.pkl
stable_diffusion_prompt = a cat
server_batch_size = 100
gen_batch_size = 4
mu = 50.0
buffer_size = 10
==================================================
Random seed set as 42

============= Running time: 0th =============
Creating server and clients ...
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes)
temp/FashionMNIST_dir_0.3_imbalance_40/NE_10/featuredim_64/FedSAE/SGD/lr_0.06/wd_0/momentum_0.0/lbs_256/lamda_1.0/localepoch_3/buffer_10/gamma_1.0_usegltest_1/1737356863.2985446
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 0
label_counts: defaultdict(<class 'int'>, {9: 545, 2: 98, 0: 287, 1: 338, 5: 106, 3: 26, 6: 3, 4: 1})
trans_simu_time 0.235
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 1
label_counts: defaultdict(<class 'int'>, {4: 630, 1: 507, 7: 199, 5: 47, 2: 18, 0: 18, 6: 2, 3: 3})
trans_simu_time 0.235
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 2
label_counts: defaultdict(<class 'int'>, {9: 99, 7: 312, 5: 157, 3: 30, 0: 190, 8: 6, 6: 67, 4: 11, 2: 3})
trans_simu_time 0.235
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 3
label_counts: defaultdict(<class 'int'>, {2: 395, 3: 171, 8: 190, 4: 51, 9: 19, 6: 100, 0: 3, 5: 4})
trans_simu_time 0.235
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 4
label_counts: defaultdict(<class 'int'>, {1: 428, 2: 202, 5: 553, 0: 327, 4: 5})
trans_simu_time 0.235
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 5
label_counts: defaultdict(<class 'int'>, {6: 633, 1: 100, 4: 421, 2: 58, 8: 45, 5: 13, 3: 41, 7: 11, 0: 1})
trans_simu_time 0.235
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 6
label_counts: defaultdict(<class 'int'>, {9: 425, 8: 384, 4: 260, 3: 24, 6: 31, 1: 12, 2: 6, 7: 1})
trans_simu_time 0.235
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 7
label_counts: defaultdict(<class 'int'>, {0: 36, 9: 477, 8: 645, 4: 53, 6: 335, 3: 38, 5: 13, 1: 11, 7: 16, 2: 7})
trans_simu_time 0.235
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 8
label_counts: defaultdict(<class 'int'>, {2: 81, 4: 502, 0: 124, 9: 102, 6: 63, 8: 26, 5: 17, 1: 3, 3: 9})
trans_simu_time 0.235
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 9
label_counts: defaultdict(<class 'int'>, {3: 943, 1: 139, 0: 75, 2: 177})
trans_simu_time 0.235
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 10
label_counts: defaultdict(<class 'int'>, {4: 883, 8: 445, 0: 32, 5: 19, 2: 57, 3: 12, 7: 1, 6: 1, 1: 1})
trans_simu_time 0.235
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 11
label_counts: defaultdict(<class 'int'>, {1: 58, 9: 88, 8: 220, 4: 230, 7: 8, 6: 147, 5: 54, 3: 44, 2: 13})
trans_simu_time 0.235
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 12
label_counts: defaultdict(<class 'int'>, {1: 263, 0: 206, 6: 248, 3: 165, 5: 101, 9: 14, 7: 1, 4: 1})
trans_simu_time 0.235
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 13
label_counts: defaultdict(<class 'int'>, {2: 795, 3: 402, 7: 197, 0: 11, 1: 7, 4: 7, 5: 3})
trans_simu_time 0.235
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 14
label_counts: defaultdict(<class 'int'>, {0: 312, 9: 218, 2: 44, 3: 131, 1: 57, 5: 65, 4: 21, 8: 3})
trans_simu_time 0.235
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 15
label_counts: defaultdict(<class 'int'>, {6: 980, 0: 83, 5: 215, 1: 39, 3: 12, 4: 2})
trans_simu_time 0.235
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 16
label_counts: defaultdict(<class 'int'>, {8: 280, 1: 860, 0: 140, 5: 68, 4: 58, 3: 83, 7: 1, 6: 18})
trans_simu_time 0.235
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 17
label_counts: defaultdict(<class 'int'>, {5: 490, 0: 104, 2: 16, 8: 642, 6: 21, 3: 30, 4: 28, 1: 2, 7: 1})
trans_simu_time 0.235
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 18
label_counts: defaultdict(<class 'int'>, {7: 229, 8: 391, 4: 108, 5: 27, 1: 105, 3: 33, 6: 2, 2: 1, 0: 1})
trans_simu_time 0.235
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 19
label_counts: defaultdict(<class 'int'>, {1: 364, 0: 1204})
trans_simu_time 0.235
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 20
label_counts: defaultdict(<class 'int'>, {9: 858, 5: 157, 1: 290, 7: 131, 4: 216, 0: 37, 3: 1, 6: 44, 2: 19, 8: 1})
trans_simu_time 0.235
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 21
label_counts: defaultdict(<class 'int'>, {1: 383, 6: 225, 4: 288, 0: 136, 3: 62, 8: 4, 9: 1, 7: 16, 5: 1})
trans_simu_time 0.235
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 22
label_counts: defaultdict(<class 'int'>, {5: 243, 7: 387, 1: 102, 6: 68, 8: 15, 0: 12, 2: 9, 4: 1, 3: 1})
trans_simu_time 0.235
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 23
label_counts: defaultdict(<class 'int'>, {5: 40, 0: 232, 8: 141, 9: 256, 1: 32, 6: 1, 3: 2, 7: 1})
trans_simu_time 0.235
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 24
label_counts: defaultdict(<class 'int'>, {0: 62, 9: 235, 3: 447, 4: 309, 5: 120, 8: 15, 1: 2})
trans_simu_time 0.235
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 25
label_counts: defaultdict(<class 'int'>, {7: 222, 3: 388, 5: 505, 2: 154, 1: 34, 4: 7, 0: 81})
trans_simu_time 0.235
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 26
label_counts: defaultdict(<class 'int'>, {8: 568, 0: 443, 7: 172, 4: 139, 2: 116, 5: 5, 3: 26, 1: 10})
trans_simu_time 0.235
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 27
label_counts: defaultdict(<class 'int'>, {5: 530, 2: 186, 6: 253, 0: 88, 3: 75, 4: 5, 7: 1})
trans_simu_time 0.235
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 28
label_counts: defaultdict(<class 'int'>, {7: 176, 8: 93, 4: 1, 9: 281, 0: 22, 2: 50, 1: 63, 3: 24, 5: 14, 6: 2})
trans_simu_time 0.235
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 29
label_counts: defaultdict(<class 'int'>, {7: 363, 5: 337, 3: 170, 1: 20, 8: 138, 9: 164, 2: 27, 4: 2, 6: 3})
trans_simu_time 0.235
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 30
label_counts: defaultdict(<class 'int'>, {0: 243, 7: 302, 9: 43, 8: 229, 5: 24, 1: 2, 3: 2, 2: 1})
trans_simu_time 0.235
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 31
label_counts: defaultdict(<class 'int'>, {2: 510, 4: 583, 0: 98, 1: 223})
trans_simu_time 0.235
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 32
label_counts: defaultdict(<class 'int'>, {9: 1142, 5: 146, 1: 20, 2: 276, 3: 51, 0: 31, 7: 49, 6: 75, 8: 12, 4: 1})
trans_simu_time 0.235
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 33
label_counts: defaultdict(<class 'int'>, {7: 122, 3: 276, 6: 254, 2: 405, 0: 151, 1: 76, 4: 83})
trans_simu_time 0.235
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 34
label_counts: defaultdict(<class 'int'>, {6: 870, 0: 172, 2: 880, 1: 42, 3: 12, 4: 9})
trans_simu_time 0.235
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 35
label_counts: defaultdict(<class 'int'>, {5: 70, 4: 312, 8: 1, 2: 90, 0: 300, 6: 18, 7: 36, 3: 121, 9: 70, 1: 25})
trans_simu_time 0.235
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 36
label_counts: defaultdict(<class 'int'>, {2: 127, 7: 124, 3: 364, 8: 221, 6: 412, 9: 158, 1: 41, 4: 5, 0: 3})
trans_simu_time 0.235
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 37
label_counts: defaultdict(<class 'int'>, {7: 2178, 3: 1002, 5: 11, 6: 142, 2: 20, 0: 1, 4: 3})
trans_simu_time 0.235
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 38
label_counts: defaultdict(<class 'int'>, {5: 1124, 1: 545, 2: 23, 3: 21, 0: 14, 4: 1})
trans_simu_time 0.235
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 39
label_counts: defaultdict(<class 'int'>, {1: 41, 2: 387, 8: 501, 6: 233, 5: 12, 0: 13, 9: 3, 3: 2, 7: 2, 4: 1})
trans_simu_time 0.235

Join ratio / total clients: 1.0 / 40
Finished creating server and clients.
tobetrained:
[9, 8, 7, 6, 5, 4, 3, 2, 1, 0]
Edge 9 begin training
Edge 8 begin training
Edge 7 begin training
Edge 6 begin training
Edge 5 begin training
Edge 4 begin training
Edge 3 begin training
Edge 2 begin training
Edge 1 begin training
Edge 0 begin training
readyList:
[7, 5, 1, 6, 2, 8, 9, 0, 4, 3]
aggregation_buffer:
[7, 5, 1, 6, 2, 8, 9, 0, 4, 3]
train global classifier
train glclassifier time: 27.952703038998152
global classifier accuracy in train virtual: 52.485
end Update
server_global_time: 67.41137109899951
only_train_time: 872.6594520790168

-------------Global Round number: 0-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.4436
Averaged Test Accuracy (Prototype Model): 0.3288
Averaged Train Loss (Regular Model): 1.7180
Averaged Train Loss (Regular + Proto): 1.7180
All Energy: 1992.1266
Std Test Accuracy (Regular Model): 0.2757
Std Test Accuracy (Prototype Model): 0.2322
tobetrained:
[7, 5, 1, 6, 2, 8, 9, 0, 4, 3]
Edge 7 begin training
Edge 5 begin training
Edge 1 begin training
Edge 6 begin training
Edge 2 begin training
Edge 8 begin training
Edge 9 begin training
Edge 0 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 5, 9, 6, 1, 2, 8, 0, 4, 3]
aggregation_buffer:
[7, 5, 9, 6, 1, 2, 8, 0, 4, 3]
train global classifier
train glclassifier time: 23.06950351300111
global classifier accuracy in train virtual: 72.9775
end Update
server_global_time: 134.72338666699753
only_train_time: 1751.5146717190073
tobetrained:
[7, 5, 9, 6, 1, 2, 8, 0, 4, 3]
Edge 7 begin training
Edge 5 begin training
Edge 9 begin training
Edge 6 begin training
Edge 1 begin training
Edge 2 begin training
Edge 8 begin training
Edge 0 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 5, 9, 6, 2, 1, 8, 0, 4, 3]
aggregation_buffer:
[7, 5, 9, 6, 2, 1, 8, 0, 4, 3]
train global classifier
train glclassifier time: 22.31959541299875
global classifier accuracy in train virtual: 83.23
end Update
server_global_time: 202.6070957449982
only_train_time: 2629.5684243920296
tobetrained:
[7, 5, 9, 6, 2, 1, 8, 0, 4, 3]
Edge 7 begin training
Edge 5 begin training
Edge 9 begin training
Edge 6 begin training
Edge 2 begin training
Edge 1 begin training
Edge 8 begin training
Edge 0 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 5, 9, 1, 6, 2, 8, 0, 4, 3]
aggregation_buffer:
[7, 5, 9, 1, 6, 2, 8, 0, 4, 3]
train global classifier
train glclassifier time: 22.740077769998607
global classifier accuracy in train virtual: 88.14
end Update
server_global_time: 268.804135659
only_train_time: 3504.2380056970287
tobetrained:
[7, 5, 9, 1, 6, 2, 8, 0, 4, 3]
Edge 7 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 6 begin training
Edge 2 begin training
Edge 8 begin training
Edge 0 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 5, 9, 6, 1, 2, 8, 0, 4, 3]
aggregation_buffer:
[7, 5, 9, 6, 1, 2, 8, 0, 4, 3]
train global classifier
train glclassifier time: 22.982328299000073
global classifier accuracy in train virtual: 90.015
end Update
server_global_time: 335.2542086590009
only_train_time: 4380.079591629026

-------------Global Round number: 4-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.8277
Averaged Test Accuracy (Prototype Model): 0.8281
Averaged Train Loss (Regular Model): 0.5635
Averaged Train Loss (Regular + Proto): 0.6121
All Energy: 9958.9293
Std Test Accuracy (Regular Model): 0.1173
Std Test Accuracy (Prototype Model): 0.1133
tobetrained:
[7, 5, 9, 6, 1, 2, 8, 0, 4, 3]
Edge 7 begin training
Edge 5 begin training
Edge 9 begin training
Edge 6 begin training
Edge 1 begin training
Edge 2 begin training
Edge 8 begin training
Edge 0 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 5, 9, 6, 1, 2, 8, 0, 4, 3]
aggregation_buffer:
[7, 5, 9, 6, 1, 2, 8, 0, 4, 3]
train global classifier
train glclassifier time: 21.86693085400111
global classifier accuracy in train virtual: 91.4125
end Update
server_global_time: 401.0548795390003
only_train_time: 5254.084249232008
tobetrained:
[7, 5, 9, 6, 1, 2, 8, 0, 4, 3]
Edge 7 begin training
Edge 5 begin training
Edge 9 begin training
Edge 6 begin training
Edge 1 begin training
Edge 2 begin training
Edge 8 begin training
Edge 0 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 5, 9, 6, 1, 8, 2, 0, 4, 3]
aggregation_buffer:
[7, 5, 9, 6, 1, 8, 2, 0, 4, 3]
train global classifier
train glclassifier time: 23.093942416999198
global classifier accuracy in train virtual: 92.2075
end Update
server_global_time: 467.7818381460009
only_train_time: 6130.573589990003
tobetrained:
[7, 5, 9, 6, 1, 8, 2, 0, 4, 3]
Edge 7 begin training
Edge 5 begin training
Edge 9 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 5, 9, 6, 1, 2, 8, 0, 4, 3]
aggregation_buffer:
[7, 5, 9, 6, 1, 2, 8, 0, 4, 3]
train global classifier
train glclassifier time: 22.122175222997612
global classifier accuracy in train virtual: 92.865
end Update
server_global_time: 534.3889465909995
only_train_time: 7002.409401461995
tobetrained:
[7, 5, 9, 6, 1, 2, 8, 0, 4, 3]
Edge 7 begin training
Edge 5 begin training
Edge 9 begin training
Edge 6 begin training
Edge 1 begin training
Edge 2 begin training
Edge 8 begin training
Edge 0 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 5, 9, 6, 1, 2, 8, 0, 4, 3]
aggregation_buffer:
[7, 5, 9, 6, 1, 2, 8, 0, 4, 3]
train global classifier
train glclassifier time: 22.32992450999882
global classifier accuracy in train virtual: 93.4725
end Update
server_global_time: 601.3202262080019
only_train_time: 7879.844575531988

-------------Global Round number: 8-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.8620
Averaged Test Accuracy (Prototype Model): 0.8631
Averaged Train Loss (Regular Model): 0.4018
Averaged Train Loss (Regular + Proto): 0.4477
All Energy: 17930.6885
Std Test Accuracy (Regular Model): 0.0964
Std Test Accuracy (Prototype Model): 0.0911
tobetrained:
[7, 5, 9, 6, 1, 2, 8, 0, 4, 3]
Edge 7 begin training
Edge 5 begin training
Edge 9 begin training
Edge 6 begin training
Edge 1 begin training
Edge 2 begin training
Edge 8 begin training
Edge 0 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 5, 9, 6, 1, 2, 8, 0, 4, 3]
aggregation_buffer:
[7, 5, 9, 6, 1, 2, 8, 0, 4, 3]
train global classifier
train glclassifier time: 22.23552895999819
global classifier accuracy in train virtual: 94.0425
end Update
server_global_time: 668.1185358180026
only_train_time: 8751.966935677989
tobetrained:
[7, 5, 9, 6, 1, 2, 8, 0, 4, 3]
Edge 7 begin training
Edge 5 begin training
Edge 9 begin training
Edge 6 begin training
Edge 1 begin training
Edge 2 begin training
Edge 8 begin training
Edge 0 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 5, 9, 1, 6, 2, 8, 0, 4, 3]
aggregation_buffer:
[7, 5, 9, 1, 6, 2, 8, 0, 4, 3]
train global classifier
train glclassifier time: 22.10845715799951
global classifier accuracy in train virtual: 94.3775
end Update
server_global_time: 735.4426494910028
only_train_time: 9630.915327701983
tobetrained:
[7, 5, 9, 1, 6, 2, 8, 0, 4, 3]
Edge 7 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 6 begin training
Edge 2 begin training
Edge 8 begin training
Edge 0 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 5, 9, 6, 1, 2, 8, 0, 4, 3]
aggregation_buffer:
[7, 5, 9, 6, 1, 2, 8, 0, 4, 3]
train global classifier
train glclassifier time: 22.327391989001626
global classifier accuracy in train virtual: 94.6325
end Update
server_global_time: 802.953747531006
only_train_time: 10509.220281138994

-------------Global Round number: 11-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.8749
Averaged Test Accuracy (Prototype Model): 0.8738
Averaged Train Loss (Regular Model): 0.3572
Averaged Train Loss (Regular + Proto): 0.4027
All Energy: 23940.6866
Std Test Accuracy (Regular Model): 0.0802
Std Test Accuracy (Prototype Model): 0.0809
tobetrained:
[7, 5, 9, 6, 1, 2, 8, 0, 4, 3]
Edge 7 begin training
Edge 5 begin training
Edge 9 begin training
Edge 6 begin training
Edge 1 begin training
Edge 2 begin training
Edge 8 begin training
Edge 0 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 5, 9, 1, 6, 2, 8, 0, 4, 3]
aggregation_buffer:
[7, 5, 9, 1, 6, 2, 8, 0, 4, 3]
train global classifier
train glclassifier time: 22.07366103900131
global classifier accuracy in train virtual: 94.95
end Update
server_global_time: 869.5865627560058
only_train_time: 11384.701296582978

-------------Global Round number: 12-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.8804
Averaged Test Accuracy (Prototype Model): 0.8799
Averaged Train Loss (Regular Model): 0.3448
Averaged Train Loss (Regular + Proto): 0.3896
All Energy: 25935.5626
Std Test Accuracy (Regular Model): 0.0790
Std Test Accuracy (Prototype Model): 0.0781
tobetrained:
[7, 5, 9, 1, 6, 2, 8, 0, 4, 3]
Edge 7 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 6 begin training
Edge 2 begin training
Edge 8 begin training
Edge 0 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 5, 9, 6, 1, 2, 8, 0, 4, 3]
aggregation_buffer:
[7, 5, 9, 6, 1, 2, 8, 0, 4, 3]
train global classifier
train glclassifier time: 22.093809088000853
global classifier accuracy in train virtual: 94.9
end Update
server_global_time: 936.4396533200031
only_train_time: 12264.09492348797

-------------Global Round number: 13-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.8843
Averaged Test Accuracy (Prototype Model): 0.8814
Averaged Train Loss (Regular Model): 0.3320
Averaged Train Loss (Regular + Proto): 0.3761
All Energy: 27932.0882
Std Test Accuracy (Regular Model): 0.0741
Std Test Accuracy (Prototype Model): 0.0754
tobetrained:
[7, 5, 9, 6, 1, 2, 8, 0, 4, 3]
Edge 7 begin training
Edge 5 begin training
Edge 9 begin training
Edge 6 begin training
Edge 1 begin training
Edge 2 begin training
Edge 8 begin training
Edge 0 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 5, 6, 1, 9, 2, 8, 0, 4, 3]
aggregation_buffer:
[7, 5, 6, 1, 9, 2, 8, 0, 4, 3]
train global classifier
train glclassifier time: 22.321403105997888
global classifier accuracy in train virtual: 95.1725
end Update
server_global_time: 1003.4831931279975
only_train_time: 13133.217432463975

-------------Global Round number: 14-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.8869
Averaged Test Accuracy (Prototype Model): 0.8849
Averaged Train Loss (Regular Model): 0.3210
Averaged Train Loss (Regular + Proto): 0.3645
All Energy: 29914.6830
Std Test Accuracy (Regular Model): 0.0716
Std Test Accuracy (Prototype Model): 0.0740
tobetrained:
[7, 5, 6, 1, 9, 2, 8, 0, 4, 3]
Edge 7 begin training
Edge 5 begin training
Edge 6 begin training
Edge 1 begin training
Edge 9 begin training
Edge 2 begin training
Edge 8 begin training
Edge 0 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 5, 9, 1, 6, 2, 8, 0, 4, 3]
aggregation_buffer:
[7, 5, 9, 1, 6, 2, 8, 0, 4, 3]
train global classifier
train glclassifier time: 21.709272703999886
global classifier accuracy in train virtual: 95.3625
end Update
server_global_time: 1069.960040075995
only_train_time: 14007.879520093968

-------------Global Round number: 15-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.8899
Averaged Test Accuracy (Prototype Model): 0.8881
Averaged Train Loss (Regular Model): 0.3147
Averaged Train Loss (Regular + Proto): 0.3582
All Energy: 31927.7901
Std Test Accuracy (Regular Model): 0.0746
Std Test Accuracy (Prototype Model): 0.0749
tobetrained:
[7, 5, 9, 1, 6, 2, 8, 0, 4, 3]
Edge 7 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 6 begin training
Edge 2 begin training
Edge 8 begin training
Edge 0 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 5, 9, 6, 1, 2, 8, 0, 4, 3]
aggregation_buffer:
[7, 5, 9, 6, 1, 2, 8, 0, 4, 3]
train global classifier
train glclassifier time: 21.767030274000717
global classifier accuracy in train virtual: 95.6575
end Update
server_global_time: 1138.3871163160004
only_train_time: 14888.549850479987

-------------Global Round number: 16-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.8928
Averaged Test Accuracy (Prototype Model): 0.8891
Averaged Train Loss (Regular Model): 0.3093
Averaged Train Loss (Regular + Proto): 0.3530
All Energy: 33918.6601
Std Test Accuracy (Regular Model): 0.0701
Std Test Accuracy (Prototype Model): 0.0726
tobetrained:
[7, 5, 9, 6, 1, 2, 8, 0, 4, 3]
Edge 7 begin training
Edge 5 begin training
Edge 9 begin training
Edge 6 begin training
Edge 1 begin training
Edge 2 begin training
Edge 8 begin training
Edge 0 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 5, 9, 6, 1, 8, 2, 0, 4, 3]
aggregation_buffer:
[7, 5, 9, 6, 1, 8, 2, 0, 4, 3]
train global classifier
train glclassifier time: 22.53671988000133
global classifier accuracy in train virtual: 95.8
end Update
server_global_time: 1204.5532841239992
only_train_time: 15765.51968442099

-------------Global Round number: 17-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.8897
Averaged Test Accuracy (Prototype Model): 0.8891
Averaged Train Loss (Regular Model): 0.2998
Averaged Train Loss (Regular + Proto): 0.3428
All Energy: 35914.9706
Std Test Accuracy (Regular Model): 0.0737
Std Test Accuracy (Prototype Model): 0.0710
tobetrained:
[7, 5, 9, 6, 1, 8, 2, 0, 4, 3]
Edge 7 begin training
Edge 5 begin training
Edge 9 begin training
Edge 6 begin training
Edge 1 begin training
Edge 8 begin training
Edge 2 begin training
Edge 0 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 5, 9, 6, 1, 2, 8, 0, 4, 3]
aggregation_buffer:
[7, 5, 9, 6, 1, 2, 8, 0, 4, 3]
train global classifier
train glclassifier time: 22.1472769289976
global classifier accuracy in train virtual: 95.9975
end Update
server_global_time: 1270.6782124079998
only_train_time: 16640.65009859799

-------------Global Round number: 18-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.8887
Averaged Test Accuracy (Prototype Model): 0.8889
Averaged Train Loss (Regular Model): 0.2948
Averaged Train Loss (Regular + Proto): 0.3382
All Energy: 37923.6415
Std Test Accuracy (Regular Model): 0.0712
Std Test Accuracy (Prototype Model): 0.0694
tobetrained:
[7, 5, 9, 6, 1, 2, 8, 0, 4, 3]
Edge 7 begin training
Edge 5 begin training
Edge 9 begin training
Edge 6 begin training
Edge 1 begin training
Edge 2 begin training
Edge 8 begin training
Edge 0 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 5, 9, 6, 1, 2, 8, 0, 4, 3]
aggregation_buffer:
[7, 5, 9, 6, 1, 2, 8, 0, 4, 3]
train global classifier
train glclassifier time: 22.675418923994584
global classifier accuracy in train virtual: 95.94
end Update
server_global_time: 1337.8672775170003
only_train_time: 17520.496641510017

-------------Global Round number: 19-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.8943
Averaged Test Accuracy (Prototype Model): 0.8934
Averaged Train Loss (Regular Model): 0.2870
Averaged Train Loss (Regular + Proto): 0.3299
All Energy: 39926.1143
Std Test Accuracy (Regular Model): 0.0702
Std Test Accuracy (Prototype Model): 0.0704
tobetrained:
[7, 5, 9, 6, 1, 2, 8, 0, 4, 3]
Edge 7 begin training
Edge 5 begin training
Edge 9 begin training
Edge 6 begin training
Edge 1 begin training
Edge 2 begin training
Edge 8 begin training
Edge 0 begin training
Edge 4 begin training
Edge 3 begin training
readyList:
[7, 5, 9, 6, 1, 2, 8, 0, 4, 3]
aggregation_buffer:
[7, 5, 9, 6, 1, 2, 8, 0, 4, 3]
train global classifier
train glclassifier time: 22.54345077399921
global classifier accuracy in train virtual: 96.405
end Update
server_global_time: 1404.1224941379944
only_train_time: 18400.142495309996

-------------Global Round number: 20-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.8926
Averaged Test Accuracy (Prototype Model): 0.8913
Averaged Train Loss (Regular Model): 0.2800
Averaged Train Loss (Regular + Proto): 0.3225
All Energy: 41907.2948
Std Test Accuracy (Regular Model): 0.0816
Std Test Accuracy (Prototype Model): 0.0808

Best accuracy.
0.894313120931826
File path: ../results/FashionMNIST_dir_0.3_imbalance_40_FedSAE_test_0.h5

Average time cost: 19848.06s.
Length:  13
std for best accurancy: 0.0
mean for best accurancy: 0.894313120931826
All done!

Storage on cpu
-------------------------------------------------------------------------------
Total Tensors: 660 	Used Memory: 3.50K
-------------------------------------------------------------------------------

Storage on cuda:0
-------------------------------------------------------------------------------
Total Tensors: 1300 	Used Memory: 6.00K
The allocated memory on cuda:0: 6.00K
-------------------------------------------------------------------------------
