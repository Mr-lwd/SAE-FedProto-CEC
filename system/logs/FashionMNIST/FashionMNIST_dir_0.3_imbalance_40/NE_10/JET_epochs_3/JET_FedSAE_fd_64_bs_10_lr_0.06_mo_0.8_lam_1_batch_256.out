it is on jetson, train on CPU and no plots

==================================================
goal = test
device = cpu
device_id = 0
dataset = FashionMNIST_dir_0.3_imbalance_40
jetson = 1
DVFS = 0
drawGMM = 0
num_classes = 10
model_family = HCNNs8
batch_size = 256
num_workers = 0
local_learning_rate = 0.06
use_decay_scheduler = False
learning_rate_decay = False
learning_rate_decay_gamma = 0.99
global_rounds = 100
edge_epochs = 1
local_epochs = 3
algorithm = FedSAE
join_ratio = 1.0
edge_join_ratio = 1.0
random_join_ratio = False
num_clients = 10
num_edges = 10
prev = 0
times = 1
eval_gap = 1
save_folder_name = temp
auto_break = False
feature_dim = 64
vocab_size = 98635
max_len = 200
client_drop_rate = 0.0
train_slow_rate = 0.0
send_slow_rate = 0.0
time_select = False
time_threthold = 10000
optimizer = SGD
lamda = 1.0
weight_decay = 0
trans_delay_simulate = False
momentum = 0.8
agg_type = 0
buffersize = 10
gl_use_clients = 1
test_useglclassifier = 1
gamma = 1.0
extra_loss = 0
delta = 1
drawtsne = 0
drawround = 20
noise_dim = 512
generator_learning_rate = 0.0001
hidden_dim = 512
server_epochs = 100
alpha = 1.0
beta = 1.0
mentee_learning_rate = 0.005
T_start = 0.95
T_end = 0.98
server_learning_rate = 0.01
margin_threthold = 100.0
generator_path = stylegan/stylegan-xl-models/imagenet64.pkl
stable_diffusion_prompt = a cat
server_batch_size = 100
gen_batch_size = 4
mu = 50.0
buffer_size = 10
==================================================
Random seed set as 42

============= Running time: 0th =============
Creating server and clients ...
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes)
temp/FashionMNIST_dir_0.3_imbalance_40/NE_10/featuredim_64/FedSAE/SGD/lr_0.06/wd_0/momentum_0.8/lbs_256/lamda_1.0/localepoch_3/buffer_10/gamma_1.0_usegltest_1/1736819864.1223834
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 0
label_counts: defaultdict(<class 'int'>, {9: 545, 2: 98, 0: 287, 1: 338, 5: 106, 3: 26, 6: 3, 4: 1})
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 1
label_counts: defaultdict(<class 'int'>, {4: 630, 1: 507, 7: 199, 5: 47, 2: 18, 0: 18, 6: 2, 3: 3})
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 2
label_counts: defaultdict(<class 'int'>, {9: 99, 7: 312, 5: 157, 3: 30, 0: 190, 8: 6, 6: 67, 4: 11, 2: 3})
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 3
label_counts: defaultdict(<class 'int'>, {2: 395, 3: 171, 8: 190, 4: 51, 9: 19, 6: 100, 0: 3, 5: 4})
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 4
label_counts: defaultdict(<class 'int'>, {1: 428, 2: 202, 5: 553, 0: 327, 4: 5})
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 5
label_counts: defaultdict(<class 'int'>, {6: 633, 1: 100, 4: 421, 2: 58, 8: 45, 5: 13, 3: 41, 7: 11, 0: 1})
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 6
label_counts: defaultdict(<class 'int'>, {9: 425, 8: 384, 4: 260, 3: 24, 6: 31, 1: 12, 2: 6, 7: 1})
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 7
label_counts: defaultdict(<class 'int'>, {0: 36, 9: 477, 8: 645, 4: 53, 6: 335, 3: 38, 5: 13, 1: 11, 7: 16, 2: 7})
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 8
label_counts: defaultdict(<class 'int'>, {2: 81, 4: 502, 0: 124, 9: 102, 6: 63, 8: 26, 5: 17, 1: 3, 3: 9})
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 9
label_counts: defaultdict(<class 'int'>, {3: 943, 1: 139, 0: 75, 2: 177})

Join ratio / total clients: 1.0 / 10
Finished creating server and clients.
tobetrained:
[9, 8, 7, 6, 5, 4, 3, 2, 1, 0]
Edge 9 begin training
Edge 8 begin training
Edge 7 begin training
Edge 6 begin training
Edge 5 begin training
Edge 4 begin training
Edge 3 begin training
Edge 2 begin training
Edge 1 begin training
Edge 0 begin training
readyList:
[0, 5, 3, 1, 6, 7, 2, 9, 4, 8]
aggregation_buffer:
[0, 5, 3, 1, 6, 7, 2, 9, 4, 8]
item[mean] tensor([0.1408, 0.3519, 0.2300, 0.3015, 0.5368, 0.3596, 0.2542, 0.2081, 0.2227,
        0.7386, 0.3949, 0.6249, 0.2656, 0.0587, 0.2703, 0.1845, 0.2243, 0.4301,
        0.3277, 0.6511, 0.4820, 0.2135, 0.1134, 0.2590, 0.3035, 0.3742, 0.1839,
        0.1800, 0.4851, 0.4947, 0.2186, 0.2096, 0.2388, 0.3580, 0.1867, 0.4218,
        0.5513, 0.4288, 0.2408, 0.4158, 0.5241, 0.4158, 0.6016, 0.3085, 0.1953,
        0.1954, 0.1700, 0.4827, 0.3869, 0.4008, 0.1400, 0.2165, 0.3002, 0.1371,
        0.2833, 0.3438, 0.2744, 0.5364, 0.2425, 0.3120, 0.1362, 0.2936, 0.5795,
        0.2285])
item[cov] tensor([[ 0.0547,  0.0349,  0.0034,  ..., -0.0055,  0.0905,  0.0493],
        [ 0.0349,  0.3324,  0.0383,  ...,  0.0619,  0.2891,  0.1300],
        [ 0.0034,  0.0383,  0.0910,  ...,  0.1117,  0.0368,  0.0291],
        ...,
        [-0.0055,  0.0619,  0.1117,  ...,  0.1896,  0.0128,  0.0165],
        [ 0.0905,  0.2891,  0.0368,  ...,  0.0128,  0.4446,  0.1675],
        [ 0.0493,  0.1300,  0.0291,  ...,  0.0165,  0.1675,  0.1023]])
item[mean] tensor([0.2430, 0.1572, 0.6187, 0.5902, 0.4848, 0.3778, 0.1625, 0.0946, 0.2533,
        0.6367, 0.1100, 0.1760, 0.6918, 0.0101, 0.5178, 0.0961, 0.9902, 0.2320,
        0.6152, 0.5289, 0.5125, 0.9296, 0.7154, 0.2737, 0.6045, 0.1561, 0.2485,
        0.2793, 0.8058, 1.0156, 0.5500, 0.1466, 0.4916, 0.7598, 0.1739, 0.5327,
        0.4072, 0.6184, 0.7413, 0.8055, 0.5554, 0.3935, 0.6840, 0.2418, 0.1994,
        0.0806, 0.3498, 1.1165, 0.2095, 0.4684, 0.1964, 0.2908, 0.1858, 0.6180,
        0.4183, 0.3678, 0.3456, 0.4535, 0.5220, 0.2961, 0.3328, 0.6970, 0.1503,
        0.3864])
item[cov] tensor([[ 6.1236e-02,  3.1983e-02, -3.9973e-04,  ..., -8.1719e-02,
          9.3973e-03,  1.0997e-01],
        [ 3.1983e-02,  3.3542e-02,  2.5068e-02,  ..., -2.0811e-02,
         -5.6653e-03,  7.5605e-02],
        [-3.9973e-04,  2.5068e-02,  2.1956e-01,  ...,  2.3571e-01,
         -3.5680e-02,  7.5668e-02],
        ...,
        [-8.1719e-02, -2.0811e-02,  2.3571e-01,  ...,  4.2716e-01,
         -4.9802e-02, -1.2031e-01],
        [ 9.3973e-03, -5.6653e-03, -3.5680e-02,  ..., -4.9802e-02,
          2.6422e-02,  8.6266e-03],
        [ 1.0997e-01,  7.5605e-02,  7.5668e-02,  ..., -1.2031e-01,
          8.6266e-03,  3.0533e-01]])
item[mean] tensor([0.1509, 0.6833, 0.5108, 0.7589, 0.7693, 0.7294, 0.5304, 0.3314, 0.7093,
        1.6678, 0.8647, 1.3228, 0.2647, 0.0787, 0.1888, 0.1687, 0.2338, 0.5377,
        0.5677, 1.1032, 1.0062, 0.2479, 0.2826, 0.5912, 0.3801, 1.3560, 0.5155,
        0.2964, 0.8813, 0.9981, 0.4238, 0.6643, 0.3715, 0.7012, 0.3312, 0.8996,
        1.2057, 1.2196, 0.4969, 0.8819, 0.9042, 0.8376, 0.8025, 0.3299, 0.3445,
        0.1887, 0.5551, 1.1819, 0.4196, 0.7676, 0.3870, 0.3683, 0.9006, 0.1797,
        0.6206, 0.8419, 0.6698, 1.1095, 0.4170, 0.2305, 0.1574, 0.2467, 1.3546,
        0.6152])
item[cov] tensor([[ 0.0539,  0.0276, -0.0221,  ..., -0.0064,  0.0431,  0.0315],
        [ 0.0276,  0.4748,  0.1736,  ..., -0.0303,  0.5075,  0.1335],
        [-0.0221,  0.1736,  0.2188,  ...,  0.0150,  0.2444,  0.0167],
        ...,
        [-0.0064, -0.0303,  0.0150,  ...,  0.0677, -0.1086, -0.0392],
        [ 0.0431,  0.5075,  0.2444,  ..., -0.1086,  0.9825,  0.1590],
        [ 0.0315,  0.1335,  0.0167,  ..., -0.0392,  0.1590,  0.1911]])
item[mean] tensor([0.2591, 1.6207, 0.0742, 0.3019, 0.2635, 0.5801, 0.4252, 0.8007, 0.4224,
        0.9935, 1.1219, 0.3984, 0.7594, 0.0592, 0.0688, 0.2997, 0.9637, 0.3757,
        0.1097, 0.0747, 0.1870, 0.1637, 0.0966, 0.4285, 0.0314, 0.6392, 0.2909,
        0.6914, 0.0753, 0.6116, 0.7831, 0.1149, 0.7065, 0.1007, 0.1546, 0.4261,
        0.3703, 0.7391, 0.1240, 0.7688, 0.6756, 0.3014, 0.3896, 1.0898, 0.2553,
        0.3288, 0.0648, 1.2650, 1.1773, 0.3025, 0.0995, 0.6064, 1.1431, 0.4809,
        0.1546, 0.7827, 1.0614, 0.4139, 0.4335, 0.6334, 0.2499, 0.7590, 0.2701,
        0.4049])
item[cov] tensor([[ 5.1277e-02,  1.6304e-01, -6.3689e-03,  ...,  5.5308e-02,
          4.0882e-02,  3.7531e-02],
        [ 1.6304e-01,  4.8744e+00, -7.6621e-02,  ...,  2.0296e+00,
          1.2763e-01,  6.4663e-01],
        [-6.3689e-03, -7.6621e-02,  1.3762e-02,  ..., -1.3849e-02,
          2.9762e-03, -4.5298e-03],
        ...,
        [ 5.5308e-02,  2.0296e+00, -1.3849e-02,  ...,  8.9582e-01,
          2.2736e-02,  2.5430e-01],
        [ 4.0882e-02,  1.2763e-01,  2.9762e-03,  ...,  2.2736e-02,
          1.0029e-01,  8.1144e-02],
        [ 3.7531e-02,  6.4663e-01, -4.5298e-03,  ...,  2.5430e-01,
          8.1144e-02,  1.9610e-01]])
item[mean] tensor([0.0524, 0.0439, 0.1786, 0.1212, 0.3381, 0.4723, 0.0130, 0.0980, 0.1895,
        0.1115, 0.0160, 0.1155, 0.4542, 0.0132, 0.2676, 0.0205, 0.2219, 0.0706,
        0.0545, 0.5617, 0.2052, 0.2619, 0.0893, 0.0488, 0.2113, 0.0555, 0.1771,
        0.0562, 0.1448, 0.5510, 0.1092, 0.1670, 0.7024, 0.0629, 0.1323, 0.2944,
        0.6351, 0.5746, 0.0803, 0.1015, 0.4845, 0.0933, 0.4892, 0.0581, 0.2905,
        0.0415, 0.0254, 0.2082, 0.1489, 0.1300, 0.0635, 0.0627, 0.1032, 0.3631,
        0.0623, 0.1682, 0.0444, 0.6304, 0.2168, 0.3583, 0.4902, 0.3761, 0.1745,
        0.0666])
item[cov] tensor([[ 0.0046,  0.0008, -0.0004,  ..., -0.0017,  0.0036,  0.0030],
        [ 0.0008,  0.0104,  0.0058,  ...,  0.0027,  0.0062,  0.0135],
        [-0.0004,  0.0058,  0.0430,  ...,  0.0635,  0.0040, -0.0026],
        ...,
        [-0.0017,  0.0027,  0.0635,  ...,  0.1259,  0.0187, -0.0134],
        [ 0.0036,  0.0062,  0.0040,  ...,  0.0187,  0.0201,  0.0134],
        [ 0.0030,  0.0135, -0.0026,  ..., -0.0134,  0.0134,  0.0595]])
item[mean] tensor([0.1457, 0.0269, 0.0578, 0.0259, 0.1111, 0.1045, 0.0338, 0.0608, 0.0554,
        0.0458, 0.0872, 0.0217, 0.1048, 0.0208, 0.0802, 0.0263, 0.0871, 0.0464,
        0.1173, 0.0898, 0.0703, 0.0726, 0.0278, 0.1028, 0.0171, 0.0657, 0.1011,
        0.0229, 0.0537, 0.2022, 0.0786, 0.1084, 0.0535, 0.0751, 0.0570, 0.0771,
        0.1465, 0.0774, 0.0436, 0.1340, 0.0696, 0.0630, 0.0572, 0.0249, 0.1256,
        0.1302, 0.0433, 0.1252, 0.0907, 0.1474, 0.0358, 0.0394, 0.1775, 0.0577,
        0.0484, 0.0973, 0.0385, 0.1428, 0.0661, 0.0433, 0.0586, 0.0633, 0.1481,
        0.0738])
item[cov] tensor([[ 0.0347, -0.0026,  0.0001,  ..., -0.0033,  0.0316,  0.0169],
        [-0.0026,  0.0029,  0.0044,  ...,  0.0084, -0.0021, -0.0002],
        [ 0.0001,  0.0044,  0.0102,  ...,  0.0200,  0.0012,  0.0006],
        ...,
        [-0.0033,  0.0084,  0.0200,  ...,  0.0422,  0.0005, -0.0010],
        [ 0.0316, -0.0021,  0.0012,  ...,  0.0005,  0.0308,  0.0171],
        [ 0.0169, -0.0002,  0.0006,  ..., -0.0010,  0.0171,  0.0154]])
item[mean] tensor([1.0306, 0.6532, 0.1842, 1.0021, 1.1316, 0.3361, 1.0744, 0.2357, 1.4086,
        3.5516, 1.2983, 4.3211, 1.2660, 0.0555, 0.5700, 0.2415, 0.3881, 2.5068,
        1.3240, 3.1090, 1.9618, 0.3849, 0.6622, 0.4701, 0.6459, 0.8681, 0.4879,
        0.3813, 2.0336, 2.0683, 0.5261, 0.3850, 0.5114, 1.4727, 0.4415, 0.7224,
        1.6007, 1.2679, 0.2873, 1.7219, 2.9765, 1.0393, 2.3848, 0.3705, 0.2273,
        0.1319, 0.3083, 0.5812, 0.5735, 1.0595, 0.5581, 0.7387, 0.4603, 0.2478,
        0.7394, 0.4913, 0.5412, 1.1359, 0.3437, 1.3100, 0.7385, 0.3449, 1.2085,
        0.9961])
item[cov] tensor([[ 0.4171, -0.1842, -0.0279,  ..., -0.0944,  0.2061, -0.0769],
        [-0.1842,  1.5680,  0.0045,  ...,  0.4163,  0.3820,  0.2823],
        [-0.0279,  0.0045,  0.0127,  ...,  0.0066, -0.0175,  0.0029],
        ...,
        [-0.0944,  0.4163,  0.0066,  ...,  0.1323,  0.0417,  0.0674],
        [ 0.2061,  0.3820, -0.0175,  ...,  0.0417,  0.4329,  0.1034],
        [-0.0769,  0.2823,  0.0029,  ...,  0.0674,  0.1034,  0.2451]])
item[mean] tensor([0.3672, 1.0380, 0.8737, 0.8960, 1.7324, 0.8175, 0.4884, 0.4742, 0.7185,
        2.3292, 1.1186, 1.9283, 0.7616, 0.0577, 0.2185, 0.4420, 1.1433, 0.7418,
        1.0336, 1.5593, 1.1501, 0.9584, 0.8650, 0.9266, 0.9892, 1.3340, 0.9786,
        0.3854, 1.5723, 1.4693, 0.0540, 0.8653, 0.8776, 1.2911, 0.2663, 1.0215,
        1.8354, 1.3084, 0.4877, 0.9533, 1.1947, 1.2217, 1.8216, 0.2531, 0.5386,
        0.3612, 1.2287, 0.8074, 0.5909, 0.6876, 0.3748, 0.5230, 1.2136, 0.7714,
        1.0656, 0.8597, 0.9456, 1.7934, 0.8992, 0.3065, 0.5083, 0.3035, 1.8592,
        1.0010])
item[cov] tensor([[ 0.0703,  0.0164, -0.0052,  ...,  0.0147, -0.2068,  0.0638],
        [ 0.0164,  0.3948,  0.3970,  ..., -0.0573,  0.6382,  0.2565],
        [-0.0052,  0.3970,  0.7386,  ..., -0.0814,  0.8677,  0.4028],
        ...,
        [ 0.0147, -0.0573, -0.0814,  ...,  0.0388, -0.2377, -0.0319],
        [-0.2068,  0.6382,  0.8677,  ..., -0.2377,  2.3999,  0.3038],
        [ 0.0638,  0.2565,  0.4028,  ..., -0.0319,  0.3038,  0.3396]])
item[mean] tensor([0.3256, 0.9933, 0.1942, 0.3758, 1.3079, 0.7975, 0.2359, 0.5967, 0.0826,
        0.6908, 0.4068, 0.3724, 0.1369, 0.2830, 0.8503, 0.6709, 0.5933, 0.3759,
        0.0271, 0.0984, 0.3335, 0.2405, 0.0317, 0.0309, 0.9695, 0.1344, 0.1027,
        0.4053, 0.3970, 0.1420, 0.0307, 0.0400, 0.2260, 0.0520, 0.8261, 0.2678,
        0.5737, 0.1306, 0.0297, 0.0502, 0.0891, 0.0894, 0.9260, 1.0145, 0.4784,
        1.1189, 0.2498, 0.0811, 0.7536, 0.2448, 0.0317, 0.3037, 0.5848, 0.0585,
        0.2786, 0.0617, 0.2232, 1.1751, 0.1131, 0.9380, 0.0700, 0.2489, 1.3367,
        0.3673])
item[cov] tensor([[0.0348, 0.0916, 0.0028,  ..., 0.0125, 0.1117, 0.0221],
        [0.0916, 0.3401, 0.0533,  ..., 0.0337, 0.4344, 0.0957],
        [0.0028, 0.0533, 0.0570,  ..., 0.0089, 0.0881, 0.0354],
        ...,
        [0.0125, 0.0337, 0.0089,  ..., 0.0241, 0.0391, 0.0070],
        [0.1117, 0.4344, 0.0881,  ..., 0.0391, 0.5842, 0.1295],
        [0.0221, 0.0957, 0.0354,  ..., 0.0070, 0.1295, 0.0732]])
item[mean] tensor([0.2755, 0.3636, 0.3333, 0.8984, 0.4666, 0.2840, 0.0193, 0.0487, 1.0607,
        0.4874, 0.0678, 1.0962, 0.4533, 0.0794, 0.3049, 0.1882, 0.7685, 0.0615,
        0.2143, 0.3962, 0.2672, 0.6867, 1.2241, 0.0939, 0.5146, 0.5696, 0.4293,
        0.6262, 0.9866, 0.8415, 0.0577, 0.3766, 0.1450, 0.6431, 0.9112, 0.4603,
        0.1344, 0.3223, 0.1890, 0.3673, 0.8584, 0.1626, 0.5137, 0.2087, 0.1338,
        0.2914, 0.4882, 0.6598, 0.0962, 0.4897, 0.7700, 0.6104, 0.2236, 0.3246,
        0.8462, 0.1183, 0.2257, 0.9066, 0.3606, 0.0246, 0.5874, 0.3858, 0.3541,
        1.0713])
item[cov] tensor([[ 0.0992,  0.0259,  0.0336,  ...,  0.0159, -0.0670, -0.1616],
        [ 0.0259,  0.0165,  0.0124,  ...,  0.0065, -0.0086,  0.0009],
        [ 0.0336,  0.0124,  0.0183,  ...,  0.0114, -0.0146, -0.0242],
        ...,
        [ 0.0159,  0.0065,  0.0114,  ...,  0.0135, -0.0014, -0.0016],
        [-0.0670, -0.0086, -0.0146,  ..., -0.0014,  0.0611,  0.1670],
        [-0.1616,  0.0009, -0.0242,  ..., -0.0016,  0.1670,  0.5282]])
train global classifier
train glclassifier time: 24.676777543999833
global classifier accuracy in train virtual: 67.605
end Update
server_global_time: 33.85403995300021
only_train_time: 216.57648573500046

-------------Global Round number: 0-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.5951
Averaged Test Accuracy (Prototype Model): 0.5134
Averaged Train Loss (Regular Model): 1.2461
Averaged Train Loss (Regular + Proto): 1.2461
All Energy: 488.1869
Std Test Accuracy (Regular Model): 0.1936
Std Test Accuracy (Prototype Model): 0.2344
tobetrained:
[0, 5, 3, 1, 6, 7, 2, 9, 4, 8]
Edge 0 begin training
Edge 5 begin training
Edge 3 begin training
