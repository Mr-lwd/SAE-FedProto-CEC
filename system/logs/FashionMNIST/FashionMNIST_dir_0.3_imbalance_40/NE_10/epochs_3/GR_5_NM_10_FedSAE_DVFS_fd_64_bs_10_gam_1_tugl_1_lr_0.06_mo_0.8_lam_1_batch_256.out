
cuda is not avaiable.

==================================================
goal = test
device = cpu
device_id = 0
dataset = FashionMNIST_dir_0.3_imbalance_40
jetson = 0
DVFS = 0
drawGMM = 0
num_classes = 10
model_family = HCNNs8
batch_size = 256
num_workers = 0
local_learning_rate = 0.06
use_decay_scheduler = False
learning_rate_decay = False
learning_rate_decay_gamma = 0.99
global_rounds = 5
edge_epochs = 1
local_epochs = 3
algorithm = FedSAE_DVFS
join_ratio = 1.0
edge_join_ratio = 1.0
random_join_ratio = False
num_clients = 10
num_edges = 10
prev = 0
times = 1
eval_gap = 1
save_folder_name = temp
auto_break = False
feature_dim = 64
vocab_size = 98635
max_len = 200
client_drop_rate = 0.0
train_slow_rate = 0.0
send_slow_rate = 0.0
time_select = False
time_threthold = 10000
optimizer = SGD
lamda = 1.0
weight_decay = 0
trans_delay_simulate = False
momentum = 0.8
agg_type = 0
buffersize = 10
gl_use_clients = 1
test_useglclassifier = 1
gamma = 1.0
extra_loss = 0
delta = 1
drawtsne = 0
drawround = 20
noise_dim = 32
generator_learning_rate = 0.0001
hidden_dim = 512
server_epochs = 100
alpha = 1.0
beta = 1.0
mentee_learning_rate = 0.005
T_start = 0.95
T_end = 0.98
server_learning_rate = 0.01
margin_threthold = 100.0
generator_path = stylegan/stylegan-xl-models/imagenet64.pkl
stable_diffusion_prompt = a cat
server_batch_size = 100
gen_batch_size = 4
mu = 50.0
buffer_size = 10
==================================================
Random seed set as 42

============= Running time: 0th =============
Creating server and clients ...
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes)
temp/FashionMNIST_dir_0.3_imbalance_40/NE_10/featuredim_64/FedSAE_DVFS/SGD/lr_0.06/wd_0/momentum_0.8/lbs_256/lamda_1.0/localepoch_3/buffer_10/gamma_1.0_usegltest_1/1736926346.4887824
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 0
label_counts: defaultdict(<class 'int'>, {9: 545, 2: 98, 0: 287, 1: 338, 5: 106, 3: 26, 6: 3, 4: 1})
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 1
label_counts: defaultdict(<class 'int'>, {4: 630, 1: 507, 7: 199, 5: 47, 2: 18, 0: 18, 6: 2, 3: 3})
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 2
label_counts: defaultdict(<class 'int'>, {9: 99, 7: 312, 5: 157, 3: 30, 0: 190, 8: 6, 6: 67, 4: 11, 2: 3})
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 3
label_counts: defaultdict(<class 'int'>, {2: 395, 3: 171, 8: 190, 4: 51, 9: 19, 6: 100, 0: 3, 5: 4})
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 4
label_counts: defaultdict(<class 'int'>, {1: 428, 2: 202, 5: 553, 0: 327, 4: 5})
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 5
label_counts: defaultdict(<class 'int'>, {6: 633, 1: 100, 4: 421, 2: 58, 8: 45, 5: 13, 3: 41, 7: 11, 0: 1})
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 6
label_counts: defaultdict(<class 'int'>, {9: 425, 8: 384, 4: 260, 3: 24, 6: 31, 1: 12, 2: 6, 7: 1})
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 7
label_counts: defaultdict(<class 'int'>, {0: 36, 9: 477, 8: 645, 4: 53, 6: 335, 3: 38, 5: 13, 1: 11, 7: 16, 2: 7})
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 8
label_counts: defaultdict(<class 'int'>, {2: 81, 4: 502, 0: 124, 9: 102, 6: 63, 8: 26, 5: 17, 1: 3, 3: 9})
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 9
label_counts: defaultdict(<class 'int'>, {3: 943, 1: 139, 0: 75, 2: 177})

Join ratio / total clients: 1.0 / 10
Finished creating server and clients.
tobetrained:
[9, 8, 7, 6, 5, 4, 3, 2, 1, 0]
Edge 9 begin training
Edge 8 begin training
Edge 7 begin training
Edge 6 begin training
Edge 5 begin training
Edge 4 begin training
Edge 3 begin training
Edge 2 begin training
Edge 1 begin training
Edge 0 begin training
readyList:
[5, 0, 1, 6, 3, 4, 2, 9, 8, 7]
aggregation_buffer:
[5, 0, 1, 6, 3, 4, 2, 9, 8, 7]
train global classifier
train glclassifier time: 3.6649299347773194
global classifier accuracy in train virtual: 56.17
end Update
server_global_time: 2.2147873174399137
only_train_time: 16.07849851809442

-------------Global Round number: 0-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.4099
Averaged Test Accuracy (Prototype Model): 0.4123
Averaged Train Loss (Regular Model): 1.7468
Averaged Train Loss (Regular + Proto): 1.7468
Std Test Accuracy (Regular Model): 0.2404
Std Test Accuracy (Prototype Model): 0.1818
tobetrained:
[5, 0, 1, 6, 3, 4, 2, 9, 8, 7]
Edge 5 begin training
Edge 0 begin training
Edge 1 begin training
Edge 6 begin training
Edge 3 begin training
Edge 4 begin training
Edge 2 begin training
Edge 9 begin training
Edge 8 begin training
Edge 7 begin training
readyList:
[0, 5, 6, 1, 3, 7, 2, 4, 9, 8]
aggregation_buffer:
[0, 5, 6, 1, 3, 7, 2, 4, 9, 8]
train global classifier
train glclassifier time: 3.5622022729367018
global classifier accuracy in train virtual: 69.275
end Update
server_global_time: 4.605951047502458
only_train_time: 32.67568895407021

-------------Global Round number: 1-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6255
Averaged Test Accuracy (Prototype Model): 0.6011
Averaged Train Loss (Regular Model): 1.2991
Averaged Train Loss (Regular + Proto): 1.3669
Std Test Accuracy (Regular Model): 0.2197
Std Test Accuracy (Prototype Model): 0.2348
tobetrained:
[0, 5, 6, 1, 3, 7, 2, 4, 9, 8]
Edge 0 begin training
Edge 5 begin training
Edge 6 begin training
Edge 1 begin training
Edge 3 begin training
Edge 7 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 8 begin training
readyList:
[0, 5, 6, 3, 1, 4, 7, 2, 8, 9]
aggregation_buffer:
[0, 5, 6, 3, 1, 4, 7, 2, 8, 9]
train global classifier
train glclassifier time: 4.045697170309722
global classifier accuracy in train virtual: 78.7975
end Update
server_global_time: 7.8513105642050505
only_train_time: 49.73794351425022

-------------Global Round number: 2-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.6857
Averaged Test Accuracy (Prototype Model): 0.6433
Averaged Train Loss (Regular Model): 1.0232
Averaged Train Loss (Regular + Proto): 1.0863
Std Test Accuracy (Regular Model): 0.2069
Std Test Accuracy (Prototype Model): 0.2249
tobetrained:
[0, 5, 6, 3, 1, 4, 7, 2, 8, 9]
Edge 0 begin training
Edge 5 begin training
Edge 6 begin training
Edge 3 begin training
Edge 1 begin training
Edge 4 begin training
Edge 7 begin training
Edge 2 begin training
Edge 8 begin training
Edge 9 begin training
readyList:
[5, 0, 6, 1, 2, 4, 3, 9, 7, 8]
aggregation_buffer:
[5, 0, 6, 1, 2, 4, 3, 9, 7, 8]
train global classifier
train glclassifier time: 4.2754063149914145
global classifier accuracy in train virtual: 83.155
end Update
server_global_time: 9.95090285781771
only_train_time: 64.14201613888144

-------------Global Round number: 3-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.7159
Averaged Test Accuracy (Prototype Model): 0.6945
Averaged Train Loss (Regular Model): 0.8508
Averaged Train Loss (Regular + Proto): 0.9040
Std Test Accuracy (Regular Model): 0.2134
Std Test Accuracy (Prototype Model): 0.2171
tobetrained:
[5, 0, 6, 1, 2, 4, 3, 9, 7, 8]
Edge 5 begin training
Edge 0 begin training
Edge 6 begin training
Edge 1 begin training
Edge 2 begin training
Edge 4 begin training
Edge 3 begin training
Edge 9 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[0, 5, 6, 1, 3, 2, 4, 9, 8, 7]
aggregation_buffer:
[0, 5, 6, 1, 3, 2, 4, 9, 8, 7]
train global classifier
train glclassifier time: 3.442793671041727
global classifier accuracy in train virtual: 86.38
end Update
server_global_time: 11.750480367802083
only_train_time: 77.7122659003362

-------------Global Round number: 4-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.7532
Averaged Test Accuracy (Prototype Model): 0.7480
Averaged Train Loss (Regular Model): 0.7209
Averaged Train Loss (Regular + Proto): 0.7750
Std Test Accuracy (Regular Model): 0.2146
Std Test Accuracy (Prototype Model): 0.2062
tobetrained:
[0, 5, 6, 1, 3, 2, 4, 9, 8, 7]
Edge 0 begin training
Edge 5 begin training
Edge 6 begin training
Edge 1 begin training
Edge 3 begin training
Edge 2 begin training
Edge 4 begin training
Edge 9 begin training
Edge 8 begin training
Edge 7 begin training
readyList:
[0, 5, 6, 2, 4, 3, 1, 9, 8, 7]
aggregation_buffer:
[0, 5, 6, 2, 4, 3, 1, 9, 8, 7]
train global classifier
train glclassifier time: 3.3705263333395123
global classifier accuracy in train virtual: 89.44
end Update
server_global_time: 13.570297194644809
only_train_time: 91.1060892380774

-------------Global Round number: 5-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.8148
Averaged Test Accuracy (Prototype Model): 0.8091
Averaged Train Loss (Regular Model): 0.6114
Averaged Train Loss (Regular + Proto): 0.6691
Std Test Accuracy (Regular Model): 0.1863
Std Test Accuracy (Prototype Model): 0.1875

Best accuracy.
0.8148059415428845
File path: ../results/FashionMNIST_dir_0.3_imbalance_40_FedSAE_DVFS_test_0.h5

Average time cost: 139.85s.
Length:  6
std for best accurancy: 0.0
mean for best accurancy: 0.8148059415428845
All done!

Storage on cpu
-------------------------------------------------------------------------------
Total Tensors: 70846612 	Used Memory: 270.45M
-------------------------------------------------------------------------------
