==================================================
goal = test
device = cuda
device_id = 0
dataset = FashionMNIST_dir_0.1_imbalance_40
num_classes = 10
model_family = HCNNs8
batch_size = 256
num_workers = 0
local_learning_rate = 0.06
use_decay_scheduler = False
learning_rate_decay = False
learning_rate_decay_gamma = 0.99
global_rounds = 200
edge_epochs = 1
local_epochs = 5
algorithm = FedTGP
join_ratio = 1.0
random_join_ratio = False
num_clients = 40
num_edges = 10
prev = 0
times = 1
eval_gap = 1
save_folder_name = temp
auto_break = False
feature_dim = 512
vocab_size = 98635
max_len = 200
client_drop_rate = 0.0
train_slow_rate = 0.0
send_slow_rate = 0.0
time_select = False
time_threthold = 10000
optimizer = SGD
lamda = 1.0
weight_decay = 0
trans_delay_simulate = False
momentum = 0.8
agg_type = 0
buffersize = 10
gl_use_clients = 1
test_useglclassifier = 1
gamma = 1
drawtsne = 1
drawround = 20
noise_dim = 512
generator_learning_rate = 0.0001
hidden_dim = 512
server_epochs = 100
alpha = 1.0
beta = 1.0
mentee_learning_rate = 0.005
T_start = 0.95
T_end = 0.98
server_learning_rate = 0.01
margin_threthold = 100.0
generator_path = stylegan/stylegan-xl-models/imagenet64.pkl
stable_diffusion_prompt = a cat
server_batch_size = 100
gen_batch_size = 4
mu = 50.0
==================================================
Random seed set as 42

============= Running time: 0th =============
Creating server and clients ...
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes)
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 0
label_counts: defaultdict(<class 'int'>, {7: 1486, 2: 18, 6: 1})
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 1
label_counts: defaultdict(<class 'int'>, {6: 128, 2: 23, 4: 74, 1: 141, 5: 907, 0: 64})
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 2
label_counts: defaultdict(<class 'int'>, {3: 903, 0: 187, 2: 364})
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 3
label_counts: defaultdict(<class 'int'>, {5: 157, 6: 498, 7: 4})
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 4
label_counts: defaultdict(<class 'int'>, {6: 712, 3: 83, 1: 39, 7: 11, 4: 2, 5: 2})
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 5
label_counts: defaultdict(<class 'int'>, {5: 1671, 0: 176, 2: 1})
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 6
label_counts: defaultdict(<class 'int'>, {0: 185, 4: 494, 6: 351, 5: 40, 3: 10})
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 7
label_counts: defaultdict(<class 'int'>, {8: 1071, 7: 88, 1: 11, 2: 5, 6: 1, 9: 1, 0: 1})
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 8
label_counts: defaultdict(<class 'int'>, {4: 595, 3: 633, 9: 21, 1: 2})
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 9
label_counts: defaultdict(<class 'int'>, {3: 592, 0: 983, 2: 17, 1: 1})
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 10
label_counts: defaultdict(<class 'int'>, {8: 386, 3: 6, 2: 2, 6: 8})
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 11
label_counts: defaultdict(<class 'int'>, {9: 280, 4: 95, 6: 1, 2: 13, 7: 3, 0: 1})
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 12
label_counts: defaultdict(<class 'int'>, {1: 1691, 0: 569})
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 13
label_counts: defaultdict(<class 'int'>, {2: 776, 1: 161, 6: 174, 7: 15, 8: 31, 3: 156, 5: 1})
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 14
label_counts: defaultdict(<class 'int'>, {3: 247, 8: 61, 5: 46})
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 15
label_counts: defaultdict(<class 'int'>, {5: 445, 2: 802, 9: 96, 1: 52, 3: 11, 0: 1})
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 16
label_counts: defaultdict(<class 'int'>, {2: 619, 0: 5, 3: 21, 9: 1})
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 17
label_counts: defaultdict(<class 'int'>, {0: 404, 2: 27, 6: 5, 5: 3, 7: 4, 3: 1})
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 18
label_counts: defaultdict(<class 'int'>, {9: 357, 7: 31, 4: 5, 8: 3})
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 19
label_counts: defaultdict(<class 'int'>, {9: 716, 7: 20, 8: 2})
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 20
label_counts: defaultdict(<class 'int'>, {9: 672, 5: 198, 0: 3, 1: 2, 6: 1})
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 21
label_counts: defaultdict(<class 'int'>, {6: 3263, 1: 578, 3: 141, 5: 73, 2: 1})
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 22
label_counts: defaultdict(<class 'int'>, {9: 2370, 2: 63, 1: 46, 7: 2})
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 23
label_counts: defaultdict(<class 'int'>, {9: 360, 4: 40, 0: 5, 1: 19, 8: 4})
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 24
label_counts: defaultdict(<class 'int'>, {3: 992, 6: 49, 9: 28, 2: 4})
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 25
label_counts: defaultdict(<class 'int'>, {7: 602, 8: 1902, 2: 180})
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 26
label_counts: defaultdict(<class 'int'>, {7: 1823, 3: 55, 0: 710, 4: 101, 1: 214, 5: 7})
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 27
label_counts: defaultdict(<class 'int'>, {0: 253, 2: 295, 6: 15, 3: 28, 1: 9})
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 28
label_counts: defaultdict(<class 'int'>, {9: 250, 0: 249, 4: 500, 6: 5, 8: 5, 3: 1, 5: 2})
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 29
label_counts: defaultdict(<class 'int'>, {5: 914, 6: 5, 1: 20, 9: 3})
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 30
label_counts: defaultdict(<class 'int'>, {3: 253, 7: 708, 2: 384})
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 31
label_counts: defaultdict(<class 'int'>, {0: 279, 9: 92, 7: 269, 8: 14, 1: 19, 5: 2})
CNN(num_cov=1, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 32
label_counts: defaultdict(<class 'int'>, {5: 748, 2: 239, 3: 354, 4: 12})
CNN(num_cov=2, hidden_dims=[], in_features=1, num_classes=args.num_classes) model chosen!
id 33
label_counts: defaultdict(<class 'int'>, {1: 985, 0: 320, 3: 122})
CNN(num_cov=1, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 34
label_counts: defaultdict(<class 'int'>, {2: 1409, 1: 79})
CNN(num_cov=2, hidden_dims=[512], in_features=1, num_classes=args.num_classes) model chosen!
id 35
label_counts: defaultdict(<class 'int'>, {4: 2966, 0: 161, 1: 2})
CNN(num_cov=1, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 36
label_counts: defaultdict(<class 'int'>, {1: 1198, 7: 171, 3: 3, 5: 10})
CNN(num_cov=2, hidden_dims=[1024], in_features=1, num_classes=args.num_classes) model chosen!
id 37
label_counts: defaultdict(<class 'int'>, {3: 642, 0: 148, 4: 103, 5: 51, 9: 11, 1: 1})
CNN(num_cov=1, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 38
label_counts: defaultdict(<class 'int'>, {0: 494, 5: 8, 8: 9, 7: 1})
CNN(num_cov=2, hidden_dims=[1024, 512], in_features=1, num_classes=args.num_classes) model chosen!
id 39
label_counts: defaultdict(<class 'int'>, {8: 1743, 4: 256, 7: 32, 6: 15, 0: 1, 2: 1, 1: 1, 3: 1, 9: 1, 5: 1})

Join ratio / total clients: 1.0 / 40
Finished creating server and clients.
Trainable_prototypes(
  (embedings): Embedding(10, 512)
  (middle): Sequential(
    (0): Sequential(
      (0): Linear(in_features=512, out_features=512, bias=True)
      (1): ReLU()
    )
  )
  (fc): Linear(in_features=512, out_features=512, bias=True)
)
tobetrained:
[9, 8, 7, 6, 5, 4, 3, 2, 1, 0]
Edge 9 begin training
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Edge 8 begin training
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Edge 7 begin training
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Edge 6 begin training
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Edge 5 begin training
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Edge 4 begin training
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Edge 3 begin training
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Edge 2 begin training
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Edge 1 begin training
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Edge 0 begin training
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
Server global_protos Not Found
readyList:
[5, 4, 3, 1, 9, 6, 0, 2, 7, 8]
aggregation_buffer:
[5, 4, 3, 1, 9, 6, 0, 2, 7, 8]
class-wise minimum distance tensor([1.8701, 2.3792, 1.9222, 2.3792, 2.8042, 1.6817, 1.6817, 1.9903, 1.9660,
        2.2580], device='cuda:0')
min_gap tensor(1.6817, device='cuda:0')
max_gap tensor(2.8042, device='cuda:0')
Server loss: 4.713450908660889
Number of samples: 192
end Update
server_global_time: 0.8036246625706553
only_train_time: 10.107525760307908

-------------Global Round number: 0-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9128
Averaged Test Accuracy (Prototype Model): 0.4803
Averaged Train Loss (Regular Model): 0.3671
Averaged Train Loss (Regular + Proto): 0.3671
Std Test Accuracy (Regular Model): 0.1023
Std Test Accuracy (Prototype Model): 0.3636
tobetrained:
[5, 4, 3, 1, 9, 6, 0, 2, 7, 8]
Edge 5 begin training
Edge 4 begin training
Edge 3 begin training
Edge 1 begin training
Edge 9 begin training
Edge 6 begin training
Edge 0 begin training
Edge 2 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[9, 5, 3, 4, 1, 6, 0, 2, 7, 8]
aggregation_buffer:
[9, 5, 3, 4, 1, 6, 0, 2, 7, 8]
class-wise minimum distance tensor([1.1790, 1.4611, 1.0469, 1.4611, 1.2338, 1.3007, 1.0469, 1.2920, 1.2920,
        1.6700], device='cuda:0')
min_gap tensor(1.0469, device='cuda:0')
max_gap tensor(1.6700, device='cuda:0')
Server loss: 3.2011468410491943
end Update
server_global_time: 1.9952902309596539
only_train_time: 24.844771708361804

-------------Global Round number: 1-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9539
Averaged Test Accuracy (Prototype Model): 0.9287
Averaged Train Loss (Regular Model): 0.1859
Averaged Train Loss (Regular + Proto): 0.2698
Std Test Accuracy (Regular Model): 0.0622
Std Test Accuracy (Prototype Model): 0.0915
tobetrained:
[9, 5, 3, 4, 1, 6, 0, 2, 7, 8]
Edge 9 begin training
Edge 5 begin training
Edge 3 begin training
Edge 4 begin training
Edge 1 begin training
Edge 6 begin training
Edge 0 begin training
Edge 2 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[5, 4, 9, 3, 6, 1, 0, 2, 7, 8]
aggregation_buffer:
[5, 4, 9, 3, 6, 1, 0, 2, 7, 8]
class-wise minimum distance tensor([1.4240, 1.7589, 1.2865, 1.7589, 1.4506, 1.6512, 1.2865, 1.6478, 1.6478,
        2.0906], device='cuda:0')
min_gap tensor(1.2865, device='cuda:0')
max_gap tensor(2.0906, device='cuda:0')
Server loss: 3.2214486598968506
end Update
server_global_time: 3.1468843296170235
only_train_time: 39.68779015541077

-------------Global Round number: 2-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9610
Averaged Test Accuracy (Prototype Model): 0.9431
Averaged Train Loss (Regular Model): 0.1365
Averaged Train Loss (Regular + Proto): 0.2130
Std Test Accuracy (Regular Model): 0.0565
Std Test Accuracy (Prototype Model): 0.0639
tobetrained:
[5, 4, 9, 3, 6, 1, 0, 2, 7, 8]
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
Edge 6 begin training
Edge 1 begin training
Edge 0 begin training
Edge 2 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[5, 9, 3, 4, 6, 1, 2, 0, 7, 8]
aggregation_buffer:
[5, 9, 3, 4, 6, 1, 2, 0, 7, 8]
class-wise minimum distance tensor([1.8092, 2.1600, 1.5715, 2.1600, 1.7855, 2.0947, 1.5715, 1.9411, 1.9411,
        2.6112], device='cuda:0')
min_gap tensor(1.5715, device='cuda:0')
max_gap tensor(2.6112, device='cuda:0')
Server loss: 3.35953688621521
end Update
server_global_time: 4.376303926110268
only_train_time: 54.32176361884922

-------------Global Round number: 3-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9652
Averaged Test Accuracy (Prototype Model): 0.9489
Averaged Train Loss (Regular Model): 0.1101
Averaged Train Loss (Regular + Proto): 0.1892
Std Test Accuracy (Regular Model): 0.0446
Std Test Accuracy (Prototype Model): 0.0599
tobetrained:
[5, 9, 3, 4, 6, 1, 2, 0, 7, 8]
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 4 begin training
Edge 6 begin training
Edge 1 begin training
Edge 2 begin training
Edge 0 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[5, 9, 3, 4, 1, 6, 0, 2, 7, 8]
aggregation_buffer:
[5, 9, 3, 4, 1, 6, 0, 2, 7, 8]
class-wise minimum distance tensor([2.2596, 2.6576, 1.9132, 2.6576, 2.1463, 2.5225, 1.9132, 2.4651, 2.4651,
        3.0200], device='cuda:0')
min_gap tensor(1.9132, device='cuda:0')
max_gap tensor(3.0200, device='cuda:0')
Server loss: 3.4067697525024414
end Update
server_global_time: 5.576668509282172
only_train_time: 69.31697246711701

-------------Global Round number: 4-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9650
Averaged Test Accuracy (Prototype Model): 0.9563
Averaged Train Loss (Regular Model): 0.0864
Averaged Train Loss (Regular + Proto): 0.1739
Std Test Accuracy (Regular Model): 0.0454
Std Test Accuracy (Prototype Model): 0.0560
tobetrained:
[5, 9, 3, 4, 1, 6, 0, 2, 7, 8]
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 4 begin training
Edge 1 begin training
Edge 6 begin training
Edge 0 begin training
Edge 2 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[5, 3, 4, 9, 1, 6, 2, 0, 7, 8]
aggregation_buffer:
[5, 3, 4, 9, 1, 6, 2, 0, 7, 8]
class-wise minimum distance tensor([2.6456, 3.1656, 2.1927, 3.1656, 2.5512, 2.9803, 2.1927, 3.0551, 3.0066,
        3.4755], device='cuda:0')
min_gap tensor(2.1927, device='cuda:0')
max_gap tensor(3.4755, device='cuda:0')
Server loss: 3.5406389236450195
end Update
server_global_time: 6.779959289357066
only_train_time: 84.39646045677364

-------------Global Round number: 5-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9681
Averaged Test Accuracy (Prototype Model): 0.9581
Averaged Train Loss (Regular Model): 0.0844
Averaged Train Loss (Regular + Proto): 0.1836
Std Test Accuracy (Regular Model): 0.0437
Std Test Accuracy (Prototype Model): 0.0539
tobetrained:
[5, 3, 4, 9, 1, 6, 2, 0, 7, 8]
Edge 5 begin training
Edge 3 begin training
Edge 4 begin training
Edge 9 begin training
Edge 1 begin training
Edge 6 begin training
Edge 2 begin training
Edge 0 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[5, 9, 4, 3, 1, 6, 0, 2, 7, 8]
aggregation_buffer:
[5, 9, 4, 3, 1, 6, 0, 2, 7, 8]
class-wise minimum distance tensor([3.1484, 3.6802, 2.6081, 3.5844, 3.0776, 3.4973, 2.6081, 3.6346, 3.5465,
        3.9638], device='cuda:0')
min_gap tensor(2.6081, device='cuda:0')
max_gap tensor(3.9638, device='cuda:0')
Server loss: 3.6799004077911377
end Update
server_global_time: 7.95733386836946
only_train_time: 99.33431494794786

-------------Global Round number: 6-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9689
Averaged Test Accuracy (Prototype Model): 0.9600
Averaged Train Loss (Regular Model): 0.0628
Averaged Train Loss (Regular + Proto): 0.1743
Std Test Accuracy (Regular Model): 0.0442
Std Test Accuracy (Prototype Model): 0.0522
tobetrained:
[5, 9, 4, 3, 1, 6, 0, 2, 7, 8]
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
Edge 1 begin training
Edge 6 begin training
Edge 0 begin training
Edge 2 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[5, 4, 9, 3, 1, 6, 2, 0, 7, 8]
aggregation_buffer:
[5, 4, 9, 3, 1, 6, 2, 0, 7, 8]
class-wise minimum distance tensor([3.5679, 4.1527, 2.9444, 3.9546, 3.6027, 3.8962, 2.9444, 4.1639, 4.0007,
        4.4563], device='cuda:0')
min_gap tensor(2.9444, device='cuda:0')
max_gap tensor(4.4563, device='cuda:0')
Server loss: 3.8574745655059814
end Update
server_global_time: 9.123399038799107
only_train_time: 114.45252261310816

-------------Global Round number: 7-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9701
Averaged Test Accuracy (Prototype Model): 0.9617
Averaged Train Loss (Regular Model): 0.0621
Averaged Train Loss (Regular + Proto): 0.1887
Std Test Accuracy (Regular Model): 0.0403
Std Test Accuracy (Prototype Model): 0.0485
tobetrained:
[5, 4, 9, 3, 1, 6, 2, 0, 7, 8]
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
Edge 6 begin training
Edge 2 begin training
Edge 0 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[5, 9, 4, 3, 1, 6, 2, 0, 7, 8]
aggregation_buffer:
[5, 9, 4, 3, 1, 6, 2, 0, 7, 8]
class-wise minimum distance tensor([4.1306, 4.7576, 3.3487, 4.4672, 4.2257, 4.4668, 3.3487, 4.6975, 4.5599,
        4.9060], device='cuda:0')
min_gap tensor(3.3487, device='cuda:0')
max_gap tensor(4.9060, device='cuda:0')
Server loss: 3.96160888671875
end Update
server_global_time: 10.342271848581731
only_train_time: 129.65857333596796

-------------Global Round number: 8-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9710
Averaged Test Accuracy (Prototype Model): 0.9618
Averaged Train Loss (Regular Model): 0.0442
Averaged Train Loss (Regular + Proto): 0.1861
Std Test Accuracy (Regular Model): 0.0410
Std Test Accuracy (Prototype Model): 0.0502
tobetrained:
[5, 9, 4, 3, 1, 6, 2, 0, 7, 8]
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
Edge 1 begin training
Edge 6 begin training
Edge 2 begin training
Edge 0 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[5, 9, 4, 3, 1, 6, 0, 2, 7, 8]
aggregation_buffer:
[5, 9, 4, 3, 1, 6, 0, 2, 7, 8]
class-wise minimum distance tensor([4.6932, 5.3236, 3.7972, 4.9672, 4.7938, 4.9927, 3.7972, 5.2008, 5.0541,
        5.3355], device='cuda:0')
min_gap tensor(3.7972, device='cuda:0')
max_gap tensor(5.3355, device='cuda:0')
Server loss: 4.095653533935547
end Update
server_global_time: 11.558094689622521
only_train_time: 144.70624763239175

-------------Global Round number: 9-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9722
Averaged Test Accuracy (Prototype Model): 0.9630
Averaged Train Loss (Regular Model): 0.0380
Averaged Train Loss (Regular + Proto): 0.1978
Std Test Accuracy (Regular Model): 0.0344
Std Test Accuracy (Prototype Model): 0.0458
tobetrained:
[5, 9, 4, 3, 1, 6, 0, 2, 7, 8]
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
Edge 1 begin training
Edge 6 begin training
Edge 0 begin training
Edge 2 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[9, 4, 3, 5, 1, 6, 2, 0, 7, 8]
aggregation_buffer:
[9, 4, 3, 5, 1, 6, 2, 0, 7, 8]
class-wise minimum distance tensor([5.2479, 5.8629, 4.1529, 5.3405, 5.4082, 5.3898, 4.1529, 5.6387, 5.5451,
        5.8782], device='cuda:0')
min_gap tensor(4.1529, device='cuda:0')
max_gap tensor(5.8782, device='cuda:0')
Server loss: 4.289721965789795
end Update
server_global_time: 12.716438009403646
only_train_time: 159.6394527470693

-------------Global Round number: 10-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9724
Averaged Test Accuracy (Prototype Model): 0.9651
Averaged Train Loss (Regular Model): 0.0336
Averaged Train Loss (Regular + Proto): 0.2130
Std Test Accuracy (Regular Model): 0.0366
Std Test Accuracy (Prototype Model): 0.0440
tobetrained:
[9, 4, 3, 5, 1, 6, 2, 0, 7, 8]
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
Edge 5 begin training
Edge 1 begin training
Edge 6 begin training
Edge 2 begin training
Edge 0 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[9, 5, 3, 4, 1, 6, 0, 7, 2, 8]
aggregation_buffer:
[9, 5, 3, 4, 1, 6, 0, 7, 2, 8]
class-wise minimum distance tensor([5.8614, 6.4240, 4.6376, 5.7455, 6.1435, 5.9520, 4.6376, 6.1937, 5.8660,
        6.3888], device='cuda:0')
min_gap tensor(4.6376, device='cuda:0')
max_gap tensor(6.4240, device='cuda:0')
Server loss: 4.507388591766357
end Update
server_global_time: 13.904329437762499
only_train_time: 174.94471865613014

-------------Global Round number: 11-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9712
Averaged Test Accuracy (Prototype Model): 0.9659
Averaged Train Loss (Regular Model): 0.0261
Averaged Train Loss (Regular + Proto): 0.2253
Std Test Accuracy (Regular Model): 0.0409
Std Test Accuracy (Prototype Model): 0.0409
tobetrained:
[9, 5, 3, 4, 1, 6, 0, 7, 2, 8]
Edge 9 begin training
Edge 5 begin training
Edge 3 begin training
Edge 4 begin training
Edge 1 begin training
Edge 6 begin training
Edge 0 begin training
Edge 7 begin training
Edge 2 begin training
Edge 8 begin training
readyList:
[9, 3, 4, 5, 1, 6, 0, 2, 7, 8]
aggregation_buffer:
[9, 3, 4, 5, 1, 6, 0, 2, 7, 8]
class-wise minimum distance tensor([6.3852, 7.0014, 5.0503, 6.2012, 6.8763, 6.4112, 5.0503, 6.7136, 6.5164,
        6.8436], device='cuda:0')
min_gap tensor(5.0503, device='cuda:0')
max_gap tensor(7.0014, device='cuda:0')
Server loss: 4.733504772186279
end Update
server_global_time: 15.051113390363753
only_train_time: 189.76769340131432

-------------Global Round number: 12-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9713
Averaged Test Accuracy (Prototype Model): 0.9652
Averaged Train Loss (Regular Model): 0.0245
Averaged Train Loss (Regular + Proto): 0.2477
Std Test Accuracy (Regular Model): 0.0444
Std Test Accuracy (Prototype Model): 0.0467
tobetrained:
[9, 3, 4, 5, 1, 6, 0, 2, 7, 8]
Edge 9 begin training
Edge 3 begin training
Edge 4 begin training
Edge 5 begin training
Edge 1 begin training
Edge 6 begin training
Edge 0 begin training
Edge 2 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[4, 5, 3, 9, 1, 6, 0, 2, 7, 8]
aggregation_buffer:
[4, 5, 3, 9, 1, 6, 0, 2, 7, 8]
class-wise minimum distance tensor([6.9204, 7.5700, 5.3066, 6.6601, 7.3637, 6.8711, 5.3066, 7.2880, 6.9331,
        7.5533], device='cuda:0')
min_gap tensor(5.3066, device='cuda:0')
max_gap tensor(7.5700, device='cuda:0')
Server loss: 4.933722496032715
end Update
server_global_time: 16.224208772182465
only_train_time: 204.57916762586683

-------------Global Round number: 13-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9718
Averaged Test Accuracy (Prototype Model): 0.9665
Averaged Train Loss (Regular Model): 0.0258
Averaged Train Loss (Regular + Proto): 0.2776
Std Test Accuracy (Regular Model): 0.0413
Std Test Accuracy (Prototype Model): 0.0444
tobetrained:
[4, 5, 3, 9, 1, 6, 0, 2, 7, 8]
Edge 4 begin training
Edge 5 begin training
Edge 3 begin training
Edge 9 begin training
Edge 1 begin training
Edge 6 begin training
Edge 0 begin training
Edge 2 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[9, 4, 3, 5, 1, 6, 0, 2, 7, 8]
aggregation_buffer:
[9, 4, 3, 5, 1, 6, 0, 2, 7, 8]
class-wise minimum distance tensor([7.6782, 8.2340, 5.9326, 7.3300, 8.2243, 7.5712, 5.9326, 7.9217, 7.5688,
        8.1420], device='cuda:0')
min_gap tensor(5.9326, device='cuda:0')
max_gap tensor(8.2340, device='cuda:0')
Server loss: 5.182301998138428
end Update
server_global_time: 17.402693098410964
only_train_time: 219.5352796688676

-------------Global Round number: 14-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9721
Averaged Test Accuracy (Prototype Model): 0.9684
Averaged Train Loss (Regular Model): 0.0181
Averaged Train Loss (Regular + Proto): 0.2948
Std Test Accuracy (Regular Model): 0.0391
Std Test Accuracy (Prototype Model): 0.0383
tobetrained:
[9, 4, 3, 5, 1, 6, 0, 2, 7, 8]
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
Edge 5 begin training
Edge 1 begin training
Edge 6 begin training
Edge 0 begin training
Edge 2 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[5, 9, 3, 4, 1, 6, 2, 0, 7, 8]
aggregation_buffer:
[5, 9, 3, 4, 1, 6, 2, 0, 7, 8]
class-wise minimum distance tensor([8.3872, 8.9737, 6.3562, 7.8892, 9.2510, 8.0933, 6.3562, 8.4489, 7.9491,
        8.6286], device='cuda:0')
min_gap tensor(6.3562, device='cuda:0')
max_gap tensor(9.2510, device='cuda:0')
Server loss: 5.7169952392578125
end Update
server_global_time: 18.581537161022425
only_train_time: 234.32967625092715

-------------Global Round number: 15-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9720
Averaged Test Accuracy (Prototype Model): 0.9690
Averaged Train Loss (Regular Model): 0.0152
Averaged Train Loss (Regular + Proto): 0.3232
Std Test Accuracy (Regular Model): 0.0366
Std Test Accuracy (Prototype Model): 0.0360
tobetrained:
[5, 9, 3, 4, 1, 6, 2, 0, 7, 8]
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 4 begin training
Edge 1 begin training
Edge 6 begin training
Edge 2 begin training
Edge 0 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[5, 3, 4, 9, 1, 6, 2, 0, 7, 8]
aggregation_buffer:
[5, 3, 4, 9, 1, 6, 2, 0, 7, 8]
class-wise minimum distance tensor([ 9.4927,  9.7688,  6.9134,  8.6152, 10.1064,  8.8450,  6.9134,  9.2018,
         8.5971,  9.4348], device='cuda:0')
min_gap tensor(6.9134, device='cuda:0')
max_gap tensor(10.1064, device='cuda:0')
Server loss: 6.0563435554504395
end Update
server_global_time: 19.779631718061864
only_train_time: 249.47355688828975

-------------Global Round number: 16-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9722
Averaged Test Accuracy (Prototype Model): 0.9698
Averaged Train Loss (Regular Model): 0.0160
Averaged Train Loss (Regular + Proto): 0.3590
Std Test Accuracy (Regular Model): 0.0370
Std Test Accuracy (Prototype Model): 0.0350
tobetrained:
[5, 3, 4, 9, 1, 6, 2, 0, 7, 8]
Edge 5 begin training
Edge 3 begin training
Edge 4 begin training
Edge 9 begin training
Edge 1 begin training
Edge 6 begin training
Edge 2 begin training
Edge 0 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[5, 4, 9, 3, 1, 6, 0, 2, 7, 8]
aggregation_buffer:
[5, 4, 9, 3, 1, 6, 0, 2, 7, 8]
class-wise minimum distance tensor([10.2844, 10.5880,  7.4728,  9.4001, 11.0076,  9.5626,  7.4728,  9.8802,
         9.1131, 10.3069], device='cuda:0')
min_gap tensor(7.4728, device='cuda:0')
max_gap tensor(11.0076, device='cuda:0')
Server loss: 6.442298889160156
end Update
server_global_time: 20.960834602825344
only_train_time: 264.4647534415126

-------------Global Round number: 17-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9720
Averaged Test Accuracy (Prototype Model): 0.9701
Averaged Train Loss (Regular Model): 0.0146
Averaged Train Loss (Regular + Proto): 0.3982
Std Test Accuracy (Regular Model): 0.0377
Std Test Accuracy (Prototype Model): 0.0356
tobetrained:
[5, 4, 9, 3, 1, 6, 0, 2, 7, 8]
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
Edge 6 begin training
Edge 0 begin training
Edge 2 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[9, 4, 5, 3, 1, 6, 2, 0, 7, 8]
aggregation_buffer:
[9, 4, 5, 3, 1, 6, 2, 0, 7, 8]
class-wise minimum distance tensor([11.1666, 11.4301,  8.2002, 10.0932, 12.3115, 10.3691,  8.2002, 10.8255,
         9.7574, 11.2021], device='cuda:0')
min_gap tensor(8.2002, device='cuda:0')
max_gap tensor(12.3115, device='cuda:0')
Server loss: 7.123779773712158
end Update
server_global_time: 22.14082270860672
only_train_time: 279.2432400388643

-------------Global Round number: 18-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9735
Averaged Test Accuracy (Prototype Model): 0.9703
Averaged Train Loss (Regular Model): 0.0124
Averaged Train Loss (Regular + Proto): 0.4339
Std Test Accuracy (Regular Model): 0.0345
Std Test Accuracy (Prototype Model): 0.0363
tobetrained:
[9, 4, 5, 3, 1, 6, 2, 0, 7, 8]
Edge 9 begin training
Edge 4 begin training
Edge 5 begin training
Edge 3 begin training
Edge 1 begin training
Edge 6 begin training
Edge 2 begin training
Edge 0 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[5, 9, 3, 4, 1, 6, 0, 2, 7, 8]
aggregation_buffer:
[5, 9, 3, 4, 1, 6, 0, 2, 7, 8]
class-wise minimum distance tensor([12.2749, 12.5895,  8.9458, 11.1521, 13.3296, 11.2743,  8.9458, 11.8920,
        10.5908, 12.2472], device='cuda:0')
min_gap tensor(8.9458, device='cuda:0')
max_gap tensor(13.3296, device='cuda:0')
Server loss: 7.553564548492432
end Update
server_global_time: 23.330018816515803
only_train_time: 294.0586261693388

-------------Global Round number: 19-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9727
Averaged Test Accuracy (Prototype Model): 0.9708
Averaged Train Loss (Regular Model): 0.0088
Averaged Train Loss (Regular + Proto): 0.4828
Std Test Accuracy (Regular Model): 0.0369
Std Test Accuracy (Prototype Model): 0.0363
tobetrained:
[5, 9, 3, 4, 1, 6, 0, 2, 7, 8]
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 4 begin training
Edge 1 begin training
Edge 6 begin training
Edge 0 begin training
Edge 2 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[5, 3, 9, 4, 1, 2, 6, 7, 0, 8]
aggregation_buffer:
[5, 3, 9, 4, 1, 2, 6, 7, 0, 8]
class-wise minimum distance tensor([13.2224, 13.6894,  9.6821, 12.1388, 14.4335, 12.2695,  9.6821, 12.8126,
        11.4140, 13.3675], device='cuda:0')
min_gap tensor(9.6821, device='cuda:0')
max_gap tensor(14.4335, device='cuda:0')
Server loss: 8.03133773803711
Number of samples: 192
end Update
server_global_time: 24.51037721335888
only_train_time: 309.755923492834

-------------Global Round number: 20-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9736
Averaged Test Accuracy (Prototype Model): 0.9710
Averaged Train Loss (Regular Model): 0.0081
Averaged Train Loss (Regular + Proto): 0.5449
Std Test Accuracy (Regular Model): 0.0345
Std Test Accuracy (Prototype Model): 0.0352
tobetrained:
[5, 3, 9, 4, 1, 2, 6, 7, 0, 8]
Edge 5 begin training
Edge 3 begin training
Edge 9 begin training
Edge 4 begin training
Edge 1 begin training
Edge 2 begin training
Edge 6 begin training
Edge 7 begin training
Edge 0 begin training
Edge 8 begin training
readyList:
[5, 9, 3, 4, 1, 6, 0, 2, 7, 8]
aggregation_buffer:
[5, 9, 3, 4, 1, 6, 0, 2, 7, 8]
class-wise minimum distance tensor([14.2494, 14.9882, 10.4614, 13.2243, 15.4647, 13.1529, 10.4614, 13.8443,
        12.2836, 14.4789], device='cuda:0')
min_gap tensor(10.4614, device='cuda:0')
max_gap tensor(15.4647, device='cuda:0')
Server loss: 8.477469444274902
end Update
server_global_time: 25.67031993344426
only_train_time: 324.85825874842703

-------------Global Round number: 21-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9734
Averaged Test Accuracy (Prototype Model): 0.9708
Averaged Train Loss (Regular Model): 0.0073
Averaged Train Loss (Regular + Proto): 0.6122
Std Test Accuracy (Regular Model): 0.0335
Std Test Accuracy (Prototype Model): 0.0353
tobetrained:
[5, 9, 3, 4, 1, 6, 0, 2, 7, 8]
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 4 begin training
Edge 1 begin training
Edge 6 begin training
Edge 0 begin training
Edge 2 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[9, 3, 5, 4, 1, 6, 0, 2, 7, 8]
aggregation_buffer:
[9, 3, 5, 4, 1, 6, 0, 2, 7, 8]
class-wise minimum distance tensor([15.0609, 15.9564, 11.3201, 14.0390, 16.3729, 13.8181, 11.3201, 14.7612,
        13.0922, 15.5551], device='cuda:0')
min_gap tensor(11.3201, device='cuda:0')
max_gap tensor(16.3729, device='cuda:0')
Server loss: 9.041098594665527
end Update
server_global_time: 26.88852664269507
only_train_time: 340.01667088083923

-------------Global Round number: 22-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9725
Averaged Test Accuracy (Prototype Model): 0.9708
Averaged Train Loss (Regular Model): 0.0199
Averaged Train Loss (Regular + Proto): 0.7091
Std Test Accuracy (Regular Model): 0.0375
Std Test Accuracy (Prototype Model): 0.0361
tobetrained:
[9, 3, 5, 4, 1, 6, 0, 2, 7, 8]
Edge 9 begin training
Edge 3 begin training
Edge 5 begin training
Edge 4 begin training
Edge 1 begin training
Edge 6 begin training
Edge 0 begin training
Edge 2 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[9, 4, 3, 5, 6, 1, 0, 2, 7, 8]
aggregation_buffer:
[9, 4, 3, 5, 6, 1, 0, 2, 7, 8]
class-wise minimum distance tensor([16.4122, 16.0602, 10.9147, 14.4112, 17.3453, 14.5945, 10.9147, 15.4988,
        12.9740, 16.4109], device='cuda:0')
min_gap tensor(10.9147, device='cuda:0')
max_gap tensor(17.3453, device='cuda:0')
Server loss: 9.687149047851562
end Update
server_global_time: 28.05903812777251
only_train_time: 355.414687724784

-------------Global Round number: 23-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9715
Averaged Test Accuracy (Prototype Model): 0.9639
Averaged Train Loss (Regular Model): 0.0276
Averaged Train Loss (Regular + Proto): 0.8109
Std Test Accuracy (Regular Model): 0.0367
Std Test Accuracy (Prototype Model): 0.0624
tobetrained:
[9, 4, 3, 5, 6, 1, 0, 2, 7, 8]
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
Edge 5 begin training
Edge 6 begin training
Edge 1 begin training
Edge 0 begin training
Edge 2 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[9, 4, 5, 3, 1, 6, 2, 0, 7, 8]
aggregation_buffer:
[9, 4, 5, 3, 1, 6, 2, 0, 7, 8]
class-wise minimum distance tensor([17.1153, 17.4826, 11.1379, 15.8610, 18.6259, 15.6309, 11.1379, 16.3534,
        13.1039, 17.2820], device='cuda:0')
min_gap tensor(11.1379, device='cuda:0')
max_gap tensor(18.6259, device='cuda:0')
Server loss: 10.218910217285156
end Update
server_global_time: 29.248695288784802
only_train_time: 370.49223977234215

-------------Global Round number: 24-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9732
Averaged Test Accuracy (Prototype Model): 0.9677
Averaged Train Loss (Regular Model): 0.0225
Averaged Train Loss (Regular + Proto): 0.9065
Std Test Accuracy (Regular Model): 0.0339
Std Test Accuracy (Prototype Model): 0.0451
tobetrained:
[9, 4, 5, 3, 1, 6, 2, 0, 7, 8]
Edge 9 begin training
Edge 4 begin training
Edge 5 begin training
Edge 3 begin training
Edge 1 begin training
Edge 6 begin training
Edge 2 begin training
Edge 0 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[5, 9, 3, 4, 1, 6, 0, 2, 7, 8]
aggregation_buffer:
[5, 9, 3, 4, 1, 6, 0, 2, 7, 8]
class-wise minimum distance tensor([18.3790, 18.7468, 11.9554, 17.0078, 20.4415, 16.6743, 11.9554, 17.3897,
        14.3386, 18.7507], device='cuda:0')
min_gap tensor(11.9554, device='cuda:0')
max_gap tensor(20.4415, device='cuda:0')
Server loss: 11.091206550598145
end Update
server_global_time: 30.429653575643897
only_train_time: 385.4611980728805

-------------Global Round number: 25-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9721
Averaged Test Accuracy (Prototype Model): 0.9674
Averaged Train Loss (Regular Model): 0.0243
Averaged Train Loss (Regular + Proto): 1.0004
Std Test Accuracy (Regular Model): 0.0361
Std Test Accuracy (Prototype Model): 0.0480
tobetrained:
[5, 9, 3, 4, 1, 6, 0, 2, 7, 8]
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 4 begin training
Edge 1 begin training
Edge 6 begin training
Edge 0 begin training
Edge 2 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[5, 3, 4, 9, 1, 6, 2, 0, 7, 8]
aggregation_buffer:
[5, 3, 4, 9, 1, 6, 2, 0, 7, 8]
class-wise minimum distance tensor([17.3930, 19.0457, 13.8763, 16.5238, 21.0193, 17.5415, 13.8763, 18.0375,
        14.8720, 18.7715], device='cuda:0')
min_gap tensor(13.8763, device='cuda:0')
max_gap tensor(21.0193, device='cuda:0')
Server loss: 12.075654983520508
end Update
server_global_time: 31.6413753926754
only_train_time: 400.27332750335336

-------------Global Round number: 26-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9557
Averaged Test Accuracy (Prototype Model): 0.9300
Averaged Train Loss (Regular Model): 0.1572
Averaged Train Loss (Regular + Proto): 1.3834
Std Test Accuracy (Regular Model): 0.0703
Std Test Accuracy (Prototype Model): 0.1793
tobetrained:
[5, 3, 4, 9, 1, 6, 2, 0, 7, 8]
Edge 5 begin training
Edge 3 begin training
Edge 4 begin training
Edge 9 begin training
Edge 1 begin training
Edge 6 begin training
Edge 2 begin training
Edge 0 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[5, 4, 9, 3, 1, 6, 0, 2, 7, 8]
aggregation_buffer:
[5, 4, 9, 3, 1, 6, 0, 2, 7, 8]
class-wise minimum distance tensor([18.0540, 20.8528, 14.8615, 18.4823, 23.0380, 18.5823, 14.8615, 19.8912,
        16.5544, 21.4533], device='cuda:0')
min_gap tensor(14.8615, device='cuda:0')
max_gap tensor(23.0380, device='cuda:0')
Server loss: 12.60405445098877
end Update
server_global_time: 32.813218001276255
only_train_time: 415.05933933425695

-------------Global Round number: 27-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9670
Averaged Test Accuracy (Prototype Model): 0.9613
Averaged Train Loss (Regular Model): 0.0385
Averaged Train Loss (Regular + Proto): 1.3179
Std Test Accuracy (Regular Model): 0.0488
Std Test Accuracy (Prototype Model): 0.0600
tobetrained:
[5, 4, 9, 3, 1, 6, 0, 2, 7, 8]
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
Edge 6 begin training
Edge 0 begin training
Edge 2 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[5, 9, 4, 3, 1, 6, 2, 0, 7, 8]
aggregation_buffer:
[5, 9, 4, 3, 1, 6, 2, 0, 7, 8]
class-wise minimum distance tensor([18.9565, 22.9980, 15.0735, 18.7746, 24.0120, 19.8385, 15.0735, 21.7776,
        18.1315, 22.9729], device='cuda:0')
min_gap tensor(15.0735, device='cuda:0')
max_gap tensor(24.0120, device='cuda:0')
Server loss: 12.94050121307373
end Update
server_global_time: 33.998335825279355
only_train_time: 430.1402456779033

-------------Global Round number: 28-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9619
Averaged Test Accuracy (Prototype Model): 0.9394
Averaged Train Loss (Regular Model): 0.0438
Averaged Train Loss (Regular + Proto): 1.4969
Std Test Accuracy (Regular Model): 0.0659
Std Test Accuracy (Prototype Model): 0.1557
tobetrained:
[5, 9, 4, 3, 1, 6, 2, 0, 7, 8]
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
Edge 1 begin training
Edge 6 begin training
Edge 2 begin training
Edge 0 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[5, 4, 9, 3, 1, 6, 0, 2, 7, 8]
aggregation_buffer:
[5, 4, 9, 3, 1, 6, 0, 2, 7, 8]
class-wise minimum distance tensor([19.8773, 24.4460, 15.9174, 19.5307, 22.0003, 20.6534, 15.9174, 22.0503,
        17.2936, 22.5883], device='cuda:0')
min_gap tensor(15.9174, device='cuda:0')
max_gap tensor(24.4460, device='cuda:0')
Server loss: 13.405738830566406
end Update
server_global_time: 35.171566881239414
only_train_time: 445.01270611863583

-------------Global Round number: 29-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9544
Averaged Test Accuracy (Prototype Model): 0.9032
Averaged Train Loss (Regular Model): 0.1478
Averaged Train Loss (Regular + Proto): 1.9521
Std Test Accuracy (Regular Model): 0.0699
Std Test Accuracy (Prototype Model): 0.1911
tobetrained:
[5, 4, 9, 3, 1, 6, 0, 2, 7, 8]
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
Edge 6 begin training
Edge 0 begin training
Edge 2 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[5, 9, 4, 3, 1, 6, 2, 0, 7, 8]
aggregation_buffer:
[5, 9, 4, 3, 1, 6, 2, 0, 7, 8]
class-wise minimum distance tensor([18.7408, 25.8919, 15.8740, 19.8561, 19.0645, 19.8650, 15.8740, 21.0462,
        17.0577, 22.8276], device='cuda:0')
min_gap tensor(15.8740, device='cuda:0')
max_gap tensor(25.8919, device='cuda:0')
Server loss: 14.720706939697266
end Update
server_global_time: 36.3854479463771
only_train_time: 460.08928084373474

-------------Global Round number: 30-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9467
Averaged Test Accuracy (Prototype Model): 0.9121
Averaged Train Loss (Regular Model): 0.1129
Averaged Train Loss (Regular + Proto): 2.1462
Std Test Accuracy (Regular Model): 0.1169
Std Test Accuracy (Prototype Model): 0.1689
tobetrained:
[5, 9, 4, 3, 1, 6, 2, 0, 7, 8]
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
Edge 1 begin training
Edge 6 begin training
Edge 2 begin training
Edge 0 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[9, 5, 3, 4, 1, 6, 0, 2, 7, 8]
aggregation_buffer:
[9, 5, 3, 4, 1, 6, 0, 2, 7, 8]
class-wise minimum distance tensor([19.9069, 27.8648, 17.2169, 21.5175, 19.4416, 21.1083, 17.2169, 22.6292,
        19.7432, 25.4377], device='cuda:0')
min_gap tensor(17.2169, device='cuda:0')
max_gap tensor(27.8648, device='cuda:0')
Server loss: 15.416790962219238
end Update
server_global_time: 37.5870263595134
only_train_time: 474.81203947309405

-------------Global Round number: 31-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9480
Averaged Test Accuracy (Prototype Model): 0.9350
Averaged Train Loss (Regular Model): 0.0914
Averaged Train Loss (Regular + Proto): 2.1925
Std Test Accuracy (Regular Model): 0.1002
Std Test Accuracy (Prototype Model): 0.1380
tobetrained:
[9, 5, 3, 4, 1, 6, 0, 2, 7, 8]
Edge 9 begin training
Edge 5 begin training
Edge 3 begin training
Edge 4 begin training
Edge 1 begin training
Edge 6 begin training
Edge 0 begin training
Edge 2 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[5, 3, 4, 9, 1, 6, 0, 2, 7, 8]
aggregation_buffer:
[5, 3, 4, 9, 1, 6, 0, 2, 7, 8]
class-wise minimum distance tensor([19.6271, 27.0486, 17.1504, 21.7674, 21.1515, 23.0177, 17.1504, 23.4324,
        18.7624, 25.9823], device='cuda:0')
min_gap tensor(17.1504, device='cuda:0')
max_gap tensor(27.0486, device='cuda:0')
Server loss: 15.439047813415527
end Update
server_global_time: 38.78851449023932
only_train_time: 489.7129630362615

-------------Global Round number: 32-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9416
Averaged Test Accuracy (Prototype Model): 0.9122
Averaged Train Loss (Regular Model): 0.1256
Averaged Train Loss (Regular + Proto): 2.5837
Std Test Accuracy (Regular Model): 0.1256
Std Test Accuracy (Prototype Model): 0.2200
tobetrained:
[5, 3, 4, 9, 1, 6, 0, 2, 7, 8]
Edge 5 begin training
Edge 3 begin training
Edge 4 begin training
Edge 9 begin training
Edge 1 begin training
Edge 6 begin training
Edge 0 begin training
Edge 2 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[4, 5, 3, 9, 1, 6, 0, 2, 7, 8]
aggregation_buffer:
[4, 5, 3, 9, 1, 6, 0, 2, 7, 8]
class-wise minimum distance tensor([20.0644, 27.7392, 17.8096, 22.5629, 23.0118, 23.8688, 17.8096, 23.8548,
        18.8188, 26.3883], device='cuda:0')
min_gap tensor(17.8096, device='cuda:0')
max_gap tensor(27.7392, device='cuda:0')
Server loss: 15.564313888549805
end Update
server_global_time: 39.96862831246108
only_train_time: 504.7627625912428

-------------Global Round number: 33-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9528
Averaged Test Accuracy (Prototype Model): 0.9163
Averaged Train Loss (Regular Model): 0.0900
Averaged Train Loss (Regular + Proto): 2.6943
Std Test Accuracy (Regular Model): 0.0751
Std Test Accuracy (Prototype Model): 0.1986
tobetrained:
[4, 5, 3, 9, 1, 6, 0, 2, 7, 8]
Edge 4 begin training
Edge 5 begin training
Edge 3 begin training
Edge 9 begin training
Edge 1 begin training
Edge 6 begin training
Edge 0 begin training
Edge 2 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[5, 9, 4, 3, 1, 6, 2, 0, 7, 8]
aggregation_buffer:
[5, 9, 4, 3, 1, 6, 2, 0, 7, 8]
class-wise minimum distance tensor([20.5796, 28.5872, 18.6847, 23.0458, 22.4936, 24.2577, 18.6847, 24.3177,
        20.2712, 27.5162], device='cuda:0')
min_gap tensor(18.6847, device='cuda:0')
max_gap tensor(28.5872, device='cuda:0')
Server loss: 16.054941177368164
end Update
server_global_time: 41.17964284028858
only_train_time: 519.7584541644901

-------------Global Round number: 34-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9212
Averaged Test Accuracy (Prototype Model): 0.8954
Averaged Train Loss (Regular Model): 0.1633
Averaged Train Loss (Regular + Proto): 2.9531
Std Test Accuracy (Regular Model): 0.1529
Std Test Accuracy (Prototype Model): 0.2147
tobetrained:
[5, 9, 4, 3, 1, 6, 2, 0, 7, 8]
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
Edge 1 begin training
Edge 6 begin training
Edge 2 begin training
Edge 0 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[5, 9, 4, 3, 1, 6, 0, 2, 7, 8]
aggregation_buffer:
[5, 9, 4, 3, 1, 6, 0, 2, 7, 8]
class-wise minimum distance tensor([20.7660, 28.5862, 19.7205, 25.5628, 23.4691, 25.1841, 19.7205, 24.7559,
        20.7334, 27.1417], device='cuda:0')
min_gap tensor(19.7205, device='cuda:0')
max_gap tensor(28.5862, device='cuda:0')
Server loss: 16.879241943359375
end Update
server_global_time: 42.34261352661997
only_train_time: 534.5923083489761

-------------Global Round number: 35-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9460
Averaged Test Accuracy (Prototype Model): 0.9211
Averaged Train Loss (Regular Model): 0.1452
Averaged Train Loss (Regular + Proto): 3.1183
Std Test Accuracy (Regular Model): 0.1146
Std Test Accuracy (Prototype Model): 0.2110
tobetrained:
[5, 9, 4, 3, 1, 6, 0, 2, 7, 8]
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
Edge 1 begin training
Edge 6 begin training
Edge 0 begin training
Edge 2 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[4, 3, 5, 9, 1, 6, 0, 2, 7, 8]
aggregation_buffer:
[4, 3, 5, 9, 1, 6, 0, 2, 7, 8]
class-wise minimum distance tensor([21.1266, 28.5157, 19.5856, 25.4240, 24.3334, 24.5984, 19.5856, 24.5984,
        20.7035, 25.8350], device='cuda:0')
min_gap tensor(19.5856, device='cuda:0')
max_gap tensor(28.5157, device='cuda:0')
Server loss: 16.32962989807129
end Update
server_global_time: 43.54850865807384
only_train_time: 549.9029774516821

-------------Global Round number: 36-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9443
Averaged Test Accuracy (Prototype Model): 0.9268
Averaged Train Loss (Regular Model): 0.1671
Averaged Train Loss (Regular + Proto): 3.0524
Std Test Accuracy (Regular Model): 0.1252
Std Test Accuracy (Prototype Model): 0.1781
tobetrained:
[4, 3, 5, 9, 1, 6, 0, 2, 7, 8]
Edge 4 begin training
Edge 3 begin training
Edge 5 begin training
Edge 9 begin training
Edge 1 begin training
Edge 6 begin training
Edge 0 begin training
Edge 2 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[5, 9, 4, 3, 1, 6, 0, 2, 7, 8]
aggregation_buffer:
[5, 9, 4, 3, 1, 6, 0, 2, 7, 8]
class-wise minimum distance tensor([21.7200, 29.0010, 19.7205, 25.9149, 24.8718, 26.2467, 19.7205, 26.3334,
        22.3616, 26.6783], device='cuda:0')
min_gap tensor(19.7205, device='cuda:0')
max_gap tensor(29.0010, device='cuda:0')
Server loss: 16.09994125366211
end Update
server_global_time: 44.696531291119754
only_train_time: 564.4614350544289

-------------Global Round number: 37-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9505
Averaged Test Accuracy (Prototype Model): 0.9263
Averaged Train Loss (Regular Model): 0.1311
Averaged Train Loss (Regular + Proto): 3.1564
Std Test Accuracy (Regular Model): 0.0881
Std Test Accuracy (Prototype Model): 0.1918
tobetrained:
[5, 9, 4, 3, 1, 6, 0, 2, 7, 8]
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
Edge 1 begin training
Edge 6 begin training
Edge 0 begin training
Edge 2 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[5, 9, 4, 3, 1, 6, 0, 2, 7, 8]
aggregation_buffer:
[5, 9, 4, 3, 1, 6, 0, 2, 7, 8]
class-wise minimum distance tensor([23.5701, 30.1548, 21.7493, 26.6583, 26.9614, 28.3247, 21.7493, 28.0548,
        23.7266, 27.0898], device='cuda:0')
min_gap tensor(21.7493, device='cuda:0')
max_gap tensor(30.1548, device='cuda:0')
Server loss: 16.329952239990234
end Update
server_global_time: 46.029075261205435
only_train_time: 579.6844790009782

-------------Global Round number: 38-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9407
Averaged Test Accuracy (Prototype Model): 0.9053
Averaged Train Loss (Regular Model): 0.0991
Averaged Train Loss (Regular + Proto): 3.2755
Std Test Accuracy (Regular Model): 0.1236
Std Test Accuracy (Prototype Model): 0.2002
tobetrained:
[5, 9, 4, 3, 1, 6, 0, 2, 7, 8]
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
Edge 1 begin training
Edge 6 begin training
Edge 0 begin training
Edge 2 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[5, 9, 4, 3, 6, 1, 2, 0, 7, 8]
aggregation_buffer:
[5, 9, 4, 3, 6, 1, 2, 0, 7, 8]
class-wise minimum distance tensor([23.7779, 31.1875, 22.6318, 28.2405, 28.5631, 29.2231, 22.6318, 29.0668,
        24.0525, 28.2011], device='cuda:0')
min_gap tensor(22.6318, device='cuda:0')
max_gap tensor(31.1875, device='cuda:0')
Server loss: 16.594316482543945
end Update
server_global_time: 47.23027484305203
only_train_time: 594.7574296947569

-------------Global Round number: 39-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9400
Averaged Test Accuracy (Prototype Model): 0.9347
Averaged Train Loss (Regular Model): 0.1214
Averaged Train Loss (Regular + Proto): 3.4526
Std Test Accuracy (Regular Model): 0.1367
Std Test Accuracy (Prototype Model): 0.1776
tobetrained:
[5, 9, 4, 3, 6, 1, 2, 0, 7, 8]
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
Edge 6 begin training
Edge 1 begin training
Edge 2 begin training
Edge 0 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[5, 4, 3, 9, 6, 0, 1, 2, 7, 8]
aggregation_buffer:
[5, 4, 3, 9, 6, 0, 1, 2, 7, 8]
class-wise minimum distance tensor([24.2739, 31.5693, 24.3067, 29.5468, 28.8957, 29.6324, 24.2739, 29.9029,
        25.5454, 28.1237], device='cuda:0')
min_gap tensor(24.2739, device='cuda:0')
max_gap tensor(31.5693, device='cuda:0')
Server loss: 16.644113540649414
Number of samples: 192
end Update
server_global_time: 48.3827561121434
only_train_time: 609.9477230058983

-------------Global Round number: 40-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9430
Averaged Test Accuracy (Prototype Model): 0.9004
Averaged Train Loss (Regular Model): 0.1488
Averaged Train Loss (Regular + Proto): 3.7243
Std Test Accuracy (Regular Model): 0.1295
Std Test Accuracy (Prototype Model): 0.2202
tobetrained:
[5, 4, 3, 9, 6, 0, 1, 2, 7, 8]
Edge 5 begin training
Edge 4 begin training
Edge 3 begin training
Edge 9 begin training
Edge 6 begin training
Edge 0 begin training
Edge 1 begin training
Edge 2 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[5, 3, 9, 4, 1, 6, 2, 0, 7, 8]
aggregation_buffer:
[5, 3, 9, 4, 1, 6, 2, 0, 7, 8]
class-wise minimum distance tensor([25.8025, 33.3134, 24.7963, 30.3971, 28.7123, 30.9733, 24.7963, 30.2250,
        25.9351, 29.9883], device='cuda:0')
min_gap tensor(24.7963, device='cuda:0')
max_gap tensor(33.3134, device='cuda:0')
Server loss: 17.39824676513672
end Update
server_global_time: 49.56563715916127
only_train_time: 624.9359400207177

-------------Global Round number: 41-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9426
Averaged Test Accuracy (Prototype Model): 0.9169
Averaged Train Loss (Regular Model): 0.1079
Averaged Train Loss (Regular + Proto): 3.7539
Std Test Accuracy (Regular Model): 0.1323
Std Test Accuracy (Prototype Model): 0.1850
tobetrained:
[5, 3, 9, 4, 1, 6, 2, 0, 7, 8]
Edge 5 begin training
Edge 3 begin training
Edge 9 begin training
Edge 4 begin training
Edge 1 begin training
Edge 6 begin training
Edge 2 begin training
Edge 0 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[5, 9, 4, 3, 1, 6, 2, 0, 7, 8]
aggregation_buffer:
[5, 9, 4, 3, 1, 6, 2, 0, 7, 8]
class-wise minimum distance tensor([26.8278, 33.7573, 24.9385, 31.6789, 30.0061, 32.6262, 24.9385, 32.9615,
        29.1053, 31.6812], device='cuda:0')
min_gap tensor(24.9385, device='cuda:0')
max_gap tensor(33.7573, device='cuda:0')
Server loss: 17.23567008972168
end Update
server_global_time: 50.75996674783528
only_train_time: 639.8662930056453

-------------Global Round number: 42-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9463
Averaged Test Accuracy (Prototype Model): 0.9043
Averaged Train Loss (Regular Model): 0.2138
Averaged Train Loss (Regular + Proto): 4.0336
Std Test Accuracy (Regular Model): 0.1187
Std Test Accuracy (Prototype Model): 0.2018
tobetrained:
[5, 9, 4, 3, 1, 6, 2, 0, 7, 8]
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
Edge 1 begin training
Edge 6 begin training
Edge 2 begin training
Edge 0 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[5, 9, 4, 3, 1, 6, 0, 2, 7, 8]
aggregation_buffer:
[5, 9, 4, 3, 1, 6, 0, 2, 7, 8]
class-wise minimum distance tensor([nan, nan, nan, nan, nan, nan, nan, nan, nan, nan], device='cuda:0')
min_gap tensor(nan, device='cuda:0')
max_gap tensor(nan, device='cuda:0')
Server loss: nan
end Update
server_global_time: 51.96540686767548
only_train_time: 654.7836526501924

-------------Global Round number: 43-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.9177
Averaged Test Accuracy (Prototype Model): 0.1028
Averaged Train Loss (Regular Model): nan
Averaged Train Loss (Regular + Proto): nan
Std Test Accuracy (Regular Model): 0.1915
Std Test Accuracy (Prototype Model): 0.2341
tobetrained:
[5, 9, 4, 3, 1, 6, 0, 2, 7, 8]
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
Edge 1 begin training
Edge 6 begin training
Edge 0 begin training
Edge 2 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[5, 4, 9, 3, 1, 6, 0, 2, 7, 8]
aggregation_buffer:
[5, 4, 9, 3, 1, 6, 0, 2, 7, 8]
class-wise minimum distance tensor([nan, nan, nan, nan, nan, nan, nan, nan, nan, nan], device='cuda:0')
min_gap tensor(nan, device='cuda:0')
max_gap tensor(nan, device='cuda:0')
Server loss: nan
end Update
server_global_time: 53.13562680315226
only_train_time: 669.744911858812

-------------Global Round number: 44-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.1028
Averaged Test Accuracy (Prototype Model): 0.1028
Averaged Train Loss (Regular Model): nan
Averaged Train Loss (Regular + Proto): nan
Std Test Accuracy (Regular Model): 0.2341
Std Test Accuracy (Prototype Model): 0.2341
tobetrained:
[5, 4, 9, 3, 1, 6, 0, 2, 7, 8]
Edge 5 begin training
Edge 4 begin training
Edge 9 begin training
Edge 3 begin training
Edge 1 begin training
Edge 6 begin training
Edge 0 begin training
Edge 2 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[9, 5, 4, 3, 6, 1, 0, 2, 7, 8]
aggregation_buffer:
[9, 5, 4, 3, 6, 1, 0, 2, 7, 8]
class-wise minimum distance tensor([nan, nan, nan, nan, nan, nan, nan, nan, nan, nan], device='cuda:0')
min_gap tensor(nan, device='cuda:0')
max_gap tensor(nan, device='cuda:0')
Server loss: nan
end Update
server_global_time: 54.283872871659696
only_train_time: 684.765779058449

-------------Global Round number: 45-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.1028
Averaged Test Accuracy (Prototype Model): 0.1028
Averaged Train Loss (Regular Model): nan
Averaged Train Loss (Regular + Proto): nan
Std Test Accuracy (Regular Model): 0.2341
Std Test Accuracy (Prototype Model): 0.2341
tobetrained:
[9, 5, 4, 3, 6, 1, 0, 2, 7, 8]
Edge 9 begin training
Edge 5 begin training
Edge 4 begin training
Edge 3 begin training
Edge 6 begin training
Edge 1 begin training
Edge 0 begin training
Edge 2 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[5, 9, 3, 4, 1, 6, 2, 0, 7, 8]
aggregation_buffer:
[5, 9, 3, 4, 1, 6, 2, 0, 7, 8]
class-wise minimum distance tensor([nan, nan, nan, nan, nan, nan, nan, nan, nan, nan], device='cuda:0')
min_gap tensor(nan, device='cuda:0')
max_gap tensor(nan, device='cuda:0')
Server loss: nan
end Update
server_global_time: 55.48652860708535
only_train_time: 699.6617025323212

-------------Global Round number: 46-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.1028
Averaged Test Accuracy (Prototype Model): 0.1028
Averaged Train Loss (Regular Model): nan
Averaged Train Loss (Regular + Proto): nan
Std Test Accuracy (Regular Model): 0.2341
Std Test Accuracy (Prototype Model): 0.2341
tobetrained:
[5, 9, 3, 4, 1, 6, 2, 0, 7, 8]
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 4 begin training
Edge 1 begin training
Edge 6 begin training
Edge 2 begin training
Edge 0 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[5, 4, 3, 9, 1, 6, 2, 0, 7, 8]
aggregation_buffer:
[5, 4, 3, 9, 1, 6, 2, 0, 7, 8]
class-wise minimum distance tensor([nan, nan, nan, nan, nan, nan, nan, nan, nan, nan], device='cuda:0')
min_gap tensor(nan, device='cuda:0')
max_gap tensor(nan, device='cuda:0')
Server loss: nan
end Update
server_global_time: 56.644418152980506
only_train_time: 714.7045874204487

-------------Global Round number: 47-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.1028
Averaged Test Accuracy (Prototype Model): 0.1028
Averaged Train Loss (Regular Model): nan
Averaged Train Loss (Regular + Proto): nan
Std Test Accuracy (Regular Model): 0.2341
Std Test Accuracy (Prototype Model): 0.2341
tobetrained:
[5, 4, 3, 9, 1, 6, 2, 0, 7, 8]
Edge 5 begin training
Edge 4 begin training
Edge 3 begin training
Edge 9 begin training
Edge 1 begin training
Edge 6 begin training
Edge 2 begin training
Edge 0 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[5, 9, 4, 3, 1, 6, 2, 0, 7, 8]
aggregation_buffer:
[5, 9, 4, 3, 1, 6, 2, 0, 7, 8]
class-wise minimum distance tensor([nan, nan, nan, nan, nan, nan, nan, nan, nan, nan], device='cuda:0')
min_gap tensor(nan, device='cuda:0')
max_gap tensor(nan, device='cuda:0')
Server loss: nan
end Update
server_global_time: 57.830724199302495
only_train_time: 729.8480773698539

-------------Global Round number: 48-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.1028
Averaged Test Accuracy (Prototype Model): 0.1028
Averaged Train Loss (Regular Model): nan
Averaged Train Loss (Regular + Proto): nan
Std Test Accuracy (Regular Model): 0.2341
Std Test Accuracy (Prototype Model): 0.2341
tobetrained:
[5, 9, 4, 3, 1, 6, 2, 0, 7, 8]
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
Edge 1 begin training
Edge 6 begin training
Edge 2 begin training
Edge 0 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[9, 4, 3, 5, 6, 1, 2, 0, 7, 8]
aggregation_buffer:
[9, 4, 3, 5, 6, 1, 2, 0, 7, 8]
class-wise minimum distance tensor([nan, nan, nan, nan, nan, nan, nan, nan, nan, nan], device='cuda:0')
min_gap tensor(nan, device='cuda:0')
max_gap tensor(nan, device='cuda:0')
Server loss: nan
end Update
server_global_time: 59.06796869728714
only_train_time: 744.8652841299772

-------------Global Round number: 49-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.1028
Averaged Test Accuracy (Prototype Model): 0.1028
Averaged Train Loss (Regular Model): nan
Averaged Train Loss (Regular + Proto): nan
Std Test Accuracy (Regular Model): 0.2341
Std Test Accuracy (Prototype Model): 0.2341
tobetrained:
[9, 4, 3, 5, 6, 1, 2, 0, 7, 8]
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
Edge 5 begin training
Edge 6 begin training
Edge 1 begin training
Edge 2 begin training
Edge 0 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[9, 5, 4, 3, 1, 6, 0, 2, 7, 8]
aggregation_buffer:
[9, 5, 4, 3, 1, 6, 0, 2, 7, 8]
class-wise minimum distance tensor([nan, nan, nan, nan, nan, nan, nan, nan, nan, nan], device='cuda:0')
min_gap tensor(nan, device='cuda:0')
max_gap tensor(nan, device='cuda:0')
Server loss: nan
end Update
server_global_time: 60.21594889368862
only_train_time: 759.6345955329016

-------------Global Round number: 50-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.1028
Averaged Test Accuracy (Prototype Model): 0.1028
Averaged Train Loss (Regular Model): nan
Averaged Train Loss (Regular + Proto): nan
Std Test Accuracy (Regular Model): 0.2341
Std Test Accuracy (Prototype Model): 0.2341
tobetrained:
[9, 5, 4, 3, 1, 6, 0, 2, 7, 8]
Edge 9 begin training
Edge 5 begin training
Edge 4 begin training
Edge 3 begin training
Edge 1 begin training
Edge 6 begin training
Edge 0 begin training
Edge 2 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[9, 4, 3, 5, 1, 6, 0, 2, 7, 8]
aggregation_buffer:
[9, 4, 3, 5, 1, 6, 0, 2, 7, 8]
class-wise minimum distance tensor([nan, nan, nan, nan, nan, nan, nan, nan, nan, nan], device='cuda:0')
min_gap tensor(nan, device='cuda:0')
max_gap tensor(nan, device='cuda:0')
Server loss: nan
end Update
server_global_time: 61.43551029730588
only_train_time: 774.3345313286409

-------------Global Round number: 51-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.1028
Averaged Test Accuracy (Prototype Model): 0.1028
Averaged Train Loss (Regular Model): nan
Averaged Train Loss (Regular + Proto): nan
Std Test Accuracy (Regular Model): 0.2341
Std Test Accuracy (Prototype Model): 0.2341
tobetrained:
[9, 4, 3, 5, 1, 6, 0, 2, 7, 8]
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
Edge 5 begin training
Edge 1 begin training
Edge 6 begin training
Edge 0 begin training
Edge 2 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[5, 9, 4, 3, 1, 6, 0, 2, 7, 8]
aggregation_buffer:
[5, 9, 4, 3, 1, 6, 0, 2, 7, 8]
class-wise minimum distance tensor([nan, nan, nan, nan, nan, nan, nan, nan, nan, nan], device='cuda:0')
min_gap tensor(nan, device='cuda:0')
max_gap tensor(nan, device='cuda:0')
Server loss: nan
end Update
server_global_time: 62.65239293593913
only_train_time: 789.3212902247906

-------------Global Round number: 52-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.1028
Averaged Test Accuracy (Prototype Model): 0.1028
Averaged Train Loss (Regular Model): nan
Averaged Train Loss (Regular + Proto): nan
Std Test Accuracy (Regular Model): 0.2341
Std Test Accuracy (Prototype Model): 0.2341
tobetrained:
[5, 9, 4, 3, 1, 6, 0, 2, 7, 8]
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
Edge 1 begin training
Edge 6 begin training
Edge 0 begin training
Edge 2 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[9, 5, 4, 3, 1, 6, 0, 2, 7, 8]
aggregation_buffer:
[9, 5, 4, 3, 1, 6, 0, 2, 7, 8]
class-wise minimum distance tensor([nan, nan, nan, nan, nan, nan, nan, nan, nan, nan], device='cuda:0')
min_gap tensor(nan, device='cuda:0')
max_gap tensor(nan, device='cuda:0')
Server loss: nan
end Update
server_global_time: 63.83341379836202
only_train_time: 803.9047570144758

-------------Global Round number: 53-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.1028
Averaged Test Accuracy (Prototype Model): 0.1028
Averaged Train Loss (Regular Model): nan
Averaged Train Loss (Regular + Proto): nan
Std Test Accuracy (Regular Model): 0.2341
Std Test Accuracy (Prototype Model): 0.2341
tobetrained:
[9, 5, 4, 3, 1, 6, 0, 2, 7, 8]
Edge 9 begin training
Edge 5 begin training
Edge 4 begin training
Edge 3 begin training
Edge 1 begin training
Edge 6 begin training
Edge 0 begin training
Edge 2 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[5, 4, 3, 9, 1, 6, 0, 2, 7, 8]
aggregation_buffer:
[5, 4, 3, 9, 1, 6, 0, 2, 7, 8]
class-wise minimum distance tensor([nan, nan, nan, nan, nan, nan, nan, nan, nan, nan], device='cuda:0')
min_gap tensor(nan, device='cuda:0')
max_gap tensor(nan, device='cuda:0')
Server loss: nan
end Update
server_global_time: 64.9769571851939
only_train_time: 818.4620346724987

-------------Global Round number: 54-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.1028
Averaged Test Accuracy (Prototype Model): 0.1028
Averaged Train Loss (Regular Model): nan
Averaged Train Loss (Regular + Proto): nan
Std Test Accuracy (Regular Model): 0.2341
Std Test Accuracy (Prototype Model): 0.2341
tobetrained:
[5, 4, 3, 9, 1, 6, 0, 2, 7, 8]
Edge 5 begin training
Edge 4 begin training
Edge 3 begin training
Edge 9 begin training
Edge 1 begin training
Edge 6 begin training
Edge 0 begin training
Edge 2 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[5, 3, 9, 4, 1, 6, 2, 0, 7, 8]
aggregation_buffer:
[5, 3, 9, 4, 1, 6, 2, 0, 7, 8]
class-wise minimum distance tensor([nan, nan, nan, nan, nan, nan, nan, nan, nan, nan], device='cuda:0')
min_gap tensor(nan, device='cuda:0')
max_gap tensor(nan, device='cuda:0')
Server loss: nan
end Update
server_global_time: 66.15508594922721
only_train_time: 833.2490749545395

-------------Global Round number: 55-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.1028
Averaged Test Accuracy (Prototype Model): 0.1028
Averaged Train Loss (Regular Model): nan
Averaged Train Loss (Regular + Proto): nan
Std Test Accuracy (Regular Model): 0.2341
Std Test Accuracy (Prototype Model): 0.2341
tobetrained:
[5, 3, 9, 4, 1, 6, 2, 0, 7, 8]
Edge 5 begin training
Edge 3 begin training
Edge 9 begin training
Edge 4 begin training
Edge 1 begin training
Edge 6 begin training
Edge 2 begin training
Edge 0 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[9, 5, 4, 3, 1, 6, 2, 0, 7, 8]
aggregation_buffer:
[9, 5, 4, 3, 1, 6, 2, 0, 7, 8]
class-wise minimum distance tensor([nan, nan, nan, nan, nan, nan, nan, nan, nan, nan], device='cuda:0')
min_gap tensor(nan, device='cuda:0')
max_gap tensor(nan, device='cuda:0')
Server loss: nan
end Update
server_global_time: 67.33714704401791
only_train_time: 848.197952920571

-------------Global Round number: 56-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.1028
Averaged Test Accuracy (Prototype Model): 0.1028
Averaged Train Loss (Regular Model): nan
Averaged Train Loss (Regular + Proto): nan
Std Test Accuracy (Regular Model): 0.2341
Std Test Accuracy (Prototype Model): 0.2341
tobetrained:
[9, 5, 4, 3, 1, 6, 2, 0, 7, 8]
Edge 9 begin training
Edge 5 begin training
Edge 4 begin training
Edge 3 begin training
Edge 1 begin training
Edge 6 begin training
Edge 2 begin training
Edge 0 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[5, 9, 4, 3, 1, 6, 2, 0, 7, 8]
aggregation_buffer:
[5, 9, 4, 3, 1, 6, 2, 0, 7, 8]
class-wise minimum distance tensor([nan, nan, nan, nan, nan, nan, nan, nan, nan, nan], device='cuda:0')
min_gap tensor(nan, device='cuda:0')
max_gap tensor(nan, device='cuda:0')
Server loss: nan
end Update
server_global_time: 68.5096460627392
only_train_time: 862.8899068711326

-------------Global Round number: 57-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.1028
Averaged Test Accuracy (Prototype Model): 0.1028
Averaged Train Loss (Regular Model): nan
Averaged Train Loss (Regular + Proto): nan
Std Test Accuracy (Regular Model): 0.2341
Std Test Accuracy (Prototype Model): 0.2341
tobetrained:
[5, 9, 4, 3, 1, 6, 2, 0, 7, 8]
Edge 5 begin training
Edge 9 begin training
Edge 4 begin training
Edge 3 begin training
Edge 1 begin training
Edge 6 begin training
Edge 2 begin training
Edge 0 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[9, 5, 3, 4, 1, 6, 0, 2, 7, 8]
aggregation_buffer:
[9, 5, 3, 4, 1, 6, 0, 2, 7, 8]
class-wise minimum distance tensor([nan, nan, nan, nan, nan, nan, nan, nan, nan, nan], device='cuda:0')
min_gap tensor(nan, device='cuda:0')
max_gap tensor(nan, device='cuda:0')
Server loss: nan
end Update
server_global_time: 69.6196974189952
only_train_time: 877.2798792440444

-------------Global Round number: 58-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.1028
Averaged Test Accuracy (Prototype Model): 0.1028
Averaged Train Loss (Regular Model): nan
Averaged Train Loss (Regular + Proto): nan
Std Test Accuracy (Regular Model): 0.2341
Std Test Accuracy (Prototype Model): 0.2341
tobetrained:
[9, 5, 3, 4, 1, 6, 0, 2, 7, 8]
Edge 9 begin training
Edge 5 begin training
Edge 3 begin training
Edge 4 begin training
Edge 1 begin training
Edge 6 begin training
Edge 0 begin training
Edge 2 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[5, 9, 3, 4, 1, 6, 0, 2, 7, 8]
aggregation_buffer:
[5, 9, 3, 4, 1, 6, 0, 2, 7, 8]
class-wise minimum distance tensor([nan, nan, nan, nan, nan, nan, nan, nan, nan, nan], device='cuda:0')
min_gap tensor(nan, device='cuda:0')
max_gap tensor(nan, device='cuda:0')
Server loss: nan
end Update
server_global_time: 70.78865094017237
only_train_time: 891.7631364893168

-------------Global Round number: 59-------------

Evaluate heterogeneous models
Averaged Test Accuracy (Regular Model): 0.1028
Averaged Test Accuracy (Prototype Model): 0.1028
Averaged Train Loss (Regular Model): nan
Averaged Train Loss (Regular + Proto): nan
Std Test Accuracy (Regular Model): 0.2341
Std Test Accuracy (Prototype Model): 0.2341
tobetrained:
[5, 9, 3, 4, 1, 6, 0, 2, 7, 8]
Edge 5 begin training
Edge 9 begin training
Edge 3 begin training
Edge 4 begin training
Edge 1 begin training
Edge 6 begin training
Edge 0 begin training
Edge 2 begin training
Edge 7 begin training
Edge 8 begin training
readyList:
[5, 3, 9, 4, 1, 6, 2, 0, 7, 8]
aggregation_buffer:
[5, 3, 9, 4, 1, 6, 2, 0, 7, 8]
class-wise minimum distance tensor([nan, nan, nan, nan, nan, nan, nan, nan, nan, nan], device='cuda:0')
min_gap tensor(nan, device='cuda:0')
max_gap tensor(nan, device='cuda:0')
Server loss: nan
Number of samples: 192
